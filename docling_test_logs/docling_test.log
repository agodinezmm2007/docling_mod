2025-06-10 20:12:27,595 - DEBUG - Test debug message from LayoutPostprocessor.py
2025-06-10 20:12:27,596 - INFO - Test info message from LayoutPostprocessor.py
2025-06-10 20:12:27,803 - INFO - NumExpr defaulting to 12 threads.
2025-06-10 20:12:40,672 - INFO - Starting pipeline
2025-06-10 20:12:40,684 - INFO - Starting multiprocessing docling extraction on 198 records using max_workers=8
2025-06-10 20:12:40,688 - INFO - [MainProc] Submitting row 0, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.3389_fpubh.2021.812743_7.pdf
2025-06-10 20:12:40,698 - INFO - Worker ForkProcess-1 assigned GPU: 1
2025-06-10 20:12:40,706 - INFO - Worker ForkProcess-2 assigned GPU: 2
2025-06-10 20:12:40,714 - INFO - Worker ForkProcess-3 assigned GPU: 1
2025-06-10 20:12:40,722 - INFO - Worker ForkProcess-4 assigned GPU: 2
2025-06-10 20:12:40,729 - INFO - Worker ForkProcess-5 assigned GPU: 1
2025-06-10 20:12:40,736 - INFO - Worker ForkProcess-6 assigned GPU: 2
2025-06-10 20:12:40,743 - INFO - Worker ForkProcess-7 assigned GPU: 1
2025-06-10 20:12:40,749 - INFO - Worker ForkProcess-8 assigned GPU: 2
2025-06-10 20:12:40,752 - INFO - [MainProc] Submitting row 1, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1186_s12916-024-03596-5_14.pdf
2025-06-10 20:12:40,754 - INFO - [MainProc] Submitting row 2, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1016_j.scitotenv.2023.169416_25.pdf
2025-06-10 20:12:40,756 - INFO - [MainProc] Submitting row 3, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1136_bmj-2023-075203_32.pdf
2025-06-10 20:12:40,758 - INFO - [MainProc] Submitting row 4, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1007_s11356-023-29544-z_34.pdf
2025-06-10 20:12:40,759 - INFO - [MainProc] Submitting row 5, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.3389_fpubh.2023.1172532_36.pdf
2025-06-10 20:12:40,761 - INFO - [MainProc] Submitting row 6, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.30773_pi.2022.0352_40.pdf
2025-06-10 20:12:40,763 - INFO - [MainProc] Submitting row 7, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1007_s11356-023-27813-5_41.pdf
2025-06-10 20:12:40,764 - INFO - [MainProc] Submitting row 8, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1186_s12940-023-00978-9_44.pdf
2025-06-10 20:12:40,766 - INFO - [MainProc] Submitting row 9, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.3390_ijerph20043506_45.pdf
2025-06-10 20:12:40,768 - INFO - [MainProc] Submitting row 10, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.4178_epih.e2023020_46.pdf
2025-06-10 20:12:40,775 - INFO - [MainProc] Submitting row 11, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1038_s41598-022-24653-0_51.pdf
2025-06-10 20:12:40,777 - INFO - [MainProc] Submitting row 12, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.3390_ijerph191710547_53.pdf
2025-06-10 20:12:40,779 - INFO - [MainProc] Submitting row 13, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.3390_ijerph16234621_54.pdf
2025-06-10 20:12:40,781 - INFO - [MainProc] Submitting row 14, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.3390_ijerph18168476_68.pdf
2025-06-10 20:12:40,782 - INFO - [MainProc] Submitting row 15, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1186_s12940-021-00726-x_71.pdf
2025-06-10 20:12:40,784 - INFO - [MainProc] Submitting row 16, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1371_journal.pone.0242147_74.pdf
2025-06-10 20:12:40,786 - INFO - [MainProc] Submitting row 17, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1186_s12940-020-00663-1_75.pdf
2025-06-10 20:12:40,788 - INFO - [MainProc] Submitting row 18, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1186_s12940-020-00662-2_77.pdf
2025-06-10 20:12:40,790 - INFO - [MainProc] Submitting row 19, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1186_s12940-020-00575-0_80.pdf
2025-06-10 20:12:40,792 - INFO - [MainProc] Submitting row 20, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1186_s12889-019-7690-4_81.pdf
2025-06-10 20:12:40,793 - INFO - [MainProc] Submitting row 21, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1371_journal.pone.0222601_82.pdf
2025-06-10 20:12:40,795 - INFO - [MainProc] Submitting row 22, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.3390_ijerph16183270_83.pdf
2025-06-10 20:12:40,797 - INFO - [MainProc] Submitting row 23, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1186_s12942-018-0138-8_94.pdf
2025-06-10 20:12:40,799 - INFO - [MainProc] Submitting row 24, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1007_s40615-018-0490-1_96.pdf
2025-06-10 20:12:40,801 - INFO - [MainProc] Submitting row 25, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.13075_ijomeh.1896.01104_98.pdf
2025-06-10 20:12:40,802 - INFO - [MainProc] Submitting row 26, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1186_s12989-017-0237-x_99.pdf
2025-06-10 20:12:40,805 - INFO - [MainProc] Submitting row 27, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.3390_toxics13040318_111.pdf
2025-06-10 20:12:40,807 - INFO - [MainProc] Submitting row 28, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.3390_biomedicines13010241_119.pdf
2025-06-10 20:12:40,809 - INFO - [MainProc] Submitting row 29, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.3390_toxics12120868_124.pdf
2025-06-10 20:12:40,810 - INFO - [MainProc] Submitting row 30, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1186_s12940-024-01148-1_132.pdf
2025-06-10 20:12:40,812 - INFO - [MainProc] Submitting row 31, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1186_s12889-024-20693-5_138.pdf
2025-06-10 20:12:40,814 - INFO - [MainProc] Submitting row 32, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1038_s41598-024-65584-2_157.pdf
2025-06-10 20:12:40,816 - INFO - [MainProc] Submitting row 33, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.3390_polym16101329_164.pdf
2025-06-10 20:12:40,818 - INFO - [MainProc] Submitting row 34, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1021_acs.chemrestox.4c00051_165.pdf
2025-06-10 20:12:40,820 - INFO - [MainProc] Submitting row 35, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1186_s12916-024-03316-z_168.pdf
2025-06-10 20:12:40,822 - INFO - [MainProc] Submitting row 36, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.3390_toxics12020123_170.pdf
2025-06-10 20:12:40,823 - INFO - [MainProc] Submitting row 37, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1038_s41598-023-45062-x_185.pdf
2025-06-10 20:12:40,825 - INFO - [MainProc] Submitting row 38, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.3390_ijerph20146326_196.pdf
2025-06-10 20:12:40,827 - INFO - [MainProc] Submitting row 39, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.3390_toxics11060481_197.pdf
2025-06-10 20:12:40,829 - INFO - [MainProc] Submitting row 40, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1007_s00477-023-02476-3_198.pdf
2025-06-10 20:12:40,831 - INFO - [MainProc] Submitting row 41, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1186_s12942-023-00333-8_202.pdf
2025-06-10 20:12:40,832 - INFO - [MainProc] Submitting row 42, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.3390_ijerph20064695_208.pdf
2025-06-10 20:12:40,834 - INFO - [MainProc] Submitting row 43, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.3390_ijerph20043517_210.pdf
2025-06-10 20:12:40,836 - INFO - [MainProc] Submitting row 44, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.3390_ijerph20032273_215.pdf
2025-06-10 20:12:40,838 - INFO - [MainProc] Submitting row 45, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.7717_peerj.14489_219.pdf
2025-06-10 20:12:40,840 - INFO - [MainProc] Submitting row 46, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1186_s12889-020-08915-y_232.pdf
2025-06-10 20:12:40,842 - INFO - [MainProc] Submitting row 47, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1186_s12989-018-0275-z_237.pdf
2025-06-10 20:12:40,844 - INFO - [MainProc] Submitting row 48, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.3390_ijerph14091091_238.pdf
2025-06-10 20:12:40,846 - INFO - [MainProc] Submitting row 49, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1136_bmj.h1295_242.pdf
2025-06-10 20:12:40,848 - INFO - [MainProc] Submitting row 50, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1016_S0140-67361360898-3_245.pdf
2025-06-10 20:12:40,850 - INFO - [MainProc] Submitting row 51, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1186_1476-069X-12-28_248.pdf
2025-06-10 20:12:40,852 - INFO - [MainProc] Submitting row 52, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1136_jech.2008.084012_252.pdf
2025-06-10 20:12:40,854 - INFO - [MainProc] Submitting row 53, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.3233_SHTI240549_257.pdf
2025-06-10 20:12:40,856 - INFO - [MainProc] Submitting row 54, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.4178_epih.e2022052_261.pdf
2025-06-10 20:12:40,857 - INFO - [MainProc] Submitting row 55, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1371_journal.pone.0062063_278.pdf
2025-06-10 20:12:40,859 - INFO - [MainProc] Submitting row 56, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1186_1476-069X-10-51_283.pdf
2025-06-10 20:12:40,861 - INFO - [MainProc] Submitting row 57, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1186_1476-069X-9-8_287.pdf
2025-06-10 20:12:40,863 - INFO - [MainProc] Submitting row 58, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.2147_JMDH.S412394_303.pdf
2025-06-10 20:12:40,864 - INFO - [MainProc] Submitting row 59, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.4046_trd.2020.0154_314.pdf
2025-06-10 20:12:40,866 - INFO - [MainProc] Submitting row 60, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.3390_ijerph17103591_317.pdf
2025-06-10 20:12:40,868 - INFO - [MainProc] Submitting row 61, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.7196_samj.2022.v112i8b.16483_384.pdf
2025-06-10 20:12:40,870 - INFO - [MainProc] Submitting row 62, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1016_s0140-67361832225-6_386.pdf
2025-06-10 20:12:40,872 - INFO - [MainProc] Submitting row 63, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.3389_fimmu.2019.02518_391.pdf
2025-06-10 20:12:40,874 - INFO - [MainProc] Submitting row 64, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1371_journal.pone.0157014_404.pdf
2025-06-10 20:12:40,876 - INFO - [MainProc] Submitting row 65, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1079_phn2003543_411.pdf
2025-06-10 20:12:40,878 - INFO - [MainProc] Submitting row 66, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1136_oem.2007.033175_418.pdf
2025-06-10 20:12:40,880 - INFO - [MainProc] Submitting row 67, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1136_bmjopen-2015-009493_420.pdf
2025-06-10 20:12:40,881 - INFO - [MainProc] Submitting row 68, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1007_s12199-007-0018-5_428.pdf
2025-06-10 20:12:40,883 - INFO - [MainProc] Submitting row 69, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.3390_ijms20030634_429.pdf
2025-06-10 20:12:40,885 - INFO - [MainProc] Submitting row 70, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.3390_ijms21124306_444.pdf
2025-06-10 20:12:40,887 - INFO - [MainProc] Submitting row 71, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1289_ehp1390_448.pdf
2025-06-10 20:12:40,889 - INFO - [MainProc] Submitting row 72, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1146_annurev-publhealth-052120-101420_449.pdf
2025-06-10 20:12:40,891 - INFO - [MainProc] Submitting row 73, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1186_1476-7120-7-30_452.pdf
2025-06-10 20:12:40,893 - INFO - [MainProc] Submitting row 74, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1016_j.waojou.2020.100106_455.pdf
2025-06-10 20:12:40,895 - INFO - [MainProc] Submitting row 75, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1186_s12940-017-0335-0_457.pdf
2025-06-10 20:12:40,896 - INFO - [MainProc] Submitting row 76, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1186_1465-9921-9-77_470.pdf
2025-06-10 20:12:40,898 - INFO - [MainProc] Submitting row 77, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.3390_su14159234_475.pdf
2025-06-10 20:12:40,900 - INFO - [MainProc] Submitting row 78, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1016_j.freeradbiomed.2020.01.004_485.pdf
2025-06-10 20:12:40,902 - INFO - [MainProc] Submitting row 79, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.5194_acp-18-16173-2018_487.pdf
2025-06-10 20:12:40,904 - INFO - [MainProc] Submitting row 80, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.3390_antiox10081220_490.pdf
2025-06-10 20:12:40,907 - INFO - [MainProc] Submitting row 81, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1017_s2045796019000623_492.pdf
2025-06-10 20:12:40,908 - INFO - [MainProc] Submitting row 82, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1186_1476-069x-13-67_495.pdf
2025-06-10 20:12:40,910 - INFO - [MainProc] Submitting row 83, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.15585_mmwr.ss6613a1_497.pdf
2025-06-10 20:12:40,913 - INFO - [MainProc] Submitting row 84, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1016_s2213-26002030105-3_499.pdf
2025-06-10 20:12:40,915 - INFO - [MainProc] Submitting row 85, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1371_journal.pmed.1002598_506.pdf
2025-06-10 20:12:40,916 - INFO - [MainProc] Submitting row 86, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1016_j.envint.2015.12.001_510.pdf
2025-06-10 20:12:40,918 - INFO - [MainProc] Submitting row 87, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1016_s2542-51962100195-9_512.pdf
2025-06-10 20:12:40,920 - INFO - [MainProc] Submitting row 88, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.2188_jea.je20080047_517.pdf
2025-06-10 20:12:40,922 - INFO - [MainProc] Submitting row 89, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.3389_fpubh.2022.869656_518.pdf
2025-06-10 20:12:40,924 - INFO - [MainProc] Submitting row 90, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.3389_fpubh.2022.864537_523.pdf
2025-06-10 20:12:40,930 - INFO - [MainProc] Submitting row 91, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1016_s0140-67361631679-8_532.pdf
2025-06-10 20:12:40,932 - INFO - [MainProc] Submitting row 92, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.3389_fpubh.2020.00014_533.pdf
2025-06-10 20:12:40,933 - INFO - [MainProc] Submitting row 93, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1371_journal.pone.0137832_537.pdf
2025-06-10 20:12:40,935 - INFO - [MainProc] Submitting row 94, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1108_ijccsm-08-2021-0090_539.pdf
2025-06-10 20:12:40,937 - INFO - [MainProc] Submitting row 95, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.3390_biology11081122_540.pdf
2025-06-10 20:12:40,939 - INFO - [MainProc] Submitting row 96, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.3390_ijerph191811186_544.pdf
2025-06-10 20:12:40,941 - INFO - [MainProc] Submitting row 97, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.3390_atmos13050788_558.pdf
2025-06-10 20:12:40,950 - INFO - [MainProc] Submitting row 98, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1116_1.2815690_576.pdf
2025-06-10 20:12:40,952 - INFO - [MainProc] Submitting row 99, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1038_ncomms2832_588.pdf
2025-06-10 20:12:40,957 - INFO - [MainProc] Submitting row 100, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.3389_fphys.2020.00694_591.pdf
2025-06-10 20:12:40,959 - INFO - [MainProc] Submitting row 101, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.5812_jhealthscope.105567_595.pdf
2025-06-10 20:12:40,961 - INFO - [MainProc] Submitting row 102, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1186_1476-069x-8-40_601.pdf
2025-06-10 20:12:40,963 - INFO - [MainProc] Submitting row 103, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1038_s41370-019-0135-4_608.pdf
2025-06-10 20:12:40,965 - INFO - [MainProc] Submitting row 104, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1186_1476-069x-9-3_611.pdf
2025-06-10 20:12:41,015 - INFO - [MainProc] Submitting row 105, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.3390_ijerph16071227_612.pdf
2025-06-10 20:12:41,017 - INFO - [MainProc] Submitting row 106, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.2739_kurumemedj.ms644002_614.pdf
2025-06-10 20:12:41,019 - INFO - [MainProc] Submitting row 107, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.3390_atmos15030380_624.pdf
2025-06-10 20:12:41,021 - INFO - [MainProc] Submitting row 108, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.30955_gnj.005358_627.pdf
2025-06-10 20:12:41,022 - INFO - [MainProc] Submitting row 109, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.31390_gradschool_theses.3567_628.pdf
2025-06-10 20:12:41,026 - INFO - [MainProc] Submitting row 110, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.18297_etd_3639_629.pdf
2025-06-10 20:12:41,028 - INFO - [MainProc] Submitting row 111, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.20868_upm.thesis.32872_630.pdf
2025-06-10 20:12:41,030 - INFO - [MainProc] Submitting row 112, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1186_s12940-021-00708-z_631.pdf
2025-06-10 20:12:41,032 - INFO - [MainProc] Submitting row 113, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.3390_nu7125539_632.pdf
2025-06-10 20:12:41,034 - INFO - [MainProc] Submitting row 114, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.3390_ijerph13040378_634.pdf
2025-06-10 20:12:41,035 - INFO - [MainProc] Submitting row 115, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.3390_ijerph13070728_635.pdf
2025-06-10 20:12:41,037 - INFO - [MainProc] Submitting row 116, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1093_exposome_osae001_637.pdf
2025-06-10 20:12:41,039 - INFO - [MainProc] Submitting row 117, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.3390_ijerph181910386_639.pdf
2025-06-10 20:12:41,041 - INFO - [MainProc] Submitting row 118, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1186_s12889-020-09766-3_642.pdf
2025-06-10 20:12:41,042 - INFO - [MainProc] Submitting row 119, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.3808_jei.200800130_645.pdf
2025-06-10 20:12:41,044 - INFO - [MainProc] Submitting row 120, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1007_s40471-022-00290-z_649.pdf
2025-06-10 20:12:41,046 - INFO - [MainProc] Submitting row 121, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1186_s12911-024-02815-6_650.pdf
2025-06-10 20:12:41,048 - INFO - [MainProc] Submitting row 122, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.11606_t.6.2016.tde-26092016-142458_652.pdf
2025-06-10 20:12:41,050 - INFO - [MainProc] Submitting row 123, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1371_journal.pone.0122245_653.pdf
2025-06-10 20:12:41,052 - INFO - [MainProc] Submitting row 124, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.4081_gh.2018.587_655.pdf
2025-06-10 20:12:41,054 - INFO - [MainProc] Submitting row 125, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.3389_fneur.2024.1260643_656.pdf
2025-06-10 20:12:41,056 - INFO - [MainProc] Submitting row 126, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.5194_acp-22-6523-2022_663.pdf
2025-06-10 20:12:41,058 - INFO - [MainProc] Submitting row 127, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.5194_acp-21-18589-2021_666.pdf
2025-06-10 20:12:41,060 - INFO - [MainProc] Submitting row 128, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.5194_acp-21-10347-2021_667.pdf
2025-06-10 20:12:41,061 - INFO - [MainProc] Submitting row 129, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.3390_ijerph13121219_669.pdf
2025-06-10 20:12:41,063 - INFO - [MainProc] Submitting row 130, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1007_s00038-015-0690-y_676.pdf
2025-06-10 20:12:41,065 - INFO - [MainProc] Submitting row 131, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.3390_atmos14101591_687.pdf
2025-06-10 20:12:41,066 - INFO - [MainProc] Submitting row 132, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1214_10-aoas351_689.pdf
2025-06-10 20:12:41,068 - INFO - [MainProc] Submitting row 133, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1007_s10661-015-4850-6_693.pdf
2025-06-10 20:12:41,070 - INFO - [MainProc] Submitting row 134, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.3390_ijerph121012735_696.pdf
2025-06-10 20:12:41,072 - INFO - [MainProc] Submitting row 135, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.3390_foods10061279_697.pdf
2025-06-10 20:12:41,078 - INFO - [MainProc] Submitting row 136, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1186_1476-069x-14-3_700.pdf
2025-06-10 20:12:41,080 - INFO - [MainProc] Submitting row 137, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.3390_atmos8030061_703.pdf
2025-06-10 20:12:41,082 - INFO - [MainProc] Submitting row 138, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.3390_atmos11121365_709.pdf
2025-06-10 20:12:41,083 - INFO - [MainProc] Submitting row 139, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1007_s10113-013-0444-4_712.pdf
2025-06-10 20:12:41,085 - INFO - [MainProc] Submitting row 140, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.3390_atmos9020074_714.pdf
2025-06-10 20:12:41,087 - INFO - [MainProc] Submitting row 141, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.5620_eaht.2023016_718.pdf
2025-06-10 20:12:41,089 - INFO - [MainProc] Submitting row 142, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.3390_atmos11121271_719.pdf
2025-06-10 20:12:41,090 - INFO - [MainProc] Submitting row 143, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1038_s41467-024-55450-0_721.pdf
2025-06-10 20:12:41,092 - INFO - [MainProc] Submitting row 144, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1136_bmjopen-2016-013941_722.pdf
2025-06-10 20:12:41,094 - INFO - [MainProc] Submitting row 145, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1007_s10584-013-0847-8_723.pdf
2025-06-10 20:12:41,096 - INFO - [MainProc] Submitting row 146, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.3390_catal11080998_724.pdf
2025-06-10 20:12:41,098 - INFO - [MainProc] Submitting row 147, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.3390_ijerph15040736_730.pdf
2025-06-10 20:12:41,100 - INFO - [MainProc] Submitting row 148, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.5194_acp-19-13367-2019_742.pdf
2025-06-10 20:12:41,102 - INFO - [MainProc] Submitting row 149, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.3390_atmos14121806_744.pdf
2025-06-10 20:12:41,104 - INFO - [MainProc] Submitting row 150, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.3390_ijerph120708075_762.pdf
2025-06-10 20:12:41,105 - INFO - [MainProc] Submitting row 151, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1136_bmj-2023-077784_764.pdf
2025-06-10 20:12:41,107 - INFO - [MainProc] Submitting row 152, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.3390_ijerph15112487_768.pdf
2025-06-10 20:12:41,109 - INFO - [MainProc] Submitting row 153, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1186_1476-069x-11-5_771.pdf
2025-06-10 20:12:41,111 - INFO - [MainProc] Submitting row 154, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.4209_aaqr.2009.10.0061_772.pdf
2025-06-10 20:12:41,113 - INFO - [MainProc] Submitting row 155, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.2188_jea.je20110049_780.pdf
2025-06-10 20:12:41,114 - INFO - [MainProc] Submitting row 156, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1186_1476-069x-11-82_782.pdf
2025-06-10 20:12:41,116 - INFO - [MainProc] Submitting row 157, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1186_s12940-019-0476-4_784.pdf
2025-06-10 20:12:41,118 - INFO - [MainProc] Submitting row 158, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1590_s0034-8910.2014048005218_785.pdf
2025-06-10 20:12:41,120 - INFO - [MainProc] Submitting row 159, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1371_journal.pone.0076759_787.pdf
2025-06-10 20:12:41,122 - INFO - [MainProc] Submitting row 160, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.3390_atmos11080868_789.pdf
2025-06-10 20:12:41,124 - INFO - [MainProc] Submitting row 161, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.3390_ijerph13050454_790.pdf
2025-06-10 20:12:41,125 - INFO - [MainProc] Submitting row 162, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1186_s41256-018-0080-0_792.pdf
2025-06-10 20:12:41,127 - INFO - [MainProc] Submitting row 163, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.20882_adicciones.233_793.pdf
2025-06-10 20:12:41,129 - INFO - [MainProc] Submitting row 164, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1371_journal.pone.0108076_794.pdf
2025-06-10 20:12:41,131 - INFO - [MainProc] Submitting row 165, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.20882_adicciones.114_797.pdf
2025-06-10 20:12:41,133 - INFO - [MainProc] Submitting row 166, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1136_heartjnl-2021-320082_798.pdf
2025-06-10 20:12:41,134 - INFO - [MainProc] Submitting row 167, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.3390_ijerph16111904_801.pdf
2025-06-10 20:12:41,136 - INFO - [MainProc] Submitting row 168, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1186_s12889-017-4332-6_803.pdf
2025-06-10 20:12:41,138 - INFO - [MainProc] Submitting row 169, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.2174_1874192401812010071_804.pdf
2025-06-10 20:12:41,140 - INFO - [MainProc] Submitting row 170, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.21203_rs.3.rs-25309_v1_807.pdf
2025-06-10 20:12:41,141 - INFO - [MainProc] Submitting row 171, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.3390_atmos11010018_809.pdf
2025-06-10 20:12:41,143 - INFO - [MainProc] Submitting row 172, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1186_1476-069x-9-37_830.pdf
2025-06-10 20:12:41,145 - INFO - [MainProc] Submitting row 173, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.7717_peerj.3574_839.pdf
2025-06-10 20:12:41,146 - INFO - [MainProc] Submitting row 174, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.3390_atmos7120158_852.pdf
2025-06-10 20:12:41,149 - INFO - [MainProc] Submitting row 175, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1136_bmj.n534_856.pdf
2025-06-10 20:12:41,152 - INFO - [MainProc] Submitting row 176, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1371_journal.pone.0066403_859.pdf
2025-06-10 20:12:41,154 - INFO - [MainProc] Submitting row 177, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1183_16000617.0242-2020_866.pdf
2025-06-10 20:12:41,156 - INFO - [MainProc] Submitting row 178, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.51523_2708-6011.2007-4-4-27_871.pdf
2025-06-10 20:12:41,158 - INFO - [MainProc] Submitting row 179, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.3390_ijerph111111772_873.pdf
2025-06-10 20:12:41,160 - INFO - [MainProc] Submitting row 180, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1186_s12940-016-0102-7_876.pdf
2025-06-10 20:12:41,161 - INFO - [MainProc] Submitting row 181, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1136_bmjopen-2019-034854_880.pdf
2025-06-10 20:12:41,163 - INFO - [MainProc] Submitting row 182, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1016_j.chest.2021.07.2170_889.pdf
2025-06-10 20:12:41,165 - INFO - [MainProc] Submitting row 183, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.3390_ijerph17062130_897.pdf
2025-06-10 20:12:41,166 - INFO - [MainProc] Submitting row 184, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1214_14-aoas754_900.pdf
2025-06-10 20:12:41,168 - INFO - [MainProc] Submitting row 185, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.3390_su9040559_910.pdf
2025-06-10 20:12:41,174 - INFO - [MainProc] Submitting row 186, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.5194_acp-20-7509-2020_912.pdf
2025-06-10 20:12:41,176 - INFO - [MainProc] Submitting row 187, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.3390_ijerph8104013_917.pdf
2025-06-10 20:12:41,178 - INFO - [MainProc] Submitting row 188, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1088_1748-9326_abe6c4_919.pdf
2025-06-10 20:12:41,180 - INFO - [MainProc] Submitting row 189, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1515_acgeo-2016-0067_931.pdf
2025-06-10 20:12:41,182 - INFO - [MainProc] Submitting row 190, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.13075_ijomeh.1896.00379_933.pdf
2025-06-10 20:12:41,190 - INFO - [MainProc] Submitting row 191, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1007_s11869-024-01546-x_940.pdf
2025-06-10 20:12:41,192 - INFO - [MainProc] Submitting row 192, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1101_489518_945.pdf
2025-06-10 20:12:41,194 - INFO - [MainProc] Submitting row 193, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1101_2022.02.21.22271281_947.pdf
2025-06-10 20:12:41,196 - INFO - [MainProc] Submitting row 194, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.5194_acp-15-8889-2015_961.pdf
2025-06-10 20:12:41,198 - INFO - [MainProc] Submitting row 195, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1136_oemed-2018-icohabstracts.1265_965.pdf
2025-06-10 20:12:41,199 - INFO - [MainProc] Submitting row 196, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.1525_elementa.273_967.pdf
2025-06-10 20:12:41,201 - INFO - [MainProc] Submitting row 197, pdf=/mnt/c/Users/WSTATION/Desktop/docling_mods/data/NEW_ETL_PDF/10.26868_25222708.2023.1472_968.pdf
2025-06-10 20:12:46,899 - INFO - Going to convert document batch...
2025-06-10 20:12:46,899 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:12:46,923 - INFO - Loading plugin 'docling_defaults'
2025-06-10 20:12:46,924 - INFO - Registered ocr engines: ['easyocr', 'ocrmac', 'rapidocr', 'tesserocr', 'tesseract']
2025-06-10 20:12:46,924 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:12:46,956 - INFO - Going to convert document batch...
2025-06-10 20:12:46,956 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:12:46,977 - DEBUG - Starting new HTTPS connection (1): huggingface.co:443
2025-06-10 20:12:46,980 - INFO - Going to convert document batch...
2025-06-10 20:12:46,980 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:12:46,982 - INFO - Loading plugin 'docling_defaults'
2025-06-10 20:12:46,982 - INFO - Registered ocr engines: ['easyocr', 'ocrmac', 'rapidocr', 'tesserocr', 'tesseract']
2025-06-10 20:12:46,983 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:12:47,003 - INFO - Going to convert document batch...
2025-06-10 20:12:47,003 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:12:47,004 - INFO - Going to convert document batch...
2025-06-10 20:12:47,004 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:12:47,004 - INFO - Loading plugin 'docling_defaults'
2025-06-10 20:12:47,005 - INFO - Registered ocr engines: ['easyocr', 'ocrmac', 'rapidocr', 'tesserocr', 'tesseract']
2025-06-10 20:12:47,005 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:12:47,009 - INFO - Going to convert document batch...
2025-06-10 20:12:47,009 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:12:47,012 - INFO - Going to convert document batch...
2025-06-10 20:12:47,013 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:12:47,026 - INFO - Loading plugin 'docling_defaults'
2025-06-10 20:12:47,027 - INFO - Registered ocr engines: ['easyocr', 'ocrmac', 'rapidocr', 'tesserocr', 'tesseract']
2025-06-10 20:12:47,027 - INFO - Loading plugin 'docling_defaults'
2025-06-10 20:12:47,027 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:12:47,027 - INFO - Registered ocr engines: ['easyocr', 'ocrmac', 'rapidocr', 'tesserocr', 'tesseract']
2025-06-10 20:12:47,028 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:12:47,031 - INFO - Loading plugin 'docling_defaults'
2025-06-10 20:12:47,032 - INFO - Registered ocr engines: ['easyocr', 'ocrmac', 'rapidocr', 'tesserocr', 'tesseract']
2025-06-10 20:12:47,032 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:12:47,035 - DEBUG - Starting new HTTPS connection (1): huggingface.co:443
2025-06-10 20:12:47,035 - INFO - Loading plugin 'docling_defaults'
2025-06-10 20:12:47,035 - INFO - Registered ocr engines: ['easyocr', 'ocrmac', 'rapidocr', 'tesserocr', 'tesseract']
2025-06-10 20:12:47,036 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:12:47,054 - DEBUG - Starting new HTTPS connection (1): huggingface.co:443
2025-06-10 20:12:47,078 - DEBUG - Starting new HTTPS connection (1): huggingface.co:443
2025-06-10 20:12:47,079 - DEBUG - Starting new HTTPS connection (1): huggingface.co:443
2025-06-10 20:12:47,081 - DEBUG - Starting new HTTPS connection (1): huggingface.co:443
2025-06-10 20:12:47,083 - INFO - Going to convert document batch...
2025-06-10 20:12:47,083 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:12:47,084 - DEBUG - Starting new HTTPS connection (1): huggingface.co:443
2025-06-10 20:12:47,105 - INFO - Loading plugin 'docling_defaults'
2025-06-10 20:12:47,106 - INFO - Registered ocr engines: ['easyocr', 'ocrmac', 'rapidocr', 'tesserocr', 'tesseract']
2025-06-10 20:12:47,106 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:12:47,154 - DEBUG - Starting new HTTPS connection (1): huggingface.co:443
2025-06-10 20:12:47,168 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:12:47,169 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:12:47,174 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:12:47,195 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:12:47,195 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:12:47,214 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:12:47,266 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:12:47,294 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:12:48,918 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:12:48,922 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:12:48,944 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:12:48,992 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:12:48,998 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:12:48,998 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:12:49,004 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:12:49,004 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:12:49,004 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:12:49,006 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:12:49,009 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:12:49,012 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:12:49,013 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:12:49,017 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:12:49,053 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:12:49,055 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:12:49,057 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:12:49,059 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:12:49,060 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:12:49,060 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:12:49,061 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:12:49,062 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:12:49,066 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:12:49,067 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:12:51,006 - INFO - Loading plugin 'docling_defaults'
2025-06-10 20:12:51,006 - INFO - Registered picture descriptions: ['vlm', 'api']
2025-06-10 20:12:51,007 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:12:51,034 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:12:51,035 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:12:51,073 - INFO - Loading plugin 'docling_defaults'
2025-06-10 20:12:51,073 - INFO - Registered picture descriptions: ['vlm', 'api']
2025-06-10 20:12:51,073 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:12:51,095 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:12:51,095 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:12:51,095 - INFO - Loading plugin 'docling_defaults'
2025-06-10 20:12:51,096 - INFO - Registered picture descriptions: ['vlm', 'api']
2025-06-10 20:12:51,096 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:12:51,119 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:12:51,119 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:12:51,132 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:12:51,139 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:12:51,151 - INFO - Loading plugin 'docling_defaults'
2025-06-10 20:12:51,151 - INFO - Registered picture descriptions: ['vlm', 'api']
2025-06-10 20:12:51,152 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:12:51,152 - INFO - Loading plugin 'docling_defaults'
2025-06-10 20:12:51,152 - INFO - Registered picture descriptions: ['vlm', 'api']
2025-06-10 20:12:51,153 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:12:51,156 - INFO - Loading plugin 'docling_defaults'
2025-06-10 20:12:51,156 - INFO - Registered picture descriptions: ['vlm', 'api']
2025-06-10 20:12:51,156 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:12:51,162 - INFO - Loading plugin 'docling_defaults'
2025-06-10 20:12:51,162 - INFO - Registered picture descriptions: ['vlm', 'api']
2025-06-10 20:12:51,162 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:12:51,168 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:12:51,170 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:12:51,171 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:12:51,171 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:12:51,172 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:12:51,174 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:12:51,174 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:12:51,180 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:12:51,181 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:12:51,184 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:12:51,199 - INFO - Loading plugin 'docling_defaults'
2025-06-10 20:12:51,200 - INFO - Registered picture descriptions: ['vlm', 'api']
2025-06-10 20:12:51,200 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:12:51,207 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:12:51,214 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:12:51,216 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:12:51,217 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:12:51,230 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:12:51,242 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:12:51,244 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:12:51,254 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:12:51,256 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:12:51,266 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:12:51,279 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:12:51,285 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:12:51,286 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:12:51,290 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:12:51,307 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:12:51,324 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:12:51,327 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:12:51,336 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:12:51,340 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:12:51,342 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:12:51,350 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:12:51,361 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:12:51,373 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:12:51,375 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:12:51,376 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:12:51,391 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:12:51,417 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:12:51,422 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:12:51,429 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:12:51,438 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:12:51,463 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:12:51,465 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:12:51,465 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:12:51,466 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:12:51,472 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:12:51,473 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:12:51,499 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:12:51,503 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:12:51,504 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:12:51,513 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:12:51,531 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:12:51,539 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:12:51,541 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:12:51,569 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:12:51,577 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:12:51,579 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:12:51,585 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:12:51,590 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:12:51,607 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:12:51,613 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:12:51,623 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:12:51,623 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:12:51,626 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:12:51,647 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:12:51,658 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:12:51,665 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:12:51,690 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:12:51,717 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:12:51,742 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:12:51,746 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:12:51,764 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:12:51,809 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:12:51,819 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:12:51,830 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:12:51,847 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:12:51,862 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:12:51,868 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:12:51,909 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:12:51,954 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:12:51,976 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:12:51,982 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:12:52,002 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:12:52,017 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:12:52,018 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:12:52,060 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:12:52,076 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:12:52,082 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:12:52,088 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:12:52,156 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:12:52,213 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:12:52,222 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:12:52,225 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:12:52,236 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:12:52,238 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:12:52,238 - INFO - Processing document 10.1007_s11356-023-29544-z_34.pdf
2025-06-10 20:12:52,275 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:12:52,276 - INFO - Processing document 10.3389_fpubh.2021.812743_7.pdf
2025-06-10 20:12:52,346 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:12:52,347 - INFO - Processing document 10.30773_pi.2022.0352_40.pdf
2025-06-10 20:12:52,388 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:12:52,388 - INFO - Processing document 10.1136_bmj-2023-075203_32.pdf
2025-06-10 20:12:52,404 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:12:52,405 - INFO - Processing document 10.1016_j.scitotenv.2023.169416_25.pdf
2025-06-10 20:12:52,459 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:12:52,600 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:12:52,601 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:12:52,636 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:12:52,637 - INFO - Processing document 10.3389_fpubh.2023.1172532_36.pdf
2025-06-10 20:12:52,805 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:12:52,805 - INFO - Processing document 10.1007_s11356-023-27813-5_41.pdf
2025-06-10 20:12:52,822 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:12:52,822 - INFO - Processing document 10.1186_s12916-024-03596-5_14.pdf
2025-06-10 20:12:53,341 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:12:53,426 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:12:53,614 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:12:53,616 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:12:53,946 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:12:54,290 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:12:54,324 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:12:54,330 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:12:54,539 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:12:54,754 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:12:54,838 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:12:55,154 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:12:55,292 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:12:55,369 - DEBUG - Dynamic vertical threshold: 46.28699999999986, Overlap threshold: 0.7
2025-06-10 20:12:55,369 - DEBUG - Checking merge:
  Current: 17, Next: 28
2025-06-10 20:12:55,370 - DEBUG -   Vertical gap: 18.682000000000016, Overlap ratio: 0.9999966752113735
2025-06-10 20:12:55,370 - DEBUG -   Left boundary diff: 4.518000000000029, Right boundary diff: 0.0009999999999763531
2025-06-10 20:12:55,370 - DEBUG -   Alignment factor (ratio): 0.022252923836191436
2025-06-10 20:12:55,371 - DEBUG -   -> c1 17 formula number: 4, c2 28 formula number: 1
2025-06-10 20:12:55,371 - DEBUG -   -> Not merging clusters 17 and 28 due to different formula numbers: 4 vs 1
2025-06-10 20:12:55,371 - DEBUG - Checking merge:
  Current: 17, Next: 29
2025-06-10 20:12:55,371 - DEBUG -   Vertical gap: 39.160999999999945, Overlap ratio: 0.9835038391467579
2025-06-10 20:12:55,371 - DEBUG -   Left boundary diff: 4.473000000000013, Right boundary diff: 34.09000000000003
2025-06-10 20:12:55,371 - DEBUG -   Alignment factor (ratio): 0.1833165288700681
2025-06-10 20:12:55,372 - DEBUG -   -> c1 17 formula number: 4, c2 29 formula number: None
2025-06-10 20:12:55,372 - DEBUG -   -> Not merging 17 and 29 (one missing, gap 39.160999999999945 > 12.8)
2025-06-10 20:12:55,372 - DEBUG - Checking merge:
  Current: 17, Next: 30
2025-06-10 20:12:55,372 - DEBUG -   Vertical gap: 41.46600000000001, Overlap ratio: 0.9036938850752295
2025-06-10 20:12:55,372 - DEBUG -   Left boundary diff: 10.971000000000004, Right boundary diff: 197.82399999999996
2025-06-10 20:12:55,373 - DEBUG -   Alignment factor (ratio): 1.8428890162048357
2025-06-10 20:12:55,373 - DEBUG -   -> c1 17 formula number: 4, c2 30 formula number: None
2025-06-10 20:12:55,373 - DEBUG - Checking merge:
  Current: 27, Next: 29
2025-06-10 20:12:55,373 - DEBUG -   Vertical gap: 15.778999999999996, Overlap ratio: 1.0
2025-06-10 20:12:55,374 - DEBUG -   Left boundary diff: 0.045000000000015916, Right boundary diff: 34.089000000000055
2025-06-10 20:12:55,374 - DEBUG -   Alignment factor (ratio): 0.18111156565951758
2025-06-10 20:12:55,374 - DEBUG -   -> c1 27 formula number: 1, c2 29 formula number: None
2025-06-10 20:12:55,374 - DEBUG -   -> Not merging 27 and 29 (one missing, gap 15.778999999999996 > 12.8)
2025-06-10 20:12:55,375 - DEBUG - Checking merge:
  Current: 27, Next: 30
2025-06-10 20:12:55,375 - DEBUG -   Vertical gap: 18.08400000000006, Overlap ratio: 0.9433539914675471
2025-06-10 20:12:55,375 - DEBUG -   Left boundary diff: 6.4529999999999745, Right boundary diff: 197.82299999999998
2025-06-10 20:12:55,375 - DEBUG -   Alignment factor (ratio): 1.8049049752287798
2025-06-10 20:12:55,375 - DEBUG -   -> c1 27 formula number: 1, c2 30 formula number: None
2025-06-10 20:12:55,375 - DEBUG -   -> Not merging 27 and 30 (one missing, gap 18.08400000000006 > 12.8)
2025-06-10 20:12:55,376 - DEBUG - Checking merge:
  Current: 27, Next: 31
2025-06-10 20:12:55,376 - DEBUG -   Vertical gap: 35.013000000000034, Overlap ratio: 0.9999928442625299
2025-06-10 20:12:55,376 - DEBUG -   Left boundary diff: 25.793999999999983, Right boundary diff: 0.0019999999999527063
2025-06-10 20:12:55,376 - DEBUG -   Alignment factor (ratio): 0.13407002370160911
2025-06-10 20:12:55,376 - DEBUG -   -> c1 27 formula number: 1, c2 31 formula number: 7
2025-06-10 20:12:55,377 - DEBUG -   -> Not merging clusters 27 and 31 due to different formula numbers: 1 vs 7
2025-06-10 20:12:55,377 - DEBUG - Checking merge:
  Current: 28, Next: 31
2025-06-10 20:12:55,377 - DEBUG -   Vertical gap: 13.999000000000024, Overlap ratio: 0.9999928442625299
2025-06-10 20:12:55,377 - DEBUG -   Left boundary diff: 25.793999999999983, Right boundary diff: 0.0019999999999527063
2025-06-10 20:12:55,377 - DEBUG -   Alignment factor (ratio): 0.13407002370160911
2025-06-10 20:12:55,378 - DEBUG -   -> c1 28 formula number: 1, c2 31 formula number: 7
2025-06-10 20:12:55,378 - DEBUG -   -> Not merging clusters 28 and 31 due to different formula numbers: 1 vs 7
2025-06-10 20:12:55,378 - DEBUG - Checking merge:
  Current: 29, Next: 31
2025-06-10 20:12:55,378 - DEBUG -   Vertical gap: 0.8389999999999418, Overlap ratio: 0.9050392028146368
2025-06-10 20:12:55,378 - DEBUG -   Left boundary diff: 25.748999999999967, Right boundary diff: 34.09100000000001
2025-06-10 20:12:55,378 - DEBUG -   Alignment factor (ratio): 0.19444460288036514
2025-06-10 20:12:55,379 - DEBUG -   -> c1 29 formula number: None, c2 31 formula number: 7
2025-06-10 20:12:55,379 - DEBUG - Checking merge:
  Current: 30, Next: 31
2025-06-10 20:12:55,379 - DEBUG -   Vertical gap: 2.1920000000000073, Overlap ratio: 0.7169279657297358
2025-06-10 20:12:55,379 - DEBUG -   Left boundary diff: 32.24699999999996, Right boundary diff: 197.82499999999993
2025-06-10 20:12:55,379 - DEBUG -   Alignment factor (ratio): 2.0456120032676015
2025-06-10 20:12:55,380 - DEBUG -   -> c1 30 formula number: None, c2 31 formula number: 7
2025-06-10 20:12:55,380 - DEBUG - Checking merge:
  Current: 31, Next: 10
2025-06-10 20:12:55,380 - DEBUG -   Vertical gap: 43.20999999999992, Overlap ratio: 0.9999964221312649
2025-06-10 20:12:55,380 - DEBUG -   Left boundary diff: 23.363999999999976, Right boundary diff: 0.0009999999999763531
2025-06-10 20:12:55,380 - DEBUG -   Alignment factor (ratio): 0.122211034248277
2025-06-10 20:12:55,380 - DEBUG -   -> c1 31 formula number: 7, c2 10 formula number: 8
2025-06-10 20:12:55,381 - DEBUG -   -> Not merging clusters 31 and 10 due to different formula numbers: 7 vs 8
2025-06-10 20:12:55,381 - DEBUG - Checking merge:
  Current: 18, Next: 9
2025-06-10 20:12:55,381 - DEBUG -   Vertical gap: 14.394000000000005, Overlap ratio: 0.07754138623967345
2025-06-10 20:12:55,381 - DEBUG -   Left boundary diff: 273.63599999999997, Right boundary diff: 260.28
2025-06-10 20:12:55,381 - DEBUG -   Alignment factor (ratio): 1.4490592415681247
2025-06-10 20:12:55,382 - DEBUG -   -> c1 18 formula number: 9, c2 9 formula number: 1
2025-06-10 20:12:55,382 - DEBUG -   -> Not merging clusters 18 and 9 due to different formula numbers: 9 vs 1
2025-06-10 20:12:55,382 - DEBUG - Checking merge:
  Current: 9, Next: 19
2025-06-10 20:12:55,382 - DEBUG -   Vertical gap: 28.635999999999967, Overlap ratio: 1.0
2025-06-10 20:12:55,382 - DEBUG -   Left boundary diff: 30.168000000000006, Right boundary diff: 0.0
2025-06-10 20:12:55,383 - DEBUG -   Alignment factor (ratio): 0.14324854344037724
2025-06-10 20:12:55,383 - DEBUG -   -> c1 9 formula number: 1, c2 19 formula number: 2
2025-06-10 20:12:55,383 - DEBUG -   -> Not merging clusters 9 and 19 due to different formula numbers: 1 vs 2
2025-06-10 20:12:55,383 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:12:55,399 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:12:55,462 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:12:55,609 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:12:55,633 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:12:55,753 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:12:55,963 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:12:55,964 - DEBUG - Finished converting page batch time=3496.047
2025-06-10 20:12:56,062 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:12:56,381 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:12:56,503 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:12:56,522 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:12:56,851 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:12:56,995 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:12:57,015 - DEBUG - Finished converting page batch time=3497.098
2025-06-10 20:12:57,025 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:12:57,029 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:12:57,206 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:12:57,438 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:12:58,017 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:12:58,149 - DEBUG - Finished converting page batch time=3498.232
2025-06-10 20:12:58,201 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:12:58,523 - DEBUG - Finished converting page batch time=3498.606
2025-06-10 20:12:58,731 - DEBUG - Finished converting page batch time=3498.814
2025-06-10 20:12:58,798 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:12:58,811 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:12:58,826 - DEBUG - Dynamic vertical threshold: 46.287000000000056, Overlap threshold: 0.7
2025-06-10 20:12:58,826 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:12:58,885 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:12:59,096 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:12:57,168 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:12:57,244 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:12:57,312 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:12:57,370 - DEBUG - Finished converting page batch time=3499.656
2025-06-10 20:12:57,798 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:12:58,248 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:12:58,371 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:12:58,428 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:12:58,480 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:12:58,512 - DEBUG - Finished converting page batch time=3500.799
2025-06-10 20:12:58,647 - DEBUG - Finished converting page batch time=3500.933
2025-06-10 20:12:58,959 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:12:59,144 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:12:59,185 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:12:59,186 - DEBUG - Finished converting page batch time=3501.472
2025-06-10 20:12:59,189 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:12:59,190 - DEBUG - Finished converting page batch time=3501.477
2025-06-10 20:12:59,295 - INFO - Finished converting document 10.1007_s11356-023-29544-z_34.pdf in 14.55 sec.
2025-06-10 20:12:59,352 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:12:59,407 - INFO - Extraction successful row 4, tokens=11014
2025-06-10 20:12:59,422 - INFO - Going to convert document batch...
2025-06-10 20:12:59,423 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:12:59,423 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:12:59,462 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:12:59,471 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:12:59,765 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:00,103 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:13:00,168 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:13:00,174 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:13:00,462 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:00,471 - DEBUG - Finished converting page batch time=3502.757
2025-06-10 20:13:00,543 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:00,551 - DEBUG - Finished converting page batch time=3502.837
2025-06-10 20:13:00,571 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:00,603 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:00,606 - DEBUG - Finished converting page batch time=3502.893
2025-06-10 20:13:00,711 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:00,712 - DEBUG - Finished converting page batch time=3502.999
2025-06-10 20:13:00,791 - DEBUG - Creating masked image for page 2 with 30 clusters.
2025-06-10 20:13:00,795 - INFO - Masked image successfully created for page 2.
2025-06-10 20:13:00,804 - INFO - Starting prediction for 5 images with labels: ['formula', 'formula', 'formula', 'formula', 'formula']
2025-06-10 20:13:00,804 - DEBUG - Generating chat message for label: formula
2025-06-10 20:13:00,809 - DEBUG - Snippet 10.3389_fpubh.2021.812743_7_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:13:00,946 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:13:00,946 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:13:00,946 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:13:00,976 - DEBUG - Snippet 10.3389_fpubh.2021.812743_7_item_0 => input_ids shape=torch.Size([1, 610]), prompt_len=610
2025-06-10 20:13:01,021 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:13:01,057 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:13:01,094 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:13:01,141 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:13:01,178 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:13:01,287 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:13:01,385 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:01,493 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:13:01,529 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:13:01,565 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:13:01,630 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:01,632 - DEBUG - Finished converting page batch time=3503.918
2025-06-10 20:13:01,656 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:01,716 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:13:01,963 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:02,009 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:13:02,198 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:13:02,199 - INFO - Processing document 10.1186_s12940-023-00978-9_44.pdf
2025-06-10 20:13:02,359 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:02,415 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:02,763 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:02,867 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:02,868 - DEBUG - Finished converting page batch time=3505.155
2025-06-10 20:13:03,008 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:03,009 - DEBUG - Finished converting page batch time=3505.295
2025-06-10 20:13:03,166 - INFO - Finished converting document 10.1007_s11356-023-27813-5_41.pdf in 18.44 sec.
2025-06-10 20:13:03,222 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:03,300 - INFO - Extraction successful row 7, tokens=16905
2025-06-10 20:13:03,313 - INFO - Going to convert document batch...
2025-06-10 20:13:03,313 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:13:03,314 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:13:03,354 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:03,364 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:13:03,606 - DEBUG - Snippet 10.3389_fpubh.2021.812743_7_item_0: generation shape=torch.Size([1, 697])
2025-06-10 20:13:03,607 - DEBUG - Snippet 10.3389_fpubh.2021.812743_7_item_0 raw docling: (tokens=86)
<formula><loc_0><loc_0><loc_500><loc_500>\gamma \left ( Y _ { 1 } , Y _ { j } \right ) = \frac { 1 } { m } \sum _ { h = 1 } ^ { m } \gamma \left ( y _ { i } ( h ) , y _ { j } ( h ) \right )</formula><end_of_utterance>
2025-06-10 20:13:03,608 - DEBUG - Starting _parse_docling_output
2025-06-10 20:13:03,608 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>\gamma \left ( Y _ { 1 } , Y _ { j } \right ) = \frac { 1 } { m } \sum _ { h = 1 } ^ { m } \gamma \left ( y _ { i } ( h ) , y _ { j } ( h ) \right )</formula><end_of_utterance>
2025-06-10 20:13:03,608 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:13:03,608 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>\\gamma \\left ( Y _ { 1 } , Y _ { j } \\right ) = \\frac { 1 } { m } \\sum _ { h = 1 } ^ { m } \\gamma \\left ( y _ { i } ( h ) , y _ { j } ( h ) \\right )</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=576x152 at 0x7F96DCE1B470>)]
2025-06-10 20:13:03,609 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:13:03,619 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=576.0, b=152.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 148))], orig='\\gamma \\left ( Y _ { 1 } , Y _ { j } \\right ) = \\frac { 1 } { m } \\sum _ { h = 1 } ^ { m } \\gamma \\left ( y _ { i } ( h ) , y _ { j } ( h ) \\right )', text='\\gamma \\left ( Y _ { 1 } , Y _ { j } \\right ) = \\frac { 1 } { m } \\sum _ { h = 1 } ^ { m } \\gamma \\left ( y _ { i } ( h ) , y _ { j } ( h ) \\right )', formatting=None, hyperlink=None)]
2025-06-10 20:13:03,619 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:13:03,620 - DEBUG - Processing text item: label=formula, text=\gamma \left ( Y _ { 1 } , Y _ { j } \right ) = \frac { 1 } { m } \sum _ { h = 1 } ^ { m } \gamma \left ( y _ { i } ( h ) , y _ { j } ( h ) \right )
2025-06-10 20:13:03,620 - DEBUG - Recognized string extracted: \gamma \left ( Y _ { 1 } , Y _ { j } \right ) = \frac { 1 } { m } \sum _ { h = 1 } ^ { m } \gamma \left ( y _ { i } ( h ) , y _ { j } ( h ) \right )
2025-06-10 20:13:03,620 - DEBUG - Generating chat message for label: formula
2025-06-10 20:13:03,620 - DEBUG - Snippet 10.3389_fpubh.2021.812743_7_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:13:03,682 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:03,952 - DEBUG - Snippet 10.3389_fpubh.2021.812743_7_item_1 => input_ids shape=torch.Size([1, 875]), prompt_len=875
2025-06-10 20:13:03,974 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:13:04,067 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:13:04,073 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:13:04,078 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:04,404 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:04,866 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:13:04,866 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:13:04,866 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:13:04,903 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:13:04,939 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:13:04,978 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:13:05,016 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:13:05,055 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:13:05,074 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:05,093 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:13:05,215 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:13:05,286 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:13:05,334 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:13:05,473 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:13:05,497 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:05,498 - DEBUG - Finished converting page batch time=3507.785
2025-06-10 20:13:05,657 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:05,807 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:05,809 - DEBUG - Finished converting page batch time=3508.095
2025-06-10 20:13:05,874 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:13:06,069 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:13:06,069 - INFO - Processing document 10.3390_ijerph20043506_45.pdf
2025-06-10 20:13:06,075 - INFO - Finished converting document 10.1186_s12916-024-03596-5_14.pdf in 21.30 sec.
2025-06-10 20:13:06,259 - INFO - Extraction successful row 1, tokens=18277
2025-06-10 20:13:06,296 - INFO - Going to convert document batch...
2025-06-10 20:13:06,296 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:13:06,297 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:13:06,342 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:13:06,709 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:07,002 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:07,024 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:13:07,124 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:13:07,131 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:13:07,516 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:07,750 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:13:07,751 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:13:07,751 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:13:07,770 - DEBUG - Finished converting page batch time=3510.057
2025-06-10 20:13:07,787 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:13:07,834 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:13:07,865 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:07,871 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:13:07,912 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:13:07,958 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:13:08,043 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:13:08,152 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:08,160 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:13:08,198 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:13:08,249 - DEBUG - Finished converting page batch time=3510.536
2025-06-10 20:13:08,275 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:13:08,283 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:08,291 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:08,292 - DEBUG - Finished converting page batch time=3510.579
2025-06-10 20:13:08,333 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:08,537 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:08,548 - INFO - Finished converting document 10.1136_bmj-2023-075203_32.pdf in 23.77 sec.
2025-06-10 20:13:08,691 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:13:08,718 - INFO - Extraction successful row 3, tokens=26357
2025-06-10 20:13:08,757 - INFO - Going to convert document batch...
2025-06-10 20:13:08,757 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:13:08,758 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:13:08,808 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:13:08,810 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:08,815 - DEBUG - Finished converting page batch time=3511.102
2025-06-10 20:13:08,961 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:13:09,066 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:09,067 - DEBUG - Finished converting page batch time=3511.353
2025-06-10 20:13:09,156 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:13:09,157 - INFO - Processing document 10.4178_epih.e2023020_46.pdf
2025-06-10 20:13:09,251 - DEBUG - Snippet 10.3389_fpubh.2021.812743_7_item_1: generation shape=torch.Size([1, 1058])
2025-06-10 20:13:09,252 - DEBUG - Snippet 10.3389_fpubh.2021.812743_7_item_1 raw docling: (tokens=182)
<formula><loc_0><loc_0><loc_500><loc_500>\gamma \left ( y _ { i } ( h ) , y _ { j } ( h ) \right ) = \\ \min _ { k } \min _ { h } \left | y _ { i } ( h ) - y _ { j } ( h ) \right | + \zeta \max _ { k } \max _ { h } \left | y _ { i } ( h ) - y _ { j } ( h ) \right | \\ \left | y _ { i } ( h ) - y _ { j } ( h ) \right | + \zeta \max _ { k } \max _ { h } \left | y _ { i } ( h ) - y _ { j } ( h ) \right |</formula><end_of_utterance>
2025-06-10 20:13:09,252 - DEBUG - Starting _parse_docling_output
2025-06-10 20:13:09,252 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>\gamma \left ( y _ { i } ( h ) , y _ { j } ( h ) \right ) = \\ \min _ { k } \min _ { h } \left | y _ { i } ( h ) - y _ { j } ( h ) \right | + \zeta \max _ { k } \max _ { h } \left | y _ { i } ( h ) - y _ { j } ( h ) \right | \\ \left | y _ { i } ( h ) - y _ { j } ( h ) \right | + \zeta \max _ { k } \max _ { h } \left | y _ { i } ( h ) - y _ { j } ( h ) \right |</formula><end_of_utterance>
2025-06-10 20:13:09,252 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:13:09,253 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>\\gamma \\left ( y _ { i } ( h ) , y _ { j } ( h ) \\right ) = \\\\ \\min _ { k } \\min _ { h } \\left | y _ { i } ( h ) - y _ { j } ( h ) \\right | + \\zeta \\max _ { k } \\max _ { h } \\left | y _ { i } ( h ) - y _ { j } ( h ) \\right | \\\\ \\left | y _ { i } ( h ) - y _ { j } ( h ) \\right | + \\zeta \\max _ { k } \\max _ { h } \\left | y _ { i } ( h ) - y _ { j } ( h ) \\right |</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=664x345 at 0x7F96DE023F50>)]
2025-06-10 20:13:09,253 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:13:09,260 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=664.0, b=345.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 363))], orig='\\gamma \\left ( y _ { i } ( h ) , y _ { j } ( h ) \\right ) = \\\\ \\min _ { k } \\min _ { h } \\left | y _ { i } ( h ) - y _ { j } ( h ) \\right | + \\zeta \\max _ { k } \\max _ { h } \\left | y _ { i } ( h ) - y _ { j } ( h ) \\right | \\\\ \\left | y _ { i } ( h ) - y _ { j } ( h ) \\right | + \\zeta \\max _ { k } \\max _ { h } \\left | y _ { i } ( h ) - y _ { j } ( h ) \\right |', text='\\gamma \\left ( y _ { i } ( h ) , y _ { j } ( h ) \\right ) = \\\\ \\min _ { k } \\min _ { h } \\left | y _ { i } ( h ) - y _ { j } ( h ) \\right | + \\zeta \\max _ { k } \\max _ { h } \\left | y _ { i } ( h ) - y _ { j } ( h ) \\right | \\\\ \\left | y _ { i } ( h ) - y _ { j } ( h ) \\right | + \\zeta \\max _ { k } \\max _ { h } \\left | y _ { i } ( h ) - y _ { j } ( h ) \\right |', formatting=None, hyperlink=None)]
2025-06-10 20:13:09,260 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:13:09,261 - DEBUG - Processing text item: label=formula, text=\gamma \left ( y _ { i } ( h ) , y _ { j } ( h ) \right ) = \\ \min _ { k } \min _ { h } \left | y _ { i } ( h ) - y _ { j } ( h ) \right | + \zeta \max _ { k } \max _ { h } \left | y _ { i } ( h ) - y _ { j } ( h ) \right | \\ \left | y _ { i } ( h ) - y _ { j } ( h ) \right | + \zeta \max _ { k } \max _ { h } \left | y _ { i } ( h ) - y _ { j } ( h ) \right |
2025-06-10 20:13:09,261 - DEBUG - Recognized string extracted: \gamma \left ( y _ { i } ( h ) , y _ { j } ( h ) \right ) = \\ \min _ { k } \min _ { h } \left | y _ { i } ( h ) - y _ { j } ( h ) \right | + \zeta \max _ { k } \max _ { h } \left | y _ { i } ( h ) - y _ { j } ( h ) \right | \\ \left | y _ { i } ( h ) - y _ { j } ( h ) \right | + \zeta \max _ { k } \max _ { h } \left | y _ { i } ( h ) - y _ { j } ( h ) \right |
2025-06-10 20:13:09,261 - DEBUG - Generating chat message for label: formula
2025-06-10 20:13:09,261 - DEBUG - Snippet 10.3389_fpubh.2021.812743_7_item_2 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:13:09,274 - INFO - Finished converting document 10.1016_j.scitotenv.2023.169416_25.pdf in 24.52 sec.
2025-06-10 20:13:09,327 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:09,351 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:09,412 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:09,456 - DEBUG - Snippet 10.3389_fpubh.2021.812743_7_item_2 => input_ids shape=torch.Size([1, 610]), prompt_len=610
2025-06-10 20:13:09,462 - INFO - Extraction successful row 2, tokens=27664
2025-06-10 20:13:09,473 - INFO - Going to convert document batch...
2025-06-10 20:13:09,473 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:13:09,474 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:13:09,485 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:09,553 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:09,564 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:13:09,564 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:13:09,619 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:13:09,625 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:13:09,666 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:09,797 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:09,802 - DEBUG - Finished converting page batch time=3512.089
2025-06-10 20:13:09,879 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:10,198 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:10,222 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:13:10,241 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:10,270 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:13:10,275 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:13:10,354 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:10,362 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:13:10,362 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:13:10,363 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:13:10,406 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:13:10,411 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:10,462 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:13:10,504 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:13:10,540 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:13:10,579 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:13:10,619 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:13:10,671 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:10,688 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:10,749 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:13:10,786 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:13:10,825 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:13:10,916 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:13:10,917 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:13:10,917 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:13:10,957 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:13:10,993 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:13:11,021 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:13:11,160 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:13:11,201 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:13:11,289 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:13:11,293 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:13:11,327 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:13:11,457 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:13:11,476 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:13:11,476 - INFO - Processing document 10.1038_s41598-022-24653-0_51.pdf
2025-06-10 20:13:11,496 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:13:11,546 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:13:11,579 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:11,680 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:13:11,716 - DEBUG - Snippet 10.3389_fpubh.2021.812743_7_item_2: generation shape=torch.Size([1, 693])
2025-06-10 20:13:11,717 - DEBUG - Snippet 10.3389_fpubh.2021.812743_7_item_2 raw docling: (tokens=82)
<formula><loc_0><loc_0><loc_500><loc_500>\epsilon _ { i j } = \frac { 1 + | r _ { i } | + | r _ { j } | } { 1 + | r _ { i } | + | r _ { j } | + | r _ { i } - r _ { j } | }</formula><end_of_utterance>
2025-06-10 20:13:11,717 - DEBUG - Starting _parse_docling_output
2025-06-10 20:13:11,718 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>\epsilon _ { i j } = \frac { 1 + | r _ { i } | + | r _ { j } | } { 1 + | r _ { i } | + | r _ { j } | + | r _ { i } - r _ { j } | }</formula><end_of_utterance>
2025-06-10 20:13:11,718 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:13:11,718 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>\\epsilon _ { i j } = \\frac { 1 + | r _ { i } | + | r _ { j } | } { 1 + | r _ { i } | + | r _ { j } | + | r _ { i } - r _ { j } | }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=544x204 at 0x7F9714077EF0>)]
2025-06-10 20:13:11,718 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:13:11,722 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=544.0, b=204.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 130))], orig='\\epsilon _ { i j } = \\frac { 1 + | r _ { i } | + | r _ { j } | } { 1 + | r _ { i } | + | r _ { j } | + | r _ { i } - r _ { j } | }', text='\\epsilon _ { i j } = \\frac { 1 + | r _ { i } | + | r _ { j } | } { 1 + | r _ { i } | + | r _ { j } | + | r _ { i } - r _ { j } | }', formatting=None, hyperlink=None)]
2025-06-10 20:13:11,722 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:13:11,722 - DEBUG - Processing text item: label=formula, text=\epsilon _ { i j } = \frac { 1 + | r _ { i } | + | r _ { j } | } { 1 + | r _ { i } | + | r _ { j } | + | r _ { i } - r _ { j } | }
2025-06-10 20:13:11,722 - DEBUG - Recognized string extracted: \epsilon _ { i j } = \frac { 1 + | r _ { i } | + | r _ { j } | } { 1 + | r _ { i } | + | r _ { j } | + | r _ { i } - r _ { j } | }
2025-06-10 20:13:11,722 - DEBUG - Generating chat message for label: formula
2025-06-10 20:13:11,723 - DEBUG - Snippet 10.3389_fpubh.2021.812743_7_item_3 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:13:11,933 - DEBUG - Snippet 10.3389_fpubh.2021.812743_7_item_3 => input_ids shape=torch.Size([1, 610]), prompt_len=610
2025-06-10 20:13:11,995 - DEBUG - Finished converting page batch time=3514.282
2025-06-10 20:13:12,075 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:13:12,149 - DEBUG - Finished converting page batch time=3514.436
2025-06-10 20:13:12,157 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:12,272 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:13:12,273 - INFO - Processing document 10.3390_ijerph191710547_53.pdf
2025-06-10 20:13:12,395 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:12,467 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:12,574 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:12,575 - DEBUG - Finished converting page batch time=3514.862
2025-06-10 20:13:12,726 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:12,792 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:12,823 - INFO - Finished converting document 10.3389_fpubh.2023.1172532_36.pdf in 28.03 sec.
2025-06-10 20:13:13,000 - INFO - Extraction successful row 5, tokens=29432
2025-06-10 20:13:13,014 - INFO - Going to convert document batch...
2025-06-10 20:13:13,015 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:13:13,015 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:13:13,019 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:13,186 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:13,192 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:13:13,779 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:13,803 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:13:13,839 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:13,851 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:13:13,857 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:13:13,992 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:14,044 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:14,060 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:14,201 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:14,201 - DEBUG - Finished converting page batch time=3516.488
2025-06-10 20:13:14,334 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:14,351 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:14,392 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:14,486 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:13:14,486 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:13:14,487 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:13:14,523 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:13:14,567 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:14,567 - DEBUG - Finished converting page batch time=3516.854
2025-06-10 20:13:14,623 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:13:14,658 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:13:14,744 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:13:14,784 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:13:14,822 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:13:14,826 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:14,828 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:14,829 - DEBUG - Finished converting page batch time=3517.115
2025-06-10 20:13:14,847 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:14,954 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:13:15,017 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:13:15,055 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:13:15,230 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:13:15,297 - DEBUG - Finished converting page batch time=3517.583
2025-06-10 20:13:15,341 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:15,387 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:15,510 - DEBUG - Finished converting page batch time=3517.797
2025-06-10 20:13:15,614 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:15,623 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:13:15,633 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:15,776 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:15,813 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:13:15,814 - INFO - Processing document 10.3390_ijerph16234621_54.pdf
2025-06-10 20:13:15,869 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:16,250 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:16,360 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:16,768 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:16,796 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:16,801 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:16,901 - WARNING - Repetitive generation detected with pattern: ' \, \,'
2025-06-10 20:13:16,906 - DEBUG - Snippet 10.3389_fpubh.2021.812743_7_item_3: generation shape=torch.Size([1, 784])
2025-06-10 20:13:16,907 - DEBUG - Snippet 10.3389_fpubh.2021.812743_7_item_3 raw docling: (tokens=173)
<formula><loc_0><loc_0><loc_500><loc_500>r _ { i } = \int _ { 1 } ^ { m } Y _ { i } ^ { 0 } d t , r _ { j } = \int _ { 1 } ^ { m } Y _ { j } ^ { 0 } d t , r _ { i } - r _ { j } \\ = \int _ { 1 } ^ { m } \left ( Y _ { i } ^ { 0 } - Y _ { j } ^ { 0 } \right ) d t \\ Y _ { \bullet } ^ { 0 } = ( v _ { \bullet \dots \bullet \, \, \, \, \, \, \, \,
2025-06-10 20:13:16,907 - DEBUG - Starting _parse_docling_output
2025-06-10 20:13:16,907 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>r _ { i } = \int _ { 1 } ^ { m } Y _ { i } ^ { 0 } d t , r _ { j } = \int _ { 1 } ^ { m } Y _ { j } ^ { 0 } d t , r _ { i } - r _ { j } \\ = \int _ { 1 } ^ { m } \left ( Y _ { i } ^ { 0 } - Y _ { j } ^ { 0 } \right ) d t \\ Y _ { \bullet } ^ { 0 } = ( v _ { \bullet \dots \bullet \, \, \, \, \, \, \, \,
2025-06-10 20:13:16,907 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:13:16,908 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>r _ { i } = \\int _ { 1 } ^ { m } Y _ { i } ^ { 0 } d t , r _ { j } = \\int _ { 1 } ^ { m } Y _ { j } ^ { 0 } d t , r _ { i } - r _ { j } \\\\ = \\int _ { 1 } ^ { m } \\left ( Y _ { i } ^ { 0 } - Y _ { j } ^ { 0 } \\right ) d t \\\\ Y _ { \\bullet } ^ { 0 } = ( v _ { \\bullet \\dots \\bullet \\, \\, \\, \\, \\, \\, \\, \\,', image=<PIL.Image.Image image mode=RGB size=591x247 at 0x7F96DCE3CC20>)]
2025-06-10 20:13:16,908 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:13:16,916 - DEBUG - DoclingDocument loaded successfully. Extracted texts: []
2025-06-10 20:13:16,916 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:13:16,916 - WARNING - Extracted text is empty or malformed. Skipping formula.
2025-06-10 20:13:16,916 - DEBUG - Generating chat message for label: formula
2025-06-10 20:13:16,916 - DEBUG - Snippet 10.3389_fpubh.2021.812743_7_item_4 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:13:17,002 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:17,019 - DEBUG - Snippet 10.3389_fpubh.2021.812743_7_item_4 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:13:17,448 - DEBUG - Finished converting page batch time=3519.735
2025-06-10 20:13:17,461 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:17,462 - DEBUG - Finished converting page batch time=3519.749
2025-06-10 20:13:17,466 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:17,690 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:17,764 - DEBUG - [Page 14] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:17,795 - DEBUG - [Page 14] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:17,965 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:17,966 - DEBUG - Finished converting page batch time=3520.253
2025-06-10 20:13:17,983 - DEBUG - [Page 15] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:18,033 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:18,215 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:18,262 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:18,334 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:18,475 - DEBUG - Finished converting page batch time=3520.762
2025-06-10 20:13:18,742 - DEBUG - [Page 15] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:18,801 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:18,842 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:18,884 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:19,072 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:19,414 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:19,422 - DEBUG - Finished converting page batch time=3521.709
2025-06-10 20:13:19,484 - DEBUG - [Page 16] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:19,510 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:19,511 - DEBUG - Finished converting page batch time=3521.798
2025-06-10 20:13:19,741 - DEBUG - [Page 16] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:19,747 - DEBUG - Finished converting page batch time=3522.034
2025-06-10 20:13:19,748 - INFO - Finished converting document 10.1186_s12940-023-00978-9_44.pdf in 20.34 sec.
2025-06-10 20:13:19,876 - INFO - Extraction successful row 8, tokens=17328
2025-06-10 20:13:19,886 - INFO - Going to convert document batch...
2025-06-10 20:13:19,886 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:13:19,886 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:13:19,975 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:13:20,069 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:20,362 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:20,590 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:13:20,634 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:13:20,641 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:13:20,726 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:21,093 - DEBUG - [Page 17] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:21,345 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:13:21,345 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:13:21,346 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:13:21,382 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:13:21,422 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:13:21,460 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:13:21,510 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:13:21,575 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:21,643 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:13:21,681 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:13:21,741 - DEBUG - Snippet 10.3389_fpubh.2021.812743_7_item_4: generation shape=torch.Size([1, 521])
2025-06-10 20:13:21,742 - DEBUG - Snippet 10.3389_fpubh.2021.812743_7_item_4 raw docling: (tokens=175)
<formula><loc_0><loc_0><loc_500><loc_500>Y _ { j } ^ { 0 } = \left ( y _ { j ( 1 ) } ^ { 0 } , y _ { j ( 1 ) } ^ { 0 } , \cdots , y _ { j ( m ) } ^ { 0 } \right ) \\ Y _ { \dots } ^ { 0 } = \nu _ { \dots / 1 \vee } - \nu _ { \dots / 1 \vee } \, a n d \, Y _ { \dots } ^ { 0 } = \nu _ { \dots / 1 \vee } - \nu _ { \dots / 1 \vee }</formula><end_of_utterance>
2025-06-10 20:13:21,742 - DEBUG - Starting _parse_docling_output
2025-06-10 20:13:21,742 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>Y _ { j } ^ { 0 } = \left ( y _ { j ( 1 ) } ^ { 0 } , y _ { j ( 1 ) } ^ { 0 } , \cdots , y _ { j ( m ) } ^ { 0 } \right ) \\ Y _ { \dots } ^ { 0 } = \nu _ { \dots / 1 \vee } - \nu _ { \dots / 1 \vee } \, a n d \, Y _ { \dots } ^ { 0 } = \nu _ { \dots / 1 \vee } - \nu _ { \dots / 1 \vee }</formula><end_of_utterance>
2025-06-10 20:13:21,743 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:13:21,743 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>Y _ { j } ^ { 0 } = \\left ( y _ { j ( 1 ) } ^ { 0 } , y _ { j ( 1 ) } ^ { 0 } , \\cdots , y _ { j ( m ) } ^ { 0 } \\right ) \\\\ Y _ { \\dots } ^ { 0 } = \\nu _ { \\dots / 1 \\vee } - \\nu _ { \\dots / 1 \\vee } \\, a n d \\, Y _ { \\dots } ^ { 0 } = \\nu _ { \\dots / 1 \\vee } - \\nu _ { \\dots / 1 \\vee }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=605x113 at 0x7F96DCE3E5D0>)]
2025-06-10 20:13:21,743 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:13:21,747 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=605.0, b=113.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 288))], orig='Y _ { j } ^ { 0 } = \\left ( y _ { j ( 1 ) } ^ { 0 } , y _ { j ( 1 ) } ^ { 0 } , \\cdots , y _ { j ( m ) } ^ { 0 } \\right ) \\\\ Y _ { \\dots } ^ { 0 } = \\nu _ { \\dots / 1 \\vee } - \\nu _ { \\dots / 1 \\vee } \\, a n d \\, Y _ { \\dots } ^ { 0 } = \\nu _ { \\dots / 1 \\vee } - \\nu _ { \\dots / 1 \\vee }', text='Y _ { j } ^ { 0 } = \\left ( y _ { j ( 1 ) } ^ { 0 } , y _ { j ( 1 ) } ^ { 0 } , \\cdots , y _ { j ( m ) } ^ { 0 } \\right ) \\\\ Y _ { \\dots } ^ { 0 } = \\nu _ { \\dots / 1 \\vee } - \\nu _ { \\dots / 1 \\vee } \\, a n d \\, Y _ { \\dots } ^ { 0 } = \\nu _ { \\dots / 1 \\vee } - \\nu _ { \\dots / 1 \\vee }', formatting=None, hyperlink=None)]
2025-06-10 20:13:21,747 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:13:21,747 - DEBUG - Processing text item: label=formula, text=Y _ { j } ^ { 0 } = \left ( y _ { j ( 1 ) } ^ { 0 } , y _ { j ( 1 ) } ^ { 0 } , \cdots , y _ { j ( m ) } ^ { 0 } \right ) \\ Y _ { \dots } ^ { 0 } = \nu _ { \dots / 1 \vee } - \nu _ { \dots / 1 \vee } \, a n d \, Y _ { \dots } ^ { 0 } = \nu _ { \dots / 1 \vee } - \nu _ { \dots / 1 \vee }
2025-06-10 20:13:21,747 - DEBUG - Recognized string extracted: Y _ { j } ^ { 0 } = \left ( y _ { j ( 1 ) } ^ { 0 } , y _ { j ( 1 ) } ^ { 0 } , \cdots , y _ { j ( m ) } ^ { 0 } \right ) \\ Y _ { \dots } ^ { 0 } = \nu _ { \dots / 1 \vee } - \nu _ { \dots / 1 \vee } \, a n d \, Y _ { \dots } ^ { 0 } = \nu _ { \dots / 1 \vee } - \nu _ { \dots / 1 \vee }
2025-06-10 20:13:21,748 - INFO - All done. Returning 5 recognized text results.
2025-06-10 20:13:21,748 - DEBUG - [Page 17] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:21,748 - DEBUG - Snippet 10.3389_fpubh.2021.812743_7_item_0 recognized text:
\gamma \left ( Y _ { 1 } , Y _ { j } \right ) = \frac { 1 } { m } \sum _ { h = 1 } ^ { m } \gamma \left ( y _ { i } ( h ) , y _ { j } ( h ) \right )
2025-06-10 20:13:21,748 - DEBUG - Snippet 10.3389_fpubh.2021.812743_7_item_1 recognized text:
\gamma \left ( y _ { i } ( h ) , y _ { j } ( h ) \right ) = \\ \min _ { k } \min _ { h } \left | y _ { i } ( h ) - y _ { j } ( h ) \right | + \zeta \max _ { k } \max _ { h } \left | y _ { i } ( h ) - y _ { j } ( h ) \right | \\ \left | y _ { i } ( h ) - y _ { j } ( h ) \right | + \zeta \max _ { k } \max _ { h } \left | y _ { i } ( h ) - y _ { j } ( h ) \right |
2025-06-10 20:13:21,748 - DEBUG - Snippet 10.3389_fpubh.2021.812743_7_item_2 recognized text:
\epsilon _ { i j } = \frac { 1 + | r _ { i } | + | r _ { j } | } { 1 + | r _ { i } | + | r _ { j } | + | r _ { i } - r _ { j } | }
2025-06-10 20:13:21,749 - DEBUG - Snippet 10.3389_fpubh.2021.812743_7_item_3 recognized text:
MALFORMED_FORMULA
2025-06-10 20:13:21,749 - DEBUG - Snippet 10.3389_fpubh.2021.812743_7_item_4 recognized text:
Y _ { j } ^ { 0 } = \left ( y _ { j ( 1 ) } ^ { 0 } , y _ { j ( 1 ) } ^ { 0 } , \cdots , y _ { j ( m ) } ^ { 0 } \right ) \\ Y _ { \dots } ^ { 0 } = \nu _ { \dots / 1 \vee } - \nu _ { \dots / 1 \vee } \, a n d \, Y _ { \dots } ^ { 0 } = \nu _ { \dots / 1 \vee } - \nu _ { \dots / 1 \vee }
2025-06-10 20:13:21,754 - INFO - Starting prediction for 5 images with labels: ['formula', 'formula', 'formula', 'formula', 'formula']
2025-06-10 20:13:21,754 - DEBUG - Generating chat message for label: formula
2025-06-10 20:13:21,755 - DEBUG - Snippet 10.3389_fpubh.2021.812743_7_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:13:21,807 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:13:21,851 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:13:21,873 - DEBUG - Snippet 10.3389_fpubh.2021.812743_7_item_0 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:13:21,891 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:13:21,908 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:21,909 - DEBUG - Finished converting page batch time=3524.195
2025-06-10 20:13:21,987 - DEBUG - [Page 18] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:22,024 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:13:22,137 - DEBUG - Finished converting page batch time=3524.423
2025-06-10 20:13:22,148 - DEBUG - [Page 14] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:22,301 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:13:22,442 - DEBUG - [Page 18] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:22,478 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:13:22,478 - INFO - Processing document 10.3390_ijerph18168476_68.pdf
2025-06-10 20:13:22,529 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:22,738 - DEBUG - [Page 15] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:22,739 - DEBUG - Finished converting page batch time=3525.025
2025-06-10 20:13:22,776 - DEBUG - [Page 19] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:22,875 - DEBUG - [Page 19] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:23,307 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:23,331 - DEBUG - [Page 16] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:23,356 - DEBUG - Finished converting page batch time=3525.643
2025-06-10 20:13:23,424 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:23,521 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:23,528 - DEBUG - Finished converting page batch time=3525.814
2025-06-10 20:13:23,626 - DEBUG - [Page 20] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:23,636 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:23,705 - INFO - Finished converting document 10.1038_s41598-022-24653-0_51.pdf in 14.98 sec.
2025-06-10 20:13:23,763 - DEBUG - Finished converting page batch time=3526.050
2025-06-10 20:13:23,856 - INFO - Extraction successful row 11, tokens=14060
2025-06-10 20:13:23,872 - INFO - Going to convert document batch...
2025-06-10 20:13:23,872 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:13:23,873 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:13:23,939 - DEBUG - [Page 20] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:23,981 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:13:24,196 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:24,338 - DEBUG - [Page 17] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:24,524 - DEBUG - [Page 21] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:24,666 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:13:24,715 - DEBUG - [Page 21] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:24,734 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:13:24,741 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:13:24,754 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:24,934 - DEBUG - [Page 18] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:25,341 - DEBUG - [Page 22] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:25,560 - DEBUG - Snippet 10.3389_fpubh.2021.812743_7_item_0: generation shape=torch.Size([1, 464])
2025-06-10 20:13:25,561 - DEBUG - Snippet 10.3389_fpubh.2021.812743_7_item_0 raw docling: (tokens=118)
<formula><loc_0><loc_0><loc_500><loc_500>Y _ { i } ^ { 0 } = \left ( y _ { i ( 1 ) } ^ { 0 } , y _ { i ( 1 ) } ^ { 0 } , \cdots , y _ { i ( m ) } ^ { 0 } \right ) \\ \ \left ( \dots 0 \quad \quad \quad \dots 0 \quad \quad \quad \dots 0 \right )</formula><end_of_utterance>
2025-06-10 20:13:25,562 - DEBUG - Starting _parse_docling_output
2025-06-10 20:13:25,562 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>Y _ { i } ^ { 0 } = \left ( y _ { i ( 1 ) } ^ { 0 } , y _ { i ( 1 ) } ^ { 0 } , \cdots , y _ { i ( m ) } ^ { 0 } \right ) \\ \ \left ( \dots 0 \quad \quad \quad \dots 0 \quad \quad \quad \dots 0 \right )</formula><end_of_utterance>
2025-06-10 20:13:25,562 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:13:25,562 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>Y _ { i } ^ { 0 } = \\left ( y _ { i ( 1 ) } ^ { 0 } , y _ { i ( 1 ) } ^ { 0 } , \\cdots , y _ { i ( m ) } ^ { 0 } \\right ) \\\\ \\ \\left ( \\dots 0 \\quad \\quad \\quad \\dots 0 \\quad \\quad \\quad \\dots 0 \\right )</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=605x113 at 0x7F96DCE19FA0>)]
2025-06-10 20:13:25,562 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:13:25,565 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=605.0, b=113.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 203))], orig='Y _ { i } ^ { 0 } = \\left ( y _ { i ( 1 ) } ^ { 0 } , y _ { i ( 1 ) } ^ { 0 } , \\cdots , y _ { i ( m ) } ^ { 0 } \\right ) \\\\ \\ \\left ( \\dots 0 \\quad \\quad \\quad \\dots 0 \\quad \\quad \\quad \\dots 0 \\right )', text='Y _ { i } ^ { 0 } = \\left ( y _ { i ( 1 ) } ^ { 0 } , y _ { i ( 1 ) } ^ { 0 } , \\cdots , y _ { i ( m ) } ^ { 0 } \\right ) \\\\ \\ \\left ( \\dots 0 \\quad \\quad \\quad \\dots 0 \\quad \\quad \\quad \\dots 0 \\right )', formatting=None, hyperlink=None)]
2025-06-10 20:13:25,565 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:13:25,566 - DEBUG - Processing text item: label=formula, text=Y _ { i } ^ { 0 } = \left ( y _ { i ( 1 ) } ^ { 0 } , y _ { i ( 1 ) } ^ { 0 } , \cdots , y _ { i ( m ) } ^ { 0 } \right ) \\ \ \left ( \dots 0 \quad \quad \quad \dots 0 \quad \quad \quad \dots 0 \right )
2025-06-10 20:13:25,566 - DEBUG - Recognized string extracted: Y _ { i } ^ { 0 } = \left ( y _ { i ( 1 ) } ^ { 0 } , y _ { i ( 1 ) } ^ { 0 } , \cdots , y _ { i ( m ) } ^ { 0 } \right ) \\ \ \left ( \dots 0 \quad \quad \quad \dots 0 \quad \quad \quad \dots 0 \right )
2025-06-10 20:13:25,566 - DEBUG - Generating chat message for label: formula
2025-06-10 20:13:25,566 - DEBUG - Snippet 10.3389_fpubh.2021.812743_7_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:13:25,631 - DEBUG - [Page 22] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:25,644 - DEBUG - [Page 19] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:25,645 - DEBUG - Finished converting page batch time=3527.931
2025-06-10 20:13:25,719 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:25,719 - DEBUG - Finished converting page batch time=3528.006
2025-06-10 20:13:25,735 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:13:25,735 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:13:25,736 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:13:25,774 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:13:25,813 - DEBUG - [Page 23] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:25,818 - DEBUG - Finished converting page batch time=3528.105
2025-06-10 20:13:25,850 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:13:25,875 - DEBUG - Snippet 10.3389_fpubh.2021.812743_7_item_1 => input_ids shape=torch.Size([1, 876]), prompt_len=876
2025-06-10 20:13:25,900 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:13:25,935 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:13:25,981 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:25,984 - INFO - Finished converting document 10.4178_epih.e2023020_46.pdf in 19.72 sec.
2025-06-10 20:13:25,986 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:13:26,026 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:13:26,144 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:26,161 - INFO - Extraction successful row 10, tokens=33855
2025-06-10 20:13:26,177 - INFO - Going to convert document batch...
2025-06-10 20:13:26,177 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:13:26,178 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:13:26,216 - DEBUG - [Page 20] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:26,246 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:13:26,377 - DEBUG - [Page 23] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:26,389 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:13:26,437 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:13:26,491 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:13:26,622 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:13:26,763 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:26,827 - DEBUG - [Page 21] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:26,835 - DEBUG - Snippet 10.3389_fpubh.2021.812743_7_item_1: generation shape=torch.Size([1, 908])
2025-06-10 20:13:26,836 - DEBUG - Snippet 10.3389_fpubh.2021.812743_7_item_1 raw docling: (tokens=31)
<formula><loc_0><loc_0><loc_500><loc_500>Y _ { i ( h } ^ { 0 }</formula><end_of_utterance>
2025-06-10 20:13:26,836 - DEBUG - Starting _parse_docling_output
2025-06-10 20:13:26,836 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>Y _ { i ( h } ^ { 0 }</formula><end_of_utterance>
2025-06-10 20:13:26,837 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:13:26,837 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>Y _ { i ( h } ^ { 0 }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=41x64 at 0x7F96DCE5A690>)]
2025-06-10 20:13:26,837 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:13:26,838 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=41.0, b=64.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 21))], orig='Y _ { i ( h } ^ { 0 }', text='Y _ { i ( h } ^ { 0 }', formatting=None, hyperlink=None)]
2025-06-10 20:13:26,838 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:13:26,838 - DEBUG - Processing text item: label=formula, text=Y _ { i ( h } ^ { 0 }
2025-06-10 20:13:26,838 - DEBUG - Recognized string extracted: Y _ { i ( h } ^ { 0 }
2025-06-10 20:13:26,839 - DEBUG - Generating chat message for label: formula
2025-06-10 20:13:26,839 - DEBUG - Snippet 10.3389_fpubh.2021.812743_7_item_2 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:13:26,845 - DEBUG - Finished converting page batch time=3529.132
2025-06-10 20:13:26,879 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:13:26,935 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:13:26,938 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:13:26,938 - DEBUG - Snippet 10.3389_fpubh.2021.812743_7_item_2 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:13:26,942 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:13:27,002 - DEBUG - [Page 24] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:27,165 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:13:27,174 - INFO - Processing document 10.1186_s12940-021-00726-x_71.pdf
2025-06-10 20:13:27,637 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:27,642 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:13:27,642 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:13:27,643 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:13:27,679 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:13:27,706 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:27,718 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:13:27,753 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:13:27,768 - DEBUG - [Page 22] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:27,790 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:13:27,826 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:13:27,892 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:13:28,023 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:13:28,024 - DEBUG - Finished converting page batch time=3530.310
2025-06-10 20:13:28,069 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:13:28,107 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:13:28,249 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:13:28,337 - DEBUG - [Page 25] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:28,524 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:13:28,619 - DEBUG - [Page 23] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:28,620 - DEBUG - Finished converting page batch time=3530.907
2025-06-10 20:13:28,621 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:28,692 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:28,723 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:13:28,723 - INFO - Processing document 10.1371_journal.pone.0242147_74.pdf
2025-06-10 20:13:28,801 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:28,822 - INFO - Finished converting document 10.3390_ijerph191710547_53.pdf in 19.36 sec.
2025-06-10 20:13:29,010 - INFO - Extraction successful row 12, tokens=29593
2025-06-10 20:13:29,022 - INFO - Going to convert document batch...
2025-06-10 20:13:29,022 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:13:29,023 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:13:29,074 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:13:29,140 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:29,185 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:29,208 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:27,152 - DEBUG - Snippet 10.3389_fpubh.2021.812743_7_item_2: generation shape=torch.Size([1, 432])
2025-06-10 20:13:27,153 - DEBUG - Snippet 10.3389_fpubh.2021.812743_7_item_2 raw docling: (tokens=86)
<formula><loc_0><loc_0><loc_500><loc_500>Y _ { i ( h ) } ^ { 0 } = y _ { i ( h ) } - y _ { i ( 1 ) } a n d Y _ { i ( h ) } ^ { 0 } = y _ { i ( h ) } - y _ { i ( 1 ) }</formula><end_of_utterance>
2025-06-10 20:13:27,153 - DEBUG - Starting _parse_docling_output
2025-06-10 20:13:27,154 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>Y _ { i ( h ) } ^ { 0 } = y _ { i ( h ) } - y _ { i ( 1 ) } a n d Y _ { i ( h ) } ^ { 0 } = y _ { i ( h ) } - y _ { i ( 1 ) }</formula><end_of_utterance>
2025-06-10 20:13:27,154 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:13:27,154 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>Y _ { i ( h ) } ^ { 0 } = y _ { i ( h ) } - y _ { i ( 1 ) } a n d Y _ { i ( h ) } ^ { 0 } = y _ { i ( h ) } - y _ { i ( 1 ) }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=504x81 at 0x7F96DCE1B740>)]
2025-06-10 20:13:27,154 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:13:27,156 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=504.0, b=81.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 125))], orig='Y _ { i ( h ) } ^ { 0 } = y _ { i ( h ) } - y _ { i ( 1 ) } a n d Y _ { i ( h ) } ^ { 0 } = y _ { i ( h ) } - y _ { i ( 1 ) }', text='Y _ { i ( h ) } ^ { 0 } = y _ { i ( h ) } - y _ { i ( 1 ) } a n d Y _ { i ( h ) } ^ { 0 } = y _ { i ( h ) } - y _ { i ( 1 ) }', formatting=None, hyperlink=None)]
2025-06-10 20:13:27,157 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:13:27,157 - DEBUG - Processing text item: label=formula, text=Y _ { i ( h ) } ^ { 0 } = y _ { i ( h ) } - y _ { i ( 1 ) } a n d Y _ { i ( h ) } ^ { 0 } = y _ { i ( h ) } - y _ { i ( 1 ) }
2025-06-10 20:13:27,157 - DEBUG - Recognized string extracted: Y _ { i ( h ) } ^ { 0 } = y _ { i ( h ) } - y _ { i ( 1 ) } a n d Y _ { i ( h ) } ^ { 0 } = y _ { i ( h ) } - y _ { i ( 1 ) }
2025-06-10 20:13:27,157 - DEBUG - Generating chat message for label: formula
2025-06-10 20:13:27,157 - DEBUG - Snippet 10.3389_fpubh.2021.812743_7_item_3 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:13:27,255 - DEBUG - Snippet 10.3389_fpubh.2021.812743_7_item_3 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:13:27,308 - DEBUG - [Page 26] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:27,611 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:27,707 - DEBUG - [Page 14] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:27,710 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:13:27,772 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:13:27,779 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:13:27,808 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:28,238 - DEBUG - Snippet 10.3389_fpubh.2021.812743_7_item_3: generation shape=torch.Size([1, 378])
2025-06-10 20:13:28,239 - DEBUG - Snippet 10.3389_fpubh.2021.812743_7_item_3 raw docling: (tokens=32)
<formula><loc_0><loc_0><loc_500><loc_500>h = 1 , 2 , \cdots , m</formula><end_of_utterance>
2025-06-10 20:13:28,239 - DEBUG - Starting _parse_docling_output
2025-06-10 20:13:28,239 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>h = 1 , 2 , \cdots , m</formula><end_of_utterance>
2025-06-10 20:13:28,239 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:13:28,239 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>h = 1 , 2 , \\cdots , m</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=527x53 at 0x7F96DCE194F0>)]
2025-06-10 20:13:28,240 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:13:28,241 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=527.0, b=53.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 22))], orig='h = 1 , 2 , \\cdots , m', text='h = 1 , 2 , \\cdots , m', formatting=None, hyperlink=None)]
2025-06-10 20:13:28,241 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:13:28,241 - DEBUG - Processing text item: label=formula, text=h = 1 , 2 , \cdots , m
2025-06-10 20:13:28,242 - DEBUG - Recognized string extracted: h = 1 , 2 , \cdots , m
2025-06-10 20:13:28,242 - DEBUG - Generating chat message for label: formula
2025-06-10 20:13:28,242 - DEBUG - Snippet 10.3389_fpubh.2021.812743_7_item_4 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:13:28,323 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:28,373 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:13:28,373 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:13:28,373 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:13:28,377 - DEBUG - [Page 15] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:28,378 - DEBUG - Finished converting page batch time=3532.814
2025-06-10 20:13:28,410 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:13:28,438 - DEBUG - Snippet 10.3389_fpubh.2021.812743_7_item_4 => input_ids shape=torch.Size([1, 610]), prompt_len=610
2025-06-10 20:13:28,446 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:13:28,507 - DEBUG - [Page 27] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:28,541 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:28,542 - DEBUG - Finished converting page batch time=3532.979
2025-06-10 20:13:28,803 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:28,804 - DEBUG - Finished converting page batch time=3533.241
2025-06-10 20:13:29,192 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:13:29,240 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:29,244 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:13:29,287 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:13:29,342 - DEBUG - [Page 16] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:29,374 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:29,485 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:13:29,584 - DEBUG - Finished converting page batch time=3534.021
2025-06-10 20:13:29,621 - DEBUG - Finished converting page batch time=3534.057
2025-06-10 20:13:29,671 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:13:29,712 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:13:29,752 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:13:29,764 - DEBUG - [Page 28] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:29,865 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:29,894 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:13:30,025 - DEBUG - [Page 17] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:30,040 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:30,124 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:30,185 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:30,185 - DEBUG - Finished converting page batch time=3534.622
2025-06-10 20:13:30,269 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:13:30,450 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:13:30,450 - INFO - Processing document 10.1186_s12940-020-00663-1_75.pdf
2025-06-10 20:13:30,466 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:30,572 - DEBUG - [Page 18] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:30,573 - DEBUG - Finished converting page batch time=3535.009
2025-06-10 20:13:30,713 - INFO - Finished converting document 10.3390_ijerph16234621_54.pdf in 19.86 sec.
2025-06-10 20:13:30,833 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:30,873 - INFO - Extraction successful row 13, tokens=25563
2025-06-10 20:13:30,896 - INFO - Going to convert document batch...
2025-06-10 20:13:30,896 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:13:30,896 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:13:30,950 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:13:30,982 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:31,102 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:31,227 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:31,259 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:31,555 - DEBUG - [Page 29] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:31,699 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:13:31,750 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:13:31,756 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:13:32,045 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:32,233 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:32,377 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:32,469 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:13:32,470 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:13:32,471 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:13:32,485 - DEBUG - Snippet 10.3389_fpubh.2021.812743_7_item_4: generation shape=torch.Size([1, 753])
2025-06-10 20:13:32,486 - DEBUG - Snippet 10.3389_fpubh.2021.812743_7_item_4 raw docling: (tokens=142)
<formula><loc_0><loc_0><loc_500><loc_500>\epsilon ^ { \pm } = \left \{ + \max _ { \substack { \min \\ + \min \\ \epsilon } } \left ( \epsilon _ { i j } , \epsilon _ { i j } \right ) , = \epsilon _ { i j } - \epsilon _ { i j } > 0 \\ \epsilon \right \} + \min \left ( \epsilon _ { i j } , \epsilon _ { i j } \right ) , = \epsilon _ { i j } - \epsilon _ { i j } < 0</formula><end_of_utterance>
2025-06-10 20:13:32,486 - DEBUG - Starting _parse_docling_output
2025-06-10 20:13:32,486 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>\epsilon ^ { \pm } = \left \{ + \max _ { \substack { \min \\ + \min \\ \epsilon } } \left ( \epsilon _ { i j } , \epsilon _ { i j } \right ) , = \epsilon _ { i j } - \epsilon _ { i j } > 0 \\ \epsilon \right \} + \min \left ( \epsilon _ { i j } , \epsilon _ { i j } \right ) , = \epsilon _ { i j } - \epsilon _ { i j } < 0</formula><end_of_utterance>
2025-06-10 20:13:32,487 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:13:32,487 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>\\epsilon ^ { \\pm } = \\left \\{ + \\max _ { \\substack { \\min \\\\ + \\min \\\\ \\epsilon } } \\left ( \\epsilon _ { i j } , \\epsilon _ { i j } \\right ) , = \\epsilon _ { i j } - \\epsilon _ { i j } > 0 \\\\ \\epsilon \\right \\} + \\min \\left ( \\epsilon _ { i j } , \\epsilon _ { i j } \\right ) , = \\epsilon _ { i j } - \\epsilon _ { i j } < 0</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=596x165 at 0x7F96DCFBAF60>)]
2025-06-10 20:13:32,487 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:13:32,490 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=596.0, b=165.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 318))], orig='\\epsilon ^ { \\pm } = \\left \\{ + \\max _ { \\substack { \\min \\\\ + \\min \\\\ \\epsilon } } \\left ( \\epsilon _ { i j } , \\epsilon _ { i j } \\right ) , = \\epsilon _ { i j } - \\epsilon _ { i j } > 0 \\\\ \\epsilon \\right \\} + \\min \\left ( \\epsilon _ { i j } , \\epsilon _ { i j } \\right ) , = \\epsilon _ { i j } - \\epsilon _ { i j }', text='\\epsilon ^ { \\pm } = \\left \\{ + \\max _ { \\substack { \\min \\\\ + \\min \\\\ \\epsilon } } \\left ( \\epsilon _ { i j } , \\epsilon _ { i j } \\right ) , = \\epsilon _ { i j } - \\epsilon _ { i j } > 0 \\\\ \\epsilon \\right \\} + \\min \\left ( \\epsilon _ { i j } , \\epsilon _ { i j } \\right ) , = \\epsilon _ { i j } - \\epsilon _ { i j }', formatting=None, hyperlink=None)]
2025-06-10 20:13:32,491 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:13:32,491 - DEBUG - Processing text item: label=formula, text=\epsilon ^ { \pm } = \left \{ + \max _ { \substack { \min \\ + \min \\ \epsilon } } \left ( \epsilon _ { i j } , \epsilon _ { i j } \right ) , = \epsilon _ { i j } - \epsilon _ { i j } > 0 \\ \epsilon \right \} + \min \left ( \epsilon _ { i j } , \epsilon _ { i j } \right ) , = \epsilon _ { i j } - \epsilon _ { i j }
2025-06-10 20:13:32,491 - DEBUG - Recognized string extracted: \epsilon ^ { \pm } = \left \{ + \max _ { \substack { \min \\ + \min \\ \epsilon } } \left ( \epsilon _ { i j } , \epsilon _ { i j } \right ) , = \epsilon _ { i j } - \epsilon _ { i j } > 0 \\ \epsilon \right \} + \min \left ( \epsilon _ { i j } , \epsilon _ { i j } \right ) , = \epsilon _ { i j } - \epsilon _ { i j }
2025-06-10 20:13:32,492 - INFO - All done. Returning 5 recognized text results.
2025-06-10 20:13:32,492 - DEBUG - Snippet 10.3389_fpubh.2021.812743_7_item_0 recognized text:
Y _ { i } ^ { 0 } = \left ( y _ { i ( 1 ) } ^ { 0 } , y _ { i ( 1 ) } ^ { 0 } , \cdots , y _ { i ( m ) } ^ { 0 } \right ) \\ \ \left ( \dots 0 \quad \quad \quad \dots 0 \quad \quad \quad \dots 0 \right )
2025-06-10 20:13:32,492 - DEBUG - Snippet 10.3389_fpubh.2021.812743_7_item_1 recognized text:
Y _ { i ( h } ^ { 0 }
2025-06-10 20:13:32,492 - DEBUG - Snippet 10.3389_fpubh.2021.812743_7_item_2 recognized text:
Y _ { i ( h ) } ^ { 0 } = y _ { i ( h ) } - y _ { i ( 1 ) } a n d Y _ { i ( h ) } ^ { 0 } = y _ { i ( h ) } - y _ { i ( 1 ) }
2025-06-10 20:13:32,492 - DEBUG - Snippet 10.3389_fpubh.2021.812743_7_item_3 recognized text:
h = 1 , 2 , \cdots , m
2025-06-10 20:13:32,493 - DEBUG - Snippet 10.3389_fpubh.2021.812743_7_item_4 recognized text:
\epsilon ^ { \pm } = \left \{ + \max _ { \substack { \min \\ + \min \\ \epsilon } } \left ( \epsilon _ { i j } , \epsilon _ { i j } \right ) , = \epsilon _ { i j } - \epsilon _ { i j } > 0 \\ \epsilon \right \} + \min \left ( \epsilon _ { i j } , \epsilon _ { i j } \right ) , = \epsilon _ { i j } - \epsilon _ { i j }
2025-06-10 20:13:32,510 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:13:32,545 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:13:32,586 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:13:32,621 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:13:32,623 - DEBUG - Creating masked image for page 5 with 19 clusters.
2025-06-10 20:13:32,625 - INFO - Masked image successfully created for page 5.
2025-06-10 20:13:32,628 - INFO - Starting prediction for 2 images with labels: ['formula', 'formula']
2025-06-10 20:13:32,628 - DEBUG - Generating chat message for label: formula
2025-06-10 20:13:32,628 - DEBUG - Snippet 10.3389_fpubh.2021.812743_7_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:13:32,666 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:13:32,675 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:32,676 - DEBUG - Finished converting page batch time=3537.113
2025-06-10 20:13:32,701 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:13:32,708 - DEBUG - Snippet 10.3389_fpubh.2021.812743_7_item_0 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:13:32,824 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:13:33,012 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:13:33,217 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:13:33,347 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:33,367 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:13:33,374 - DEBUG - [Page 30] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:33,408 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:33,591 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:33,652 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:13:33,720 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:33,722 - DEBUG - Finished converting page batch time=3538.158
2025-06-10 20:13:33,858 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:13:33,859 - INFO - Processing document 10.1186_s12940-020-00662-2_77.pdf
2025-06-10 20:13:33,974 - DEBUG - [Page 31] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:33,975 - DEBUG - Finished converting page batch time=3538.411
2025-06-10 20:13:34,205 - DEBUG - Finished converting page batch time=3538.642
2025-06-10 20:13:34,339 - DEBUG - [Page 32] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:34,471 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:34,629 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:34,737 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:34,791 - DEBUG - Snippet 10.3389_fpubh.2021.812743_7_item_0: generation shape=torch.Size([1, 423])
2025-06-10 20:13:34,792 - DEBUG - Snippet 10.3389_fpubh.2021.812743_7_item_0 raw docling: (tokens=77)
<formula><loc_0><loc_0><loc_500><loc_500>p = \vartheta \, \epsilon _ { i j } + ( 1 - \vartheta ) \, \gamma _ { i j } \vartheta \, \epsilon \, \left [ 0 , 1 \right ]</formula><end_of_utterance>
2025-06-10 20:13:34,792 - DEBUG - Starting _parse_docling_output
2025-06-10 20:13:34,792 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>p = \vartheta \, \epsilon _ { i j } + ( 1 - \vartheta ) \, \gamma _ { i j } \vartheta \, \epsilon \, \left [ 0 , 1 \right ]</formula><end_of_utterance>
2025-06-10 20:13:34,793 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:13:34,793 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>p = \\vartheta \\, \\epsilon _ { i j } + ( 1 - \\vartheta ) \\, \\gamma _ { i j } \\vartheta \\, \\epsilon \\, \\left [ 0 , 1 \\right ]</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=536x56 at 0x7F96DCE9E600>)]
2025-06-10 20:13:34,793 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:13:34,795 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=536.0, b=56.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 123))], orig='p = \\vartheta \\, \\epsilon _ { i j } + ( 1 - \\vartheta ) \\, \\gamma _ { i j } \\vartheta \\, \\epsilon \\, \\left [ 0 , 1 \\right ]', text='p = \\vartheta \\, \\epsilon _ { i j } + ( 1 - \\vartheta ) \\, \\gamma _ { i j } \\vartheta \\, \\epsilon \\, \\left [ 0 , 1 \\right ]', formatting=None, hyperlink=None)]
2025-06-10 20:13:34,795 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:13:34,795 - DEBUG - Processing text item: label=formula, text=p = \vartheta \, \epsilon _ { i j } + ( 1 - \vartheta ) \, \gamma _ { i j } \vartheta \, \epsilon \, \left [ 0 , 1 \right ]
2025-06-10 20:13:34,796 - DEBUG - Recognized string extracted: p = \vartheta \, \epsilon _ { i j } + ( 1 - \vartheta ) \, \gamma _ { i j } \vartheta \, \epsilon \, \left [ 0 , 1 \right ]
2025-06-10 20:13:34,796 - DEBUG - Generating chat message for label: formula
2025-06-10 20:13:34,796 - DEBUG - Snippet 10.3389_fpubh.2021.812743_7_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:13:34,857 - DEBUG - [Page 33] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:34,867 - DEBUG - Snippet 10.3389_fpubh.2021.812743_7_item_1 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:13:34,912 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:34,913 - DEBUG - Finished converting page batch time=3539.350
2025-06-10 20:13:35,137 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:35,244 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:35,263 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:35,706 - DEBUG - [Page 14] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:35,711 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:35,836 - DEBUG - [Page 14] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:35,837 - DEBUG - Finished converting page batch time=3540.274
2025-06-10 20:13:35,873 - DEBUG - [Page 15] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:35,873 - DEBUG - Finished converting page batch time=3540.310
2025-06-10 20:13:35,972 - INFO - Finished converting document 10.1371_journal.pone.0242147_74.pdf in 11.96 sec.
2025-06-10 20:13:35,993 - DEBUG - [Page 34] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:36,021 - INFO - Finished converting document 10.3390_ijerph18168476_68.pdf in 18.30 sec.
2025-06-10 20:13:36,089 - INFO - Extraction successful row 16, tokens=13860
2025-06-10 20:13:36,099 - INFO - Going to convert document batch...
2025-06-10 20:13:36,099 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:13:36,100 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:13:36,153 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:13:36,157 - INFO - Extraction successful row 14, tokens=20766
2025-06-10 20:13:36,175 - INFO - Going to convert document batch...
2025-06-10 20:13:36,175 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:13:36,176 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:13:36,235 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:13:36,583 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:36,681 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:36,721 - DEBUG - [Page 35] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:36,725 - DEBUG - Finished converting page batch time=3541.162
2025-06-10 20:13:36,780 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:13:36,837 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:13:36,844 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:13:36,968 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:13:37,232 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:13:37,239 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:13:37,289 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:13:37,290 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:13:37,290 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:13:37,330 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:13:37,372 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:13:37,403 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:37,404 - DEBUG - [Page 36] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:37,407 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:13:37,616 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:37,617 - DEBUG - Finished converting page batch time=3542.054
2025-06-10 20:13:37,646 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:13:37,646 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:13:37,646 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:13:37,682 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:13:37,711 - DEBUG - Snippet 10.3389_fpubh.2021.812743_7_item_1: generation shape=torch.Size([1, 449])
2025-06-10 20:13:37,712 - DEBUG - Snippet 10.3389_fpubh.2021.812743_7_item_1 raw docling: (tokens=103)
<formula><loc_0><loc_0><loc_500><loc_500>\min P _ { k } \{ \alpha \min D _ { p } \, v \, \left ( P _ { k } , D _ { p } \right ) + ( 1 - \alpha ) \, \max D _ { p } \, v \, \left ( P _ { k } , D _ { p } \right ) \} \\ T h e</formula><end_of_utterance>
2025-06-10 20:13:37,712 - DEBUG - Starting _parse_docling_output
2025-06-10 20:13:37,712 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>\min P _ { k } \{ \alpha \min D _ { p } \, v \, \left ( P _ { k } , D _ { p } \right ) + ( 1 - \alpha ) \, \max D _ { p } \, v \, \left ( P _ { k } , D _ { p } \right ) \} \\ T h e</formula><end_of_utterance>
2025-06-10 20:13:37,713 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:13:37,713 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>\\min P _ { k } \\{ \\alpha \\min D _ { p } \\, v \\, \\left ( P _ { k } , D _ { p } \\right ) + ( 1 - \\alpha ) \\, \\max D _ { p } \\, v \\, \\left ( P _ { k } , D _ { p } \\right ) \\} \\\\ T h e</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=675x113 at 0x7F971D2C7CB0>)]
2025-06-10 20:13:37,713 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:13:37,716 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=675.0, b=113.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 180))], orig='\\min P _ { k } \\{ \\alpha \\min D _ { p } \\, v \\, \\left ( P _ { k } , D _ { p } \\right ) + ( 1 - \\alpha ) \\, \\max D _ { p } \\, v \\, \\left ( P _ { k } , D _ { p } \\right ) \\} \\\\ T h e', text='\\min P _ { k } \\{ \\alpha \\min D _ { p } \\, v \\, \\left ( P _ { k } , D _ { p } \\right ) + ( 1 - \\alpha ) \\, \\max D _ { p } \\, v \\, \\left ( P _ { k } , D _ { p } \\right ) \\} \\\\ T h e', formatting=None, hyperlink=None)]
2025-06-10 20:13:37,717 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:13:37,718 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:13:37,719 - DEBUG - Processing text item: label=formula, text=\min P _ { k } \{ \alpha \min D _ { p } \, v \, \left ( P _ { k } , D _ { p } \right ) + ( 1 - \alpha ) \, \max D _ { p } \, v \, \left ( P _ { k } , D _ { p } \right ) \} \\ T h e
2025-06-10 20:13:37,719 - DEBUG - Recognized string extracted: \min P _ { k } \{ \alpha \min D _ { p } \, v \, \left ( P _ { k } , D _ { p } \right ) + ( 1 - \alpha ) \, \max D _ { p } \, v \, \left ( P _ { k } , D _ { p } \right ) \} \\ T h e
2025-06-10 20:13:37,719 - INFO - All done. Returning 2 recognized text results.
2025-06-10 20:13:37,720 - DEBUG - Snippet 10.3389_fpubh.2021.812743_7_item_0 recognized text:
p = \vartheta \, \epsilon _ { i j } + ( 1 - \vartheta ) \, \gamma _ { i j } \vartheta \, \epsilon \, \left [ 0 , 1 \right ]
2025-06-10 20:13:37,720 - DEBUG - Snippet 10.3389_fpubh.2021.812743_7_item_1 recognized text:
\min P _ { k } \{ \alpha \min D _ { p } \, v \, \left ( P _ { k } , D _ { p } \right ) + ( 1 - \alpha ) \, \max D _ { p } \, v \, \left ( P _ { k } , D _ { p } \right ) \} \\ T h e
2025-06-10 20:13:37,790 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:13:37,795 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:37,806 - INFO - Finished converting document 10.3389_fpubh.2021.812743_7.pdf in 55.29 sec.
2025-06-10 20:13:37,869 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:13:37,895 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:13:37,904 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:13:37,934 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:13:37,940 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:13:37,957 - INFO - Extraction successful row 0, tokens=15105
2025-06-10 20:13:37,984 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:13:38,002 - INFO - Going to convert document batch...
2025-06-10 20:13:38,003 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:13:38,003 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:13:38,058 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:13:38,116 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:13:38,122 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:13:38,155 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:13:38,159 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:13:38,200 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:13:38,209 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:13:38,360 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:13:38,382 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:13:38,530 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:38,655 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:13:38,662 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:13:38,699 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:13:38,774 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:13:38,781 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:13:38,826 - DEBUG - [Page 37] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:38,833 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:13:38,833 - INFO - Processing document 10.1186_s12889-019-7690-4_81.pdf
2025-06-10 20:13:38,917 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:13:38,919 - INFO - Processing document 10.1186_s12940-020-00575-0_80.pdf
2025-06-10 20:13:39,363 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:39,408 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:39,414 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:13:39,415 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:13:39,415 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:13:39,452 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:13:39,506 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:13:39,605 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:13:39,644 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:13:39,685 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:13:39,719 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:39,723 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:13:39,920 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:13:39,920 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:39,922 - DEBUG - Finished converting page batch time=3544.358
2025-06-10 20:13:39,970 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:39,977 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:13:39,982 - DEBUG - [Page 38] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:40,014 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:13:40,156 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:13:40,232 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:40,234 - DEBUG - Finished converting page batch time=3544.671
2025-06-10 20:13:40,383 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:40,435 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:40,468 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:13:40,617 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:40,638 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:13:40,639 - INFO - Processing document 10.1371_journal.pone.0222601_82.pdf
2025-06-10 20:13:40,723 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:40,918 - DEBUG - [Page 39] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:40,919 - DEBUG - Finished converting page batch time=3545.356
2025-06-10 20:13:40,933 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:41,317 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:41,367 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:41,526 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:41,806 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:41,810 - DEBUG - [Page 40] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:41,812 - DEBUG - Finished converting page batch time=3546.248
2025-06-10 20:13:41,856 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:42,060 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:42,080 - INFO - Finished converting document 10.3390_ijerph20043506_45.pdf in 40.93 sec.
2025-06-10 20:13:42,485 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:42,486 - DEBUG - Finished converting page batch time=3546.923
2025-06-10 20:13:42,718 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:42,722 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:42,915 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:42,915 - DEBUG - Finished converting page batch time=3547.352
2025-06-10 20:13:42,920 - INFO - Extraction successful row 9, tokens=156684
2025-06-10 20:13:42,929 - INFO - Going to convert document batch...
2025-06-10 20:13:42,930 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:13:42,930 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:13:42,986 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:13:42,988 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:42,989 - DEBUG - Finished converting page batch time=3547.426
2025-06-10 20:13:43,148 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:43,149 - DEBUG - Finished converting page batch time=3547.586
2025-06-10 20:13:43,296 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:43,345 - DEBUG - Finished converting page batch time=3547.781
2025-06-10 20:13:43,540 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:13:43,588 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:13:43,595 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:13:43,603 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:43,764 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:43,954 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:43,972 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:43,973 - DEBUG - Finished converting page batch time=3548.410
2025-06-10 20:13:44,048 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:44,081 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:44,195 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:44,217 - INFO - Finished converting document 10.1186_s12940-021-00726-x_71.pdf in 22.51 sec.
2025-06-10 20:13:44,310 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:13:44,310 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:13:44,310 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:13:44,349 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:13:44,379 - INFO - Extraction successful row 15, tokens=27021
2025-06-10 20:13:44,387 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:13:44,401 - INFO - Going to convert document batch...
2025-06-10 20:13:44,402 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:13:44,402 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:13:44,454 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:13:44,461 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:44,646 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:44,830 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:44,864 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:44,896 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:44,921 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:13:44,960 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:13:44,991 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:45,047 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:13:45,089 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:13:45,096 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:13:45,102 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:13:45,121 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:45,128 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:13:45,254 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:13:45,297 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:13:45,522 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:13:45,523 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:13:45,523 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:13:45,569 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:13:45,598 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:13:45,639 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:13:45,673 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:13:45,715 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:13:45,731 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:13:45,764 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:13:45,799 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:13:45,861 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:45,862 - DEBUG - Finished converting page batch time=3550.299
2025-06-10 20:13:45,913 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:13:45,951 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:13:45,993 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:13:46,006 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:13:46,131 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:13:46,187 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:13:46,188 - INFO - Processing document 10.3390_ijerph16183270_83.pdf
2025-06-10 20:13:46,269 - DEBUG - Finished converting page batch time=3550.706
2025-06-10 20:13:46,380 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:46,381 - DEBUG - Finished converting page batch time=3550.818
2025-06-10 20:13:46,426 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:13:46,464 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:46,638 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:46,822 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:13:46,823 - INFO - Processing document 10.1186_s12942-018-0138-8_94.pdf
2025-06-10 20:13:46,827 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:46,869 - DEBUG - [Page 14] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:47,111 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:47,437 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:47,611 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:47,612 - DEBUG - Finished converting page batch time=3552.048
2025-06-10 20:13:47,690 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:47,786 - INFO - Finished converting document 10.1186_s12940-020-00663-1_75.pdf in 20.92 sec.
2025-06-10 20:13:47,811 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:47,888 - INFO - Extraction successful row 17, tokens=21812
2025-06-10 20:13:47,905 - INFO - Going to convert document batch...
2025-06-10 20:13:47,905 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:13:47,906 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:13:47,970 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:13:48,207 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:48,209 - DEBUG - Finished converting page batch time=3552.645
2025-06-10 20:13:48,210 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:48,354 - INFO - Finished converting document 10.1186_s12889-019-7690-4_81.pdf in 12.20 sec.
2025-06-10 20:13:48,435 - INFO - Extraction successful row 20, tokens=12743
2025-06-10 20:13:48,444 - INFO - Going to convert document batch...
2025-06-10 20:13:48,444 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:13:48,444 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:13:48,465 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:48,498 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:13:48,623 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:13:48,681 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:13:48,688 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:13:48,708 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:49,084 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:49,085 - DEBUG - Finished converting page batch time=3553.522
2025-06-10 20:13:49,163 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:13:49,246 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:13:49,252 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:13:49,370 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:13:49,370 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:13:49,371 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:13:49,384 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:49,440 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:13:49,479 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:13:49,561 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:13:49,601 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:13:49,649 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:13:49,660 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:49,677 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:13:49,677 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:13:49,678 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:13:49,686 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:13:49,712 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:13:49,745 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:49,750 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:13:49,808 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:13:49,875 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:13:49,905 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:13:49,916 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:13:49,945 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:13:49,957 - DEBUG - [Page 15] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:49,958 - DEBUG - Finished converting page batch time=3554.395
2025-06-10 20:13:49,978 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:13:50,022 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:13:50,092 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:13:50,158 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:13:50,218 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:13:50,280 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:13:50,317 - DEBUG - [Page 16] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:50,318 - DEBUG - Finished converting page batch time=3554.754
2025-06-10 20:13:50,382 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:13:50,421 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:13:50,526 - DEBUG - Dynamic vertical threshold: 72.8658, Overlap threshold: 0.7
2025-06-10 20:13:50,527 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:50,528 - DEBUG - Finished converting page batch time=3554.964
2025-06-10 20:13:50,555 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:13:50,556 - INFO - Processing document 10.1007_s40615-018-0490-1_96.pdf
2025-06-10 20:13:50,556 - INFO - Finished converting document 10.1186_s12940-020-00662-2_77.pdf in 19.68 sec.
2025-06-10 20:13:50,632 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:50,724 - INFO - Extraction successful row 18, tokens=19120
2025-06-10 20:13:50,730 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:50,740 - INFO - Going to convert document batch...
2025-06-10 20:13:50,741 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:13:50,741 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:13:50,748 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:13:50,799 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:13:50,914 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:13:50,914 - INFO - Processing document 10.13075_ijomeh.1896.01104_98.pdf
2025-06-10 20:13:51,031 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:51,080 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:51,101 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:51,102 - DEBUG - Finished converting page batch time=3555.538
2025-06-10 20:13:51,282 - INFO - Finished converting document 10.1186_s12940-020-00575-0_80.pdf in 15.20 sec.
2025-06-10 20:13:51,380 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:13:51,386 - INFO - Extraction successful row 19, tokens=14663
2025-06-10 20:13:51,404 - INFO - Going to convert document batch...
2025-06-10 20:13:51,405 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:13:51,405 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:13:51,409 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:51,432 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:13:51,438 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:13:51,468 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:13:51,474 - DEBUG - Dynamic vertical threshold: 60.01560000000018, Overlap threshold: 0.7
2025-06-10 20:13:51,474 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:51,975 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:52,026 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:52,076 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:52,221 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:13:52,296 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:13:52,302 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:13:52,309 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:13:52,309 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:13:52,310 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:13:52,340 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:52,348 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:13:52,384 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:13:52,458 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:13:52,505 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:52,537 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:13:52,568 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:52,611 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:13:52,648 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:13:52,717 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:13:52,717 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:13:52,717 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:13:52,752 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:13:52,766 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:13:52,789 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:13:52,808 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:13:52,851 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:13:52,854 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:13:52,896 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:13:52,903 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:52,908 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:52,932 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:13:52,969 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:13:52,988 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:13:53,157 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:53,158 - DEBUG - Finished converting page batch time=3557.594
2025-06-10 20:13:53,268 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:53,325 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:13:53,329 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:53,330 - DEBUG - Finished converting page batch time=3557.767
2025-06-10 20:13:53,422 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:13:53,427 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:53,466 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:13:53,533 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:13:53,533 - INFO - Processing document 10.1186_s12989-017-0237-x_99.pdf
2025-06-10 20:13:53,581 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:53,591 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:13:53,778 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:13:54,036 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:13:54,107 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:54,241 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:13:54,242 - INFO - Processing document 10.3390_toxics13040318_111.pdf
2025-06-10 20:13:54,246 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:54,246 - DEBUG - Finished converting page batch time=3558.683
2025-06-10 20:13:54,298 - DEBUG - Finished converting page batch time=3558.735
2025-06-10 20:13:54,559 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:54,583 - DEBUG - Finished converting page batch time=3559.019
2025-06-10 20:13:54,840 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:54,857 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:54,990 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:55,274 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:55,377 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:55,451 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:55,580 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:55,599 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:56,029 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:56,030 - DEBUG - Finished converting page batch time=3560.467
2025-06-10 20:13:56,233 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:56,396 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:56,823 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:56,884 - DEBUG - Dynamic vertical threshold: 33.07860000000012, Overlap threshold: 0.7
2025-06-10 20:13:56,884 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:56,885 - DEBUG - Finished converting page batch time=3561.322
2025-06-10 20:13:56,907 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:57,263 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:57,271 - DEBUG - Dynamic vertical threshold: 22.964399999999866, Overlap threshold: 0.7
2025-06-10 20:13:57,272 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:57,328 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:57,345 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:57,492 - DEBUG - [Page 14] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:58,004 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:58,021 - DEBUG - [Page 15] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:58,021 - DEBUG - Finished converting page batch time=3562.458
2025-06-10 20:13:58,099 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:58,320 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:58,426 - DEBUG - [Page 16] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:58,506 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:58,530 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:58,720 - DEBUG - [Page 17] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:58,790 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:58,792 - DEBUG - Finished converting page batch time=3563.228
2025-06-10 20:13:58,953 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:59,142 - DEBUG - Finished converting page batch time=3563.579
2025-06-10 20:13:59,174 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:59,175 - DEBUG - Finished converting page batch time=3563.612
2025-06-10 20:13:57,283 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:57,284 - DEBUG - Finished converting page batch time=3563.943
2025-06-10 20:13:57,453 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:57,520 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:57,559 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:57,589 - DEBUG - [Page 18] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:57,960 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:58,245 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:58,330 - DEBUG - [Page 19] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:58,331 - DEBUG - Finished converting page batch time=3564.990
2025-06-10 20:13:58,691 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:58,753 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:59,135 - DEBUG - [Page 20] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:59,205 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:59,220 - DEBUG - [Page 21] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:59,221 - DEBUG - Finished converting page batch time=3565.880
2025-06-10 20:13:59,342 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:59,415 - INFO - Finished converting document 10.1371_journal.pone.0222601_82.pdf in 23.68 sec.
2025-06-10 20:13:59,579 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:59,666 - INFO - Extraction successful row 21, tokens=29150
2025-06-10 20:13:59,686 - INFO - Going to convert document batch...
2025-06-10 20:13:59,686 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:13:59,686 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:13:59,751 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:13:59,788 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:13:59,789 - DEBUG - Finished converting page batch time=3566.448
2025-06-10 20:14:00,179 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:00,278 - DEBUG - [Page 14] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:00,432 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:14:00,448 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:00,449 - DEBUG - Finished converting page batch time=3567.109
2025-06-10 20:14:00,459 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:00,459 - DEBUG - Finished converting page batch time=3567.119
2025-06-10 20:14:00,554 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:14:00,561 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:14:01,187 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:01,256 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:01,303 - DEBUG - [Page 15] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:01,305 - DEBUG - Finished converting page batch time=3567.964
2025-06-10 20:14:01,346 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:14:01,346 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:14:01,347 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:14:01,381 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:14:01,436 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:14:01,440 - INFO - Finished converting document 10.3390_ijerph16183270_83.pdf in 20.74 sec.
2025-06-10 20:14:01,479 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:14:01,557 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:14:01,587 - INFO - Extraction successful row 22, tokens=36031
2025-06-10 20:14:01,661 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:01,682 - INFO - Going to convert document batch...
2025-06-10 20:14:01,682 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:14:01,683 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:14:01,728 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:14:01,766 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:01,800 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:01,800 - DEBUG - Finished converting page batch time=3568.460
2025-06-10 20:14:01,841 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:01,913 - INFO - Finished converting document 10.1007_s40615-018-0490-1_96.pdf in 16.25 sec.
2025-06-10 20:14:02,000 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:14:02,009 - INFO - Extraction successful row 24, tokens=38333
2025-06-10 20:14:02,032 - INFO - Going to convert document batch...
2025-06-10 20:14:02,033 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:14:02,033 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:14:02,037 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:14:02,061 - DEBUG - [Page 14] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:02,107 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:14:02,167 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:14:02,203 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:14:02,319 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:14:02,340 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:14:02,366 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:14:02,373 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:14:02,383 - DEBUG - [Page 15] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:02,385 - DEBUG - Finished converting page batch time=3569.044
2025-06-10 20:14:02,491 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:14:02,586 - DEBUG - Creating masked image for page 3 with 19 clusters.
2025-06-10 20:14:02,590 - INFO - Masked image successfully created for page 3.
2025-06-10 20:14:02,716 - DEBUG - Creating masked image for page 4 with 16 clusters.
2025-06-10 20:14:02,717 - INFO - Masked image successfully created for page 4.
2025-06-10 20:14:02,722 - INFO - Starting prediction for 2 images with labels: ['formula', 'formula']
2025-06-10 20:14:02,722 - DEBUG - Generating chat message for label: formula
2025-06-10 20:14:02,726 - DEBUG - Snippet 10.1186_s12942-018-0138-8_94_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:14:02,779 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:14:02,790 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:14:02,837 - DEBUG - [Page 14] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:02,885 - DEBUG - Snippet 10.1186_s12942-018-0138-8_94_item_0 => input_ids shape=torch.Size([1, 610]), prompt_len=610
2025-06-10 20:14:02,974 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:14:02,974 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:14:02,975 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:14:02,984 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:14:02,984 - INFO - Processing document 10.3390_biomedicines13010241_119.pdf
2025-06-10 20:14:03,050 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:14:03,142 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:14:03,202 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:14:03,208 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:14:03,209 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:14:03,311 - DEBUG - [Page 15] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:03,321 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:14:03,359 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:14:03,396 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:14:03,520 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:14:03,547 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:03,554 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:14:03,600 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:14:03,678 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:14:03,678 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:14:03,679 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:14:03,688 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:03,713 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:14:03,746 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:14:03,790 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:14:03,825 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:14:03,866 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:14:03,912 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:14:03,947 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:14:04,008 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:14:04,073 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:14:04,112 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:14:04,148 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:14:04,214 - DEBUG - Finished converting page batch time=3570.874
2025-06-10 20:14:04,217 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:14:04,217 - INFO - Processing document 10.3390_toxics12120868_124.pdf
2025-06-10 20:14:04,289 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:14:04,392 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:04,639 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:04,673 - DEBUG - [Page 16] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:04,674 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:14:04,854 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:14:04,854 - INFO - Processing document 10.1186_s12940-024-01148-1_132.pdf
2025-06-10 20:14:04,892 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:05,097 - INFO - Finished converting document 10.30773_pi.2022.0352_40.pdf in 84.68 sec.
2025-06-10 20:14:05,130 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:05,130 - DEBUG - Finished converting page batch time=3571.790
2025-06-10 20:14:05,171 - DEBUG - [Page 17] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:05,383 - INFO - Extraction successful row 6, tokens=20491
2025-06-10 20:14:05,400 - INFO - Going to convert document batch...
2025-06-10 20:14:05,401 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:14:05,401 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:14:05,452 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:14:05,491 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:05,579 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:05,747 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:05,800 - DEBUG - [Page 14] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:05,825 - DEBUG - [Page 18] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:06,022 - DEBUG - [Page 15] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:06,023 - DEBUG - Finished converting page batch time=3572.683
2025-06-10 20:14:06,080 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:14:06,110 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:06,125 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:14:06,130 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:14:06,277 - INFO - Finished converting document 10.1186_s12989-017-0237-x_99.pdf in 17.77 sec.
2025-06-10 20:14:06,409 - INFO - Extraction successful row 26, tokens=18823
2025-06-10 20:14:06,437 - INFO - Going to convert document batch...
2025-06-10 20:14:06,441 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:14:06,441 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:14:06,476 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:06,488 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:14:06,518 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:06,647 - DEBUG - [Page 19] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:06,649 - DEBUG - Finished converting page batch time=3573.308
2025-06-10 20:14:06,799 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:14:06,799 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:14:06,800 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:14:06,834 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:14:06,856 - DEBUG - Snippet 10.1186_s12942-018-0138-8_94_item_0: generation shape=torch.Size([1, 741])
2025-06-10 20:14:06,857 - DEBUG - Snippet 10.1186_s12942-018-0138-8_94_item_0 raw docling: (tokens=130)
<formula><loc_0><loc_0><loc_500><loc_500>\log ( \lambda _ { i t } ) = \beta _ { 0 } + \sum _ { k = 1 } ^ { 3 } \beta _ { k } X _ { k , i t } + \sum _ { l = 1 } ^ { 1 2 } \alpha _ { l } T _ { l , t } + \sum _ { m = 1 } ^ { 5 } \eta _ { m } Z _ { m , i } + U _ { i }</formula><end_of_utterance>
2025-06-10 20:14:06,857 - DEBUG - Starting _parse_docling_output
2025-06-10 20:14:06,857 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>\log ( \lambda _ { i t } ) = \beta _ { 0 } + \sum _ { k = 1 } ^ { 3 } \beta _ { k } X _ { k , i t } + \sum _ { l = 1 } ^ { 1 2 } \alpha _ { l } T _ { l , t } + \sum _ { m = 1 } ^ { 5 } \eta _ { m } Z _ { m , i } + U _ { i }</formula><end_of_utterance>
2025-06-10 20:14:06,857 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:14:06,858 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>\\log ( \\lambda _ { i t } ) = \\beta _ { 0 } + \\sum _ { k = 1 } ^ { 3 } \\beta _ { k } X _ { k , i t } + \\sum _ { l = 1 } ^ { 1 2 } \\alpha _ { l } T _ { l , t } + \\sum _ { m = 1 } ^ { 5 } \\eta _ { m } Z _ { m , i } + U _ { i }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=629x179 at 0x7F96CD0DC8F0>)]
2025-06-10 20:14:06,858 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:14:06,869 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=629.0, b=179.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 223))], orig='\\log ( \\lambda _ { i t } ) = \\beta _ { 0 } + \\sum _ { k = 1 } ^ { 3 } \\beta _ { k } X _ { k , i t } + \\sum _ { l = 1 } ^ { 1 2 } \\alpha _ { l } T _ { l , t } + \\sum _ { m = 1 } ^ { 5 } \\eta _ { m } Z _ { m , i } + U _ { i }', text='\\log ( \\lambda _ { i t } ) = \\beta _ { 0 } + \\sum _ { k = 1 } ^ { 3 } \\beta _ { k } X _ { k , i t } + \\sum _ { l = 1 } ^ { 1 2 } \\alpha _ { l } T _ { l , t } + \\sum _ { m = 1 } ^ { 5 } \\eta _ { m } Z _ { m , i } + U _ { i }', formatting=None, hyperlink=None)]
2025-06-10 20:14:06,869 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:14:06,870 - DEBUG - Processing text item: label=formula, text=\log ( \lambda _ { i t } ) = \beta _ { 0 } + \sum _ { k = 1 } ^ { 3 } \beta _ { k } X _ { k , i t } + \sum _ { l = 1 } ^ { 1 2 } \alpha _ { l } T _ { l , t } + \sum _ { m = 1 } ^ { 5 } \eta _ { m } Z _ { m , i } + U _ { i }
2025-06-10 20:14:06,870 - DEBUG - Recognized string extracted: \log ( \lambda _ { i t } ) = \beta _ { 0 } + \sum _ { k = 1 } ^ { 3 } \beta _ { k } X _ { k , i t } + \sum _ { l = 1 } ^ { 1 2 } \alpha _ { l } T _ { l , t } + \sum _ { m = 1 } ^ { 5 } \eta _ { m } Z _ { m , i } + U _ { i }
2025-06-10 20:14:06,870 - DEBUG - Generating chat message for label: formula
2025-06-10 20:14:06,871 - DEBUG - Snippet 10.1186_s12942-018-0138-8_94_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:14:06,871 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:14:06,905 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:14:06,948 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:14:06,978 - DEBUG - Snippet 10.1186_s12942-018-0138-8_94_item_1 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:14:07,005 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:07,014 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:14:07,038 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:07,054 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:14:07,153 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:14:07,205 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:14:07,223 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:14:07,230 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:14:07,284 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:14:07,319 - DEBUG - Dynamic vertical threshold: 34.53120000000015, Overlap threshold: 0.7
2025-06-10 20:14:07,319 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:14:07,320 - DEBUG - Checking merge:
  Current: 6, Next: 5
2025-06-10 20:14:07,320 - DEBUG -   Vertical gap: 10.195999999999913, Overlap ratio: 1.0
2025-06-10 20:14:07,320 - DEBUG -   Left boundary diff: 33.553, Right boundary diff: 0.0
2025-06-10 20:14:07,320 - DEBUG -   Alignment factor (ratio): 0.11699480980018516
2025-06-10 20:14:07,321 - DEBUG -   -> c1 6 formula number: 2, c2 5 formula number: 3
2025-06-10 20:14:07,321 - DEBUG -   -> Not merging clusters 6 and 5 due to different formula numbers: 2 vs 3
2025-06-10 20:14:07,321 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:07,322 - DEBUG - Finished converting page batch time=3573.981
2025-06-10 20:14:07,483 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:14:07,670 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:07,671 - DEBUG - Finished converting page batch time=3574.330
2025-06-10 20:14:07,748 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:14:07,777 - DEBUG - Dynamic vertical threshold: 41.6727, Overlap threshold: 0.7
2025-06-10 20:14:07,778 - DEBUG - Checking merge:
  Current: 5, Next: 8
2025-06-10 20:14:07,778 - DEBUG -   Vertical gap: 3.6539999999999964, Overlap ratio: 1.0
2025-06-10 20:14:07,778 - DEBUG -   Left boundary diff: 58.15799999999996, Right boundary diff: 0.0
2025-06-10 20:14:07,778 - DEBUG -   Alignment factor (ratio): 0.22295230282073486
2025-06-10 20:14:07,778 - DEBUG -   -> c1 5 formula number: 4, c2 8 formula number: 5
2025-06-10 20:14:07,779 - DEBUG -   -> Not merging clusters 5 and 8 due to different formula numbers: 4 vs 5
2025-06-10 20:14:07,779 - DEBUG - Checking merge:
  Current: 5, Next: 6
2025-06-10 20:14:07,779 - DEBUG -   Vertical gap: 25.682000000000016, Overlap ratio: 1.0
2025-06-10 20:14:07,779 - DEBUG -   Left boundary diff: 24.260999999999967, Right boundary diff: 0.0
2025-06-10 20:14:07,780 - DEBUG -   Alignment factor (ratio): 0.08733182746735531
2025-06-10 20:14:07,780 - DEBUG -   -> c1 5 formula number: 4, c2 6 formula number: 6
2025-06-10 20:14:07,780 - DEBUG -   -> Not merging clusters 5 and 6 due to different formula numbers: 4 vs 6
2025-06-10 20:14:07,780 - DEBUG - Checking merge:
  Current: 8, Next: 6
2025-06-10 20:14:07,780 - DEBUG -   Vertical gap: 1.886000000000024, Overlap ratio: 1.0
2025-06-10 20:14:07,780 - DEBUG -   Left boundary diff: 33.89699999999999, Right boundary diff: 0.0
2025-06-10 20:14:07,781 - DEBUG -   Alignment factor (ratio): 0.13628386541681825
2025-06-10 20:14:07,781 - DEBUG -   -> c1 8 formula number: 5, c2 6 formula number: 6
2025-06-10 20:14:07,781 - DEBUG -   -> Not merging clusters 8 and 6 due to different formula numbers: 5 vs 6
2025-06-10 20:14:07,781 - DEBUG - Checking merge:
  Current: 8, Next: 7
2025-06-10 20:14:07,781 - DEBUG -   Vertical gap: 33.15400000000005, Overlap ratio: 1.0
2025-06-10 20:14:07,782 - DEBUG -   Left boundary diff: 2.3010000000000446, Right boundary diff: 0.0
2025-06-10 20:14:07,782 - DEBUG -   Alignment factor (ratio): 0.009977257403268278
2025-06-10 20:14:07,782 - DEBUG -   -> c1 8 formula number: 5, c2 7 formula number: 7
2025-06-10 20:14:07,782 - DEBUG -   -> Not merging clusters 8 and 7 due to different formula numbers: 5 vs 7
2025-06-10 20:14:07,782 - DEBUG - Checking merge:
  Current: 6, Next: 7
2025-06-10 20:14:07,782 - DEBUG -   Vertical gap: 0.8179999999999836, Overlap ratio: 1.0
2025-06-10 20:14:07,783 - DEBUG -   Left boundary diff: 36.198000000000036, Right boundary diff: 0.0
2025-06-10 20:14:07,783 - DEBUG -   Alignment factor (ratio): 0.14621142046992217
2025-06-10 20:14:07,783 - DEBUG -   -> c1 6 formula number: 6, c2 7 formula number: 7
2025-06-10 20:14:07,783 - DEBUG -   -> Not merging clusters 6 and 7 due to different formula numbers: 6 vs 7
2025-06-10 20:14:07,784 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:07,915 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:14:07,915 - INFO - Processing document 10.1186_s12889-024-20693-5_138.pdf
2025-06-10 20:14:07,971 - DEBUG - [Page 20] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:08,137 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:14:08,138 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:14:08,138 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:14:08,175 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:14:08,177 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:08,235 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:14:08,242 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:08,378 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:14:08,414 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:14:08,429 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:08,430 - DEBUG - Finished converting page batch time=3575.089
2025-06-10 20:14:08,494 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:14:08,545 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:08,574 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:14:08,695 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:08,699 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:14:08,832 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:08,845 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:08,859 - DEBUG - [Page 21] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:08,905 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:14:08,943 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:14:09,134 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:14:09,398 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:09,440 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:14:09,490 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:09,629 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:14:09,629 - INFO - Processing document 10.1038_s41598-024-65584-2_157.pdf
2025-06-10 20:14:09,739 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:09,740 - DEBUG - Finished converting page batch time=3576.400
2025-06-10 20:14:09,749 - DEBUG - Snippet 10.1186_s12942-018-0138-8_94_item_1: generation shape=torch.Size([1, 443])
2025-06-10 20:14:09,750 - DEBUG - Snippet 10.1186_s12942-018-0138-8_94_item_1 raw docling: (tokens=97)
<formula><loc_0><loc_0><loc_500><loc_500>[ V _ { i } | V _ { j } , j \ne i ] \sim N \left ( \frac { \sum _ { j \sim i } V _ { j } } { | j \sim i | } , \frac { c o _ { 1 } ^ { 2 } } { | j \sim i | } \right )</formula><end_of_utterance>
2025-06-10 20:14:09,751 - DEBUG - Starting _parse_docling_output
2025-06-10 20:14:09,751 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>[ V _ { i } | V _ { j } , j \ne i ] \sim N \left ( \frac { \sum _ { j \sim i } V _ { j } } { | j \sim i | } , \frac { c o _ { 1 } ^ { 2 } } { | j \sim i | } \right )</formula><end_of_utterance>
2025-06-10 20:14:09,751 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:14:09,751 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>[ V _ { i } | V _ { j } , j \\ne i ] \\sim N \\left ( \\frac { \\sum _ { j \\sim i } V _ { j } } { | j \\sim i | } , \\frac { c o _ { 1 } ^ { 2 } } { | j \\sim i | } \\right )</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=631x148 at 0x7F96CD0E37A0>)]
2025-06-10 20:14:09,752 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:14:09,756 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=631.0, b=148.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 165))], orig='[ V _ { i } | V _ { j } , j \\ne i ] \\sim N \\left ( \\frac { \\sum _ { j \\sim i } V _ { j } } { | j \\sim i | } , \\frac { c o _ { 1 } ^ { 2 } } { | j \\sim i | } \\right )', text='[ V _ { i } | V _ { j } , j \\ne i ] \\sim N \\left ( \\frac { \\sum _ { j \\sim i } V _ { j } } { | j \\sim i | } , \\frac { c o _ { 1 } ^ { 2 } } { | j \\sim i | } \\right )', formatting=None, hyperlink=None)]
2025-06-10 20:14:09,756 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:14:09,756 - DEBUG - Processing text item: label=formula, text=[ V _ { i } | V _ { j } , j \ne i ] \sim N \left ( \frac { \sum _ { j \sim i } V _ { j } } { | j \sim i | } , \frac { c o _ { 1 } ^ { 2 } } { | j \sim i | } \right )
2025-06-10 20:14:09,757 - DEBUG - Recognized string extracted: [ V _ { i } | V _ { j } , j \ne i ] \sim N \left ( \frac { \sum _ { j \sim i } V _ { j } } { | j \sim i | } , \frac { c o _ { 1 } ^ { 2 } } { | j \sim i | } \right )
2025-06-10 20:14:09,757 - INFO - All done. Returning 2 recognized text results.
2025-06-10 20:14:09,757 - DEBUG - Snippet 10.1186_s12942-018-0138-8_94_item_0 recognized text:
\log ( \lambda _ { i t } ) = \beta _ { 0 } + \sum _ { k = 1 } ^ { 3 } \beta _ { k } X _ { k , i t } + \sum _ { l = 1 } ^ { 1 2 } \alpha _ { l } T _ { l , t } + \sum _ { m = 1 } ^ { 5 } \eta _ { m } Z _ { m , i } + U _ { i }
2025-06-10 20:14:09,758 - DEBUG - Snippet 10.1186_s12942-018-0138-8_94_item_1 recognized text:
[ V _ { i } | V _ { j } , j \ne i ] \sim N \left ( \frac { \sum _ { j \sim i } V _ { j } } { | j \sim i | } , \frac { c o _ { 1 } ^ { 2 } } { | j \sim i | } \right )
2025-06-10 20:14:09,910 - INFO - Finished converting document 10.1186_s12942-018-0138-8_94.pdf in 27.75 sec.
2025-06-10 20:14:09,927 - DEBUG - [Page 22] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:10,069 - INFO - Extraction successful row 23, tokens=24602
2025-06-10 20:14:10,094 - DEBUG - [Page 23] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:10,094 - DEBUG - Finished converting page batch time=3576.753
2025-06-10 20:14:10,107 - INFO - Going to convert document batch...
2025-06-10 20:14:10,108 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:14:10,108 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:14:10,160 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:14:10,282 - DEBUG - Creating masked image for page 3 with 14 clusters.
2025-06-10 20:14:10,283 - INFO - Masked image successfully created for page 3.
2025-06-10 20:14:10,343 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:10,419 - DEBUG - Creating masked image for page 4 with 15 clusters.
2025-06-10 20:14:10,420 - INFO - Masked image successfully created for page 4.
2025-06-10 20:14:10,427 - INFO - Starting prediction for 3 images with labels: ['formula', 'formula', 'formula']
2025-06-10 20:14:10,428 - DEBUG - Generating chat message for label: formula
2025-06-10 20:14:10,432 - DEBUG - Snippet 10.3390_toxics13040318_111_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:14:10,441 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:10,441 - DEBUG - Finished converting page batch time=3577.101
2025-06-10 20:14:10,480 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:10,515 - DEBUG - Snippet 10.3390_toxics13040318_111_item_0 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:14:10,708 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:10,717 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:10,849 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:14:10,906 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:14:10,912 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:14:10,932 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:10,933 - DEBUG - Finished converting page batch time=3577.592
2025-06-10 20:14:10,968 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:11,012 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:11,019 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:11,091 - DEBUG - Dynamic vertical threshold: 46.05840000000004, Overlap threshold: 0.7
2025-06-10 20:14:11,097 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:11,556 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:11,609 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:11,631 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:14:11,632 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:14:11,632 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:14:11,671 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:14:11,713 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:14:11,727 - DEBUG - Snippet 10.3390_toxics13040318_111_item_0: generation shape=torch.Size([1, 375])
2025-06-10 20:14:11,728 - DEBUG - Snippet 10.3390_toxics13040318_111_item_0 raw docling: (tokens=29)
<formula><loc_0><loc_0><loc_500><loc_500>E C R = I R \times E C</formula><end_of_utterance>
2025-06-10 20:14:11,728 - DEBUG - Starting _parse_docling_output
2025-06-10 20:14:11,728 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>E C R = I R \times E C</formula><end_of_utterance>
2025-06-10 20:14:11,728 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:14:11,729 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>E C R = I R \\times E C</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=1166x81 at 0x7F96DB9592B0>)]
2025-06-10 20:14:11,729 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:14:11,738 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=1166.0, b=81.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 22))], orig='E C R = I R \\times E C', text='E C R = I R \\times E C', formatting=None, hyperlink=None)]
2025-06-10 20:14:11,738 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:14:11,739 - DEBUG - Processing text item: label=formula, text=E C R = I R \times E C
2025-06-10 20:14:11,739 - DEBUG - Recognized string extracted: E C R = I R \times E C
2025-06-10 20:14:11,739 - DEBUG - Generating chat message for label: formula
2025-06-10 20:14:11,740 - DEBUG - Snippet 10.3390_toxics13040318_111_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:14:11,754 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:14:11,764 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:11,783 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:11,784 - DEBUG - Finished converting page batch time=3578.443
2025-06-10 20:14:11,794 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:14:11,831 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:14:11,858 - DEBUG - Snippet 10.3390_toxics13040318_111_item_1 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:14:11,868 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:14:11,994 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:14:12,030 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:14:12,066 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:14:12,127 - DEBUG - Dynamic vertical threshold: 34.56540000000006, Overlap threshold: 0.7
2025-06-10 20:14:12,127 - DEBUG - Checking merge:
  Current: 6, Next: 21
2025-06-10 20:14:12,128 - DEBUG -   Vertical gap: 11.197000000000003, Overlap ratio: 0.9999686789046729
2025-06-10 20:14:12,128 - DEBUG -   Left boundary diff: 41.33800000000002, Right boundary diff: 0.010999999999967258
2025-06-10 20:14:12,128 - DEBUG -   Alignment factor (ratio): 0.152053688510269
2025-06-10 20:14:12,129 - DEBUG -   -> c1 6 formula number: 1, c2 21 formula number: 2
2025-06-10 20:14:12,129 - DEBUG -   -> Not merging clusters 6 and 21 due to different formula numbers: 1 vs 2
2025-06-10 20:14:12,129 - DEBUG - Checking merge:
  Current: 16, Next: 11
2025-06-10 20:14:12,130 - DEBUG -   Vertical gap: 18.817999999999984, Overlap ratio: 1.0
2025-06-10 20:14:12,130 - DEBUG -   Left boundary diff: 45.462000000000046, Right boundary diff: 0.0
2025-06-10 20:14:12,130 - DEBUG -   Alignment factor (ratio): 0.18301195604041723
2025-06-10 20:14:12,130 - DEBUG -   -> c1 16 formula number: 5, c2 11 formula number: 6
2025-06-10 20:14:12,131 - DEBUG -   -> Not merging clusters 16 and 11 due to different formula numbers: 5 vs 6
2025-06-10 20:14:12,131 - DEBUG - Checking merge:
  Current: 15, Next: 20
2025-06-10 20:14:12,131 - DEBUG -   Vertical gap: 18.965000000000032, Overlap ratio: 1.0
2025-06-10 20:14:12,131 - DEBUG -   Left boundary diff: 10.439999999999998, Right boundary diff: 0.0
2025-06-10 20:14:12,131 - DEBUG -   Alignment factor (ratio): 0.038348656878698484
2025-06-10 20:14:12,131 - DEBUG -   -> c1 15 formula number: 7, c2 20 formula number: 8
2025-06-10 20:14:12,132 - DEBUG -   -> Not merging clusters 15 and 20 due to different formula numbers: 7 vs 8
2025-06-10 20:14:12,132 - DEBUG - Checking merge:
  Current: 20, Next: 14
2025-06-10 20:14:12,132 - DEBUG -   Vertical gap: 9.765999999999963, Overlap ratio: 1.0
2025-06-10 20:14:12,132 - DEBUG -   Left boundary diff: 24.843999999999994, Right boundary diff: 0.0
2025-06-10 20:14:12,132 - DEBUG -   Alignment factor (ratio): 0.09758166828360111
2025-06-10 20:14:12,133 - DEBUG -   -> c1 20 formula number: 8, c2 14 formula number: 9
2025-06-10 20:14:12,133 - DEBUG -   -> Not merging clusters 20 and 14 due to different formula numbers: 8 vs 9
2025-06-10 20:14:12,133 - DEBUG - Checking merge:
  Current: 14, Next: 23
2025-06-10 20:14:12,133 - DEBUG -   Vertical gap: 31.12999999999988, Overlap ratio: 0.77979396507635
2025-06-10 20:14:12,133 - DEBUG -   Left boundary diff: 79.89399999999998, Right boundary diff: 75.34899999999999
2025-06-10 20:14:12,133 - DEBUG -   Alignment factor (ratio): 0.32683500547152244
2025-06-10 20:14:12,134 - DEBUG -   -> c1 14 formula number: 9, c2 23 formula number: None
2025-06-10 20:14:12,134 - DEBUG - Checking merge:
  Current: 23, Next: 5
2025-06-10 20:14:12,134 - DEBUG -   Vertical gap: 10.598999999999933, Overlap ratio: 0.8146256345177666
2025-06-10 20:14:12,134 - DEBUG -   Left boundary diff: 64.273, Right boundary diff: 75.34899999999999
2025-06-10 20:14:12,134 - DEBUG -   Alignment factor (ratio): 0.29869815823482304
2025-06-10 20:14:12,135 - DEBUG -   -> c1 23 formula number: None, c2 5 formula number: 10
2025-06-10 20:14:12,135 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:12,146 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:12,181 - DEBUG - [Page 14] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:12,213 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:14:12,523 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:14:12,719 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:14:12,720 - INFO - Processing document 10.3390_polym16101329_164.pdf
2025-06-10 20:14:12,728 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:12,973 - DEBUG - Dynamic vertical threshold: 22.608000000000004, Overlap threshold: 0.7
2025-06-10 20:14:12,973 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:13,018 - DEBUG - Snippet 10.3390_toxics13040318_111_item_1: generation shape=torch.Size([1, 386])
2025-06-10 20:14:13,019 - DEBUG - Snippet 10.3390_toxics13040318_111_item_1 raw docling: (tokens=40)
<formula><loc_0><loc_0><loc_500><loc_500>H Q = E C / ( R f C \times 1 0 0 0 )</formula><end_of_utterance>
2025-06-10 20:14:13,019 - DEBUG - Starting _parse_docling_output
2025-06-10 20:14:13,019 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>H Q = E C / ( R f C \times 1 0 0 0 )</formula><end_of_utterance>
2025-06-10 20:14:13,020 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:14:13,020 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>H Q = E C / ( R f C \\times 1 0 0 0 )</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=738x55 at 0x7F96C78CF740>)]
2025-06-10 20:14:13,020 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:14:13,022 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=738.0, b=55.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 36))], orig='H Q = E C / ( R f C \\times 1 0 0 0 )', text='H Q = E C / ( R f C \\times 1 0 0 0 )', formatting=None, hyperlink=None)]
2025-06-10 20:14:13,023 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:14:13,023 - DEBUG - Processing text item: label=formula, text=H Q = E C / ( R f C \times 1 0 0 0 )
2025-06-10 20:14:13,023 - DEBUG - Recognized string extracted: H Q = E C / ( R f C \times 1 0 0 0 )
2025-06-10 20:14:13,023 - DEBUG - Generating chat message for label: formula
2025-06-10 20:14:13,024 - DEBUG - Snippet 10.3390_toxics13040318_111_item_2 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:14:13,096 - DEBUG - Snippet 10.3390_toxics13040318_111_item_2 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:14:13,160 - DEBUG - [Page 15] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:13,166 - DEBUG - Finished converting page batch time=3579.825
2025-06-10 20:14:13,398 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:13,417 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:13,419 - DEBUG - Finished converting page batch time=3580.078
2025-06-10 20:14:13,667 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:14,078 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:14,205 - DEBUG - [Page 16] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:14,236 - DEBUG - Snippet 10.3390_toxics13040318_111_item_2: generation shape=torch.Size([1, 385])
2025-06-10 20:14:14,237 - DEBUG - Snippet 10.3390_toxics13040318_111_item_2 raw docling: (tokens=39)
<formula><loc_0><loc_0><loc_500><loc_500>E C = C A \times E T \times E F \times E D / A T</formula><end_of_utterance>
2025-06-10 20:14:14,238 - DEBUG - Starting _parse_docling_output
2025-06-10 20:14:14,238 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>E C = C A \times E T \times E F \times E D / A T</formula><end_of_utterance>
2025-06-10 20:14:14,238 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:14,238 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:14:14,238 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>E C = C A \\times E T \\times E F \\times E D / A T</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=782x55 at 0x7F96C3E7CD70>)]
2025-06-10 20:14:14,239 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:14:14,241 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=782.0, b=55.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 48))], orig='E C = C A \\times E T \\times E F \\times E D / A T', text='E C = C A \\times E T \\times E F \\times E D / A T', formatting=None, hyperlink=None)]
2025-06-10 20:14:14,241 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:14:14,241 - DEBUG - Processing text item: label=formula, text=E C = C A \times E T \times E F \times E D / A T
2025-06-10 20:14:14,241 - DEBUG - Recognized string extracted: E C = C A \times E T \times E F \times E D / A T
2025-06-10 20:14:14,242 - INFO - All done. Returning 3 recognized text results.
2025-06-10 20:14:14,242 - DEBUG - Snippet 10.3390_toxics13040318_111_item_0 recognized text:
E C R = I R \times E C
2025-06-10 20:14:14,242 - DEBUG - Snippet 10.3390_toxics13040318_111_item_1 recognized text:
H Q = E C / ( R f C \times 1 0 0 0 )
2025-06-10 20:14:14,242 - DEBUG - Snippet 10.3390_toxics13040318_111_item_2 recognized text:
E C = C A \times E T \times E F \times E D / A T
2025-06-10 20:14:14,320 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:14,435 - INFO - Finished converting document 10.3390_toxics13040318_111.pdf in 25.27 sec.
2025-06-10 20:14:14,598 - DEBUG - [Page 14] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:14,686 - INFO - Extraction successful row 27, tokens=27805
2025-06-10 20:14:14,711 - INFO - Going to convert document batch...
2025-06-10 20:14:14,711 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:14:14,711 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:14:14,739 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:14,766 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:14:14,787 - DEBUG - [Page 17] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:15,134 - DEBUG - Finished converting page batch time=3581.794
2025-06-10 20:14:15,221 - DEBUG - Finished converting page batch time=3581.880
2025-06-10 20:14:15,305 - DEBUG - [Page 18] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:15,381 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:14:15,461 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:14:15,468 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:14:15,672 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:15,826 - DEBUG - [Page 15] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:15,826 - DEBUG - Finished converting page batch time=3582.486
2025-06-10 20:14:15,844 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:15,914 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:15,915 - DEBUG - Finished converting page batch time=3582.574
2025-06-10 20:14:15,978 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:14:15,978 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:14:15,979 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:14:16,012 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:14:16,045 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:14:16,069 - DEBUG - [Page 19] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:16,070 - DEBUG - Finished converting page batch time=3582.729
2025-06-10 20:14:16,081 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:14:16,127 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:14:16,267 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:14:16,283 - DEBUG - [Page 16] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:16,284 - DEBUG - Finished converting page batch time=3582.943
2025-06-10 20:14:16,302 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:14:16,415 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:16,437 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:14:16,468 - DEBUG - Creating masked image for page 3 with 14 clusters.
2025-06-10 20:14:16,469 - INFO - Masked image successfully created for page 3.
2025-06-10 20:14:16,481 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:14:16,521 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:14:16,594 - DEBUG - Creating masked image for page 4 with 14 clusters.
2025-06-10 20:14:16,596 - INFO - Masked image successfully created for page 4.
2025-06-10 20:14:16,604 - INFO - Starting prediction for 5 images with labels: ['formula', 'formula', 'formula', 'formula', 'formula']
2025-06-10 20:14:16,604 - DEBUG - Generating chat message for label: formula
2025-06-10 20:14:16,609 - DEBUG - Snippet 10.3390_toxics12120868_124_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:14:16,682 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:14:16,690 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:16,690 - DEBUG - Snippet 10.3390_toxics12120868_124_item_0 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:14:16,821 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:16,831 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:16,846 - DEBUG - [Page 20] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:16,981 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:14:17,152 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:17,156 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:14:17,157 - INFO - Processing document 10.1021_acs.chemrestox.4c00051_165.pdf
2025-06-10 20:14:17,207 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:17,276 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:17,579 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:17,596 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:17,700 - DEBUG - [Page 21] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:17,911 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:17,972 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:17,973 - DEBUG - Finished converting page batch time=3584.633
2025-06-10 20:14:18,078 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:18,078 - DEBUG - Finished converting page batch time=3584.738
2025-06-10 20:14:18,220 - DEBUG - Snippet 10.3390_toxics12120868_124_item_0: generation shape=torch.Size([1, 387])
2025-06-10 20:14:18,221 - DEBUG - Snippet 10.3390_toxics12120868_124_item_0 raw docling: (tokens=41)
<formula><loc_0><loc_0><loc_500><loc_500>O F P = [ V O C ] _ { i } \times M I R _ { i }</formula><end_of_utterance>
2025-06-10 20:14:18,221 - DEBUG - Starting _parse_docling_output
2025-06-10 20:14:18,221 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>O F P = [ V O C ] _ { i } \times M I R _ { i }</formula><end_of_utterance>
2025-06-10 20:14:18,221 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:14:18,222 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>O F P = [ V O C ] _ { i } \\times M I R _ { i }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=732x65 at 0x7F96D219CA70>)]
2025-06-10 20:14:18,222 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:14:18,231 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=732.0, b=65.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 46))], orig='O F P = [ V O C ] _ { i } \\times M I R _ { i }', text='O F P = [ V O C ] _ { i } \\times M I R _ { i }', formatting=None, hyperlink=None)]
2025-06-10 20:14:18,231 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:14:18,232 - DEBUG - Processing text item: label=formula, text=O F P = [ V O C ] _ { i } \times M I R _ { i }
2025-06-10 20:14:18,232 - DEBUG - Recognized string extracted: O F P = [ V O C ] _ { i } \times M I R _ { i }
2025-06-10 20:14:18,232 - DEBUG - Generating chat message for label: formula
2025-06-10 20:14:18,232 - DEBUG - Snippet 10.3390_toxics12120868_124_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:14:18,354 - DEBUG - Snippet 10.3390_toxics12120868_124_item_1 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:14:18,360 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:18,376 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:18,377 - DEBUG - Finished converting page batch time=3585.037
2025-06-10 20:14:18,457 - DEBUG - Finished converting page batch time=3585.116
2025-06-10 20:14:18,533 - INFO - Finished converting document 10.1186_s12940-024-01148-1_132.pdf in 16.52 sec.
2025-06-10 20:14:18,635 - INFO - Extraction successful row 30, tokens=20618
2025-06-10 20:14:18,649 - INFO - Going to convert document batch...
2025-06-10 20:14:18,650 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:14:18,650 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:14:18,706 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:14:18,821 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:18,825 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:18,826 - DEBUG - Finished converting page batch time=3585.485
2025-06-10 20:14:18,979 - DEBUG - [Page 22] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:19,259 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:19,299 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:14:19,578 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:19,581 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:19,646 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:14:19,653 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:14:19,757 - DEBUG - [Page 23] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:19,758 - DEBUG - Finished converting page batch time=3586.417
2025-06-10 20:14:19,810 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:20,010 - DEBUG - [Page 14] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:20,016 - DEBUG - Finished converting page batch time=3586.675
2025-06-10 20:14:20,164 - DEBUG - Snippet 10.3390_toxics12120868_124_item_1: generation shape=torch.Size([1, 412])
2025-06-10 20:14:20,170 - DEBUG - Snippet 10.3390_toxics12120868_124_item_1 raw docling: (tokens=66)
<formula><loc_0><loc_0><loc_500><loc_500>U n c = \sqrt { ( E F \times c ) ^ { 2 } + ( 0 . 5 \times M D L ) ^ { 2 } } \, ( c > M D L )</formula><end_of_utterance>
2025-06-10 20:14:20,170 - DEBUG - Starting _parse_docling_output
2025-06-10 20:14:20,173 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>U n c = \sqrt { ( E F \times c ) ^ { 2 } + ( 0 . 5 \times M D L ) ^ { 2 } } \, ( c > M D L )</formula><end_of_utterance>
2025-06-10 20:14:20,173 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:14:20,174 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>U n c = \\sqrt { ( E F \\times c ) ^ { 2 } + ( 0 . 5 \\times M D L ) ^ { 2 } } \\, ( c > M D L )</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=894x84 at 0x7F96D219CDD0>)]
2025-06-10 20:14:20,174 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:14:20,177 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=894.0, b=84.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 92))], orig='U n c = \\sqrt { ( E F \\times c ) ^ { 2 } + ( 0 . 5 \\times M D L ) ^ { 2 } } \\, ( c > M D L )', text='U n c = \\sqrt { ( E F \\times c ) ^ { 2 } + ( 0 . 5 \\times M D L ) ^ { 2 } } \\, ( c > M D L )', formatting=None, hyperlink=None)]
2025-06-10 20:14:20,177 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:14:20,177 - DEBUG - Processing text item: label=formula, text=U n c = \sqrt { ( E F \times c ) ^ { 2 } + ( 0 . 5 \times M D L ) ^ { 2 } } \, ( c > M D L )
2025-06-10 20:14:20,178 - DEBUG - Recognized string extracted: U n c = \sqrt { ( E F \times c ) ^ { 2 } + ( 0 . 5 \times M D L ) ^ { 2 } } \, ( c > M D L )
2025-06-10 20:14:20,178 - DEBUG - Generating chat message for label: formula
2025-06-10 20:14:20,178 - DEBUG - Snippet 10.3390_toxics12120868_124_item_2 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:14:20,238 - INFO - Finished converting document 10.13075_ijomeh.1896.01104_98.pdf in 34.02 sec.
2025-06-10 20:14:20,257 - DEBUG - Snippet 10.3390_toxics12120868_124_item_2 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:14:20,305 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:20,378 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:20,402 - DEBUG - [Page 24] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:20,402 - DEBUG - Finished converting page batch time=3587.062
2025-06-10 20:14:20,431 - INFO - Extraction successful row 25, tokens=34395
2025-06-10 20:14:20,445 - INFO - Going to convert document batch...
2025-06-10 20:14:20,446 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:14:20,446 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:14:20,454 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:14:20,455 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:14:20,455 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:14:20,493 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:14:20,499 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:14:20,534 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:14:20,566 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:14:20,615 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:14:20,628 - INFO - Finished converting document 10.3390_biomedicines13010241_119.pdf in 20.96 sec.
2025-06-10 20:14:20,750 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:14:20,822 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:20,857 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:14:20,861 - INFO - Extraction successful row 28, tokens=26339
2025-06-10 20:14:20,905 - INFO - Going to convert document batch...
2025-06-10 20:14:20,905 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:14:20,906 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:14:20,921 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:20,964 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:14:20,978 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:14:21,102 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:21,102 - DEBUG - Finished converting page batch time=3587.762
2025-06-10 20:14:21,108 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:14:21,168 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:14:21,175 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:14:21,252 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:21,293 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:14:21,333 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:14:21,503 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:14:21,551 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:14:21,552 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:14:21,552 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:14:21,589 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:14:21,613 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:14:21,645 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:21,663 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:14:21,669 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:14:21,690 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:21,691 - DEBUG - Finished converting page batch time=3588.350
2025-06-10 20:14:21,714 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:14:21,749 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:14:21,784 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:14:21,809 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:14:21,840 - DEBUG - Snippet 10.3390_toxics12120868_124_item_2: generation shape=torch.Size([1, 403])
2025-06-10 20:14:21,841 - DEBUG - Snippet 10.3390_toxics12120868_124_item_2 raw docling: (tokens=57)
<formula><loc_0><loc_0><loc_500><loc_500>U n c = \left ( \frac { 5 } { 6 } \right ) \times M D L \left ( c \leq M D L \right )</formula><end_of_utterance>
2025-06-10 20:14:21,841 - DEBUG - Starting _parse_docling_output
2025-06-10 20:14:21,842 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>U n c = \left ( \frac { 5 } { 6 } \right ) \times M D L \left ( c \leq M D L \right )</formula><end_of_utterance>
2025-06-10 20:14:21,842 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:14:21,842 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>U n c = \\left ( \\frac { 5 } { 6 } \\right ) \\times M D L \\left ( c \\leq M D L \\right )</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=795x119 at 0x7F96D219CBC0>)]
2025-06-10 20:14:21,843 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:14:21,846 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=795.0, b=119.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 85))], orig='U n c = \\left ( \\frac { 5 } { 6 } \\right ) \\times M D L \\left ( c \\leq M D L \\right )', text='U n c = \\left ( \\frac { 5 } { 6 } \\right ) \\times M D L \\left ( c \\leq M D L \\right )', formatting=None, hyperlink=None)]
2025-06-10 20:14:21,846 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:14:21,847 - DEBUG - Processing text item: label=formula, text=U n c = \left ( \frac { 5 } { 6 } \right ) \times M D L \left ( c \leq M D L \right )
2025-06-10 20:14:21,847 - DEBUG - Recognized string extracted: U n c = \left ( \frac { 5 } { 6 } \right ) \times M D L \left ( c \leq M D L \right )
2025-06-10 20:14:21,847 - DEBUG - Generating chat message for label: formula
2025-06-10 20:14:21,847 - DEBUG - Snippet 10.3390_toxics12120868_124_item_3 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:14:21,850 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:14:21,891 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:14:21,916 - DEBUG - Snippet 10.3390_toxics12120868_124_item_3 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:14:21,953 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:14:21,953 - INFO - Processing document 10.1186_s12916-024-03316-z_168.pdf
2025-06-10 20:14:22,036 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:14:22,072 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:14:22,136 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:14:22,136 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:14:22,136 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:14:22,151 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:14:22,178 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:14:22,219 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:14:22,257 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:14:22,300 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:14:22,313 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:14:22,323 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:22,342 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:14:22,379 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:14:22,426 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:22,427 - DEBUG - Finished converting page batch time=3589.087
2025-06-10 20:14:22,561 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:14:22,601 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:14:22,643 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:14:22,678 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:14:22,714 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:22,788 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:22,831 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:14:22,937 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:14:22,937 - INFO - Processing document 10.3390_toxics12020123_170.pdf
2025-06-10 20:14:22,942 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:23,068 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:23,069 - DEBUG - Finished converting page batch time=3589.729
2025-06-10 20:14:23,109 - INFO - Finished converting document 10.3390_polym16101329_164.pdf in 13.04 sec.
2025-06-10 20:14:23,131 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:14:23,231 - INFO - Extraction successful row 33, tokens=15280
2025-06-10 20:14:23,248 - INFO - Going to convert document batch...
2025-06-10 20:14:23,248 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:14:23,249 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:14:23,266 - DEBUG - Creating masked image for page 1 with 17 clusters.
2025-06-10 20:14:23,267 - INFO - Masked image successfully created for page 1.
2025-06-10 20:14:23,296 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:14:23,319 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:23,324 - DEBUG - Finished converting page batch time=3589.983
2025-06-10 20:14:23,393 - DEBUG - Creating masked image for page 2 with 29 clusters.
2025-06-10 20:14:23,394 - INFO - Masked image successfully created for page 2.
2025-06-10 20:14:23,404 - INFO - Starting prediction for 5 images with labels: ['formula', 'formula', 'formula', 'formula', 'formula']
2025-06-10 20:14:23,404 - DEBUG - Generating chat message for label: formula
2025-06-10 20:14:23,409 - DEBUG - Snippet 10.1038_s41598-024-65584-2_157_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:14:23,463 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:14:23,464 - INFO - Processing document 10.1038_s41598-023-45062-x_185.pdf
2025-06-10 20:14:23,492 - DEBUG - Snippet 10.1038_s41598-024-65584-2_157_item_0 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:14:23,640 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:23,680 - DEBUG - Snippet 10.3390_toxics12120868_124_item_3: generation shape=torch.Size([1, 408])
2025-06-10 20:14:23,711 - DEBUG - Snippet 10.3390_toxics12120868_124_item_3 raw docling: (tokens=62)
<formula><loc_0><loc_0><loc_500><loc_500>L C R = [ V O C ] _ { m i } \times \frac { E T \times E F \times E D } { A T } \times I U R _ { i }</formula><end_of_utterance>
2025-06-10 20:14:23,711 - DEBUG - Starting _parse_docling_output
2025-06-10 20:14:23,712 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>L C R = [ V O C ] _ { m i } \times \frac { E T \times E F \times E D } { A T } \times I U R _ { i }</formula><end_of_utterance>
2025-06-10 20:14:23,712 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:14:23,712 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>L C R = [ V O C ] _ { m i } \\times \\frac { E T \\times E F \\times E D } { A T } \\times I U R _ { i }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=854x117 at 0x7F96D219C1A0>)]
2025-06-10 20:14:23,713 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:14:23,716 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=854.0, b=117.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 99))], orig='L C R = [ V O C ] _ { m i } \\times \\frac { E T \\times E F \\times E D } { A T } \\times I U R _ { i }', text='L C R = [ V O C ] _ { m i } \\times \\frac { E T \\times E F \\times E D } { A T } \\times I U R _ { i }', formatting=None, hyperlink=None)]
2025-06-10 20:14:23,717 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:14:23,717 - DEBUG - Processing text item: label=formula, text=L C R = [ V O C ] _ { m i } \times \frac { E T \times E F \times E D } { A T } \times I U R _ { i }
2025-06-10 20:14:23,717 - DEBUG - Recognized string extracted: L C R = [ V O C ] _ { m i } \times \frac { E T \times E F \times E D } { A T } \times I U R _ { i }
2025-06-10 20:14:23,717 - DEBUG - Generating chat message for label: formula
2025-06-10 20:14:23,718 - DEBUG - Snippet 10.3390_toxics12120868_124_item_4 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:14:23,784 - DEBUG - Snippet 10.3390_toxics12120868_124_item_4 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:14:23,895 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:23,903 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:24,042 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:24,096 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:14:24,128 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:24,147 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:14:24,154 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:14:24,424 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:24,595 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:24,754 - DEBUG - Snippet 10.3390_toxics12120868_124_item_4: generation shape=torch.Size([1, 378])
2025-06-10 20:14:24,754 - DEBUG - Snippet 10.3390_toxics12120868_124_item_4 raw docling: (tokens=32)
<formula><loc_0><loc_0><loc_500><loc_500>L C R = \sum L C R _ { i }</formula><end_of_utterance>
2025-06-10 20:14:24,755 - DEBUG - Starting _parse_docling_output
2025-06-10 20:14:24,755 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>L C R = \sum L C R _ { i }</formula><end_of_utterance>
2025-06-10 20:14:24,755 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:14:24,755 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>L C R = \\sum L C R _ { i }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=683x89 at 0x7F96D219C830>)]
2025-06-10 20:14:24,755 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:14:24,758 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=683.0, b=89.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 26))], orig='L C R = \\sum L C R _ { i }', text='L C R = \\sum L C R _ { i }', formatting=None, hyperlink=None)]
2025-06-10 20:14:24,758 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:14:24,758 - DEBUG - Processing text item: label=formula, text=L C R = \sum L C R _ { i }
2025-06-10 20:14:24,758 - DEBUG - Recognized string extracted: L C R = \sum L C R _ { i }
2025-06-10 20:14:24,758 - INFO - All done. Returning 5 recognized text results.
2025-06-10 20:14:24,758 - DEBUG - Snippet 10.3390_toxics12120868_124_item_0 recognized text:
O F P = [ V O C ] _ { i } \times M I R _ { i }
2025-06-10 20:14:24,759 - DEBUG - Snippet 10.3390_toxics12120868_124_item_1 recognized text:
U n c = \sqrt { ( E F \times c ) ^ { 2 } + ( 0 . 5 \times M D L ) ^ { 2 } } \, ( c > M D L )
2025-06-10 20:14:24,759 - DEBUG - Snippet 10.3390_toxics12120868_124_item_2 recognized text:
U n c = \left ( \frac { 5 } { 6 } \right ) \times M D L \left ( c \leq M D L \right )
2025-06-10 20:14:24,759 - DEBUG - Snippet 10.3390_toxics12120868_124_item_3 recognized text:
L C R = [ V O C ] _ { m i } \times \frac { E T \times E F \times E D } { A T } \times I U R _ { i }
2025-06-10 20:14:24,759 - DEBUG - Snippet 10.3390_toxics12120868_124_item_4 recognized text:
L C R = \sum L C R _ { i }
2025-06-10 20:14:24,763 - INFO - Starting prediction for 2 images with labels: ['formula', 'formula']
2025-06-10 20:14:24,763 - DEBUG - Generating chat message for label: formula
2025-06-10 20:14:24,764 - DEBUG - Snippet 10.3390_toxics12120868_124_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:14:24,832 - DEBUG - Snippet 10.3390_toxics12120868_124_item_0 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:14:24,873 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:14:24,873 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:14:24,874 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:14:24,910 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:14:24,946 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:14:24,984 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:14:25,020 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:14:25,026 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:25,053 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:14:25,088 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:14:25,187 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:25,209 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:14:25,347 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:25,348 - DEBUG - Finished converting page batch time=3592.007
2025-06-10 20:14:25,478 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:25,572 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:25,574 - DEBUG - Finished converting page batch time=3592.233
2025-06-10 20:14:25,713 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:25,714 - DEBUG - Finished converting page batch time=3592.373
2025-06-10 20:14:25,948 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:14:25,985 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:14:25,986 - INFO - Finished converting document 10.1186_s12889-024-20693-5_138.pdf in 20.60 sec.
2025-06-10 20:14:26,044 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:26,046 - DEBUG - Finished converting page batch time=3592.705
2025-06-10 20:14:26,125 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:14:26,135 - INFO - Extraction successful row 31, tokens=47426
2025-06-10 20:14:26,162 - INFO - Going to convert document batch...
2025-06-10 20:14:26,162 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:14:26,163 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:14:26,221 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:14:26,276 - DEBUG - Dynamic vertical threshold: 23.977799999999895, Overlap threshold: 0.7
2025-06-10 20:14:26,276 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:26,346 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:26,460 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:14:26,528 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:26,659 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:26,668 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:14:26,669 - INFO - Processing document 10.3390_ijerph20146326_196.pdf
2025-06-10 20:14:26,835 - DEBUG - Snippet 10.3390_toxics12120868_124_item_0: generation shape=torch.Size([1, 419])
2025-06-10 20:14:26,836 - DEBUG - Snippet 10.3390_toxics12120868_124_item_0 raw docling: (tokens=73)
<formula><loc_0><loc_0><loc_500><loc_500>N C R _ { i } = [ V O C ] _ { m i } \times \frac { E T \times E F \times E D } { A T * 1 0 0 0 } R f C _ { i }</formula><end_of_utterance>
2025-06-10 20:14:26,837 - DEBUG - Starting _parse_docling_output
2025-06-10 20:14:26,837 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>N C R _ { i } = [ V O C ] _ { m i } \times \frac { E T \times E F \times E D } { A T * 1 0 0 0 } R f C _ { i }</formula><end_of_utterance>
2025-06-10 20:14:26,837 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:14:26,837 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>N C R _ { i } = [ V O C ] _ { m i } \\times \\frac { E T \\times E F \\times E D } { A T * 1 0 0 0 } R f C _ { i }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=783x136 at 0x7F96D219D580>)]
2025-06-10 20:14:26,837 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:14:26,841 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=783.0, b=136.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 110))], orig='N C R _ { i } = [ V O C ] _ { m i } \\times \\frac { E T \\times E F \\times E D } { A T * 1 0 0 0 } R f C _ { i }', text='N C R _ { i } = [ V O C ] _ { m i } \\times \\frac { E T \\times E F \\times E D } { A T * 1 0 0 0 } R f C _ { i }', formatting=None, hyperlink=None)]
2025-06-10 20:14:26,841 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:14:26,841 - DEBUG - Processing text item: label=formula, text=N C R _ { i } = [ V O C ] _ { m i } \times \frac { E T \times E F \times E D } { A T * 1 0 0 0 } R f C _ { i }
2025-06-10 20:14:26,842 - DEBUG - Recognized string extracted: N C R _ { i } = [ V O C ] _ { m i } \times \frac { E T \times E F \times E D } { A T * 1 0 0 0 } R f C _ { i }
2025-06-10 20:14:26,842 - DEBUG - Generating chat message for label: formula
2025-06-10 20:14:26,842 - DEBUG - Snippet 10.3390_toxics12120868_124_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:14:26,885 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:14:26,892 - DEBUG - Dynamic vertical threshold: 37.0755, Overlap threshold: 0.7
2025-06-10 20:14:26,893 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:26,908 - DEBUG - Snippet 10.3390_toxics12120868_124_item_1 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:14:26,933 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:14:26,939 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:14:27,164 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:27,208 - DEBUG - Snippet 10.1038_s41598-024-65584-2_157_item_0: generation shape=torch.Size([1, 463])
2025-06-10 20:14:27,214 - DEBUG - Snippet 10.1038_s41598-024-65584-2_157_item_0 raw docling: (tokens=117)
<formula><loc_0><loc_0><loc_500><loc_500>A Q I _ { i } = \frac { ( A Q I _ { i , j } - A Q I _ { i , j - 1 } ) } { ( C _ { i , j } - C _ { i , j - 1 } ) } \times ( C _ { i , m } - C _ { i , j - 1 } ) + A Q I _ { i , j - 1 } , j > 1</formula><end_of_utterance>
2025-06-10 20:14:27,214 - DEBUG - Starting _parse_docling_output
2025-06-10 20:14:27,214 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>A Q I _ { i } = \frac { ( A Q I _ { i , j } - A Q I _ { i , j - 1 } ) } { ( C _ { i , j } - C _ { i , j - 1 } ) } \times ( C _ { i , m } - C _ { i , j - 1 } ) + A Q I _ { i , j - 1 } , j > 1</formula><end_of_utterance>
2025-06-10 20:14:27,214 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:14:27,214 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>A Q I _ { i } = \\frac { ( A Q I _ { i , j } - A Q I _ { i , j - 1 } ) } { ( C _ { i , j } - C _ { i , j - 1 } ) } \\times ( C _ { i , m } - C _ { i , j - 1 } ) + A Q I _ { i , j - 1 } , j > 1</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=688x113 at 0x7F96D7B39580>)]
2025-06-10 20:14:27,215 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:14:27,224 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=688.0, b=113.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 190))], orig='A Q I _ { i } = \\frac { ( A Q I _ { i , j } - A Q I _ { i , j - 1 } ) } { ( C _ { i , j } - C _ { i , j - 1 } ) } \\times ( C _ { i , m } - C _ { i , j - 1 } ) + A Q I _ { i , j - 1 } , j > 1', text='A Q I _ { i } = \\frac { ( A Q I _ { i , j } - A Q I _ { i , j - 1 } ) } { ( C _ { i , j } - C _ { i , j - 1 } ) } \\times ( C _ { i , m } - C _ { i , j - 1 } ) + A Q I _ { i , j - 1 } , j > 1', formatting=None, hyperlink=None)]
2025-06-10 20:14:27,224 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:14:27,224 - DEBUG - Processing text item: label=formula, text=A Q I _ { i } = \frac { ( A Q I _ { i , j } - A Q I _ { i , j - 1 } ) } { ( C _ { i , j } - C _ { i , j - 1 } ) } \times ( C _ { i , m } - C _ { i , j - 1 } ) + A Q I _ { i , j - 1 } , j > 1
2025-06-10 20:14:27,224 - DEBUG - Recognized string extracted: A Q I _ { i } = \frac { ( A Q I _ { i , j } - A Q I _ { i , j - 1 } ) } { ( C _ { i , j } - C _ { i , j - 1 } ) } \times ( C _ { i , m } - C _ { i , j - 1 } ) + A Q I _ { i , j - 1 } , j > 1
2025-06-10 20:14:27,225 - DEBUG - Generating chat message for label: formula
2025-06-10 20:14:27,225 - DEBUG - Snippet 10.1038_s41598-024-65584-2_157_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:14:27,327 - DEBUG - Snippet 10.1038_s41598-024-65584-2_157_item_1 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:14:27,460 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:27,576 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:27,683 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:14:27,683 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:14:27,684 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:14:27,723 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:14:27,771 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:14:27,820 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:14:27,858 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:14:27,889 - DEBUG - Snippet 10.3390_toxics12120868_124_item_1: generation shape=torch.Size([1, 377])
2025-06-10 20:14:27,890 - DEBUG - Snippet 10.3390_toxics12120868_124_item_1 raw docling: (tokens=31)
<formula><loc_0><loc_0><loc_500><loc_500>H I = \sum N C R _ { i }</formula><end_of_utterance>
2025-06-10 20:14:27,890 - DEBUG - Starting _parse_docling_output
2025-06-10 20:14:27,890 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>H I = \sum N C R _ { i }</formula><end_of_utterance>
2025-06-10 20:14:27,891 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:14:27,891 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>H I = \\sum N C R _ { i }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=677x89 at 0x7F96D219DC10>)]
2025-06-10 20:14:27,892 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:14:27,894 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=677.0, b=89.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 24))], orig='H I = \\sum N C R _ { i }', text='H I = \\sum N C R _ { i }', formatting=None, hyperlink=None)]
2025-06-10 20:14:27,894 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:14:27,894 - DEBUG - Processing text item: label=formula, text=H I = \sum N C R _ { i }
2025-06-10 20:14:27,894 - DEBUG - Recognized string extracted: H I = \sum N C R _ { i }
2025-06-10 20:14:27,894 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:14:27,895 - INFO - All done. Returning 2 recognized text results.
2025-06-10 20:14:27,895 - DEBUG - Snippet 10.3390_toxics12120868_124_item_0 recognized text:
N C R _ { i } = [ V O C ] _ { m i } \times \frac { E T \times E F \times E D } { A T * 1 0 0 0 } R f C _ { i }
2025-06-10 20:14:27,895 - DEBUG - Snippet 10.3390_toxics12120868_124_item_1 recognized text:
H I = \sum N C R _ { i }
2025-06-10 20:14:27,931 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:14:27,997 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:28,031 - DEBUG - Finished converting page batch time=3594.691
2025-06-10 20:14:28,037 - INFO - Finished converting document 10.3390_toxics12120868_124.pdf in 26.45 sec.
2025-06-10 20:14:28,088 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:14:28,177 - INFO - Extraction successful row 29, tokens=16895
2025-06-10 20:14:28,191 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:14:28,198 - INFO - Going to convert document batch...
2025-06-10 20:14:28,199 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:14:28,199 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:14:28,252 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:14:28,355 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:14:28,479 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:28,502 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:14:28,544 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:28,577 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:28,709 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:28,768 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:28,769 - DEBUG - Finished converting page batch time=3595.428
2025-06-10 20:14:28,780 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:28,781 - DEBUG - Finished converting page batch time=3595.440
2025-06-10 20:14:28,873 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:28,946 - INFO - Finished converting document 10.1021_acs.chemrestox.4c00051_165.pdf in 14.26 sec.
2025-06-10 20:14:29,052 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:14:29,132 - INFO - Extraction successful row 34, tokens=14315
2025-06-10 20:14:29,159 - INFO - Going to convert document batch...
2025-06-10 20:14:29,159 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:14:29,160 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:14:29,220 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:14:29,220 - INFO - Processing document 10.3390_toxics11060481_197.pdf
2025-06-10 20:14:29,238 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:14:29,287 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:14:29,294 - DEBUG - Snippet 10.1038_s41598-024-65584-2_157_item_1: generation shape=torch.Size([1, 411])
2025-06-10 20:14:29,294 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:14:29,295 - DEBUG - Snippet 10.1038_s41598-024-65584-2_157_item_1 raw docling: (tokens=65)
<formula><loc_0><loc_0><loc_500><loc_500>A Q I _ { i } = A Q I _ { i , 1 } \times \frac { C _ { i , m } } { C _ { i , 1 } } , j = 1</formula><end_of_utterance>
2025-06-10 20:14:29,295 - DEBUG - Starting _parse_docling_output
2025-06-10 20:14:29,295 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>A Q I _ { i } = A Q I _ { i , 1 } \times \frac { C _ { i , m } } { C _ { i , 1 } } , j = 1</formula><end_of_utterance>
2025-06-10 20:14:29,295 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:14:29,296 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>A Q I _ { i } = A Q I _ { i , 1 } \\times \\frac { C _ { i , m } } { C _ { i , 1 } } , j = 1</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=738x109 at 0x7F96D7B069F0>)]
2025-06-10 20:14:29,296 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:14:29,299 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=738.0, b=109.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 90))], orig='A Q I _ { i } = A Q I _ { i , 1 } \\times \\frac { C _ { i , m } } { C _ { i , 1 } } , j = 1', text='A Q I _ { i } = A Q I _ { i , 1 } \\times \\frac { C _ { i , m } } { C _ { i , 1 } } , j = 1', formatting=None, hyperlink=None)]
2025-06-10 20:14:29,299 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:14:29,300 - DEBUG - Processing text item: label=formula, text=A Q I _ { i } = A Q I _ { i , 1 } \times \frac { C _ { i , m } } { C _ { i , 1 } } , j = 1
2025-06-10 20:14:29,300 - DEBUG - Recognized string extracted: A Q I _ { i } = A Q I _ { i , 1 } \times \frac { C _ { i , m } } { C _ { i , 1 } } , j = 1
2025-06-10 20:14:29,300 - DEBUG - Generating chat message for label: formula
2025-06-10 20:14:29,300 - DEBUG - Snippet 10.1038_s41598-024-65584-2_157_item_2 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:14:29,339 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:27,161 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:14:27,197 - DEBUG - Snippet 10.1038_s41598-024-65584-2_157_item_2 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:14:27,257 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:27,259 - DEBUG - Finished converting page batch time=3596.117
2025-06-10 20:14:27,504 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:14:27,505 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:14:27,505 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:14:27,549 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:27,559 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:14:27,600 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:14:27,635 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:14:27,663 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:27,685 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:14:27,687 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:27,758 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:27,787 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:14:27,828 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:14:27,920 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:14:27,936 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:14:27,981 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:14:27,987 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:14:27,988 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:14:28,004 - DEBUG - Finished converting page batch time=3596.863
2025-06-10 20:14:28,028 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:14:28,155 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:28,166 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:14:28,257 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:28,425 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:28,468 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:14:28,560 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:14:28,561 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:14:28,561 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:14:28,597 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:14:28,630 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:28,675 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:14:28,675 - INFO - Processing document 10.1007_s00477-023-02476-3_198.pdf
2025-06-10 20:14:28,677 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:14:28,714 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:14:28,798 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:14:28,836 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:14:28,870 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:14:29,045 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:14:29,080 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:14:29,090 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:29,115 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:14:29,181 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:29,245 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:29,258 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:14:29,269 - DEBUG - Snippet 10.1038_s41598-024-65584-2_157_item_2: generation shape=torch.Size([1, 419])
2025-06-10 20:14:29,269 - DEBUG - Snippet 10.1038_s41598-024-65584-2_157_item_2 raw docling: (tokens=73)
<formula><loc_0><loc_0><loc_500><loc_500>A Q I = \max \{ A Q I _ { 1 } , A Q I _ { 2 } , \dots , A Q I _ { n } \} , n = 1 , 2 , \dots , 6</formula><end_of_utterance>
2025-06-10 20:14:29,270 - DEBUG - Starting _parse_docling_output
2025-06-10 20:14:29,270 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>A Q I = \max \{ A Q I _ { 1 } , A Q I _ { 2 } , \dots , A Q I _ { n } \} , n = 1 , 2 , \dots , 6</formula><end_of_utterance>
2025-06-10 20:14:29,270 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:14:29,270 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>A Q I = \\max \\{ A Q I _ { 1 } , A Q I _ { 2 } , \\dots , A Q I _ { n } \\} , n = 1 , 2 , \\dots , 6</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=862x54 at 0x7F96D7B04890>)]
2025-06-10 20:14:29,270 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:14:29,272 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=862.0, b=54.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 96))], orig='A Q I = \\max \\{ A Q I _ { 1 } , A Q I _ { 2 } , \\dots , A Q I _ { n } \\} , n = 1 , 2 , \\dots , 6', text='A Q I = \\max \\{ A Q I _ { 1 } , A Q I _ { 2 } , \\dots , A Q I _ { n } \\} , n = 1 , 2 , \\dots , 6', formatting=None, hyperlink=None)]
2025-06-10 20:14:29,273 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:14:29,273 - DEBUG - Processing text item: label=formula, text=A Q I = \max \{ A Q I _ { 1 } , A Q I _ { 2 } , \dots , A Q I _ { n } \} , n = 1 , 2 , \dots , 6
2025-06-10 20:14:29,273 - DEBUG - Recognized string extracted: A Q I = \max \{ A Q I _ { 1 } , A Q I _ { 2 } , \dots , A Q I _ { n } \} , n = 1 , 2 , \dots , 6
2025-06-10 20:14:29,273 - DEBUG - Generating chat message for label: formula
2025-06-10 20:14:29,274 - DEBUG - Snippet 10.1038_s41598-024-65584-2_157_item_3 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:14:29,303 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:29,341 - DEBUG - Snippet 10.1038_s41598-024-65584-2_157_item_3 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:14:29,362 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:29,488 - DEBUG - Finished converting page batch time=3598.347
2025-06-10 20:14:29,531 - DEBUG - Dynamic vertical threshold: 50.713199999999965, Overlap threshold: 0.7
2025-06-10 20:14:29,531 - DEBUG - Checking merge:
  Current: 12, Next: 7
2025-06-10 20:14:29,532 - DEBUG -   Vertical gap: 43.94, Overlap ratio: 0.9999910429312305
2025-06-10 20:14:29,532 - DEBUG -   Left boundary diff: 7.239999999999952, Right boundary diff: 0.0030000000000427463
2025-06-10 20:14:29,532 - DEBUG -   Alignment factor (ratio): 0.03035009505364695
2025-06-10 20:14:29,533 - DEBUG -   -> c1 12 formula number: 3, c2 7 formula number: 4
2025-06-10 20:14:29,533 - DEBUG -   -> Not merging clusters 12 and 7 due to different formula numbers: 3 vs 4
2025-06-10 20:14:29,533 - DEBUG - Checking merge:
  Current: 10, Next: 9
2025-06-10 20:14:29,533 - DEBUG -   Vertical gap: 3.298999999999978, Overlap ratio: 1.0
2025-06-10 20:14:29,533 - DEBUG -   Left boundary diff: 78.23700000000002, Right boundary diff: 0.0009999999999763531
2025-06-10 20:14:29,534 - DEBUG -   Alignment factor (ratio): 0.26617199779542355
2025-06-10 20:14:29,534 - DEBUG -   -> c1 10 formula number: 5, c2 9 formula number: 6
2025-06-10 20:14:29,534 - DEBUG -   -> Not merging clusters 10 and 9 due to different formula numbers: 5 vs 6
2025-06-10 20:14:29,534 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:29,535 - DEBUG - Finished converting page batch time=3598.394
2025-06-10 20:14:29,585 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:14:29,665 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:29,677 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:29,678 - DEBUG - Finished converting page batch time=3598.537
2025-06-10 20:14:29,782 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:14:29,782 - INFO - Processing document 10.1186_s12942-023-00333-8_202.pdf
2025-06-10 20:14:30,021 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:30,028 - DEBUG - Dynamic vertical threshold: 53.775, Overlap threshold: 0.7
2025-06-10 20:14:30,029 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:30,397 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:30,489 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:30,523 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:30,538 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:30,781 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:30,873 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:30,996 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:31,106 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:31,315 - DEBUG - Snippet 10.1038_s41598-024-65584-2_157_item_3: generation shape=torch.Size([1, 416])
2025-06-10 20:14:31,316 - DEBUG - Snippet 10.1038_s41598-024-65584-2_157_item_3 raw docling: (tokens=70)
<formula><loc_0><loc_0><loc_500><loc_500>A A Q I = \left ( \sum _ { i = 1 } ^ { n } ( A Q I _ { i } ) ^ { \rho } \right ) ^ { \frac { 1 } { \rho } }</formula><end_of_utterance>
2025-06-10 20:14:31,316 - DEBUG - Starting _parse_docling_output
2025-06-10 20:14:31,316 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>A A Q I = \left ( \sum _ { i = 1 } ^ { n } ( A Q I _ { i } ) ^ { \rho } \right ) ^ { \frac { 1 } { \rho } }</formula><end_of_utterance>
2025-06-10 20:14:31,316 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:14:31,317 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>A A Q I = \\left ( \\sum _ { i = 1 } ^ { n } ( A Q I _ { i } ) ^ { \\rho } \\right ) ^ { \\frac { 1 } { \\rho } }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=737x108 at 0x7F96D7B056D0>)]
2025-06-10 20:14:31,317 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:14:31,320 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=737.0, b=108.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 107))], orig='A A Q I = \\left ( \\sum _ { i = 1 } ^ { n } ( A Q I _ { i } ) ^ { \\rho } \\right ) ^ { \\frac { 1 } { \\rho } }', text='A A Q I = \\left ( \\sum _ { i = 1 } ^ { n } ( A Q I _ { i } ) ^ { \\rho } \\right ) ^ { \\frac { 1 } { \\rho } }', formatting=None, hyperlink=None)]
2025-06-10 20:14:31,320 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:14:31,320 - DEBUG - Processing text item: label=formula, text=A A Q I = \left ( \sum _ { i = 1 } ^ { n } ( A Q I _ { i } ) ^ { \rho } \right ) ^ { \frac { 1 } { \rho } }
2025-06-10 20:14:31,320 - DEBUG - Recognized string extracted: A A Q I = \left ( \sum _ { i = 1 } ^ { n } ( A Q I _ { i } ) ^ { \rho } \right ) ^ { \frac { 1 } { \rho } }
2025-06-10 20:14:31,320 - DEBUG - Generating chat message for label: formula
2025-06-10 20:14:31,321 - DEBUG - Snippet 10.1038_s41598-024-65584-2_157_item_4 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:14:31,381 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:31,385 - DEBUG - Snippet 10.1038_s41598-024-65584-2_157_item_4 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:14:31,469 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:31,685 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:31,724 - DEBUG - Dynamic vertical threshold: 24.400799999999972, Overlap threshold: 0.7
2025-06-10 20:14:31,724 - DEBUG - Checking merge:
  Current: 19, Next: 14
2025-06-10 20:14:31,725 - DEBUG -   Vertical gap: 10.707000000000107, Overlap ratio: 0.2454139430329202
2025-06-10 20:14:31,725 - DEBUG -   Left boundary diff: 255.118, Right boundary diff: 255.11899999999997
2025-06-10 20:14:31,725 - DEBUG -   Alignment factor (ratio): 1.0715211232703532
2025-06-10 20:14:31,726 - DEBUG -   -> c1 19 formula number: None, c2 14 formula number: None
2025-06-10 20:14:31,726 - DEBUG -   -> Not merging clusters 19 and 14 because vertical_gap 10.707000000000107 > 3 with no numbers
2025-06-10 20:14:31,726 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:31,727 - DEBUG - Finished converting page batch time=3600.586
2025-06-10 20:14:31,866 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:31,947 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:31,949 - DEBUG - Finished converting page batch time=3600.807
2025-06-10 20:14:32,105 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:32,114 - DEBUG - Finished converting page batch time=3600.973
2025-06-10 20:14:32,263 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:32,264 - DEBUG - Finished converting page batch time=3601.123
2025-06-10 20:14:32,273 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:32,306 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:32,441 - DEBUG - Creating masked image for page 2 with 24 clusters.
2025-06-10 20:14:32,443 - INFO - Masked image successfully created for page 2.
2025-06-10 20:14:32,448 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:32,556 - DEBUG - Creating masked image for page 3 with 21 clusters.
2025-06-10 20:14:32,558 - INFO - Masked image successfully created for page 3.
2025-06-10 20:14:32,564 - INFO - Starting prediction for 4 images with labels: ['formula', 'formula', 'formula', 'formula']
2025-06-10 20:14:32,564 - DEBUG - Generating chat message for label: formula
2025-06-10 20:14:32,564 - DEBUG - Snippet 10.1038_s41598-023-45062-x_185_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:14:32,595 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:32,596 - DEBUG - Finished converting page batch time=3601.455
2025-06-10 20:14:32,650 - DEBUG - Snippet 10.1038_s41598-023-45062-x_185_item_0 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:14:32,886 - DEBUG - Dynamic vertical threshold: 59.62860000000002, Overlap threshold: 0.7
2025-06-10 20:14:32,886 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:32,906 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:32,930 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:33,127 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:33,129 - DEBUG - Finished converting page batch time=3601.987
2025-06-10 20:14:33,202 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:33,382 - DEBUG - Snippet 10.1038_s41598-024-65584-2_157_item_4: generation shape=torch.Size([1, 418])
2025-06-10 20:14:33,384 - DEBUG - Snippet 10.1038_s41598-024-65584-2_157_item_4 raw docling: (tokens=72)
<formula><loc_0><loc_0><loc_500><loc_500>R R _ { i } = e x p [ \beta _ { i } ( C _ { i , m } - C _ { i , 0 } ) ] , C _ { i , m } > C _ { i , 0 }</formula><end_of_utterance>
2025-06-10 20:14:33,384 - DEBUG - Starting _parse_docling_output
2025-06-10 20:14:33,384 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>R R _ { i } = e x p [ \beta _ { i } ( C _ { i , m } - C _ { i , 0 } ) ] , C _ { i , m } > C _ { i , 0 }</formula><end_of_utterance>
2025-06-10 20:14:33,384 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:14:33,385 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>R R _ { i } = e x p [ \\beta _ { i } ( C _ { i , m } - C _ { i , 0 } ) ] , C _ { i , m } > C _ { i , 0 }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=796x84 at 0x7F96D7AC4DD0>)]
2025-06-10 20:14:33,385 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:14:33,388 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=796.0, b=84.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 103))], orig='R R _ { i } = e x p [ \\beta _ { i } ( C _ { i , m } - C _ { i , 0 } ) ] , C _ { i , m } > C _ { i , 0 }', text='R R _ { i } = e x p [ \\beta _ { i } ( C _ { i , m } - C _ { i , 0 } ) ] , C _ { i , m } > C _ { i , 0 }', formatting=None, hyperlink=None)]
2025-06-10 20:14:33,388 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:14:33,388 - DEBUG - Processing text item: label=formula, text=R R _ { i } = e x p [ \beta _ { i } ( C _ { i , m } - C _ { i , 0 } ) ] , C _ { i , m } > C _ { i , 0 }
2025-06-10 20:14:33,388 - DEBUG - Recognized string extracted: R R _ { i } = e x p [ \beta _ { i } ( C _ { i , m } - C _ { i , 0 } ) ] , C _ { i , m } > C _ { i , 0 }
2025-06-10 20:14:33,388 - INFO - All done. Returning 5 recognized text results.
2025-06-10 20:14:33,389 - DEBUG - Snippet 10.1038_s41598-024-65584-2_157_item_0 recognized text:
A Q I _ { i } = \frac { ( A Q I _ { i , j } - A Q I _ { i , j - 1 } ) } { ( C _ { i , j } - C _ { i , j - 1 } ) } \times ( C _ { i , m } - C _ { i , j - 1 } ) + A Q I _ { i , j - 1 } , j > 1
2025-06-10 20:14:33,389 - DEBUG - Snippet 10.1038_s41598-024-65584-2_157_item_1 recognized text:
A Q I _ { i } = A Q I _ { i , 1 } \times \frac { C _ { i , m } } { C _ { i , 1 } } , j = 1
2025-06-10 20:14:33,389 - DEBUG - Snippet 10.1038_s41598-024-65584-2_157_item_2 recognized text:
A Q I = \max \{ A Q I _ { 1 } , A Q I _ { 2 } , \dots , A Q I _ { n } \} , n = 1 , 2 , \dots , 6
2025-06-10 20:14:33,389 - DEBUG - Snippet 10.1038_s41598-024-65584-2_157_item_3 recognized text:
A A Q I = \left ( \sum _ { i = 1 } ^ { n } ( A Q I _ { i } ) ^ { \rho } \right ) ^ { \frac { 1 } { \rho } }
2025-06-10 20:14:33,390 - DEBUG - Snippet 10.1038_s41598-024-65584-2_157_item_4 recognized text:
R R _ { i } = e x p [ \beta _ { i } ( C _ { i , m } - C _ { i , 0 } ) ] , C _ { i , m } > C _ { i , 0 }
2025-06-10 20:14:33,398 - INFO - Starting prediction for 5 images with labels: ['formula', 'formula', 'formula', 'formula', 'formula']
2025-06-10 20:14:33,399 - DEBUG - Generating chat message for label: formula
2025-06-10 20:14:33,399 - DEBUG - Snippet 10.1038_s41598-024-65584-2_157_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:14:33,435 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:33,436 - DEBUG - Finished converting page batch time=3602.294
2025-06-10 20:14:33,452 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:33,460 - DEBUG - Snippet 10.1038_s41598-024-65584-2_157_item_0 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:14:33,561 - INFO - Finished converting document 10.3390_ijerph20146326_196.pdf in 12.53 sec.
2025-06-10 20:14:33,668 - INFO - Extraction successful row 38, tokens=14483
2025-06-10 20:14:33,686 - INFO - Going to convert document batch...
2025-06-10 20:14:33,687 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:14:33,687 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:14:33,834 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:14:33,848 - DEBUG - Dynamic vertical threshold: 46.07280000000001, Overlap threshold: 0.7
2025-06-10 20:14:33,850 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:34,378 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:34,503 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:34,638 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:34,675 - DEBUG - Snippet 10.1038_s41598-024-65584-2_157_item_0: generation shape=torch.Size([1, 381])
2025-06-10 20:14:34,676 - DEBUG - Snippet 10.1038_s41598-024-65584-2_157_item_0 raw docling: (tokens=35)
<formula><loc_0><loc_0><loc_500><loc_500>E R _ { i } = R R _ { i } - 1</formula><end_of_utterance>
2025-06-10 20:14:34,676 - DEBUG - Starting _parse_docling_output
2025-06-10 20:14:34,676 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>E R _ { i } = R R _ { i } - 1</formula><end_of_utterance>
2025-06-10 20:14:34,677 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:14:34,677 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>E R _ { i } = R R _ { i } - 1</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=663x54 at 0x7F96D7B16600>)]
2025-06-10 20:14:34,677 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:14:34,679 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=663.0, b=54.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 29))], orig='E R _ { i } = R R _ { i } - 1', text='E R _ { i } = R R _ { i } - 1', formatting=None, hyperlink=None)]
2025-06-10 20:14:34,679 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:14:34,679 - DEBUG - Processing text item: label=formula, text=E R _ { i } = R R _ { i } - 1
2025-06-10 20:14:34,679 - DEBUG - Recognized string extracted: E R _ { i } = R R _ { i } - 1
2025-06-10 20:14:34,679 - DEBUG - Generating chat message for label: formula
2025-06-10 20:14:34,680 - DEBUG - Snippet 10.1038_s41598-024-65584-2_157_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:14:34,681 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:14:34,737 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:14:34,743 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:14:34,746 - DEBUG - Snippet 10.1038_s41598-024-65584-2_157_item_1 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:14:34,762 - DEBUG - Snippet 10.1038_s41598-023-45062-x_185_item_0: generation shape=torch.Size([1, 422])
2025-06-10 20:14:34,763 - DEBUG - Snippet 10.1038_s41598-023-45062-x_185_item_0 raw docling: (tokens=76)
<formula><loc_0><loc_0><loc_500><loc_500>\log ( E ( Y _ { i } ) ) = \alpha + \beta X _ { i } + s ( t i m e , d f ) + s ( Z _ { i } , d f ) + D O W + H o l i d a y</formula><end_of_utterance>
2025-06-10 20:14:34,766 - DEBUG - Starting _parse_docling_output
2025-06-10 20:14:34,766 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>\log ( E ( Y _ { i } ) ) = \alpha + \beta X _ { i } + s ( t i m e , d f ) + s ( Z _ { i } , d f ) + D O W + H o l i d a y</formula><end_of_utterance>
2025-06-10 20:14:34,770 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:14:34,770 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>\\log ( E ( Y _ { i } ) ) = \\alpha + \\beta X _ { i } + s ( t i m e , d f ) + s ( Z _ { i } , d f ) + D O W + H o l i d a y</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=674x59 at 0x7F96DBC601A0>)]
2025-06-10 20:14:34,770 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:14:34,773 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=674.0, b=59.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 121))], orig='\\log ( E ( Y _ { i } ) ) = \\alpha + \\beta X _ { i } + s ( t i m e , d f ) + s ( Z _ { i } , d f ) + D O W + H o l i d a y', text='\\log ( E ( Y _ { i } ) ) = \\alpha + \\beta X _ { i } + s ( t i m e , d f ) + s ( Z _ { i } , d f ) + D O W + H o l i d a y', formatting=None, hyperlink=None)]
2025-06-10 20:14:34,773 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:14:34,773 - DEBUG - Processing text item: label=formula, text=\log ( E ( Y _ { i } ) ) = \alpha + \beta X _ { i } + s ( t i m e , d f ) + s ( Z _ { i } , d f ) + D O W + H o l i d a y
2025-06-10 20:14:34,773 - DEBUG - Recognized string extracted: \log ( E ( Y _ { i } ) ) = \alpha + \beta X _ { i } + s ( t i m e , d f ) + s ( Z _ { i } , d f ) + D O W + H o l i d a y
2025-06-10 20:14:34,773 - DEBUG - Generating chat message for label: formula
2025-06-10 20:14:34,774 - DEBUG - Snippet 10.1038_s41598-023-45062-x_185_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:14:34,839 - DEBUG - Snippet 10.1038_s41598-023-45062-x_185_item_1 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:14:34,986 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:34,995 - DEBUG - Finished converting page batch time=3603.853
2025-06-10 20:14:34,998 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:35,006 - DEBUG - Finished converting page batch time=3603.865
2025-06-10 20:14:35,189 - INFO - Finished converting document 10.1186_s12916-024-03316-z_168.pdf in 18.75 sec.
2025-06-10 20:14:35,304 - INFO - Extraction successful row 35, tokens=23373
2025-06-10 20:14:35,334 - INFO - Going to convert document batch...
2025-06-10 20:14:35,334 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:14:35,335 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:14:35,389 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:14:35,409 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:14:35,409 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:14:35,410 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:14:35,445 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:14:35,487 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:14:35,492 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:35,493 - DEBUG - Finished converting page batch time=3604.352
2025-06-10 20:14:35,513 - DEBUG - [Page 14] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:35,539 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:14:35,579 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:14:35,625 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:14:35,663 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:14:35,800 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:14:35,837 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:35,883 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:14:35,925 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:14:35,976 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:36,025 - DEBUG - [Page 15] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:36,026 - DEBUG - Finished converting page batch time=3604.885
2025-06-10 20:14:36,088 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:14:36,103 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:14:36,153 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:14:36,160 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:14:36,369 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:14:36,602 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:14:36,602 - INFO - Processing document 10.3390_ijerph20064695_208.pdf
2025-06-10 20:14:36,674 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:14:36,674 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:14:36,675 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:14:36,736 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:36,781 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:14:36,817 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:14:36,853 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:14:36,861 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:36,862 - DEBUG - Finished converting page batch time=3605.720
2025-06-10 20:14:36,889 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:14:36,908 - DEBUG - [Page 16] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:36,916 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:36,926 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:14:36,964 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:14:37,005 - DEBUG - Snippet 10.1038_s41598-024-65584-2_157_item_1: generation shape=torch.Size([1, 420])
2025-06-10 20:14:37,007 - DEBUG - Snippet 10.1038_s41598-024-65584-2_157_item_1 raw docling: (tokens=74)
<formula><loc_0><loc_0><loc_500><loc_500>E R _ { t o t a l } = \sum _ { i = 1 } ^ { n } E R _ { i } = \sum _ { i = 1 } ^ { n } ( R R _ { i } - 1 )</formula><end_of_utterance>
2025-06-10 20:14:37,007 - DEBUG - Starting _parse_docling_output
2025-06-10 20:14:37,007 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>E R _ { t o t a l } = \sum _ { i = 1 } ^ { n } E R _ { i } = \sum _ { i = 1 } ^ { n } ( R R _ { i } - 1 )</formula><end_of_utterance>
2025-06-10 20:14:37,008 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:14:37,008 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>E R _ { t o t a l } = \\sum _ { i = 1 } ^ { n } E R _ { i } = \\sum _ { i = 1 } ^ { n } ( R R _ { i } - 1 )</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=798x94 at 0x7F96D7AF18B0>)]
2025-06-10 20:14:37,008 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:14:37,011 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=798.0, b=94.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 105))], orig='E R _ { t o t a l } = \\sum _ { i = 1 } ^ { n } E R _ { i } = \\sum _ { i = 1 } ^ { n } ( R R _ { i } - 1 )', text='E R _ { t o t a l } = \\sum _ { i = 1 } ^ { n } E R _ { i } = \\sum _ { i = 1 } ^ { n } ( R R _ { i } - 1 )', formatting=None, hyperlink=None)]
2025-06-10 20:14:37,012 - DEBUG - Snippet 10.1038_s41598-023-45062-x_185_item_1: generation shape=torch.Size([1, 425])
2025-06-10 20:14:37,017 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:14:37,017 - DEBUG - Processing text item: label=formula, text=E R _ { t o t a l } = \sum _ { i = 1 } ^ { n } E R _ { i } = \sum _ { i = 1 } ^ { n } ( R R _ { i } - 1 )
2025-06-10 20:14:37,018 - DEBUG - Recognized string extracted: E R _ { t o t a l } = \sum _ { i = 1 } ^ { n } E R _ { i } = \sum _ { i = 1 } ^ { n } ( R R _ { i } - 1 )
2025-06-10 20:14:37,018 - DEBUG - Generating chat message for label: formula
2025-06-10 20:14:37,018 - DEBUG - Snippet 10.1038_s41598-023-45062-x_185_item_1 raw docling: (tokens=79)
<formula><loc_0><loc_0><loc_500><loc_500>\Delta M o r t a l i t y _ { i } = Y _ { 0 } \times ( 1 - 1 / \exp [ \beta ( C _ { i } - C _ { 0 } ) ] ) \times P O P _ { i }</formula><end_of_utterance>
2025-06-10 20:14:37,018 - DEBUG - Snippet 10.1038_s41598-024-65584-2_157_item_2 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:14:37,018 - DEBUG - Starting _parse_docling_output
2025-06-10 20:14:37,019 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>\Delta M o r t a l i t y _ { i } = Y _ { 0 } \times ( 1 - 1 / \exp [ \beta ( C _ { i } - C _ { 0 } ) ] ) \times P O P _ { i }</formula><end_of_utterance>
2025-06-10 20:14:37,019 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:14:37,019 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>\\Delta M o r t a l i t y _ { i } = Y _ { 0 } \\times ( 1 - 1 / \\exp [ \\beta ( C _ { i } - C _ { 0 } ) ] ) \\times P O P _ { i }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=582x59 at 0x7F96DDE72360>)]
2025-06-10 20:14:37,020 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:14:37,021 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=582.0, b=59.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 125))], orig='\\Delta M o r t a l i t y _ { i } = Y _ { 0 } \\times ( 1 - 1 / \\exp [ \\beta ( C _ { i } - C _ { 0 } ) ] ) \\times P O P _ { i }', text='\\Delta M o r t a l i t y _ { i } = Y _ { 0 } \\times ( 1 - 1 / \\exp [ \\beta ( C _ { i } - C _ { 0 } ) ] ) \\times P O P _ { i }', formatting=None, hyperlink=None)]
2025-06-10 20:14:37,022 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:14:37,022 - DEBUG - Processing text item: label=formula, text=\Delta M o r t a l i t y _ { i } = Y _ { 0 } \times ( 1 - 1 / \exp [ \beta ( C _ { i } - C _ { 0 } ) ] ) \times P O P _ { i }
2025-06-10 20:14:37,022 - DEBUG - Recognized string extracted: \Delta M o r t a l i t y _ { i } = Y _ { 0 } \times ( 1 - 1 / \exp [ \beta ( C _ { i } - C _ { 0 } ) ] ) \times P O P _ { i }
2025-06-10 20:14:37,022 - DEBUG - Generating chat message for label: formula
2025-06-10 20:14:37,023 - DEBUG - Snippet 10.1038_s41598-023-45062-x_185_item_2 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:14:37,074 - DEBUG - Creating masked image for page 3 with 17 clusters.
2025-06-10 20:14:37,076 - INFO - Masked image successfully created for page 3.
2025-06-10 20:14:37,084 - DEBUG - Snippet 10.1038_s41598-024-65584-2_157_item_2 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:14:37,085 - INFO - Starting prediction for 5 images with labels: ['formula', 'formula', 'formula', 'formula', 'formula']
2025-06-10 20:14:37,085 - DEBUG - Generating chat message for label: formula
2025-06-10 20:14:37,090 - DEBUG - Snippet 10.3390_toxics11060481_197_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:14:37,097 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:14:37,098 - DEBUG - Snippet 10.1038_s41598-023-45062-x_185_item_2 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:14:37,135 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:14:37,176 - DEBUG - Snippet 10.3390_toxics11060481_197_item_0 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:14:37,185 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:14:37,340 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:14:37,605 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:14:37,646 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:37,714 - DEBUG - [Page 17] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:37,715 - DEBUG - Finished converting page batch time=3606.573
2025-06-10 20:14:37,830 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:14:37,831 - INFO - Processing document 10.3390_ijerph20043517_210.pdf
2025-06-10 20:14:37,884 - INFO - Finished converting document 10.3390_toxics12020123_170.pdf in 19.65 sec.
2025-06-10 20:14:37,994 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:37,995 - DEBUG - Finished converting page batch time=3606.854
2025-06-10 20:14:38,062 - INFO - Extraction successful row 36, tokens=29341
2025-06-10 20:14:38,101 - INFO - Going to convert document batch...
2025-06-10 20:14:38,102 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:14:38,102 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:14:38,161 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:14:38,163 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:38,303 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:38,784 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:38,810 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:38,911 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:14:38,963 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:14:38,969 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:14:39,040 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:39,170 - DEBUG - Snippet 10.1038_s41598-024-65584-2_157_item_2: generation shape=torch.Size([1, 420])
2025-06-10 20:14:39,178 - DEBUG - Snippet 10.1038_s41598-024-65584-2_157_item_2 raw docling: (tokens=74)
<formula><loc_0><loc_0><loc_500><loc_500>R R _ { i } ^ { * } = E R _ { t o t a l } + 1 = \exp [ \beta _ { i } ( ( C _ { i , m } - C _ { i , 0 } ) ) ]</formula><end_of_utterance>
2025-06-10 20:14:39,179 - DEBUG - Starting _parse_docling_output
2025-06-10 20:14:39,179 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>R R _ { i } ^ { * } = E R _ { t o t a l } + 1 = \exp [ \beta _ { i } ( ( C _ { i , m } - C _ { i , 0 } ) ) ]</formula><end_of_utterance>
2025-06-10 20:14:39,179 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:14:39,179 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>R R _ { i } ^ { * } = E R _ { t o t a l } + 1 = \\exp [ \\beta _ { i } ( ( C _ { i , m } - C _ { i , 0 } ) ) ]</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=817x69 at 0x7F96D7AF31D0>)]
2025-06-10 20:14:39,180 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:14:39,182 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=817.0, b=69.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 108))], orig='R R _ { i } ^ { * } = E R _ { t o t a l } + 1 = \\exp [ \\beta _ { i } ( ( C _ { i , m } - C _ { i , 0 } ) ) ]', text='R R _ { i } ^ { * } = E R _ { t o t a l } + 1 = \\exp [ \\beta _ { i } ( ( C _ { i , m } - C _ { i , 0 } ) ) ]', formatting=None, hyperlink=None)]
2025-06-10 20:14:39,182 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:14:39,183 - DEBUG - Processing text item: label=formula, text=R R _ { i } ^ { * } = E R _ { t o t a l } + 1 = \exp [ \beta _ { i } ( ( C _ { i , m } - C _ { i , 0 } ) ) ]
2025-06-10 20:14:39,183 - DEBUG - Recognized string extracted: R R _ { i } ^ { * } = E R _ { t o t a l } + 1 = \exp [ \beta _ { i } ( ( C _ { i , m } - C _ { i , 0 } ) ) ]
2025-06-10 20:14:39,183 - DEBUG - Generating chat message for label: formula
2025-06-10 20:14:39,183 - DEBUG - Snippet 10.1038_s41598-024-65584-2_157_item_3 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:14:39,256 - DEBUG - Snippet 10.1038_s41598-024-65584-2_157_item_3 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:14:39,392 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:39,400 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:39,402 - DEBUG - Finished converting page batch time=3608.260
2025-06-10 20:14:39,567 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:39,635 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:14:39,635 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:14:39,636 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:14:39,681 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:14:39,726 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:14:39,775 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:14:39,816 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:14:39,852 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:14:39,957 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:14:39,993 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:40,078 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:14:40,104 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:40,109 - DEBUG - Snippet 10.3390_toxics11060481_197_item_0: generation shape=torch.Size([1, 436])
2025-06-10 20:14:40,117 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:14:40,135 - DEBUG - Snippet 10.3390_toxics11060481_197_item_0 raw docling: (tokens=90)
<formula><loc_0><loc_0><loc_500><loc_500>M E T \, i m p a c t \, i n d e x = \frac { C _ { i , o b s e r v e d } - C _ { i , d e w e a t h e r e d } } { C _ { i , o b s e r v e d } }</formula><end_of_utterance>
2025-06-10 20:14:40,135 - DEBUG - Starting _parse_docling_output
2025-06-10 20:14:40,135 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>M E T \, i m p a c t \, i n d e x = \frac { C _ { i , o b s e r v e d } - C _ { i , d e w e a t h e r e d } } { C _ { i , o b s e r v e d } }</formula><end_of_utterance>
2025-06-10 20:14:40,136 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:14:40,136 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>M E T \\, i m p a c t \\, i n d e x = \\frac { C _ { i , o b s e r v e d } - C _ { i , d e w e a t h e r e d } } { C _ { i , o b s e r v e d } }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=872x123 at 0x7F96D547FAD0>)]
2025-06-10 20:14:40,137 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:14:40,147 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=872.0, b=123.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 141))], orig='M E T \\, i m p a c t \\, i n d e x = \\frac { C _ { i , o b s e r v e d } - C _ { i , d e w e a t h e r e d } } { C _ { i , o b s e r v e d } }', text='M E T \\, i m p a c t \\, i n d e x = \\frac { C _ { i , o b s e r v e d } - C _ { i , d e w e a t h e r e d } } { C _ { i , o b s e r v e d } }', formatting=None, hyperlink=None)]
2025-06-10 20:14:40,147 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:14:40,147 - DEBUG - Processing text item: label=formula, text=M E T \, i m p a c t \, i n d e x = \frac { C _ { i , o b s e r v e d } - C _ { i , d e w e a t h e r e d } } { C _ { i , o b s e r v e d } }
2025-06-10 20:14:40,148 - DEBUG - Recognized string extracted: M E T \, i m p a c t \, i n d e x = \frac { C _ { i , o b s e r v e d } - C _ { i , d e w e a t h e r e d } } { C _ { i , o b s e r v e d } }
2025-06-10 20:14:40,148 - DEBUG - Generating chat message for label: formula
2025-06-10 20:14:40,148 - DEBUG - Snippet 10.3390_toxics11060481_197_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:14:40,173 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:14:40,247 - DEBUG - Snippet 10.3390_toxics11060481_197_item_1 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:14:40,512 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:14:40,651 - DEBUG - Snippet 10.1038_s41598-023-45062-x_185_item_2: generation shape=torch.Size([1, 471])
2025-06-10 20:14:40,654 - DEBUG - Snippet 10.1038_s41598-023-45062-x_185_item_2 raw docling: (tokens=125)
<formula><loc_0><loc_0><loc_500><loc_500>V S L _ { 2 0 1 5 } / 2 0 1 6 = V S L _ { b a s e } \times \left ( \frac { I n c o m e _ { j i l i n , 2 0 1 5 / 2 0 1 6 } } { I n c o m e _ { b a s e , 2 0 1 0 } } \right ) ^ { e }</formula><end_of_utterance>
2025-06-10 20:14:40,654 - DEBUG - Starting _parse_docling_output
2025-06-10 20:14:40,655 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>V S L _ { 2 0 1 5 } / 2 0 1 6 = V S L _ { b a s e } \times \left ( \frac { I n c o m e _ { j i l i n , 2 0 1 5 / 2 0 1 6 } } { I n c o m e _ { b a s e , 2 0 1 0 } } \right ) ^ { e }</formula><end_of_utterance>
2025-06-10 20:14:40,655 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:14:40,655 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>V S L _ { 2 0 1 5 } / 2 0 1 6 = V S L _ { b a s e } \\times \\left ( \\frac { I n c o m e _ { j i l i n , 2 0 1 5 / 2 0 1 6 } } { I n c o m e _ { b a s e , 2 0 1 0 } } \\right ) ^ { e }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=551x122 at 0x7F96DCE1B830>)]
2025-06-10 20:14:40,656 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:14:40,659 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=551.0, b=122.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 181))], orig='V S L _ { 2 0 1 5 } / 2 0 1 6 = V S L _ { b a s e } \\times \\left ( \\frac { I n c o m e _ { j i l i n , 2 0 1 5 / 2 0 1 6 } } { I n c o m e _ { b a s e , 2 0 1 0 } } \\right ) ^ { e }', text='V S L _ { 2 0 1 5 } / 2 0 1 6 = V S L _ { b a s e } \\times \\left ( \\frac { I n c o m e _ { j i l i n , 2 0 1 5 / 2 0 1 6 } } { I n c o m e _ { b a s e , 2 0 1 0 } } \\right ) ^ { e }', formatting=None, hyperlink=None)]
2025-06-10 20:14:40,659 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:14:40,659 - DEBUG - Processing text item: label=formula, text=V S L _ { 2 0 1 5 } / 2 0 1 6 = V S L _ { b a s e } \times \left ( \frac { I n c o m e _ { j i l i n , 2 0 1 5 / 2 0 1 6 } } { I n c o m e _ { b a s e , 2 0 1 0 } } \right ) ^ { e }
2025-06-10 20:14:40,659 - DEBUG - Recognized string extracted: V S L _ { 2 0 1 5 } / 2 0 1 6 = V S L _ { b a s e } \times \left ( \frac { I n c o m e _ { j i l i n , 2 0 1 5 / 2 0 1 6 } } { I n c o m e _ { b a s e , 2 0 1 0 } } \right ) ^ { e }
2025-06-10 20:14:40,660 - DEBUG - Generating chat message for label: formula
2025-06-10 20:14:40,660 - DEBUG - Snippet 10.1038_s41598-023-45062-x_185_item_3 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:14:40,729 - DEBUG - Snippet 10.1038_s41598-023-45062-x_185_item_3 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:14:40,801 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:14:40,879 - DEBUG - Dynamic vertical threshold: 27.363599999999998, Overlap threshold: 0.7
2025-06-10 20:14:40,880 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:40,881 - DEBUG - Finished converting page batch time=3609.739
2025-06-10 20:14:41,009 - DEBUG - Finished converting page batch time=3609.868
2025-06-10 20:14:41,043 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:14:41,044 - INFO - Processing document 10.3390_ijerph20032273_215.pdf
2025-06-10 20:14:41,223 - DEBUG - Dynamic vertical threshold: 48.94560000000001, Overlap threshold: 0.7
2025-06-10 20:14:41,224 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:41,369 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:41,475 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:41,608 - DEBUG - Snippet 10.1038_s41598-024-65584-2_157_item_3: generation shape=torch.Size([1, 424])
2025-06-10 20:14:41,609 - DEBUG - Snippet 10.1038_s41598-024-65584-2_157_item_3 raw docling: (tokens=78)
<formula><loc_0><loc_0><loc_500><loc_500>C _ { i , m } ^ { * } = \ln ( R R _ { i } ^ { * } ) / \beta _ { i } + C _ { i , 0 } , C _ { i , m } > C _ { i , 0 }</formula><end_of_utterance>
2025-06-10 20:14:41,609 - DEBUG - Starting _parse_docling_output
2025-06-10 20:14:41,610 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>C _ { i , m } ^ { * } = \ln ( R R _ { i } ^ { * } ) / \beta _ { i } + C _ { i , 0 } , C _ { i , m } > C _ { i , 0 }</formula><end_of_utterance>
2025-06-10 20:14:41,610 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:14:41,610 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>C _ { i , m } ^ { * } = \\ln ( R R _ { i } ^ { * } ) / \\beta _ { i } + C _ { i , 0 } , C _ { i , m } > C _ { i , 0 }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=787x68 at 0x7F96D7AF09B0>)]
2025-06-10 20:14:41,611 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:14:41,613 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=787.0, b=68.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 115))], orig='C _ { i , m } ^ { * } = \\ln ( R R _ { i } ^ { * } ) / \\beta _ { i } + C _ { i , 0 } , C _ { i , m } > C _ { i , 0 }', text='C _ { i , m } ^ { * } = \\ln ( R R _ { i } ^ { * } ) / \\beta _ { i } + C _ { i , 0 } , C _ { i , m } > C _ { i , 0 }', formatting=None, hyperlink=None)]
2025-06-10 20:14:41,613 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:14:41,613 - DEBUG - Processing text item: label=formula, text=C _ { i , m } ^ { * } = \ln ( R R _ { i } ^ { * } ) / \beta _ { i } + C _ { i , 0 } , C _ { i , m } > C _ { i , 0 }
2025-06-10 20:14:41,613 - DEBUG - Recognized string extracted: C _ { i , m } ^ { * } = \ln ( R R _ { i } ^ { * } ) / \beta _ { i } + C _ { i , 0 } , C _ { i , m } > C _ { i , 0 }
2025-06-10 20:14:41,614 - DEBUG - Generating chat message for label: formula
2025-06-10 20:14:41,614 - DEBUG - Snippet 10.1038_s41598-024-65584-2_157_item_4 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:14:41,639 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:41,640 - DEBUG - Finished converting page batch time=3610.499
2025-06-10 20:14:41,660 - DEBUG - Snippet 10.3390_toxics11060481_197_item_1: generation shape=torch.Size([1, 395])
2025-06-10 20:14:41,661 - DEBUG - Snippet 10.3390_toxics11060481_197_item_1 raw docling: (tokens=49)
<formula><loc_0><loc_0><loc_500><loc_500>R R = \exp \{ \beta ( C - C _ { 0 } ) \} , C > C _ { 0 }</formula><end_of_utterance>
2025-06-10 20:14:41,661 - DEBUG - Starting _parse_docling_output
2025-06-10 20:14:41,661 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>R R = \exp \{ \beta ( C - C _ { 0 } ) \} , C > C _ { 0 }</formula><end_of_utterance>
2025-06-10 20:14:41,661 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:14:41,662 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>R R = \\exp \\{ \\beta ( C - C _ { 0 } ) \\} , C > C _ { 0 }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=783x61 at 0x7F96D547D340>)]
2025-06-10 20:14:41,662 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:14:41,665 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=783.0, b=61.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 56))], orig='R R = \\exp \\{ \\beta ( C - C _ { 0 } ) \\} , C > C _ { 0 }', text='R R = \\exp \\{ \\beta ( C - C _ { 0 } ) \\} , C > C _ { 0 }', formatting=None, hyperlink=None)]
2025-06-10 20:14:41,665 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:14:41,665 - DEBUG - Processing text item: label=formula, text=R R = \exp \{ \beta ( C - C _ { 0 } ) \} , C > C _ { 0 }
2025-06-10 20:14:41,665 - DEBUG - Recognized string extracted: R R = \exp \{ \beta ( C - C _ { 0 } ) \} , C > C _ { 0 }
2025-06-10 20:14:41,665 - DEBUG - Generating chat message for label: formula
2025-06-10 20:14:41,666 - DEBUG - Snippet 10.3390_toxics11060481_197_item_2 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:14:41,690 - DEBUG - Snippet 10.1038_s41598-024-65584-2_157_item_4 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:14:41,736 - DEBUG - Snippet 10.3390_toxics11060481_197_item_2 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:14:41,753 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:41,853 - DEBUG - Creating masked image for page 5 with 16 clusters.
2025-06-10 20:14:41,855 - INFO - Masked image successfully created for page 5.
2025-06-10 20:14:41,862 - INFO - Starting prediction for 3 images with labels: ['formula', 'formula', 'formula']
2025-06-10 20:14:41,863 - DEBUG - Generating chat message for label: formula
2025-06-10 20:14:41,863 - DEBUG - Snippet 10.1186_s12942-023-00333-8_202_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:14:41,877 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:41,964 - DEBUG - Snippet 10.1186_s12942-023-00333-8_202_item_0 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:14:41,998 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:42,102 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:42,134 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:42,309 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:42,310 - DEBUG - Finished converting page batch time=3611.168
2025-06-10 20:14:42,670 - DEBUG - Snippet 10.1038_s41598-023-45062-x_185_item_3: generation shape=torch.Size([1, 411])
2025-06-10 20:14:42,674 - DEBUG - Snippet 10.1038_s41598-023-45062-x_185_item_3 raw docling: (tokens=65)
<formula><loc_0><loc_0><loc_500><loc_500>E _ { i } = V S L _ { 2 0 1 5 / 2 0 1 6 } \times \Delta M o r t a l i t y _ { i }</formula><end_of_utterance>
2025-06-10 20:14:42,674 - DEBUG - Starting _parse_docling_output
2025-06-10 20:14:42,674 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>E _ { i } = V S L _ { 2 0 1 5 / 2 0 1 6 } \times \Delta M o r t a l i t y _ { i }</formula><end_of_utterance>
2025-06-10 20:14:42,675 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:14:42,675 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>E _ { i } = V S L _ { 2 0 1 5 / 2 0 1 6 } \\times \\Delta M o r t a l i t y _ { i }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=350x59 at 0x7F96DDEA5A90>)]
2025-06-10 20:14:42,675 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:14:42,676 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=350.0, b=59.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 81))], orig='E _ { i } = V S L _ { 2 0 1 5 / 2 0 1 6 } \\times \\Delta M o r t a l i t y _ { i }', text='E _ { i } = V S L _ { 2 0 1 5 / 2 0 1 6 } \\times \\Delta M o r t a l i t y _ { i }', formatting=None, hyperlink=None)]
2025-06-10 20:14:42,677 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:14:42,677 - DEBUG - Processing text item: label=formula, text=E _ { i } = V S L _ { 2 0 1 5 / 2 0 1 6 } \times \Delta M o r t a l i t y _ { i }
2025-06-10 20:14:42,677 - DEBUG - Recognized string extracted: E _ { i } = V S L _ { 2 0 1 5 / 2 0 1 6 } \times \Delta M o r t a l i t y _ { i }
2025-06-10 20:14:42,677 - INFO - All done. Returning 4 recognized text results.
2025-06-10 20:14:42,677 - DEBUG - Snippet 10.1038_s41598-023-45062-x_185_item_0 recognized text:
\log ( E ( Y _ { i } ) ) = \alpha + \beta X _ { i } + s ( t i m e , d f ) + s ( Z _ { i } , d f ) + D O W + H o l i d a y
2025-06-10 20:14:42,678 - DEBUG - Snippet 10.1038_s41598-023-45062-x_185_item_1 recognized text:
\Delta M o r t a l i t y _ { i } = Y _ { 0 } \times ( 1 - 1 / \exp [ \beta ( C _ { i } - C _ { 0 } ) ] ) \times P O P _ { i }
2025-06-10 20:14:42,678 - DEBUG - Snippet 10.1038_s41598-023-45062-x_185_item_2 recognized text:
V S L _ { 2 0 1 5 } / 2 0 1 6 = V S L _ { b a s e } \times \left ( \frac { I n c o m e _ { j i l i n , 2 0 1 5 / 2 0 1 6 } } { I n c o m e _ { b a s e , 2 0 1 0 } } \right ) ^ { e }
2025-06-10 20:14:42,678 - DEBUG - Snippet 10.1038_s41598-023-45062-x_185_item_3 recognized text:
E _ { i } = V S L _ { 2 0 1 5 / 2 0 1 6 } \times \Delta M o r t a l i t y _ { i }
2025-06-10 20:14:42,782 - INFO - Finished converting document 10.1038_s41598-023-45062-x_185.pdf in 24.12 sec.
2025-06-10 20:14:42,814 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:42,896 - INFO - Extraction successful row 37, tokens=16162
2025-06-10 20:14:42,921 - INFO - Going to convert document batch...
2025-06-10 20:14:42,922 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:14:42,922 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:14:42,928 - DEBUG - Snippet 10.3390_toxics11060481_197_item_2: generation shape=torch.Size([1, 386])
2025-06-10 20:14:42,929 - DEBUG - Snippet 10.3390_toxics11060481_197_item_2 raw docling: (tokens=40)
<formula><loc_0><loc_0><loc_500><loc_500>R R ^ { \prime } = E R _ { T o t a l } + 1</formula><end_of_utterance>
2025-06-10 20:14:42,929 - DEBUG - Starting _parse_docling_output
2025-06-10 20:14:42,929 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>R R ^ { \prime } = E R _ { T o t a l } + 1</formula><end_of_utterance>
2025-06-10 20:14:42,929 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:14:42,930 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>R R ^ { \\prime } = E R _ { T o t a l } + 1</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=691x73 at 0x7F96D547EA50>)]
2025-06-10 20:14:42,930 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:14:42,932 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=691.0, b=73.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 42))], orig='R R ^ { \\prime } = E R _ { T o t a l } + 1', text='R R ^ { \\prime } = E R _ { T o t a l } + 1', formatting=None, hyperlink=None)]
2025-06-10 20:14:42,932 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:14:42,933 - DEBUG - Processing text item: label=formula, text=R R ^ { \prime } = E R _ { T o t a l } + 1
2025-06-10 20:14:42,933 - DEBUG - Recognized string extracted: R R ^ { \prime } = E R _ { T o t a l } + 1
2025-06-10 20:14:42,933 - DEBUG - Generating chat message for label: formula
2025-06-10 20:14:42,934 - DEBUG - Snippet 10.3390_toxics11060481_197_item_3 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:14:42,969 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:14:43,004 - DEBUG - Snippet 10.3390_toxics11060481_197_item_3 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:14:43,189 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:43,423 - DEBUG - Snippet 10.1038_s41598-024-65584-2_157_item_4: generation shape=torch.Size([1, 401])
2025-06-10 20:14:43,424 - DEBUG - Snippet 10.1038_s41598-024-65584-2_157_item_4 raw docling: (tokens=55)
<formula><loc_0><loc_0><loc_500><loc_500>C _ { i , m } ^ { * } = C _ { i , m } , C _ { i , m } < C _ { i , 0 }</formula><end_of_utterance>
2025-06-10 20:14:43,424 - DEBUG - Starting _parse_docling_output
2025-06-10 20:14:43,425 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>C _ { i , m } ^ { * } = C _ { i , m } , C _ { i , m } < C _ { i , 0 }</formula><end_of_utterance>
2025-06-10 20:14:43,425 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:14:43,425 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>C _ { i , m } ^ { * } = C _ { i , m } , C _ { i , m } < C _ { i , 0 }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=714x69 at 0x7F971BF74320>)]
2025-06-10 20:14:43,426 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:14:43,428 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=714.0, b=69.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 53))], orig='C _ { i , m } ^ { * } = C _ { i , m } , C _ { i , m }', text='C _ { i , m } ^ { * } = C _ { i , m } , C _ { i , m }', formatting=None, hyperlink=None)]
2025-06-10 20:14:43,428 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:14:43,428 - DEBUG - Processing text item: label=formula, text=C _ { i , m } ^ { * } = C _ { i , m } , C _ { i , m }
2025-06-10 20:14:43,429 - DEBUG - Recognized string extracted: C _ { i , m } ^ { * } = C _ { i , m } , C _ { i , m }
2025-06-10 20:14:43,429 - INFO - All done. Returning 5 recognized text results.
2025-06-10 20:14:43,429 - DEBUG - Snippet 10.1038_s41598-024-65584-2_157_item_0 recognized text:
E R _ { i } = R R _ { i } - 1
2025-06-10 20:14:43,429 - DEBUG - Snippet 10.1038_s41598-024-65584-2_157_item_1 recognized text:
E R _ { t o t a l } = \sum _ { i = 1 } ^ { n } E R _ { i } = \sum _ { i = 1 } ^ { n } ( R R _ { i } - 1 )
2025-06-10 20:14:43,430 - DEBUG - Snippet 10.1038_s41598-024-65584-2_157_item_2 recognized text:
R R _ { i } ^ { * } = E R _ { t o t a l } + 1 = \exp [ \beta _ { i } ( ( C _ { i , m } - C _ { i , 0 } ) ) ]
2025-06-10 20:14:43,430 - DEBUG - Snippet 10.1038_s41598-024-65584-2_157_item_3 recognized text:
C _ { i , m } ^ { * } = \ln ( R R _ { i } ^ { * } ) / \beta _ { i } + C _ { i , 0 } , C _ { i , m } > C _ { i , 0 }
2025-06-10 20:14:43,430 - DEBUG - Snippet 10.1038_s41598-024-65584-2_157_item_4 recognized text:
C _ { i , m } ^ { * } = C _ { i , m } , C _ { i , m }
2025-06-10 20:14:43,526 - DEBUG - Creating masked image for page 3 with 17 clusters.
2025-06-10 20:14:43,528 - INFO - Masked image successfully created for page 3.
2025-06-10 20:14:43,535 - INFO - Starting prediction for 4 images with labels: ['formula', 'formula', 'formula', 'formula']
2025-06-10 20:14:43,535 - DEBUG - Generating chat message for label: formula
2025-06-10 20:14:43,536 - DEBUG - Snippet 10.1038_s41598-024-65584-2_157_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:14:43,609 - WARNING - Repetitive generation detected with pattern: ' \, \,'
2025-06-10 20:14:43,610 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:14:43,610 - DEBUG - Snippet 10.1186_s12942-023-00333-8_202_item_0: generation shape=torch.Size([1, 396])
2025-06-10 20:14:43,611 - DEBUG - Snippet 10.1186_s12942-023-00333-8_202_item_0 raw docling: (tokens=50)
<formula><loc_0><loc_0><loc_500><loc_500>R R = \frac { P r o b a b i l i t y \, \, \, \, \, \, \, \,
2025-06-10 20:14:43,611 - DEBUG - Starting _parse_docling_output
2025-06-10 20:14:43,611 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>R R = \frac { P r o b a b i l i t y \, \, \, \, \, \, \, \,
2025-06-10 20:14:43,612 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:14:43,612 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>R R = \\frac { P r o b a b i l i t y \\, \\, \\, \\, \\, \\, \\, \\,', image=<PIL.Image.Image image mode=RGB size=629x112 at 0x7F96F11142F0>)]
2025-06-10 20:14:43,612 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:14:43,616 - DEBUG - DoclingDocument loaded successfully. Extracted texts: []
2025-06-10 20:14:43,616 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:14:43,616 - WARNING - Extracted text is empty or malformed. Skipping formula.
2025-06-10 20:14:43,616 - DEBUG - Generating chat message for label: formula
2025-06-10 20:14:43,617 - DEBUG - Snippet 10.1186_s12942-023-00333-8_202_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:14:43,620 - DEBUG - Snippet 10.1038_s41598-024-65584-2_157_item_0 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:14:43,659 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:14:43,667 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:14:43,692 - DEBUG - Snippet 10.1186_s12942-023-00333-8_202_item_1 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:14:43,836 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:44,070 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:44,163 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:44,196 - DEBUG - Dynamic vertical threshold: 53.00640000000006, Overlap threshold: 0.7
2025-06-10 20:14:44,197 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:44,217 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:14:44,218 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:14:44,218 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:14:44,256 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:14:44,294 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:14:44,343 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:14:44,402 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:14:44,463 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:14:44,500 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:14:44,622 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:14:44,661 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:14:44,692 - DEBUG - Snippet 10.3390_toxics11060481_197_item_3: generation shape=torch.Size([1, 408])
2025-06-10 20:14:44,693 - DEBUG - Snippet 10.3390_toxics11060481_197_item_3 raw docling: (tokens=62)
<formula><loc_0><loc_0><loc_500><loc_500>C _ { i } ^ { \prime } = \frac { \ln ( R K ^ { \prime } ) } { \beta _ { i } } + C _ { 0 , i }</formula><end_of_utterance>
2025-06-10 20:14:44,693 - DEBUG - Starting _parse_docling_output
2025-06-10 20:14:44,693 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>C _ { i } ^ { \prime } = \frac { \ln ( R K ^ { \prime } ) } { \beta _ { i } } + C _ { 0 , i }</formula><end_of_utterance>
2025-06-10 20:14:44,693 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:14:44,694 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>C _ { i } ^ { \\prime } = \\frac { \\ln ( R K ^ { \\prime } ) } { \\beta _ { i } } + C _ { 0 , i }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=714x137 at 0x7F96D547D190>)]
2025-06-10 20:14:44,694 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:14:44,700 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:14:44,700 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=714.0, b=137.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 93))], orig='C _ { i } ^ { \\prime } = \\frac { \\ln ( R K ^ { \\prime } ) } { \\beta _ { i } } + C _ { 0 , i }', text='C _ { i } ^ { \\prime } = \\frac { \\ln ( R K ^ { \\prime } ) } { \\beta _ { i } } + C _ { 0 , i }', formatting=None, hyperlink=None)]
2025-06-10 20:14:44,700 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:14:44,701 - DEBUG - Processing text item: label=formula, text=C _ { i } ^ { \prime } = \frac { \ln ( R K ^ { \prime } ) } { \beta _ { i } } + C _ { 0 , i }
2025-06-10 20:14:44,701 - DEBUG - Recognized string extracted: C _ { i } ^ { \prime } = \frac { \ln ( R K ^ { \prime } ) } { \beta _ { i } } + C _ { 0 , i }
2025-06-10 20:14:44,701 - DEBUG - Generating chat message for label: formula
2025-06-10 20:14:44,701 - DEBUG - Snippet 10.3390_toxics11060481_197_item_4 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:14:44,710 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:44,711 - DEBUG - Finished converting page batch time=3613.569
2025-06-10 20:14:44,726 - DEBUG - Dynamic vertical threshold: 46.755000000000045, Overlap threshold: 0.7
2025-06-10 20:14:44,727 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:44,728 - DEBUG - Finished converting page batch time=3613.587
2025-06-10 20:14:44,787 - DEBUG - Snippet 10.3390_toxics11060481_197_item_4 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:14:44,844 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:44,985 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:45,038 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:14:45,323 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:14:45,413 - DEBUG - Snippet 10.1186_s12942-023-00333-8_202_item_1: generation shape=torch.Size([1, 394])
2025-06-10 20:14:45,414 - DEBUG - Snippet 10.1186_s12942-023-00333-8_202_item_1 raw docling: (tokens=48)
<formula><loc_0><loc_0><loc_500><loc_500>H R I = C * \frac { R R - 1 } { 1 0 } * F S A * I O R</formula><end_of_utterance>
2025-06-10 20:14:45,414 - DEBUG - Starting _parse_docling_output
2025-06-10 20:14:45,415 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>H R I = C * \frac { R R - 1 } { 1 0 } * F S A * I O R</formula><end_of_utterance>
2025-06-10 20:14:45,415 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:14:45,415 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>H R I = C * \\frac { R R - 1 } { 1 0 } * F S A * I O R</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=628x113 at 0x7F96DAA6FB90>)]
2025-06-10 20:14:45,415 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:14:45,418 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=628.0, b=113.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 53))], orig='H R I = C * \\frac { R R - 1 } { 1 0 } * F S A * I O R', text='H R I = C * \\frac { R R - 1 } { 1 0 } * F S A * I O R', formatting=None, hyperlink=None)]
2025-06-10 20:14:45,418 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:14:45,419 - DEBUG - Processing text item: label=formula, text=H R I = C * \frac { R R - 1 } { 1 0 } * F S A * I O R
2025-06-10 20:14:45,419 - DEBUG - Recognized string extracted: H R I = C * \frac { R R - 1 } { 1 0 } * F S A * I O R
2025-06-10 20:14:45,419 - DEBUG - Generating chat message for label: formula
2025-06-10 20:14:45,420 - DEBUG - Snippet 10.1186_s12942-023-00333-8_202_item_2 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:14:45,490 - DEBUG - Snippet 10.1186_s12942-023-00333-8_202_item_2 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:14:45,511 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:14:45,511 - INFO - Processing document 10.7717_peerj.14489_219.pdf
2025-06-10 20:14:45,662 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:45,663 - DEBUG - Finished converting page batch time=3614.522
2025-06-10 20:14:45,723 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:45,953 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:45,989 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:46,222 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:46,319 - DEBUG - Finished converting page batch time=3615.178
2025-06-10 20:14:46,411 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:46,426 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:46,589 - DEBUG - Snippet 10.1186_s12942-023-00333-8_202_item_2: generation shape=torch.Size([1, 373])
2025-06-10 20:14:46,590 - DEBUG - Snippet 10.1186_s12942-023-00333-8_202_item_2 raw docling: (tokens=27)
<formula><loc_0><loc_0><loc_500><loc_500>H B = H R I * P</formula><end_of_utterance>
2025-06-10 20:14:46,594 - DEBUG - Starting _parse_docling_output
2025-06-10 20:14:46,594 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>H B = H R I * P</formula><end_of_utterance>
2025-06-10 20:14:46,594 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:14:46,595 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>H B = H R I * P</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=628x61 at 0x7F9714A7DC70>)]
2025-06-10 20:14:46,595 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:14:46,597 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=628.0, b=61.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 15))], orig='H B = H R I * P', text='H B = H R I * P', formatting=None, hyperlink=None)]
2025-06-10 20:14:46,597 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:14:46,597 - DEBUG - Processing text item: label=formula, text=H B = H R I * P
2025-06-10 20:14:46,597 - DEBUG - Recognized string extracted: H B = H R I * P
2025-06-10 20:14:46,598 - INFO - All done. Returning 3 recognized text results.
2025-06-10 20:14:46,598 - DEBUG - Snippet 10.1186_s12942-023-00333-8_202_item_0 recognized text:
MALFORMED_FORMULA
2025-06-10 20:14:46,598 - DEBUG - Snippet 10.1186_s12942-023-00333-8_202_item_1 recognized text:
H R I = C * \frac { R R - 1 } { 1 0 } * F S A * I O R
2025-06-10 20:14:46,598 - DEBUG - Snippet 10.1186_s12942-023-00333-8_202_item_2 recognized text:
H B = H R I * P
2025-06-10 20:14:46,605 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:46,708 - INFO - Finished converting document 10.1186_s12942-023-00333-8_202.pdf in 19.77 sec.
2025-06-10 20:14:46,786 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:46,787 - DEBUG - Finished converting page batch time=3615.646
2025-06-10 20:14:46,805 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:46,839 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:46,851 - INFO - Extraction successful row 41, tokens=15746
2025-06-10 20:14:46,880 - INFO - Going to convert document batch...
2025-06-10 20:14:46,881 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:14:46,881 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:14:46,907 - INFO - Finished converting document 10.3390_ijerph20064695_208.pdf in 13.24 sec.
2025-06-10 20:14:46,939 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:14:47,007 - INFO - Extraction successful row 42, tokens=18561
2025-06-10 20:14:47,032 - INFO - Going to convert document batch...
2025-06-10 20:14:47,032 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:14:47,033 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:14:47,093 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:14:47,123 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:47,183 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:47,184 - DEBUG - Finished converting page batch time=3616.043
2025-06-10 20:14:47,298 - DEBUG - Snippet 10.1038_s41598-024-65584-2_157_item_0: generation shape=torch.Size([1, 469])
2025-06-10 20:14:47,299 - DEBUG - Snippet 10.1038_s41598-024-65584-2_157_item_0 raw docling: (tokens=123)
<formula><loc_0><loc_0><loc_500><loc_500>N H A Q I _ { i } = \frac { ( A Q I _ { i , j } - A Q I _ { i , j - 1 } ) } { ( C _ { i , j } - C _ { i , j - 1 } ) } \times ( C _ { i , m } ^ { * } - C _ { i , j - 1 } ) + A Q I _ { i , j - 1 } , j > 1</formula><end_of_utterance>
2025-06-10 20:14:47,299 - DEBUG - Starting _parse_docling_output
2025-06-10 20:14:47,299 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>N H A Q I _ { i } = \frac { ( A Q I _ { i , j } - A Q I _ { i , j - 1 } ) } { ( C _ { i , j } - C _ { i , j - 1 } ) } \times ( C _ { i , m } ^ { * } - C _ { i , j - 1 } ) + A Q I _ { i , j - 1 } , j > 1</formula><end_of_utterance>
2025-06-10 20:14:47,299 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:14:47,299 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>N H A Q I _ { i } = \\frac { ( A Q I _ { i , j } - A Q I _ { i , j - 1 } ) } { ( C _ { i , j } - C _ { i , j - 1 } ) } \\times ( C _ { i , m } ^ { * } - C _ { i , j - 1 } ) + A Q I _ { i , j - 1 } , j > 1</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=726x112 at 0x7F96CE9E3680>)]
2025-06-10 20:14:47,300 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:14:47,303 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=726.0, b=112.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 202))], orig='N H A Q I _ { i } = \\frac { ( A Q I _ { i , j } - A Q I _ { i , j - 1 } ) } { ( C _ { i , j } - C _ { i , j - 1 } ) } \\times ( C _ { i , m } ^ { * } - C _ { i , j - 1 } ) + A Q I _ { i , j - 1 } , j > 1', text='N H A Q I _ { i } = \\frac { ( A Q I _ { i , j } - A Q I _ { i , j - 1 } ) } { ( C _ { i , j } - C _ { i , j - 1 } ) } \\times ( C _ { i , m } ^ { * } - C _ { i , j - 1 } ) + A Q I _ { i , j - 1 } , j > 1', formatting=None, hyperlink=None)]
2025-06-10 20:14:47,303 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:14:47,304 - DEBUG - Processing text item: label=formula, text=N H A Q I _ { i } = \frac { ( A Q I _ { i , j } - A Q I _ { i , j - 1 } ) } { ( C _ { i , j } - C _ { i , j - 1 } ) } \times ( C _ { i , m } ^ { * } - C _ { i , j - 1 } ) + A Q I _ { i , j - 1 } , j > 1
2025-06-10 20:14:47,304 - DEBUG - Recognized string extracted: N H A Q I _ { i } = \frac { ( A Q I _ { i , j } - A Q I _ { i , j - 1 } ) } { ( C _ { i , j } - C _ { i , j - 1 } ) } \times ( C _ { i , m } ^ { * } - C _ { i , j - 1 } ) + A Q I _ { i , j - 1 } , j > 1
2025-06-10 20:14:47,304 - DEBUG - Generating chat message for label: formula
2025-06-10 20:14:47,304 - DEBUG - Snippet 10.1038_s41598-024-65584-2_157_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:14:47,388 - DEBUG - Snippet 10.1038_s41598-024-65584-2_157_item_1 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:14:47,388 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:47,389 - DEBUG - Finished converting page batch time=3616.248
2025-06-10 20:14:47,541 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:47,541 - DEBUG - Finished converting page batch time=3616.400
2025-06-10 20:14:47,685 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:47,715 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:14:47,760 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:14:47,768 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:14:47,892 - DEBUG - Dynamic vertical threshold: 23.26860000000004, Overlap threshold: 0.7
2025-06-10 20:14:47,898 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:47,902 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:14:48,169 - DEBUG - Dynamic vertical threshold: 44.00460000000006, Overlap threshold: 0.7
2025-06-10 20:14:48,169 - DEBUG - Checking merge:
  Current: 8, Next: 15
2025-06-10 20:14:48,170 - DEBUG -   Vertical gap: 17.504999999999995, Overlap ratio: 1.0
2025-06-10 20:14:48,170 - DEBUG -   Left boundary diff: 0.0, Right boundary diff: 340.898
2025-06-10 20:14:48,170 - DEBUG -   Alignment factor (ratio): 1.5271428955408417
2025-06-10 20:14:48,170 - DEBUG -   -> c1 8 formula number: 4, c2 15 formula number: None
2025-06-10 20:14:48,170 - DEBUG -   -> Not merging 8 and 15 (one missing, gap 17.504999999999995 > 12.8)
2025-06-10 20:14:48,171 - DEBUG - Checking merge:
  Current: 17, Next: 15
2025-06-10 20:14:48,171 - DEBUG -   Vertical gap: 9.760000000000048, Overlap ratio: 0.5369602445617562
2025-06-10 20:14:48,171 - DEBUG -   Left boundary diff: 76.89700000000002, Right boundary diff: 65.43399999999997
2025-06-10 20:14:48,171 - DEBUG -   Alignment factor (ratio): 1.6345240246144697
2025-06-10 20:14:48,171 - DEBUG -   -> c1 17 formula number: None, c2 15 formula number: None
2025-06-10 20:14:48,172 - DEBUG -   -> Not merging clusters 17 and 15 because vertical_gap 9.760000000000048 > 3 with no numbers
2025-06-10 20:14:48,172 - DEBUG - Checking merge:
  Current: 15, Next: 11
2025-06-10 20:14:48,172 - DEBUG -   Vertical gap: 19.08299999999997, Overlap ratio: 1.0
2025-06-10 20:14:48,172 - DEBUG -   Left boundary diff: 0.0, Right boundary diff: 340.903
2025-06-10 20:14:48,172 - DEBUG -   Alignment factor (ratio): 1.527148191203184
2025-06-10 20:14:48,173 - DEBUG -   -> c1 15 formula number: None, c2 11 formula number: 5
2025-06-10 20:14:48,173 - DEBUG -   -> Not merging 15 and 11 (one missing, gap 19.08299999999997 > 12.8)
2025-06-10 20:14:48,173 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:48,191 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:14:48,197 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:14:48,206 - DEBUG - Snippet 10.3390_toxics11060481_197_item_4: generation shape=torch.Size([1, 467])
2025-06-10 20:14:48,207 - DEBUG - Snippet 10.3390_toxics11060481_197_item_4 raw docling: (tokens=121)
<formula><loc_0><loc_0><loc_500><loc_500>H A Q I _ { i } = \frac { ( A Q I _ { i , j } - A Q I _ { i , j - 1 } ) } { ( C _ { i , j } - C _ { i , j - 1 } ) } \times ( C _ { i } ^ { \prime } - C _ { i , j - 1 } ) + A Q I _ { i , j - 1 } , j > 1</formula><end_of_utterance>
2025-06-10 20:14:48,207 - DEBUG - Starting _parse_docling_output
2025-06-10 20:14:48,208 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>H A Q I _ { i } = \frac { ( A Q I _ { i , j } - A Q I _ { i , j - 1 } ) } { ( C _ { i , j } - C _ { i , j - 1 } ) } \times ( C _ { i } ^ { \prime } - C _ { i , j - 1 } ) + A Q I _ { i , j - 1 } , j > 1</formula><end_of_utterance>
2025-06-10 20:14:48,208 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:14:48,208 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>H A Q I _ { i } = \\frac { ( A Q I _ { i , j } - A Q I _ { i , j - 1 } ) } { ( C _ { i , j } - C _ { i , j - 1 } ) } \\times ( C _ { i } ^ { \\prime } - C _ { i , j - 1 } ) + A Q I _ { i , j - 1 } , j > 1</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=980x129 at 0x7F96D547D0D0>)]
2025-06-10 20:14:48,208 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:14:48,213 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=980.0, b=129.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 201))], orig='H A Q I _ { i } = \\frac { ( A Q I _ { i , j } - A Q I _ { i , j - 1 } ) } { ( C _ { i , j } - C _ { i , j - 1 } ) } \\times ( C _ { i } ^ { \\prime } - C _ { i , j - 1 } ) + A Q I _ { i , j - 1 } , j > 1', text='H A Q I _ { i } = \\frac { ( A Q I _ { i , j } - A Q I _ { i , j - 1 } ) } { ( C _ { i , j } - C _ { i , j - 1 } ) } \\times ( C _ { i } ^ { \\prime } - C _ { i , j - 1 } ) + A Q I _ { i , j - 1 } , j > 1', formatting=None, hyperlink=None)]
2025-06-10 20:14:48,213 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:14:48,214 - DEBUG - Processing text item: label=formula, text=H A Q I _ { i } = \frac { ( A Q I _ { i , j } - A Q I _ { i , j - 1 } ) } { ( C _ { i , j } - C _ { i , j - 1 } ) } \times ( C _ { i } ^ { \prime } - C _ { i , j - 1 } ) + A Q I _ { i , j - 1 } , j > 1
2025-06-10 20:14:48,214 - DEBUG - Recognized string extracted: H A Q I _ { i } = \frac { ( A Q I _ { i , j } - A Q I _ { i , j - 1 } ) } { ( C _ { i , j } - C _ { i , j - 1 } ) } \times ( C _ { i } ^ { \prime } - C _ { i , j - 1 } ) + A Q I _ { i , j - 1 } , j > 1
2025-06-10 20:14:48,214 - INFO - All done. Returning 5 recognized text results.
2025-06-10 20:14:48,214 - DEBUG - Snippet 10.3390_toxics11060481_197_item_0 recognized text:
M E T \, i m p a c t \, i n d e x = \frac { C _ { i , o b s e r v e d } - C _ { i , d e w e a t h e r e d } } { C _ { i , o b s e r v e d } }
2025-06-10 20:14:48,215 - DEBUG - Snippet 10.3390_toxics11060481_197_item_1 recognized text:
R R = \exp \{ \beta ( C - C _ { 0 } ) \} , C > C _ { 0 }
2025-06-10 20:14:48,215 - DEBUG - Snippet 10.3390_toxics11060481_197_item_2 recognized text:
R R ^ { \prime } = E R _ { T o t a l } + 1
2025-06-10 20:14:48,215 - DEBUG - Snippet 10.3390_toxics11060481_197_item_3 recognized text:
C _ { i } ^ { \prime } = \frac { \ln ( R K ^ { \prime } ) } { \beta _ { i } } + C _ { 0 , i }
2025-06-10 20:14:48,215 - DEBUG - Snippet 10.3390_toxics11060481_197_item_4 recognized text:
H A Q I _ { i } = \frac { ( A Q I _ { i , j } - A Q I _ { i , j - 1 } ) } { ( C _ { i , j } - C _ { i , j - 1 } ) } \times ( C _ { i } ^ { \prime } - C _ { i , j - 1 } ) + A Q I _ { i , j - 1 } , j > 1
2025-06-10 20:14:48,300 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:14:48,308 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:14:48,308 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:14:48,349 - DEBUG - Creating masked image for page 4 with 29 clusters.
2025-06-10 20:14:48,350 - INFO - Masked image successfully created for page 4.
2025-06-10 20:14:48,358 - INFO - Starting prediction for 3 images with labels: ['formula', 'formula', 'formula']
2025-06-10 20:14:48,358 - DEBUG - Generating chat message for label: formula
2025-06-10 20:14:48,358 - DEBUG - Snippet 10.3390_toxics11060481_197_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:14:48,384 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:14:48,419 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:14:48,436 - DEBUG - Snippet 10.3390_toxics11060481_197_item_0 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:14:48,454 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:14:48,506 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:14:48,526 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:48,568 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:48,696 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:48,846 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:48,847 - DEBUG - Finished converting page batch time=3617.706
2025-06-10 20:14:48,889 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:14:48,890 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:14:48,890 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:14:48,896 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:48,902 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:49,024 - DEBUG - Creating masked image for page 3 with 15 clusters.
2025-06-10 20:14:49,026 - INFO - Masked image successfully created for page 3.
2025-06-10 20:14:49,091 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:49,092 - DEBUG - Finished converting page batch time=3617.950
2025-06-10 20:14:49,145 - DEBUG - Creating masked image for page 4 with 16 clusters.
2025-06-10 20:14:49,147 - INFO - Masked image successfully created for page 4.
2025-06-10 20:14:49,154 - INFO - Starting prediction for 4 images with labels: ['formula', 'formula', 'formula', 'formula']
2025-06-10 20:14:49,154 - DEBUG - Generating chat message for label: formula
2025-06-10 20:14:49,159 - DEBUG - Snippet 10.3390_ijerph20043517_210_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:14:49,221 - DEBUG - Snippet 10.3390_toxics11060481_197_item_0: generation shape=torch.Size([1, 372])
2025-06-10 20:14:49,222 - DEBUG - Snippet 10.3390_toxics11060481_197_item_0 raw docling: (tokens=25)
<formula><loc_0><loc_0><loc_500><loc_500>, \quad , \quad ,</formula><end_of_utterance>
2025-06-10 20:14:49,222 - DEBUG - Starting _parse_docling_output
2025-06-10 20:14:49,222 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>, \quad , \quad ,</formula><end_of_utterance>
2025-06-10 20:14:49,222 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:14:49,223 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>, \\quad , \\quad ,</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=751x132 at 0x7F96D548A960>)]
2025-06-10 20:14:49,223 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:14:49,227 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=751.0, b=132.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 17))], orig=', \\quad , \\quad ,', text=', \\quad , \\quad ,', formatting=None, hyperlink=None)]
2025-06-10 20:14:49,227 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:14:49,227 - DEBUG - Processing text item: label=formula, text=, \quad , \quad ,
2025-06-10 20:14:49,227 - DEBUG - Recognized string extracted: , \quad , \quad ,
2025-06-10 20:14:49,228 - DEBUG - Generating chat message for label: formula
2025-06-10 20:14:49,228 - DEBUG - Snippet 10.3390_toxics11060481_197_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:14:49,228 - DEBUG - Snippet 10.3390_ijerph20043517_210_item_0 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:14:49,294 - DEBUG - Snippet 10.3390_toxics11060481_197_item_1 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:14:49,431 - DEBUG - Snippet 10.1038_s41598-024-65584-2_157_item_1: generation shape=torch.Size([1, 417])
2025-06-10 20:14:49,432 - DEBUG - Snippet 10.1038_s41598-024-65584-2_157_item_1 raw docling: (tokens=71)
<formula><loc_0><loc_0><loc_500><loc_500>N H A Q I _ { i } = A Q I _ { i , 1 } \times \frac { C _ { i , m } ^ { * } } { C _ { i , 1 } } , j = 1</formula><end_of_utterance>
2025-06-10 20:14:49,432 - DEBUG - Starting _parse_docling_output
2025-06-10 20:14:49,432 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>N H A Q I _ { i } = A Q I _ { i , 1 } \times \frac { C _ { i , m } ^ { * } } { C _ { i , 1 } } , j = 1</formula><end_of_utterance>
2025-06-10 20:14:49,432 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:14:49,433 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>N H A Q I _ { i } = A Q I _ { i , 1 } \\times \\frac { C _ { i , m } ^ { * } } { C _ { i , 1 } } , j = 1</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=759x120 at 0x7F96DF3BE360>)]
2025-06-10 20:14:49,433 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:14:49,436 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=759.0, b=120.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 102))], orig='N H A Q I _ { i } = A Q I _ { i , 1 } \\times \\frac { C _ { i , m } ^ { * } } { C _ { i , 1 } } , j = 1', text='N H A Q I _ { i } = A Q I _ { i , 1 } \\times \\frac { C _ { i , m } ^ { * } } { C _ { i , 1 } } , j = 1', formatting=None, hyperlink=None)]
2025-06-10 20:14:49,436 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:14:49,437 - DEBUG - Processing text item: label=formula, text=N H A Q I _ { i } = A Q I _ { i , 1 } \times \frac { C _ { i , m } ^ { * } } { C _ { i , 1 } } , j = 1
2025-06-10 20:14:49,437 - DEBUG - Recognized string extracted: N H A Q I _ { i } = A Q I _ { i , 1 } \times \frac { C _ { i , m } ^ { * } } { C _ { i , 1 } } , j = 1
2025-06-10 20:14:49,437 - DEBUG - Generating chat message for label: formula
2025-06-10 20:14:49,437 - DEBUG - Snippet 10.1038_s41598-024-65584-2_157_item_2 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:14:49,519 - DEBUG - Snippet 10.1038_s41598-024-65584-2_157_item_2 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:14:49,542 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:14:49,544 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:14:49,544 - DEBUG - [Page 14] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:49,582 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:14:49,590 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:14:49,641 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:14:49,692 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:14:49,698 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:14:49,730 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:14:49,746 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:14:49,782 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:14:49,825 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:49,874 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:14:49,940 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:14:49,982 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:49,983 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:49,984 - DEBUG - Finished converting page batch time=3618.842
2025-06-10 20:14:50,014 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:14:50,050 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:14:50,089 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:14:50,244 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:14:50,439 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:50,490 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:14:50,599 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:14:50,670 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:14:50,671 - INFO - Processing document 10.1186_s12889-020-08915-y_232.pdf
2025-06-10 20:14:50,781 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:14:50,782 - INFO - Processing document 10.1186_s12989-018-0275-z_237.pdf
2025-06-10 20:14:50,839 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:50,839 - DEBUG - Finished converting page batch time=3619.698
2025-06-10 20:14:51,235 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:51,259 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:51,330 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:51,407 - DEBUG - [Page 15] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:51,409 - DEBUG - Finished converting page batch time=3620.268
2025-06-10 20:14:51,414 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:51,451 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:51,543 - DEBUG - Snippet 10.3390_ijerph20043517_210_item_0: generation shape=torch.Size([1, 417])
2025-06-10 20:14:51,550 - DEBUG - Snippet 10.3390_ijerph20043517_210_item_0 raw docling: (tokens=71)
<formula><loc_0><loc_0><loc_500><loc_500>U \dot { I } ^ { \mathcal { I } } _ { i } = M \mathbb { K } \times [ V \mathcal { U } \mathcal { I } ^ { s } ] _ { i }</formula><end_of_utterance>
2025-06-10 20:14:51,551 - DEBUG - Starting _parse_docling_output
2025-06-10 20:14:51,551 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>U \dot { I } ^ { \mathcal { I } } _ { i } = M \mathbb { K } \times [ V \mathcal { U } \mathcal { I } ^ { s } ] _ { i }</formula><end_of_utterance>
2025-06-10 20:14:51,551 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:14:51,551 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>U \\dot { I } ^ { \\mathcal { I } } _ { i } = M \\mathbb { K } \\times [ V \\mathcal { U } \\mathcal { I } ^ { s } ] _ { i }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=729x68 at 0x7F96CAC59AF0>)]
2025-06-10 20:14:51,552 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:14:51,561 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=729.0, b=68.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 118))], orig='U \\dot { I } ^ { \\mathcal { I } } _ { i } = M \\mathbb { K } \\times [ V \\mathcal { U } \\mathcal { I } ^ { s } ] _ { i }', text='U \\dot { I } ^ { \\mathcal { I } } _ { i } = M \\mathbb { K } \\times [ V \\mathcal { U } \\mathcal { I } ^ { s } ] _ { i }', formatting=None, hyperlink=None)]
2025-06-10 20:14:51,562 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:14:51,562 - DEBUG - Processing text item: label=formula, text=U \dot { I } ^ { \mathcal { I } } _ { i } = M \mathbb { K } \times [ V \mathcal { U } \mathcal { I } ^ { s } ] _ { i }
2025-06-10 20:14:51,562 - DEBUG - Recognized string extracted: U \dot { I } ^ { \mathcal { I } } _ { i } = M \mathbb { K } \times [ V \mathcal { U } \mathcal { I } ^ { s } ] _ { i }
2025-06-10 20:14:51,562 - DEBUG - Generating chat message for label: formula
2025-06-10 20:14:51,562 - DEBUG - Snippet 10.3390_ijerph20043517_210_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:14:51,669 - DEBUG - Snippet 10.1038_s41598-024-65584-2_157_item_2: generation shape=torch.Size([1, 427])
2025-06-10 20:14:51,670 - DEBUG - Snippet 10.1038_s41598-024-65584-2_157_item_2 raw docling: (tokens=81)
<formula><loc_0><loc_0><loc_500><loc_500>N H A Q I = \max \{ N H A Q I _ { 1 } , N H A Q I _ { 2 } , \dots , N H A Q I _ { n } \} , n = 1 , 2 , \dots , 6</formula><end_of_utterance>
2025-06-10 20:14:51,670 - DEBUG - Starting _parse_docling_output
2025-06-10 20:14:51,670 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>N H A Q I = \max \{ N H A Q I _ { 1 } , N H A Q I _ { 2 } , \dots , N H A Q I _ { n } \} , n = 1 , 2 , \dots , 6</formula><end_of_utterance>
2025-06-10 20:14:51,670 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:14:51,671 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>N H A Q I = \\max \\{ N H A Q I _ { 1 } , N H A Q I _ { 2 } , \\dots , N H A Q I _ { n } \\} , n = 1 , 2 , \\dots , 6</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=940x55 at 0x7F971B4AF620>)]
2025-06-10 20:14:51,671 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:14:51,673 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=940.0, b=55.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 112))], orig='N H A Q I = \\max \\{ N H A Q I _ { 1 } , N H A Q I _ { 2 } , \\dots , N H A Q I _ { n } \\} , n = 1 , 2 , \\dots , 6', text='N H A Q I = \\max \\{ N H A Q I _ { 1 } , N H A Q I _ { 2 } , \\dots , N H A Q I _ { n } \\} , n = 1 , 2 , \\dots , 6', formatting=None, hyperlink=None)]
2025-06-10 20:14:51,673 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:14:51,674 - DEBUG - Processing text item: label=formula, text=N H A Q I = \max \{ N H A Q I _ { 1 } , N H A Q I _ { 2 } , \dots , N H A Q I _ { n } \} , n = 1 , 2 , \dots , 6
2025-06-10 20:14:51,674 - DEBUG - Recognized string extracted: N H A Q I = \max \{ N H A Q I _ { 1 } , N H A Q I _ { 2 } , \dots , N H A Q I _ { n } \} , n = 1 , 2 , \dots , 6
2025-06-10 20:14:51,674 - DEBUG - Generating chat message for label: formula
2025-06-10 20:14:51,674 - DEBUG - Snippet 10.1038_s41598-024-65584-2_157_item_3 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:14:51,687 - DEBUG - Snippet 10.3390_ijerph20043517_210_item_1 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:14:51,736 - DEBUG - Snippet 10.1038_s41598-024-65584-2_157_item_3 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:14:51,828 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:51,829 - DEBUG - Finished converting page batch time=3620.687
2025-06-10 20:14:51,998 - DEBUG - Snippet 10.3390_toxics11060481_197_item_1: generation shape=torch.Size([1, 434])
2025-06-10 20:14:51,999 - DEBUG - Snippet 10.3390_toxics11060481_197_item_1 raw docling: (tokens=88)
<formula><loc_0><loc_0><loc_500><loc_500>H A Q I _ { i } = \max ( H A Q I _ { 1 } , H A Q I _ { 2 } , \dots , H A Q I _ { n } ) , \, n = 1 , \, 2 , \, \dots , \, 6 .</formula><end_of_utterance>
2025-06-10 20:14:51,999 - DEBUG - Starting _parse_docling_output
2025-06-10 20:14:52,000 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>H A Q I _ { i } = \max ( H A Q I _ { 1 } , H A Q I _ { 2 } , \dots , H A Q I _ { n } ) , \, n = 1 , \, 2 , \, \dots , \, 6 .</formula><end_of_utterance>
2025-06-10 20:14:52,000 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:14:52,000 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>H A Q I _ { i } = \\max ( H A Q I _ { 1 } , H A Q I _ { 2 } , \\dots , H A Q I _ { n } ) , \\, n = 1 , \\, 2 , \\, \\dots , \\, 6 .</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=975x62 at 0x7F97159E4D70>)]
2025-06-10 20:14:52,000 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:14:52,003 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=975.0, b=62.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 124))], orig='H A Q I _ { i } = \\max ( H A Q I _ { 1 } , H A Q I _ { 2 } , \\dots , H A Q I _ { n } ) , \\, n = 1 , \\, 2 , \\, \\dots , \\, 6 .', text='H A Q I _ { i } = \\max ( H A Q I _ { 1 } , H A Q I _ { 2 } , \\dots , H A Q I _ { n } ) , \\, n = 1 , \\, 2 , \\, \\dots , \\, 6 .', formatting=None, hyperlink=None)]
2025-06-10 20:14:52,003 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:14:52,004 - DEBUG - Processing text item: label=formula, text=H A Q I _ { i } = \max ( H A Q I _ { 1 } , H A Q I _ { 2 } , \dots , H A Q I _ { n } ) , \, n = 1 , \, 2 , \, \dots , \, 6 .
2025-06-10 20:14:52,004 - DEBUG - Recognized string extracted: H A Q I _ { i } = \max ( H A Q I _ { 1 } , H A Q I _ { 2 } , \dots , H A Q I _ { n } ) , \, n = 1 , \, 2 , \, \dots , \, 6 .
2025-06-10 20:14:52,004 - DEBUG - Generating chat message for label: formula
2025-06-10 20:14:52,004 - DEBUG - Snippet 10.3390_toxics11060481_197_item_2 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:14:52,018 - DEBUG - Creating masked image for page 2 with 49 clusters.
2025-06-10 20:14:52,020 - INFO - Masked image successfully created for page 2.
2025-06-10 20:14:52,075 - DEBUG - Snippet 10.3390_toxics11060481_197_item_2 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:14:52,127 - DEBUG - Creating masked image for page 3 with 12 clusters.
2025-06-10 20:14:52,128 - INFO - Masked image successfully created for page 3.
2025-06-10 20:14:52,136 - INFO - Starting prediction for 4 images with labels: ['formula', 'formula', 'formula', 'formula']
2025-06-10 20:14:52,136 - DEBUG - Generating chat message for label: formula
2025-06-10 20:14:52,141 - DEBUG - Snippet 10.3390_ijerph20032273_215_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:14:52,214 - DEBUG - Snippet 10.3390_ijerph20032273_215_item_0 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:14:52,298 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:52,326 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:52,573 - DEBUG - [Page 16] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:52,574 - DEBUG - Finished converting page batch time=3621.433
2025-06-10 20:14:52,742 - DEBUG - Creating masked image for page 3 with 23 clusters.
2025-06-10 20:14:52,743 - INFO - Masked image successfully created for page 3.
2025-06-10 20:14:52,751 - INFO - Starting prediction for 5 images with labels: ['formula', 'formula', 'formula', 'formula', 'formula']
2025-06-10 20:14:52,752 - DEBUG - Generating chat message for label: formula
2025-06-10 20:14:52,752 - DEBUG - Snippet 10.1007_s00477-023-02476-3_198_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:14:52,820 - DEBUG - Snippet 10.1007_s00477-023-02476-3_198_item_0 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:14:52,940 - DEBUG - Snippet 10.1038_s41598-024-65584-2_157_item_3: generation shape=torch.Size([1, 390])
2025-06-10 20:14:52,940 - DEBUG - Snippet 10.1038_s41598-024-65584-2_157_item_3 raw docling: (tokens=44)
<formula><loc_0><loc_0><loc_500><loc_500>\Delta M o r t a l i t y = E R \times P O P \times Y _ { b }</formula><end_of_utterance>
2025-06-10 20:14:52,941 - DEBUG - Starting _parse_docling_output
2025-06-10 20:14:52,941 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>\Delta M o r t a l i t y = E R \times P O P \times Y _ { b }</formula><end_of_utterance>
2025-06-10 20:14:52,941 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:14:52,941 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>\\Delta M o r t a l i t y = E R \\times P O P \\times Y _ { b }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=752x54 at 0x7F9712A2A900>)]
2025-06-10 20:14:52,941 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:14:52,943 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=752.0, b=54.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 60))], orig='\\Delta M o r t a l i t y = E R \\times P O P \\times Y _ { b }', text='\\Delta M o r t a l i t y = E R \\times P O P \\times Y _ { b }', formatting=None, hyperlink=None)]
2025-06-10 20:14:52,944 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:14:52,944 - DEBUG - Processing text item: label=formula, text=\Delta M o r t a l i t y = E R \times P O P \times Y _ { b }
2025-06-10 20:14:52,944 - DEBUG - Recognized string extracted: \Delta M o r t a l i t y = E R \times P O P \times Y _ { b }
2025-06-10 20:14:52,944 - INFO - All done. Returning 4 recognized text results.
2025-06-10 20:14:52,944 - DEBUG - Snippet 10.1038_s41598-024-65584-2_157_item_0 recognized text:
N H A Q I _ { i } = \frac { ( A Q I _ { i , j } - A Q I _ { i , j - 1 } ) } { ( C _ { i , j } - C _ { i , j - 1 } ) } \times ( C _ { i , m } ^ { * } - C _ { i , j - 1 } ) + A Q I _ { i , j - 1 } , j > 1
2025-06-10 20:14:52,944 - DEBUG - Snippet 10.1038_s41598-024-65584-2_157_item_1 recognized text:
N H A Q I _ { i } = A Q I _ { i , 1 } \times \frac { C _ { i , m } ^ { * } } { C _ { i , 1 } } , j = 1
2025-06-10 20:14:52,945 - DEBUG - Snippet 10.1038_s41598-024-65584-2_157_item_2 recognized text:
N H A Q I = \max \{ N H A Q I _ { 1 } , N H A Q I _ { 2 } , \dots , N H A Q I _ { n } \} , n = 1 , 2 , \dots , 6
2025-06-10 20:14:52,945 - DEBUG - Snippet 10.1038_s41598-024-65584-2_157_item_3 recognized text:
\Delta M o r t a l i t y = E R \times P O P \times Y _ { b }
2025-06-10 20:14:52,998 - DEBUG - [Page 14] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:53,072 - INFO - Finished converting document 10.1038_s41598-024-65584-2_157.pdf in 48.86 sec.
2025-06-10 20:14:53,187 - INFO - Extraction successful row 32, tokens=16455
2025-06-10 20:14:53,213 - INFO - Going to convert document batch...
2025-06-10 20:14:53,213 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:14:53,214 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:14:53,234 - DEBUG - Snippet 10.3390_ijerph20043517_210_item_1: generation shape=torch.Size([1, 392])
2025-06-10 20:14:53,235 - DEBUG - Snippet 10.3390_ijerph20043517_210_item_1 raw docling: (tokens=46)
<formula><loc_0><loc_0><loc_500><loc_500>S R = \sum _ { n } ^ { i } x _ { i } \cdot M I R _ { i }</formula><end_of_utterance>
2025-06-10 20:14:53,235 - DEBUG - Starting _parse_docling_output
2025-06-10 20:14:53,235 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>S R = \sum _ { n } ^ { i } x _ { i } \cdot M I R _ { i }</formula><end_of_utterance>
2025-06-10 20:14:53,236 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:14:53,236 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>S R = \\sum _ { n } ^ { i } x _ { i } \\cdot M I R _ { i }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=684x137 at 0x7F96CAC58DA0>)]
2025-06-10 20:14:53,236 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:14:53,239 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=684.0, b=137.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 56))], orig='S R = \\sum _ { n } ^ { i } x _ { i } \\cdot M I R _ { i }', text='S R = \\sum _ { n } ^ { i } x _ { i } \\cdot M I R _ { i }', formatting=None, hyperlink=None)]
2025-06-10 20:14:53,239 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:14:53,240 - DEBUG - Processing text item: label=formula, text=S R = \sum _ { n } ^ { i } x _ { i } \cdot M I R _ { i }
2025-06-10 20:14:53,240 - DEBUG - Recognized string extracted: S R = \sum _ { n } ^ { i } x _ { i } \cdot M I R _ { i }
2025-06-10 20:14:53,240 - DEBUG - Generating chat message for label: formula
2025-06-10 20:14:53,240 - DEBUG - Snippet 10.3390_ijerph20043517_210_item_2 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:14:53,262 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:14:53,304 - DEBUG - Snippet 10.3390_ijerph20043517_210_item_2 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:14:53,461 - DEBUG - Dynamic vertical threshold: 50.61600000000001, Overlap threshold: 0.7
2025-06-10 20:14:53,461 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:53,632 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:53,819 - DEBUG - Snippet 10.3390_toxics11060481_197_item_2: generation shape=torch.Size([1, 397])
2025-06-10 20:14:53,820 - DEBUG - Snippet 10.3390_toxics11060481_197_item_2 raw docling: (tokens=51)
<formula><loc_0><loc_0><loc_500><loc_500>M = Y _ { 0 } \times P o p \times \frac { \Lambda \Lambda - 1 } { R R }</formula><end_of_utterance>
2025-06-10 20:14:53,820 - DEBUG - Starting _parse_docling_output
2025-06-10 20:14:53,820 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>M = Y _ { 0 } \times P o p \times \frac { \Lambda \Lambda - 1 } { R R }</formula><end_of_utterance>
2025-06-10 20:14:53,820 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:14:53,821 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>M = Y _ { 0 } \\times P o p \\times \\frac { \\Lambda \\Lambda - 1 } { R R }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=1334x131 at 0x7F96D8FA2930>)]
2025-06-10 20:14:53,821 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:14:53,826 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=1334.0, b=131.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 71))], orig='M = Y _ { 0 } \\times P o p \\times \\frac { \\Lambda \\Lambda - 1 } { R R }', text='M = Y _ { 0 } \\times P o p \\times \\frac { \\Lambda \\Lambda - 1 } { R R }', formatting=None, hyperlink=None)]
2025-06-10 20:14:53,826 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:14:53,826 - DEBUG - Processing text item: label=formula, text=M = Y _ { 0 } \times P o p \times \frac { \Lambda \Lambda - 1 } { R R }
2025-06-10 20:14:53,826 - DEBUG - Recognized string extracted: M = Y _ { 0 } \times P o p \times \frac { \Lambda \Lambda - 1 } { R R }
2025-06-10 20:14:53,826 - INFO - All done. Returning 3 recognized text results.
2025-06-10 20:14:53,827 - DEBUG - Snippet 10.3390_toxics11060481_197_item_0 recognized text:
, \quad , \quad ,
2025-06-10 20:14:53,827 - DEBUG - Snippet 10.3390_toxics11060481_197_item_1 recognized text:
H A Q I _ { i } = \max ( H A Q I _ { 1 } , H A Q I _ { 2 } , \dots , H A Q I _ { n } ) , \, n = 1 , \, 2 , \, \dots , \, 6 .
2025-06-10 20:14:53,827 - DEBUG - Snippet 10.3390_toxics11060481_197_item_2 recognized text:
M = Y _ { 0 } \times P o p \times \frac { \Lambda \Lambda - 1 } { R R }
2025-06-10 20:14:53,939 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:14:53,949 - INFO - Finished converting document 10.3390_toxics11060481_197.pdf in 30.01 sec.
2025-06-10 20:14:53,961 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:54,108 - INFO - Extraction successful row 39, tokens=17603
2025-06-10 20:14:54,135 - INFO - Going to convert document batch...
2025-06-10 20:14:54,135 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:14:54,135 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:14:54,192 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:14:54,224 - DEBUG - Snippet 10.1007_s00477-023-02476-3_198_item_0: generation shape=torch.Size([1, 396])
2025-06-10 20:14:54,226 - DEBUG - Snippet 10.1007_s00477-023-02476-3_198_item_0 raw docling: (tokens=50)
<formula><loc_0><loc_0><loc_500><loc_500>C _ { B T E X } = ( Q \times 1 0 ^ { 6 } ) / ( S R \times t )</formula><end_of_utterance>
2025-06-10 20:14:54,226 - DEBUG - Starting _parse_docling_output
2025-06-10 20:14:54,226 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>C _ { B T E X } = ( Q \times 1 0 ^ { 6 } ) / ( S R \times t )</formula><end_of_utterance>
2025-06-10 20:14:54,227 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:14:54,227 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>C _ { B T E X } = ( Q \\times 1 0 ^ { 6 } ) / ( S R \\times t )</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=700x63 at 0x7F96E1458A10>)]
2025-06-10 20:14:54,227 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:14:54,229 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=700.0, b=63.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 61))], orig='C _ { B T E X } = ( Q \\times 1 0 ^ { 6 } ) / ( S R \\times t )', text='C _ { B T E X } = ( Q \\times 1 0 ^ { 6 } ) / ( S R \\times t )', formatting=None, hyperlink=None)]
2025-06-10 20:14:54,229 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:14:54,230 - DEBUG - Processing text item: label=formula, text=C _ { B T E X } = ( Q \times 1 0 ^ { 6 } ) / ( S R \times t )
2025-06-10 20:14:54,230 - DEBUG - Recognized string extracted: C _ { B T E X } = ( Q \times 1 0 ^ { 6 } ) / ( S R \times t )
2025-06-10 20:14:54,230 - DEBUG - Generating chat message for label: formula
2025-06-10 20:14:54,230 - DEBUG - Snippet 10.1007_s00477-023-02476-3_198_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:14:54,302 - DEBUG - Snippet 10.1007_s00477-023-02476-3_198_item_1 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:14:54,351 - DEBUG - [Page 15] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:54,351 - DEBUG - Finished converting page batch time=3623.210
2025-06-10 20:14:54,370 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:54,594 - DEBUG - Snippet 10.3390_ijerph20032273_215_item_0: generation shape=torch.Size([1, 406])
2025-06-10 20:14:54,595 - DEBUG - Snippet 10.3390_ijerph20032273_215_item_0 raw docling: (tokens=60)
<formula><loc_0><loc_0><loc_500><loc_500>\psi _ { a , b } ( t ) = | a | ^ { - 1 / 2 } \psi \left ( \frac { t - b } { a } \right )</formula><end_of_utterance>
2025-06-10 20:14:54,595 - DEBUG - Starting _parse_docling_output
2025-06-10 20:14:54,595 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>\psi _ { a , b } ( t ) = | a | ^ { - 1 / 2 } \psi \left ( \frac { t - b } { a } \right )</formula><end_of_utterance>
2025-06-10 20:14:54,595 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:14:54,595 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>\\psi _ { a , b } ( t ) = | a | ^ { - 1 / 2 } \\psi \\left ( \\frac { t - b } { a } \\right )</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=1166x131 at 0x7F96D5F1F320>)]
2025-06-10 20:14:54,596 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:14:54,606 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=1166.0, b=131.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 88))], orig='\\psi _ { a , b } ( t ) = | a | ^ { - 1 / 2 } \\psi \\left ( \\frac { t - b } { a } \\right )', text='\\psi _ { a , b } ( t ) = | a | ^ { - 1 / 2 } \\psi \\left ( \\frac { t - b } { a } \\right )', formatting=None, hyperlink=None)]
2025-06-10 20:14:54,607 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:14:54,607 - DEBUG - Processing text item: label=formula, text=\psi _ { a , b } ( t ) = | a | ^ { - 1 / 2 } \psi \left ( \frac { t - b } { a } \right )
2025-06-10 20:14:54,607 - DEBUG - Recognized string extracted: \psi _ { a , b } ( t ) = | a | ^ { - 1 / 2 } \psi \left ( \frac { t - b } { a } \right )
2025-06-10 20:14:54,607 - DEBUG - Generating chat message for label: formula
2025-06-10 20:14:54,607 - DEBUG - Snippet 10.3390_ijerph20032273_215_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:14:54,681 - DEBUG - Snippet 10.3390_ijerph20043517_210_item_2: generation shape=torch.Size([1, 388])
2025-06-10 20:14:54,682 - DEBUG - Snippet 10.3390_ijerph20043517_210_item_2 raw docling: (tokens=42)
<formula><loc_0><loc_0><loc_500><loc_500>S O A _ { i } = F A C \times [ V O C s ] _ { i }</formula><end_of_utterance>
2025-06-10 20:14:54,682 - DEBUG - Starting _parse_docling_output
2025-06-10 20:14:54,682 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>S O A _ { i } = F A C \times [ V O C s ] _ { i }</formula><end_of_utterance>
2025-06-10 20:14:54,682 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:14:54,682 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>S O A _ { i } = F A C \\times [ V O C s ] _ { i }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=733x68 at 0x7F96D24976E0>)]
2025-06-10 20:14:54,683 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:14:54,685 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=733.0, b=68.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 48))], orig='S O A _ { i } = F A C \\times [ V O C s ] _ { i }', text='S O A _ { i } = F A C \\times [ V O C s ] _ { i }', formatting=None, hyperlink=None)]
2025-06-10 20:14:54,685 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:14:54,685 - DEBUG - Processing text item: label=formula, text=S O A _ { i } = F A C \times [ V O C s ] _ { i }
2025-06-10 20:14:54,686 - DEBUG - Recognized string extracted: S O A _ { i } = F A C \times [ V O C s ] _ { i }
2025-06-10 20:14:54,686 - DEBUG - Generating chat message for label: formula
2025-06-10 20:14:54,686 - DEBUG - Snippet 10.3390_ijerph20043517_210_item_3 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:14:54,702 - DEBUG - Snippet 10.3390_ijerph20032273_215_item_1 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:14:54,755 - DEBUG - Snippet 10.3390_ijerph20043517_210_item_3 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:14:54,773 - DEBUG - Finished converting page batch time=3623.632
2025-06-10 20:14:55,129 - DEBUG - [Page 16] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:55,216 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:14:55,254 - DEBUG - [Page 17] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:55,264 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:14:55,270 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:14:55,507 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:55,695 - DEBUG - [Page 18] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:55,940 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:14:55,940 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:14:55,940 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:14:55,951 - DEBUG - [Page 19] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:55,951 - DEBUG - Finished converting page batch time=3624.810
2025-06-10 20:14:55,976 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:14:56,014 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:14:56,048 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:14:56,052 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:14:56,054 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:14:56,118 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:14:56,155 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:14:56,202 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:14:56,209 - DEBUG - [Page 20] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:56,351 - DEBUG - Snippet 10.1007_s00477-023-02476-3_198_item_1: generation shape=torch.Size([1, 412])
2025-06-10 20:14:56,352 - DEBUG - Snippet 10.1007_s00477-023-02476-3_198_item_1 raw docling: (tokens=66)
<formula><loc_0><loc_0><loc_500><loc_500>O F P = C _ { B T E X } ( \mu g / m ^ { \prime } ) \times M I R ( g O _ { 3 } / g V O C _ { S } )</formula><end_of_utterance>
2025-06-10 20:14:56,352 - DEBUG - Starting _parse_docling_output
2025-06-10 20:14:56,352 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>O F P = C _ { B T E X } ( \mu g / m ^ { \prime } ) \times M I R ( g O _ { 3 } / g V O C _ { S } )</formula><end_of_utterance>
2025-06-10 20:14:56,352 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:14:56,352 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>O F P = C _ { B T E X } ( \\mu g / m ^ { \\prime } ) \\times M I R ( g O _ { 3 } / g V O C _ { S } )</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=700x64 at 0x7F96E1459100>)]
2025-06-10 20:14:56,353 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:14:56,355 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=700.0, b=64.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 97))], orig='O F P = C _ { B T E X } ( \\mu g / m ^ { \\prime } ) \\times M I R ( g O _ { 3 } / g V O C _ { S } )', text='O F P = C _ { B T E X } ( \\mu g / m ^ { \\prime } ) \\times M I R ( g O _ { 3 } / g V O C _ { S } )', formatting=None, hyperlink=None)]
2025-06-10 20:14:56,355 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:14:56,356 - DEBUG - Processing text item: label=formula, text=O F P = C _ { B T E X } ( \mu g / m ^ { \prime } ) \times M I R ( g O _ { 3 } / g V O C _ { S } )
2025-06-10 20:14:56,356 - DEBUG - Recognized string extracted: O F P = C _ { B T E X } ( \mu g / m ^ { \prime } ) \times M I R ( g O _ { 3 } / g V O C _ { S } )
2025-06-10 20:14:56,356 - DEBUG - Generating chat message for label: formula
2025-06-10 20:14:56,356 - DEBUG - Snippet 10.1007_s00477-023-02476-3_198_item_2 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:14:56,381 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:14:56,421 - DEBUG - Snippet 10.1007_s00477-023-02476-3_198_item_2 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:14:56,434 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:14:56,472 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:14:56,531 - DEBUG - [Page 21] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:56,640 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:14:56,753 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:14:56,753 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:14:56,754 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:14:56,789 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:14:56,832 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:14:56,844 - DEBUG - [Page 22] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:56,860 - DEBUG - Finished converting page batch time=3625.719
2025-06-10 20:14:56,871 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:14:56,911 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:14:56,927 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:14:56,947 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:14:56,984 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:14:57,001 - DEBUG - Snippet 10.3390_ijerph20032273_215_item_1: generation shape=torch.Size([1, 423])
2025-06-10 20:14:57,002 - DEBUG - Snippet 10.3390_ijerph20032273_215_item_1 raw docling: (tokens=77)
<formula><loc_0><loc_0><loc_500><loc_500>W _ { f } ( a , b ) = | a | ^ { - 1 / 2 } \int _ { R } f ( t ) \overline { \psi } \left ( \frac { t - b } { a } \right ) d t</formula><end_of_utterance>
2025-06-10 20:14:57,006 - DEBUG - Starting _parse_docling_output
2025-06-10 20:14:57,006 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>W _ { f } ( a , b ) = | a | ^ { - 1 / 2 } \int _ { R } f ( t ) \overline { \psi } \left ( \frac { t - b } { a } \right ) d t</formula><end_of_utterance>
2025-06-10 20:14:57,006 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:14:57,006 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>W _ { f } ( a , b ) = | a | ^ { - 1 / 2 } \\int _ { R } f ( t ) \\overline { \\psi } \\left ( \\frac { t - b } { a } \\right ) d t</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=824x120 at 0x7F96DE228800>)]
2025-06-10 20:14:57,007 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:14:57,011 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=824.0, b=120.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 124))], orig='W _ { f } ( a , b ) = | a | ^ { - 1 / 2 } \\int _ { R } f ( t ) \\overline { \\psi } \\left ( \\frac { t - b } { a } \\right ) d t', text='W _ { f } ( a , b ) = | a | ^ { - 1 / 2 } \\int _ { R } f ( t ) \\overline { \\psi } \\left ( \\frac { t - b } { a } \\right ) d t', formatting=None, hyperlink=None)]
2025-06-10 20:14:57,011 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:14:57,011 - DEBUG - Processing text item: label=formula, text=W _ { f } ( a , b ) = | a | ^ { - 1 / 2 } \int _ { R } f ( t ) \overline { \psi } \left ( \frac { t - b } { a } \right ) d t
2025-06-10 20:14:57,011 - DEBUG - Recognized string extracted: W _ { f } ( a , b ) = | a | ^ { - 1 / 2 } \int _ { R } f ( t ) \overline { \psi } \left ( \frac { t - b } { a } \right ) d t
2025-06-10 20:14:57,012 - DEBUG - Generating chat message for label: formula
2025-06-10 20:14:57,012 - DEBUG - Snippet 10.3390_ijerph20032273_215_item_2 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:14:57,063 - DEBUG - Snippet 10.3390_ijerph20043517_210_item_3: generation shape=torch.Size([1, 428])
2025-06-10 20:14:57,064 - DEBUG - Snippet 10.3390_ijerph20043517_210_item_3 raw docling: (tokens=82)
<formula><loc_0><loc_0><loc_500><loc_500>H I = \frac { ( C _ { i } \times E T \times E F \times E D ) } { 3 6 5 \times A T _ { n c a } \times 2 4 } \times \frac { 1 } { R F C }</formula><end_of_utterance>
2025-06-10 20:14:57,064 - DEBUG - Starting _parse_docling_output
2025-06-10 20:14:57,064 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>H I = \frac { ( C _ { i } \times E T \times E F \times E D ) } { 3 6 5 \times A T _ { n c a } \times 2 4 } \times \frac { 1 } { R F C }</formula><end_of_utterance>
2025-06-10 20:14:57,065 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:14:57,065 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>H I = \\frac { ( C _ { i } \\times E T \\times E F \\times E D ) } { 3 6 5 \\times A T _ { n c a } \\times 2 4 } \\times \\frac { 1 } { R F C }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=802x120 at 0x7F96D24969F0>)]
2025-06-10 20:14:57,065 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:14:57,069 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=802.0, b=120.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 135))], orig='H I = \\frac { ( C _ { i } \\times E T \\times E F \\times E D ) } { 3 6 5 \\times A T _ { n c a } \\times 2 4 } \\times \\frac { 1 } { R F C }', text='H I = \\frac { ( C _ { i } \\times E T \\times E F \\times E D ) } { 3 6 5 \\times A T _ { n c a } \\times 2 4 } \\times \\frac { 1 } { R F C }', formatting=None, hyperlink=None)]
2025-06-10 20:14:57,069 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:14:57,069 - DEBUG - Processing text item: label=formula, text=H I = \frac { ( C _ { i } \times E T \times E F \times E D ) } { 3 6 5 \times A T _ { n c a } \times 2 4 } \times \frac { 1 } { R F C }
2025-06-10 20:14:57,070 - DEBUG - Recognized string extracted: H I = \frac { ( C _ { i } \times E T \times E F \times E D ) } { 3 6 5 \times A T _ { n c a } \times 2 4 } \times \frac { 1 } { R F C }
2025-06-10 20:14:57,070 - INFO - All done. Returning 4 recognized text results.
2025-06-10 20:14:57,070 - DEBUG - Snippet 10.3390_ijerph20043517_210_item_0 recognized text:
U \dot { I } ^ { \mathcal { I } } _ { i } = M \mathbb { K } \times [ V \mathcal { U } \mathcal { I } ^ { s } ] _ { i }
2025-06-10 20:14:57,070 - DEBUG - Snippet 10.3390_ijerph20043517_210_item_1 recognized text:
S R = \sum _ { n } ^ { i } x _ { i } \cdot M I R _ { i }
2025-06-10 20:14:57,071 - DEBUG - Snippet 10.3390_ijerph20043517_210_item_2 recognized text:
S O A _ { i } = F A C \times [ V O C s ] _ { i }
2025-06-10 20:14:57,071 - DEBUG - Snippet 10.3390_ijerph20043517_210_item_3 recognized text:
H I = \frac { ( C _ { i } \times E T \times E F \times E D ) } { 3 6 5 \times A T _ { n c a } \times 2 4 } \times \frac { 1 } { R F C }
2025-06-10 20:14:57,087 - DEBUG - Snippet 10.3390_ijerph20032273_215_item_2 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:14:57,120 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:14:57,137 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:14:57,137 - INFO - Processing document 10.1136_bmj.h1295_242.pdf
2025-06-10 20:14:57,157 - DEBUG - [Page 23] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:57,158 - DEBUG - Finished converting page batch time=3626.017
2025-06-10 20:14:57,162 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:14:57,184 - INFO - Finished converting document 10.3390_ijerph20043517_210.pdf in 21.88 sec.
2025-06-10 20:14:57,201 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:14:57,309 - INFO - Extraction successful row 43, tokens=15901
2025-06-10 20:14:57,328 - INFO - Going to convert document batch...
2025-06-10 20:14:57,328 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:14:57,328 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:14:57,336 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:14:57,627 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:14:57,789 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:14:57,816 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:14:57,817 - INFO - Processing document 10.3390_ijerph14091091_238.pdf
2025-06-10 20:14:57,940 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:57,943 - DEBUG - [Page 24] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:58,265 - DEBUG - [Page 25] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:58,283 - DEBUG - Snippet 10.1007_s00477-023-02476-3_198_item_2: generation shape=torch.Size([1, 410])
2025-06-10 20:14:58,284 - DEBUG - Snippet 10.1007_s00477-023-02476-3_198_item_2 raw docling: (tokens=64)
<formula><loc_0><loc_0><loc_500><loc_500>B T E X - O H ^ { 0 } = C _ { B T E X } ( p p b ) \times R C _ { B T E X - O H ^ { 0 } }</formula><end_of_utterance>
2025-06-10 20:14:58,284 - DEBUG - Starting _parse_docling_output
2025-06-10 20:14:58,284 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>B T E X - O H ^ { 0 } = C _ { B T E X } ( p p b ) \times R C _ { B T E X - O H ^ { 0 } }</formula><end_of_utterance>
2025-06-10 20:14:58,285 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:14:58,285 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>B T E X - O H ^ { 0 } = C _ { B T E X } ( p p b ) \\times R C _ { B T E X - O H ^ { 0 } }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=701x68 at 0x7F96E1459130>)]
2025-06-10 20:14:58,285 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:14:58,288 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=701.0, b=68.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 88))], orig='B T E X - O H ^ { 0 } = C _ { B T E X } ( p p b ) \\times R C _ { B T E X - O H ^ { 0 } }', text='B T E X - O H ^ { 0 } = C _ { B T E X } ( p p b ) \\times R C _ { B T E X - O H ^ { 0 } }', formatting=None, hyperlink=None)]
2025-06-10 20:14:58,288 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:14:58,288 - DEBUG - Processing text item: label=formula, text=B T E X - O H ^ { 0 } = C _ { B T E X } ( p p b ) \times R C _ { B T E X - O H ^ { 0 } }
2025-06-10 20:14:58,288 - DEBUG - Recognized string extracted: B T E X - O H ^ { 0 } = C _ { B T E X } ( p p b ) \times R C _ { B T E X - O H ^ { 0 } }
2025-06-10 20:14:58,288 - DEBUG - Generating chat message for label: formula
2025-06-10 20:14:58,289 - DEBUG - Snippet 10.1007_s00477-023-02476-3_198_item_3 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:14:58,329 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:58,353 - DEBUG - Snippet 10.1007_s00477-023-02476-3_198_item_3 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:14:58,409 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:14:58,462 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:14:58,468 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:14:58,468 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:58,512 - DEBUG - [Page 26] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:58,512 - DEBUG - Finished converting page batch time=3627.371
2025-06-10 20:14:58,669 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:58,680 - DEBUG - Creating masked image for page 4 with 19 clusters.
2025-06-10 20:14:58,681 - INFO - Masked image successfully created for page 4.
2025-06-10 20:14:58,809 - DEBUG - Creating masked image for page 5 with 16 clusters.
2025-06-10 20:14:58,810 - INFO - Masked image successfully created for page 5.
2025-06-10 20:14:58,817 - INFO - Starting prediction for 5 images with labels: ['formula', 'formula', 'formula', 'formula', 'formula']
2025-06-10 20:14:58,817 - DEBUG - Generating chat message for label: formula
2025-06-10 20:14:58,817 - DEBUG - Snippet 10.7717_peerj.14489_219_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:14:58,897 - DEBUG - Snippet 10.3390_ijerph20032273_215_item_2: generation shape=torch.Size([1, 410])
2025-06-10 20:14:58,898 - DEBUG - Snippet 10.3390_ijerph20032273_215_item_2 raw docling: (tokens=64)
<formula><loc_0><loc_0><loc_500><loc_500>V a r ( a ) = \int _ { - \infty } ^ { \infty } \left | W _ { f } ( a , b ) \right | ^ { 2 } d b</formula><end_of_utterance>
2025-06-10 20:14:58,898 - DEBUG - Starting _parse_docling_output
2025-06-10 20:14:58,898 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>V a r ( a ) = \int _ { - \infty } ^ { \infty } \left | W _ { f } ( a , b ) \right | ^ { 2 } d b</formula><end_of_utterance>
2025-06-10 20:14:58,898 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:14:58,899 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>V a r ( a ) = \\int _ { - \\infty } ^ { \\infty } \\left | W _ { f } ( a , b ) \\right | ^ { 2 } d b</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=758x175 at 0x7F96DBE9FEC0>)]
2025-06-10 20:14:58,899 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:14:58,903 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=758.0, b=175.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 95))], orig='V a r ( a ) = \\int _ { - \\infty } ^ { \\infty } \\left | W _ { f } ( a , b ) \\right | ^ { 2 } d b', text='V a r ( a ) = \\int _ { - \\infty } ^ { \\infty } \\left | W _ { f } ( a , b ) \\right | ^ { 2 } d b', formatting=None, hyperlink=None)]
2025-06-10 20:14:58,903 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:14:58,903 - DEBUG - Processing text item: label=formula, text=V a r ( a ) = \int _ { - \infty } ^ { \infty } \left | W _ { f } ( a , b ) \right | ^ { 2 } d b
2025-06-10 20:14:58,904 - DEBUG - Recognized string extracted: V a r ( a ) = \int _ { - \infty } ^ { \infty } \left | W _ { f } ( a , b ) \right | ^ { 2 } d b
2025-06-10 20:14:58,904 - DEBUG - Generating chat message for label: formula
2025-06-10 20:14:58,904 - DEBUG - Snippet 10.3390_ijerph20032273_215_item_3 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:14:58,955 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:14:58,955 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:14:58,956 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:14:58,975 - DEBUG - Snippet 10.3390_ijerph20032273_215_item_3 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:14:58,999 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:14:59,044 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:14:59,091 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:14:59,134 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:59,140 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:14:59,146 - DEBUG - Snippet 10.7717_peerj.14489_219_item_0 => input_ids shape=torch.Size([1, 876]), prompt_len=876
2025-06-10 20:14:59,180 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:59,186 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:59,187 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:14:59,226 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:14:59,359 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:14:59,393 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:14:57,289 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:57,301 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:14:57,360 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:57,401 - DEBUG - Snippet 10.1007_s00477-023-02476-3_198_item_3: generation shape=torch.Size([1, 386])
2025-06-10 20:14:57,402 - DEBUG - Snippet 10.1007_s00477-023-02476-3_198_item_3 raw docling: (tokens=40)
<formula><loc_0><loc_0><loc_500><loc_500>E C = ( C \times E T \times E F \times E D ) / A T</formula><end_of_utterance>
2025-06-10 20:14:57,403 - DEBUG - Starting _parse_docling_output
2025-06-10 20:14:57,403 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>E C = ( C \times E T \times E F \times E D ) / A T</formula><end_of_utterance>
2025-06-10 20:14:57,403 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:14:57,403 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>E C = ( C \\times E T \\times E F \\times E D ) / A T</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=701x54 at 0x7F96E14589B0>)]
2025-06-10 20:14:57,404 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:14:57,406 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=701.0, b=54.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 50))], orig='E C = ( C \\times E T \\times E F \\times E D ) / A T', text='E C = ( C \\times E T \\times E F \\times E D ) / A T', formatting=None, hyperlink=None)]
2025-06-10 20:14:57,406 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:14:57,406 - DEBUG - Processing text item: label=formula, text=E C = ( C \times E T \times E F \times E D ) / A T
2025-06-10 20:14:57,406 - DEBUG - Recognized string extracted: E C = ( C \times E T \times E F \times E D ) / A T
2025-06-10 20:14:57,406 - DEBUG - Generating chat message for label: formula
2025-06-10 20:14:57,407 - DEBUG - Snippet 10.1007_s00477-023-02476-3_198_item_4 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:14:57,450 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:14:57,469 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:57,471 - DEBUG - Snippet 10.1007_s00477-023-02476-3_198_item_4 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:14:57,728 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:14:57,960 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:14:57,961 - INFO - Processing document 10.1016_S0140-67361360898-3_245.pdf
2025-06-10 20:14:58,066 - DEBUG - Snippet 10.7717_peerj.14489_219_item_0: generation shape=torch.Size([1, 910])
2025-06-10 20:14:58,067 - DEBUG - Snippet 10.7717_peerj.14489_219_item_0 raw docling: (tokens=33)
<formula><loc_0><loc_0><loc_500><loc_500>( \begin{matrix} 1 \end{matrix} )</formula><end_of_utterance>
2025-06-10 20:14:58,067 - DEBUG - Starting _parse_docling_output
2025-06-10 20:14:58,067 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>( \begin{matrix} 1 \end{matrix} )</formula><end_of_utterance>
2025-06-10 20:14:58,067 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:14:58,067 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>( \\begin{matrix} 1 \\end{matrix} )</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=39x56 at 0x7F96D5DB5C40>)]
2025-06-10 20:14:58,068 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:14:58,069 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=39.0, b=56.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 33))], orig='( \\begin{matrix} 1 \\end{matrix} )', text='( \\begin{matrix} 1 \\end{matrix} )', formatting=None, hyperlink=None)]
2025-06-10 20:14:58,069 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:14:58,069 - DEBUG - Processing text item: label=formula, text=( \begin{matrix} 1 \end{matrix} )
2025-06-10 20:14:58,069 - DEBUG - Recognized string extracted: ( \begin{matrix} 1 \end{matrix} )
2025-06-10 20:14:58,069 - DEBUG - Generating chat message for label: formula
2025-06-10 20:14:58,070 - DEBUG - Snippet 10.7717_peerj.14489_219_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:14:58,134 - DEBUG - Snippet 10.7717_peerj.14489_219_item_1 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:14:58,140 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:58,148 - DEBUG - Snippet 10.3390_ijerph20032273_215_item_3: generation shape=torch.Size([1, 391])
2025-06-10 20:14:58,149 - DEBUG - Snippet 10.3390_ijerph20032273_215_item_3 raw docling: (tokens=45)
<formula><loc_0><loc_0><loc_500><loc_500>R = \frac { C } { R f _ { c } } \times 1 0 ^ { 6 }</formula><end_of_utterance>
2025-06-10 20:14:58,149 - DEBUG - Starting _parse_docling_output
2025-06-10 20:14:58,149 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>R = \frac { C } { R f _ { c } } \times 1 0 ^ { 6 }</formula><end_of_utterance>
2025-06-10 20:14:58,149 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:14:58,149 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>R = \\frac { C } { R f _ { c } } \\times 1 0 ^ { 6 }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=680x113 at 0x7F96DE2ABCB0>)]
2025-06-10 20:14:58,150 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:14:58,152 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=680.0, b=113.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 50))], orig='R = \\frac { C } { R f _ { c } } \\times 1 0 ^ { 6 }', text='R = \\frac { C } { R f _ { c } } \\times 1 0 ^ { 6 }', formatting=None, hyperlink=None)]
2025-06-10 20:14:58,152 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:14:58,152 - DEBUG - Processing text item: label=formula, text=R = \frac { C } { R f _ { c } } \times 1 0 ^ { 6 }
2025-06-10 20:14:58,153 - DEBUG - Recognized string extracted: R = \frac { C } { R f _ { c } } \times 1 0 ^ { 6 }
2025-06-10 20:14:58,153 - INFO - All done. Returning 4 recognized text results.
2025-06-10 20:14:58,153 - DEBUG - Snippet 10.3390_ijerph20032273_215_item_0 recognized text:
\psi _ { a , b } ( t ) = | a | ^ { - 1 / 2 } \psi \left ( \frac { t - b } { a } \right )
2025-06-10 20:14:58,153 - DEBUG - Snippet 10.3390_ijerph20032273_215_item_1 recognized text:
W _ { f } ( a , b ) = | a | ^ { - 1 / 2 } \int _ { R } f ( t ) \overline { \psi } \left ( \frac { t - b } { a } \right ) d t
2025-06-10 20:14:58,153 - DEBUG - Snippet 10.3390_ijerph20032273_215_item_2 recognized text:
V a r ( a ) = \int _ { - \infty } ^ { \infty } \left | W _ { f } ( a , b ) \right | ^ { 2 } d b
2025-06-10 20:14:58,153 - DEBUG - Snippet 10.3390_ijerph20032273_215_item_3 recognized text:
R = \frac { C } { R f _ { c } } \times 1 0 ^ { 6 }
2025-06-10 20:14:58,190 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:58,251 - INFO - Finished converting document 10.3390_ijerph20032273_215.pdf in 22.32 sec.
2025-06-10 20:14:58,273 - DEBUG - Snippet 10.1007_s00477-023-02476-3_198_item_4: generation shape=torch.Size([1, 374])
2025-06-10 20:14:58,274 - DEBUG - Snippet 10.1007_s00477-023-02476-3_198_item_4 raw docling: (tokens=28)
<formula><loc_0><loc_0><loc_500><loc_500>H Q = E C / R f C</formula><end_of_utterance>
2025-06-10 20:14:58,275 - DEBUG - Starting _parse_docling_output
2025-06-10 20:14:58,275 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>H Q = E C / R f C</formula><end_of_utterance>
2025-06-10 20:14:58,275 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:14:58,275 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>H Q = E C / R f C</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=701x54 at 0x7F96E14A7CB0>)]
2025-06-10 20:14:58,276 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:14:58,277 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=701.0, b=54.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 17))], orig='H Q = E C / R f C', text='H Q = E C / R f C', formatting=None, hyperlink=None)]
2025-06-10 20:14:58,278 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:14:58,278 - DEBUG - Processing text item: label=formula, text=H Q = E C / R f C
2025-06-10 20:14:58,278 - DEBUG - Recognized string extracted: H Q = E C / R f C
2025-06-10 20:14:58,278 - INFO - All done. Returning 5 recognized text results.
2025-06-10 20:14:58,278 - DEBUG - Snippet 10.1007_s00477-023-02476-3_198_item_0 recognized text:
C _ { B T E X } = ( Q \times 1 0 ^ { 6 } ) / ( S R \times t )
2025-06-10 20:14:58,278 - DEBUG - Snippet 10.1007_s00477-023-02476-3_198_item_1 recognized text:
O F P = C _ { B T E X } ( \mu g / m ^ { \prime } ) \times M I R ( g O _ { 3 } / g V O C _ { S } )
2025-06-10 20:14:58,279 - DEBUG - Snippet 10.1007_s00477-023-02476-3_198_item_2 recognized text:
B T E X - O H ^ { 0 } = C _ { B T E X } ( p p b ) \times R C _ { B T E X - O H ^ { 0 } }
2025-06-10 20:14:58,279 - DEBUG - Snippet 10.1007_s00477-023-02476-3_198_item_3 recognized text:
E C = ( C \times E T \times E F \times E D ) / A T
2025-06-10 20:14:58,279 - DEBUG - Snippet 10.1007_s00477-023-02476-3_198_item_4 recognized text:
H Q = E C / R f C
2025-06-10 20:14:58,296 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:58,297 - DEBUG - Finished converting page batch time=3629.288
2025-06-10 20:14:58,375 - DEBUG - Creating masked image for page 4 with 17 clusters.
2025-06-10 20:14:58,376 - INFO - Masked image successfully created for page 4.
2025-06-10 20:14:58,383 - INFO - Starting prediction for 2 images with labels: ['formula', 'formula']
2025-06-10 20:14:58,384 - DEBUG - Generating chat message for label: formula
2025-06-10 20:14:58,384 - DEBUG - Snippet 10.1007_s00477-023-02476-3_198_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:14:58,387 - INFO - Extraction successful row 44, tokens=12994
2025-06-10 20:14:58,393 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:58,394 - DEBUG - Finished converting page batch time=3629.385
2025-06-10 20:14:58,410 - INFO - Going to convert document batch...
2025-06-10 20:14:58,411 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:14:58,411 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:14:58,450 - DEBUG - Snippet 10.1007_s00477-023-02476-3_198_item_0 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:14:58,464 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:14:58,655 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:58,702 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:58,704 - DEBUG - Finished converting page batch time=3629.695
2025-06-10 20:14:58,823 - DEBUG - Snippet 10.7717_peerj.14489_219_item_1: generation shape=torch.Size([1, 369])
2025-06-10 20:14:58,823 - DEBUG - Snippet 10.7717_peerj.14489_219_item_1 raw docling: (tokens=23)
<formula><loc_0><loc_0><loc_500><loc_500>\times A T )</formula><end_of_utterance>
2025-06-10 20:14:58,824 - DEBUG - Starting _parse_docling_output
2025-06-10 20:14:58,824 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>\times A T )</formula><end_of_utterance>
2025-06-10 20:14:58,824 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:14:58,824 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>\\times A T )</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=1087x56 at 0x7F96D5E0D2B0>)]
2025-06-10 20:14:58,824 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:14:58,827 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=1087.0, b=56.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 12))], orig='\\times A T )', text='\\times A T )', formatting=None, hyperlink=None)]
2025-06-10 20:14:58,827 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:14:58,827 - DEBUG - Processing text item: label=formula, text=\times A T )
2025-06-10 20:14:58,827 - DEBUG - Recognized string extracted: \times A T )
2025-06-10 20:14:58,827 - DEBUG - Generating chat message for label: formula
2025-06-10 20:14:58,828 - DEBUG - Snippet 10.7717_peerj.14489_219_item_2 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:14:58,893 - DEBUG - Snippet 10.7717_peerj.14489_219_item_2 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:14:58,901 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:59,018 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:59,277 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:59,278 - DEBUG - Finished converting page batch time=3630.269
2025-06-10 20:14:59,318 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:14:59,321 - DEBUG - Snippet 10.1007_s00477-023-02476-3_198_item_0: generation shape=torch.Size([1, 375])
2025-06-10 20:14:59,322 - DEBUG - Snippet 10.1007_s00477-023-02476-3_198_item_0 raw docling: (tokens=29)
<formula><loc_0><loc_0><loc_500><loc_500>C R = E C \times I U R</formula><end_of_utterance>
2025-06-10 20:14:59,322 - DEBUG - Starting _parse_docling_output
2025-06-10 20:14:59,322 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>C R = E C \times I U R</formula><end_of_utterance>
2025-06-10 20:14:59,323 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:14:59,323 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>C R = E C \\times I U R</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=701x54 at 0x7F96E1459370>)]
2025-06-10 20:14:59,323 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:14:59,325 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=701.0, b=54.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 22))], orig='C R = E C \\times I U R', text='C R = E C \\times I U R', formatting=None, hyperlink=None)]
2025-06-10 20:14:59,325 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:14:59,325 - DEBUG - Processing text item: label=formula, text=C R = E C \times I U R
2025-06-10 20:14:59,326 - DEBUG - Recognized string extracted: C R = E C \times I U R
2025-06-10 20:14:59,326 - DEBUG - Generating chat message for label: formula
2025-06-10 20:14:59,326 - DEBUG - Snippet 10.1007_s00477-023-02476-3_198_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:14:59,364 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:14:59,370 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:14:59,400 - DEBUG - Snippet 10.1007_s00477-023-02476-3_198_item_1 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:14:59,497 - DEBUG - Snippet 10.7717_peerj.14489_219_item_2: generation shape=torch.Size([1, 367])
2025-06-10 20:14:59,498 - DEBUG - Snippet 10.7717_peerj.14489_219_item_2 raw docling: (tokens=21)
<formula><loc_0><loc_0><loc_500><loc_500>D E</formula><end_of_utterance>
2025-06-10 20:14:59,504 - DEBUG - Starting _parse_docling_output
2025-06-10 20:14:59,505 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>D E</formula><end_of_utterance>
2025-06-10 20:14:59,505 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:14:59,505 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>D E</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=679x56 at 0x7F96D5DB5BE0>)]
2025-06-10 20:14:59,505 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:14:59,507 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=679.0, b=56.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 3))], orig='D E', text='D E', formatting=None, hyperlink=None)]
2025-06-10 20:14:59,511 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:14:59,511 - DEBUG - Processing text item: label=formula, text=D E
2025-06-10 20:14:59,512 - DEBUG - Recognized string extracted: D E
2025-06-10 20:14:59,512 - DEBUG - Generating chat message for label: formula
2025-06-10 20:14:59,512 - DEBUG - Snippet 10.7717_peerj.14489_219_item_3 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:14:59,581 - DEBUG - Snippet 10.7717_peerj.14489_219_item_3 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:14:59,718 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:59,731 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:14:59,732 - DEBUG - Finished converting page batch time=3630.723
2025-06-10 20:14:59,854 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:14:59,855 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:14:59,855 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:14:59,875 - INFO - Finished converting document 10.1186_s12989-018-0275-z_237.pdf in 15.00 sec.
2025-06-10 20:14:59,890 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:14:59,929 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:14:59,953 - INFO - Extraction successful row 47, tokens=13243
2025-06-10 20:14:59,971 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:14:59,975 - INFO - Going to convert document batch...
2025-06-10 20:14:59,975 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:14:59,976 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:15:00,009 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:15:00,032 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:15:00,047 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:15:00,066 - DEBUG - Dynamic vertical threshold: 38.56859999999999, Overlap threshold: 0.7
2025-06-10 20:15:00,066 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:00,091 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:15:00,221 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:15:00,263 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:15:00,305 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:15:00,457 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:15:00,520 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:00,725 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:00,740 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:15:00,753 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:15:00,797 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:15:00,803 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:15:00,820 - DEBUG - Snippet 10.1007_s00477-023-02476-3_198_item_1: generation shape=torch.Size([1, 393])
2025-06-10 20:15:00,821 - DEBUG - Snippet 10.1007_s00477-023-02476-3_198_item_1 raw docling: (tokens=47)
<formula><loc_0><loc_0><loc_500><loc_500>W _ { E } = \sum _ { i } ^ { j } C _ { i j } P _ { i j }</formula><end_of_utterance>
2025-06-10 20:15:00,825 - DEBUG - Starting _parse_docling_output
2025-06-10 20:15:00,826 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>W _ { E } = \sum _ { i } ^ { j } C _ { i j } P _ { i j }</formula><end_of_utterance>
2025-06-10 20:15:00,826 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:15:00,826 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>W _ { E } = \\sum _ { i } ^ { j } C _ { i j } P _ { i j }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=700x147 at 0x7F96E1458E00>)]
2025-06-10 20:15:00,826 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:15:00,829 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=700.0, b=147.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 56))], orig='W _ { E } = \\sum _ { i } ^ { j } C _ { i j } P _ { i j }', text='W _ { E } = \\sum _ { i } ^ { j } C _ { i j } P _ { i j }', formatting=None, hyperlink=None)]
2025-06-10 20:15:00,830 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:15:00,830 - DEBUG - Processing text item: label=formula, text=W _ { E } = \sum _ { i } ^ { j } C _ { i j } P _ { i j }
2025-06-10 20:15:00,830 - DEBUG - Recognized string extracted: W _ { E } = \sum _ { i } ^ { j } C _ { i j } P _ { i j }
2025-06-10 20:15:00,830 - INFO - All done. Returning 2 recognized text results.
2025-06-10 20:15:00,830 - DEBUG - Snippet 10.1007_s00477-023-02476-3_198_item_0 recognized text:
C R = E C \times I U R
2025-06-10 20:15:00,831 - DEBUG - Snippet 10.1007_s00477-023-02476-3_198_item_1 recognized text:
W _ { E } = \sum _ { i } ^ { j } C _ { i j } P _ { i j }
2025-06-10 20:15:00,926 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:15:00,926 - INFO - Processing document 10.1186_1476-069X-12-28_248.pdf
2025-06-10 20:15:00,944 - INFO - Finished converting document 10.1007_s00477-023-02476-3_198.pdf in 37.10 sec.
2025-06-10 20:15:01,110 - DEBUG - Snippet 10.7717_peerj.14489_219_item_3: generation shape=torch.Size([1, 401])
2025-06-10 20:15:01,111 - DEBUG - Snippet 10.7717_peerj.14489_219_item_3 raw docling: (tokens=55)
<formula><loc_0><loc_0><loc_500><loc_500>A D D \, i n h = \frac { C \times I n h R \times E F \times E D } { B W \times A T }</formula><end_of_utterance>
2025-06-10 20:15:01,117 - INFO - Extraction successful row 40, tokens=29014
2025-06-10 20:15:01,117 - DEBUG - Starting _parse_docling_output
2025-06-10 20:15:01,118 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>A D D \, i n h = \frac { C \times I n h R \times E F \times E D } { B W \times A T }</formula><end_of_utterance>
2025-06-10 20:15:01,118 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:15:01,120 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>A D D \\, i n h = \\frac { C \\times I n h R \\times E F \\times E D } { B W \\times A T }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=1159x90 at 0x7F96D5DB5D60>)]
2025-06-10 20:15:01,121 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:15:01,125 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=1159.0, b=90.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 84))], orig='A D D \\, i n h = \\frac { C \\times I n h R \\times E F \\times E D } { B W \\times A T }', text='A D D \\, i n h = \\frac { C \\times I n h R \\times E F \\times E D } { B W \\times A T }', formatting=None, hyperlink=None)]
2025-06-10 20:15:01,125 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:15:01,125 - DEBUG - Processing text item: label=formula, text=A D D \, i n h = \frac { C \times I n h R \times E F \times E D } { B W \times A T }
2025-06-10 20:15:01,126 - DEBUG - Recognized string extracted: A D D \, i n h = \frac { C \times I n h R \times E F \times E D } { B W \times A T }
2025-06-10 20:15:01,126 - DEBUG - Generating chat message for label: formula
2025-06-10 20:15:01,126 - DEBUG - Snippet 10.7717_peerj.14489_219_item_4 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:15:01,137 - INFO - Going to convert document batch...
2025-06-10 20:15:01,142 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:15:01,150 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:15:01,220 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:15:01,298 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:01,310 - DEBUG - Snippet 10.7717_peerj.14489_219_item_4 => input_ids shape=torch.Size([1, 610]), prompt_len=610
2025-06-10 20:15:01,423 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:01,471 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:15:01,472 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:15:01,472 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:15:01,487 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:01,543 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:15:01,589 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:15:01,627 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:15:01,667 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:15:01,712 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:15:01,749 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:15:01,826 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:01,883 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:15:01,902 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:15:01,931 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:15:01,966 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:15:01,969 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:15:01,972 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:15:02,066 - DEBUG - Snippet 10.7717_peerj.14489_219_item_4: generation shape=torch.Size([1, 636])
2025-06-10 20:15:02,067 - DEBUG - Snippet 10.7717_peerj.14489_219_item_4 raw docling: (tokens=25)
<formula><loc_0><loc_0><loc_500><loc_500>B W \times A T</formula><end_of_utterance>
2025-06-10 20:15:02,067 - DEBUG - Starting _parse_docling_output
2025-06-10 20:15:02,067 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>B W \times A T</formula><end_of_utterance>
2025-06-10 20:15:02,068 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:15:02,068 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>B W \\times A T</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=121x56 at 0x7F96D5DB54F0>)]
2025-06-10 20:15:02,068 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:15:02,069 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=121.0, b=56.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 14))], orig='B W \\times A T', text='B W \\times A T', formatting=None, hyperlink=None)]
2025-06-10 20:15:02,069 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:15:02,069 - DEBUG - Processing text item: label=formula, text=B W \times A T
2025-06-10 20:15:02,070 - DEBUG - Recognized string extracted: B W \times A T
2025-06-10 20:15:02,070 - INFO - All done. Returning 5 recognized text results.
2025-06-10 20:15:02,070 - DEBUG - Snippet 10.7717_peerj.14489_219_item_0 recognized text:
( \begin{matrix} 1 \end{matrix} )
2025-06-10 20:15:02,070 - DEBUG - Snippet 10.7717_peerj.14489_219_item_1 recognized text:
\times A T )
2025-06-10 20:15:02,071 - DEBUG - Snippet 10.7717_peerj.14489_219_item_2 recognized text:
D E
2025-06-10 20:15:02,071 - DEBUG - Snippet 10.7717_peerj.14489_219_item_3 recognized text:
A D D \, i n h = \frac { C \times I n h R \times E F \times E D } { B W \times A T }
2025-06-10 20:15:02,071 - DEBUG - Snippet 10.7717_peerj.14489_219_item_4 recognized text:
B W \times A T
2025-06-10 20:15:02,075 - INFO - Starting prediction for 2 images with labels: ['formula', 'formula']
2025-06-10 20:15:02,081 - DEBUG - Generating chat message for label: formula
2025-06-10 20:15:02,082 - DEBUG - Snippet 10.7717_peerj.14489_219_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:15:02,125 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:15:02,435 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:15:02,435 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:15:02,436 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:15:02,443 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:15:02,460 - DEBUG - Snippet 10.7717_peerj.14489_219_item_0 => input_ids shape=torch.Size([1, 1140]), prompt_len=1140
2025-06-10 20:15:02,499 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:15:02,525 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:02,526 - DEBUG - Finished converting page batch time=3633.517
2025-06-10 20:15:02,538 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:15:02,591 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:15:02,614 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:15:02,615 - INFO - Processing document 10.1136_jech.2008.084012_252.pdf
2025-06-10 20:15:02,627 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:15:02,636 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:02,662 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:15:02,699 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:15:02,758 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:02,788 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:02,837 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:15:02,874 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:15:02,932 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:15:02,991 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:03,078 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:15:03,163 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:03,367 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:03,367 - DEBUG - Finished converting page batch time=3634.358
2025-06-10 20:15:03,408 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:15:03,542 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:03,543 - DEBUG - Finished converting page batch time=3634.534
2025-06-10 20:15:03,590 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:15:03,591 - INFO - Processing document 10.3233_SHTI240549_257.pdf
2025-06-10 20:15:03,599 - DEBUG - Snippet 10.7717_peerj.14489_219_item_0: generation shape=torch.Size([1, 1175])
2025-06-10 20:15:03,600 - DEBUG - Snippet 10.7717_peerj.14489_219_item_0 raw docling: (tokens=34)
<formula><loc_0><loc_0><loc_500><loc_500>H Q = \frac { A D D } { R E F }</formula><end_of_utterance>
2025-06-10 20:15:03,600 - DEBUG - Starting _parse_docling_output
2025-06-10 20:15:03,601 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>H Q = \frac { A D D } { R E F }</formula><end_of_utterance>
2025-06-10 20:15:03,601 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:15:03,601 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>H Q = \\frac { A D D } { R E F }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=155x126 at 0x7F96DD43A690>)]
2025-06-10 20:15:03,602 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:15:03,603 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=155.0, b=126.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 31))], orig='H Q = \\frac { A D D } { R E F }', text='H Q = \\frac { A D D } { R E F }', formatting=None, hyperlink=None)]
2025-06-10 20:15:03,603 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:15:03,603 - DEBUG - Processing text item: label=formula, text=H Q = \frac { A D D } { R E F }
2025-06-10 20:15:03,603 - DEBUG - Recognized string extracted: H Q = \frac { A D D } { R E F }
2025-06-10 20:15:03,604 - DEBUG - Generating chat message for label: formula
2025-06-10 20:15:03,604 - DEBUG - Snippet 10.7717_peerj.14489_219_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:15:03,605 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:03,623 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:03,674 - DEBUG - Snippet 10.7717_peerj.14489_219_item_1 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:15:03,753 - DEBUG - Creating masked image for page 2 with 20 clusters.
2025-06-10 20:15:03,754 - INFO - Masked image successfully created for page 2.
2025-06-10 20:15:03,758 - INFO - Starting prediction for 2 images with labels: ['formula', 'formula']
2025-06-10 20:15:03,759 - DEBUG - Generating chat message for label: formula
2025-06-10 20:15:03,759 - DEBUG - Snippet 10.1186_s12889-020-08915-y_232_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:15:03,787 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:03,789 - DEBUG - Finished converting page batch time=3634.780
2025-06-10 20:15:03,894 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:03,947 - DEBUG - Snippet 10.1186_s12889-020-08915-y_232_item_0 => input_ids shape=torch.Size([1, 610]), prompt_len=610
2025-06-10 20:15:04,087 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:04,109 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:04,398 - DEBUG - Finished converting page batch time=3635.389
2025-06-10 20:15:04,457 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:04,658 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:04,734 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:04,797 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:05,012 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:05,076 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:05,076 - DEBUG - Snippet 10.7717_peerj.14489_219_item_1: generation shape=torch.Size([1, 393])
2025-06-10 20:15:05,077 - DEBUG - Finished converting page batch time=3636.068
2025-06-10 20:15:05,077 - DEBUG - Snippet 10.7717_peerj.14489_219_item_1 raw docling: (tokens=47)
<formula><loc_0><loc_0><loc_500><loc_500>H Q = x = \frac { A H D } { R E F } ( a c u t e \exp osure )</formula><end_of_utterance>
2025-06-10 20:15:05,077 - DEBUG - Starting _parse_docling_output
2025-06-10 20:15:05,078 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>H Q = x = \frac { A H D } { R E F } ( a c u t e \exp osure )</formula><end_of_utterance>
2025-06-10 20:15:05,078 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:15:05,078 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>H Q = x = \\frac { A H D } { R E F } ( a c u t e \\exp osure )</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=1159x126 at 0x7F96DD43AE10>)]
2025-06-10 20:15:05,078 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:15:05,081 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:05,082 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=1159.0, b=126.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 60))], orig='H Q = x = \\frac { A H D } { R E F } ( a c u t e \\exp osure )', text='H Q = x = \\frac { A H D } { R E F } ( a c u t e \\exp osure )', formatting=None, hyperlink=None)]
2025-06-10 20:15:05,083 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:15:05,083 - DEBUG - Processing text item: label=formula, text=H Q = x = \frac { A H D } { R E F } ( a c u t e \exp osure )
2025-06-10 20:15:05,083 - DEBUG - Recognized string extracted: H Q = x = \frac { A H D } { R E F } ( a c u t e \exp osure )
2025-06-10 20:15:05,083 - INFO - All done. Returning 2 recognized text results.
2025-06-10 20:15:05,084 - DEBUG - Snippet 10.7717_peerj.14489_219_item_0 recognized text:
H Q = \frac { A D D } { R E F }
2025-06-10 20:15:05,084 - DEBUG - Snippet 10.7717_peerj.14489_219_item_1 recognized text:
H Q = x = \frac { A H D } { R E F } ( a c u t e \exp osure )
2025-06-10 20:15:05,182 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:05,200 - INFO - Finished converting document 10.7717_peerj.14489_219.pdf in 24.43 sec.
2025-06-10 20:15:05,301 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:05,439 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:05,469 - INFO - Extraction successful row 45, tokens=24174
2025-06-10 20:15:05,493 - INFO - Going to convert document batch...
2025-06-10 20:15:05,494 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:15:05,497 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:15:05,923 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:06,054 - DEBUG - Snippet 10.1186_s12889-020-08915-y_232_item_0: generation shape=torch.Size([1, 678])
2025-06-10 20:15:06,055 - DEBUG - Snippet 10.1186_s12889-020-08915-y_232_item_0 raw docling: (tokens=66)
<formula><loc_0><loc_0><loc_500><loc_500>\log E ( Y t ) = \beta Z t + n s ( t i m e , 7 * 3 ) + D O W \\ + n s ( X t , 3 ) + \text {intercept}</formula><end_of_utterance>
2025-06-10 20:15:06,055 - DEBUG - Starting _parse_docling_output
2025-06-10 20:15:06,055 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>\log E ( Y t ) = \beta Z t + n s ( t i m e , 7 * 3 ) + D O W \\ + n s ( X t , 3 ) + \text {intercept}</formula><end_of_utterance>
2025-06-10 20:15:06,056 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:15:06,056 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>\\log E ( Y t ) = \\beta Z t + n s ( t i m e , 7 * 3 ) + D O W \\\\ + n s ( X t , 3 ) + \\text {intercept}</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=482x157 at 0x7F97507360F0>)]
2025-06-10 20:15:06,056 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:15:06,059 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=482.0, b=157.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 101))], orig='\\log E ( Y t ) = \\beta Z t + n s ( t i m e , 7 * 3 ) + D O W \\\\ + n s ( X t , 3 ) + \\text {intercept}', text='\\log E ( Y t ) = \\beta Z t + n s ( t i m e , 7 * 3 ) + D O W \\\\ + n s ( X t , 3 ) + \\text {intercept}', formatting=None, hyperlink=None)]
2025-06-10 20:15:06,060 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:15:06,060 - DEBUG - Processing text item: label=formula, text=\log E ( Y t ) = \beta Z t + n s ( t i m e , 7 * 3 ) + D O W \\ + n s ( X t , 3 ) + \text {intercept}
2025-06-10 20:15:06,060 - DEBUG - Recognized string extracted: \log E ( Y t ) = \beta Z t + n s ( t i m e , 7 * 3 ) + D O W \\ + n s ( X t , 3 ) + \text {intercept}
2025-06-10 20:15:06,060 - DEBUG - Generating chat message for label: formula
2025-06-10 20:15:06,060 - DEBUG - Snippet 10.1186_s12889-020-08915-y_232_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:15:06,094 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:15:06,130 - DEBUG - Snippet 10.1186_s12889-020-08915-y_232_item_1 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:15:06,178 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:06,179 - DEBUG - Finished converting page batch time=3637.170
2025-06-10 20:15:06,299 - INFO - Finished converting document 10.3390_ijerph14091091_238.pdf in 15.24 sec.
2025-06-10 20:15:06,326 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:06,343 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:06,344 - DEBUG - Finished converting page batch time=3637.335
2025-06-10 20:15:06,380 - INFO - Extraction successful row 48, tokens=17251
2025-06-10 20:15:06,401 - INFO - Going to convert document batch...
2025-06-10 20:15:06,401 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:15:06,402 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:15:06,504 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:15:06,572 - DEBUG - Finished converting page batch time=3637.563
2025-06-10 20:15:06,820 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:06,821 - DEBUG - Finished converting page batch time=3637.812
2025-06-10 20:15:06,855 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:06,859 - INFO - Finished converting document 10.3233_SHTI240549_257.pdf in 5.74 sec.
2025-06-10 20:15:06,886 - INFO - Extraction successful row 53, tokens=3537
2025-06-10 20:15:06,914 - INFO - Going to convert document batch...
2025-06-10 20:15:06,914 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:15:06,915 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:15:06,927 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:15:06,965 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:15:06,989 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:15:06,995 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:15:07,103 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:07,206 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:15:07,384 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:07,428 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:15:07,435 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:15:07,474 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:15:07,474 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:15:07,475 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:15:07,524 - DEBUG - Snippet 10.1186_s12889-020-08915-y_232_item_1: generation shape=torch.Size([1, 393])
2025-06-10 20:15:07,525 - DEBUG - Snippet 10.1186_s12889-020-08915-y_232_item_1 raw docling: (tokens=46)
<formula><loc_0><loc_0><loc_500><loc_500>\log E ( Y t ) = \beta Z t + n s ( X t , 3 ) + \text {intercept}</formula><end_of_utterance>
2025-06-10 20:15:07,525 - DEBUG - Starting _parse_docling_output
2025-06-10 20:15:07,525 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>\log E ( Y t ) = \beta Z t + n s ( X t , 3 ) + \text {intercept}</formula><end_of_utterance>
2025-06-10 20:15:07,529 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:15:07,529 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:15:07,530 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>\\log E ( Y t ) = \\beta Z t + n s ( X t , 3 ) + \\text {intercept}</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=473x92 at 0x7F96D3878710>)]
2025-06-10 20:15:07,530 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:15:07,532 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=473.0, b=92.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 64))], orig='\\log E ( Y t ) = \\beta Z t + n s ( X t , 3 ) + \\text {intercept}', text='\\log E ( Y t ) = \\beta Z t + n s ( X t , 3 ) + \\text {intercept}', formatting=None, hyperlink=None)]
2025-06-10 20:15:07,532 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:15:07,533 - DEBUG - Processing text item: label=formula, text=\log E ( Y t ) = \beta Z t + n s ( X t , 3 ) + \text {intercept}
2025-06-10 20:15:07,533 - DEBUG - Recognized string extracted: \log E ( Y t ) = \beta Z t + n s ( X t , 3 ) + \text {intercept}
2025-06-10 20:15:07,533 - INFO - All done. Returning 2 recognized text results.
2025-06-10 20:15:07,533 - DEBUG - Snippet 10.1186_s12889-020-08915-y_232_item_0 recognized text:
\log E ( Y t ) = \beta Z t + n s ( t i m e , 7 * 3 ) + D O W \\ + n s ( X t , 3 ) + \text {intercept}
2025-06-10 20:15:07,533 - DEBUG - Snippet 10.1186_s12889-020-08915-y_232_item_1 recognized text:
\log E ( Y t ) = \beta Z t + n s ( X t , 3 ) + \text {intercept}
2025-06-10 20:15:07,570 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:15:07,598 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:15:07,609 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:15:07,649 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:15:07,656 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:15:07,667 - INFO - Finished converting document 10.1186_s12889-020-08915-y_232.pdf in 22.95 sec.
2025-06-10 20:15:07,677 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:07,782 - INFO - Extraction successful row 46, tokens=16010
2025-06-10 20:15:07,809 - INFO - Going to convert document batch...
2025-06-10 20:15:07,809 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:15:07,810 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:15:07,818 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:15:07,856 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:15:07,871 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:15:07,872 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:15:07,872 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:15:07,906 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:15:07,944 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:15:07,956 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:07,957 - DEBUG - Finished converting page batch time=3638.948
2025-06-10 20:15:08,012 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:15:08,037 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:08,038 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:15:08,039 - DEBUG - Finished converting page batch time=3639.030
2025-06-10 20:15:08,047 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:15:08,076 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:15:08,109 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:15:08,109 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:15:08,110 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:15:08,120 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:15:08,146 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:15:08,155 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:15:08,161 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:08,172 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:15:08,186 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:15:08,217 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:15:08,229 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:15:08,264 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:15:08,266 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:15:08,422 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:15:08,520 - DEBUG - Finished converting page batch time=3639.511
2025-06-10 20:15:08,529 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:15:08,546 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:15:08,555 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:15:08,590 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:15:08,601 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:15:08,602 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:15:08,607 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:15:08,644 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:15:08,715 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:15:08,718 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:15:08,755 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:15:08,795 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:15:08,795 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:08,807 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:15:08,886 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:15:08,886 - INFO - Processing document 10.4178_epih.e2022052_261.pdf
2025-06-10 20:15:08,995 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:15:08,996 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:15:08,996 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:15:09,010 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:15:09,039 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:15:09,074 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:15:09,131 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:15:09,144 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:15:09,181 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:15:09,222 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:15:09,258 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:15:09,288 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:15:09,289 - INFO - Processing document 10.1371_journal.pone.0062063_278.pdf
2025-06-10 20:15:09,291 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:15:09,403 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:15:09,424 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:09,441 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:15:09,442 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:09,468 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:15:09,468 - INFO - Processing document 10.1186_1476-069X-10-51_283.pdf
2025-06-10 20:15:09,479 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:09,485 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:15:09,496 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:09,500 - DEBUG - Finished converting page batch time=3640.491
2025-06-10 20:15:09,626 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:15:09,628 - INFO - Finished converting document 10.1186_1476-069X-12-28_248.pdf in 11.24 sec.
2025-06-10 20:15:09,657 - DEBUG - [Page 14] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:09,753 - INFO - Extraction successful row 51, tokens=11716
2025-06-10 20:15:09,796 - INFO - Going to convert document batch...
2025-06-10 20:15:09,797 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:15:09,797 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:15:09,842 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:15:09,920 - DEBUG - [Page 15] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:09,921 - DEBUG - Finished converting page batch time=3640.912
2025-06-10 20:15:09,938 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:15:10,001 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:10,021 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:10,134 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:15:10,135 - INFO - Processing document 10.1186_1476-069X-9-8_287.pdf
2025-06-10 20:15:10,189 - DEBUG - [Page 16] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:10,409 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:10,464 - DEBUG - [Page 17] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:10,481 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:15:10,532 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:15:10,539 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:15:10,549 - DEBUG - [Page 18] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:10,575 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:10,670 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:10,769 - DEBUG - [Page 19] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:10,770 - DEBUG - Finished converting page batch time=3641.761
2025-06-10 20:15:11,117 - DEBUG - [Page 20] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:11,174 - DEBUG - Dynamic vertical threshold: 51.89939999999995, Overlap threshold: 0.7
2025-06-10 20:15:11,175 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:11,208 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:11,231 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:11,232 - DEBUG - Finished converting page batch time=3642.223
2025-06-10 20:15:11,274 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:15:11,275 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:15:11,275 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:15:11,289 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:11,313 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:15:11,349 - DEBUG - [Page 21] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:11,358 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:15:11,396 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:15:11,438 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:15:11,444 - DEBUG - [Page 22] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:11,477 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:15:11,510 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:15:11,568 - DEBUG - [Page 23] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:11,569 - DEBUG - Finished converting page batch time=3642.560
2025-06-10 20:15:11,635 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:15:11,651 - DEBUG - [Page 24] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:11,671 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:15:11,671 - INFO - Finished converting document 10.1136_bmj.h1295_242.pdf in 19.69 sec.
2025-06-10 20:15:11,709 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:15:11,719 - DEBUG - [Page 25] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:11,788 - DEBUG - [Page 26] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:11,789 - DEBUG - Finished converting page batch time=3642.780
2025-06-10 20:15:11,829 - INFO - Extraction successful row 49, tokens=16728
2025-06-10 20:15:11,851 - INFO - Going to convert document batch...
2025-06-10 20:15:11,852 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:15:11,852 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:15:11,874 - INFO - Finished converting document 10.1136_jech.2008.084012_252.pdf in 11.92 sec.
2025-06-10 20:15:11,919 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:11,980 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:15:12,006 - INFO - Extraction successful row 52, tokens=14650
2025-06-10 20:15:12,009 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:12,029 - INFO - Going to convert document batch...
2025-06-10 20:15:12,030 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:15:12,030 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:15:12,117 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:15:12,149 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:12,165 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:15:12,235 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:12,401 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:15:12,450 - DEBUG - Dynamic vertical threshold: 37.381500000000074, Overlap threshold: 0.7
2025-06-10 20:15:12,450 - DEBUG - Checking merge:
  Current: 22, Next: 20
2025-06-10 20:15:12,450 - DEBUG -   Vertical gap: 32.65199999999993, Overlap ratio: 1.0
2025-06-10 20:15:12,451 - DEBUG -   Left boundary diff: 13.719000000000008, Right boundary diff: 0.0
2025-06-10 20:15:12,451 - DEBUG -   Alignment factor (ratio): 0.06626367814370901
2025-06-10 20:15:12,451 - DEBUG -   -> c1 22 formula number: None, c2 20 formula number: None
2025-06-10 20:15:12,451 - DEBUG -   -> Not merging clusters 22 and 20 because vertical_gap 32.65199999999993 > 3 with no numbers
2025-06-10 20:15:12,452 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:12,604 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:15:12,605 - INFO - Processing document 10.2147_JMDH.S412394_303.pdf
2025-06-10 20:15:12,650 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:12,652 - DEBUG - Finished converting page batch time=3643.643
2025-06-10 20:15:12,666 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:15:12,859 - DEBUG - Creating masked image for page 2 with 19 clusters.
2025-06-10 20:15:12,860 - INFO - Masked image successfully created for page 2.
2025-06-10 20:15:12,864 - INFO - Starting prediction for 2 images with labels: ['formula', 'formula']
2025-06-10 20:15:12,864 - DEBUG - Generating chat message for label: formula
2025-06-10 20:15:12,865 - DEBUG - Snippet 10.1016_S0140-67361360898-3_245_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:15:12,904 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:12,905 - DEBUG - Finished converting page batch time=3643.896
2025-06-10 20:15:12,922 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:15:12,935 - DEBUG - Snippet 10.1016_S0140-67361360898-3_245_item_0 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:15:12,976 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:15:12,983 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:15:13,029 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:15:13,036 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:15:13,063 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:13,077 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:13,494 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:13,682 - DEBUG - Snippet 10.1016_S0140-67361360898-3_245_item_0: generation shape=torch.Size([1, 365])
2025-06-10 20:15:13,683 - DEBUG - Snippet 10.1016_S0140-67361360898-3_245_item_0 raw docling: (tokens=19)
<formula><loc_0><loc_0><loc_500><loc_500></formula><end_of_utterance>
2025-06-10 20:15:13,683 - DEBUG - Starting _parse_docling_output
2025-06-10 20:15:13,683 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500></formula><end_of_utterance>
2025-06-10 20:15:13,683 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:15:13,684 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500></formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=407x69 at 0x7F96DCCAA330>)]
2025-06-10 20:15:13,684 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:15:13,685 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=407.0, b=69.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 0))], orig='', text='', formatting=None, hyperlink=None)]
2025-06-10 20:15:13,685 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:15:13,685 - DEBUG - Processing text item: label=formula, text=
2025-06-10 20:15:13,686 - WARNING - Extracted text is empty or malformed. Skipping formula.
2025-06-10 20:15:13,686 - DEBUG - Generating chat message for label: formula
2025-06-10 20:15:13,686 - DEBUG - Snippet 10.1016_S0140-67361360898-3_245_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:15:13,727 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:13,800 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:15:13,801 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:15:13,801 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:15:13,830 - DEBUG - Snippet 10.1016_S0140-67361360898-3_245_item_1 => input_ids shape=torch.Size([1, 610]), prompt_len=610
2025-06-10 20:15:13,836 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:15:13,837 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:15:13,837 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:15:13,837 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:15:13,876 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:15:13,913 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:15:13,941 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:13,941 - DEBUG - Finished converting page batch time=3644.932
2025-06-10 20:15:13,942 - DEBUG - Finished converting page batch time=3644.933
2025-06-10 20:15:13,970 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:15:14,005 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:15:14,024 - DEBUG - Finished converting page batch time=3645.015
2025-06-10 20:15:14,047 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:15:14,105 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:14,197 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:15:14,210 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:15:14,230 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:15:14,258 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:15:14,269 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:15:14,298 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:15:14,383 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:15:14,428 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:15:14,434 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:15:14,515 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:15:14,540 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:14,658 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:15:14,664 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:14,696 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:15:14,727 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:15:14,762 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:15:14,916 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:14,946 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:15:14,958 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:15:14,958 - INFO - Processing document 10.4046_trd.2020.0154_314.pdf
2025-06-10 20:15:15,046 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:15,073 - DEBUG - Snippet 10.1016_S0140-67361360898-3_245_item_1: generation shape=torch.Size([1, 652])
2025-06-10 20:15:15,074 - DEBUG - Snippet 10.1016_S0140-67361360898-3_245_item_1 raw docling: (tokens=41)
<formula><loc_0><loc_0><loc_500><loc_500>Population-attributable risks = \frac { ( R R - 1 ) } { R R }</formula><end_of_utterance>
2025-06-10 20:15:15,074 - DEBUG - Starting _parse_docling_output
2025-06-10 20:15:15,074 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>Population-attributable risks = \frac { ( R R - 1 ) } { R R }</formula><end_of_utterance>
2025-06-10 20:15:15,075 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:15:15,075 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>Population-attributable risks = \\frac { ( R R - 1 ) } { R R }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=421x120 at 0x7F96C8F75BE0>)]
2025-06-10 20:15:15,075 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:15:15,077 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=421.0, b=120.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 61))], orig='Population-attributable risks = \\frac { ( R R - 1 ) } { R R }', text='Population-attributable risks = \\frac { ( R R - 1 ) } { R R }', formatting=None, hyperlink=None)]
2025-06-10 20:15:15,078 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:15:15,078 - DEBUG - Processing text item: label=formula, text=Population-attributable risks = \frac { ( R R - 1 ) } { R R }
2025-06-10 20:15:15,078 - DEBUG - Recognized string extracted: Population-attributable risks = \frac { ( R R - 1 ) } { R R }
2025-06-10 20:15:15,078 - INFO - All done. Returning 2 recognized text results.
2025-06-10 20:15:15,079 - DEBUG - Snippet 10.1016_S0140-67361360898-3_245_item_0 recognized text:
MALFORMED_FORMULA
2025-06-10 20:15:15,079 - DEBUG - Snippet 10.1016_S0140-67361360898-3_245_item_1 recognized text:
Population-attributable risks = \frac { ( R R - 1 ) } { R R }
2025-06-10 20:15:15,174 - INFO - Finished converting document 10.1016_S0140-67361360898-3_245.pdf in 20.00 sec.
2025-06-10 20:15:15,303 - INFO - Extraction successful row 50, tokens=19300
2025-06-10 20:15:15,330 - INFO - Going to convert document batch...
2025-06-10 20:15:15,330 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:15:15,331 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:15:15,382 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:15:15,479 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:15:15,747 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:15:15,748 - INFO - Processing document 10.3390_ijerph17103591_317.pdf
2025-06-10 20:15:15,858 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:15,910 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:16,027 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:15:16,073 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:15:16,080 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:15:16,127 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:16,362 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:16,437 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:16,462 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:16,685 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:15:16,685 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:15:16,685 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:15:16,719 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:15:16,757 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:15:16,793 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:15:16,835 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:15:16,878 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:16,947 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:16,975 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:17,245 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:15:17,250 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:17,289 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:15:17,346 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:17,427 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:15:17,471 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:15:17,535 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:15:17,780 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:15:18,035 - DEBUG - Dynamic vertical threshold: 63.6318, Overlap threshold: 0.7
2025-06-10 20:15:18,035 - DEBUG - Checking merge:
  Current: 8, Next: 14
2025-06-10 20:15:18,036 - DEBUG -   Vertical gap: 39.849000000000046, Overlap ratio: 1.0
2025-06-10 20:15:18,036 - DEBUG -   Left boundary diff: 103.34400000000002, Right boundary diff: 0.002000000000066393
2025-06-10 20:15:18,036 - DEBUG -   Alignment factor (ratio): 0.32451171261696926
2025-06-10 20:15:18,037 - DEBUG -   -> c1 8 formula number: 1, c2 14 formula number: 2
2025-06-10 20:15:18,037 - DEBUG -   -> Not merging clusters 8 and 14 due to different formula numbers: 1 vs 2
2025-06-10 20:15:18,037 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:18,044 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:18,045 - DEBUG - Finished converting page batch time=3649.036
2025-06-10 20:15:18,110 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:15:18,291 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:18,309 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:15:18,310 - INFO - Processing document 10.7196_samj.2022.v112i8b.16483_384.pdf
2025-06-10 20:15:18,478 - DEBUG - Dynamic vertical threshold: 48.416399999999946, Overlap threshold: 0.7
2025-06-10 20:15:18,479 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:18,480 - DEBUG - Finished converting page batch time=3649.470
2025-06-10 20:15:18,626 - DEBUG - Finished converting page batch time=3649.617
2025-06-10 20:15:18,838 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:19,141 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:19,148 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:19,165 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:19,166 - DEBUG - Finished converting page batch time=3650.157
2025-06-10 20:15:19,225 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:19,360 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:19,585 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:19,598 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:19,599 - DEBUG - Finished converting page batch time=3650.590
2025-06-10 20:15:19,798 - DEBUG - Creating masked image for page 1 with 27 clusters.
2025-06-10 20:15:19,800 - INFO - Masked image successfully created for page 1.
2025-06-10 20:15:19,921 - DEBUG - Creating masked image for page 2 with 24 clusters.
2025-06-10 20:15:19,923 - INFO - Masked image successfully created for page 2.
2025-06-10 20:15:19,930 - INFO - Starting prediction for 3 images with labels: ['formula', 'formula', 'formula']
2025-06-10 20:15:19,931 - DEBUG - Generating chat message for label: formula
2025-06-10 20:15:19,931 - DEBUG - Snippet 10.1371_journal.pone.0062063_278_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:15:19,952 - DEBUG - Finished converting page batch time=3650.943
2025-06-10 20:15:20,007 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:20,015 - DEBUG - Snippet 10.1371_journal.pone.0062063_278_item_0 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:15:20,015 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:20,016 - DEBUG - Finished converting page batch time=3651.007
2025-06-10 20:15:20,228 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:20,333 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:20,350 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:20,350 - DEBUG - Finished converting page batch time=3651.341
2025-06-10 20:15:20,438 - INFO - Finished converting document 10.4046_trd.2020.0154_314.pdf in 8.61 sec.
2025-06-10 20:15:20,486 - INFO - Extraction successful row 59, tokens=6206
2025-06-10 20:15:20,512 - INFO - Going to convert document batch...
2025-06-10 20:15:20,512 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:15:20,513 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:15:20,558 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:15:20,801 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:20,931 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:20,932 - DEBUG - Finished converting page batch time=3651.923
2025-06-10 20:15:20,983 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:21,060 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:21,162 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:15:21,355 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:15:21,362 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:15:21,447 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:21,496 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:21,697 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:21,698 - DEBUG - Finished converting page batch time=3652.689
2025-06-10 20:15:21,750 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:21,751 - DEBUG - Finished converting page batch time=3652.742
2025-06-10 20:15:21,832 - INFO - Finished converting document 10.4178_epih.e2022052_261.pdf in 16.36 sec.
2025-06-10 20:15:21,843 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:15:21,843 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:15:21,843 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:15:21,904 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:15:21,914 - INFO - Finished converting document 10.1186_1476-069X-10-51_283.pdf in 15.03 sec.
2025-06-10 20:15:21,923 - INFO - Extraction successful row 54, tokens=19752
2025-06-10 20:15:21,937 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:21,938 - DEBUG - Finished converting page batch time=3652.929
2025-06-10 20:15:21,946 - INFO - Going to convert document batch...
2025-06-10 20:15:21,947 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:15:21,947 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:15:21,965 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:15:21,966 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:22,002 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:15:22,002 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:15:22,019 - INFO - Extraction successful row 56, tokens=17643
2025-06-10 20:15:22,047 - INFO - Going to convert document batch...
2025-06-10 20:15:22,048 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:15:22,048 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:15:22,060 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:15:22,069 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:22,100 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:15:22,144 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:15:22,206 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:15:22,269 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:15:22,276 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:22,307 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:15:22,360 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:15:22,531 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:15:22,602 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:22,645 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:15:22,701 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:15:22,708 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:15:22,898 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:15:22,926 - DEBUG - Snippet 10.1371_journal.pone.0062063_278_item_0: generation shape=torch.Size([1, 450])
2025-06-10 20:15:22,927 - DEBUG - Snippet 10.1371_journal.pone.0062063_278_item_0 raw docling: (tokens=104)
<formula><loc_0><loc_0><loc_500><loc_500>L o g ( E ( Y ) ) = \beta _ { 0 } + \beta _ { 1 } \, T i m e W + \beta _ { 2 } B A N + \beta _ { 3 } ( T i m e W \ast B A N ) + \beta _ { k } ( S P , I , S e a s o n ) + e</formula><end_of_utterance>
2025-06-10 20:15:22,927 - DEBUG - Starting _parse_docling_output
2025-06-10 20:15:22,927 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>L o g ( E ( Y ) ) = \beta _ { 0 } + \beta _ { 1 } \, T i m e W + \beta _ { 2 } B A N + \beta _ { 3 } ( T i m e W \ast B A N ) + \beta _ { k } ( S P , I , S e a s o n ) + e</formula><end_of_utterance>
2025-06-10 20:15:22,927 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:15:22,928 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>L o g ( E ( Y ) ) = \\beta _ { 0 } + \\beta _ { 1 } \\, T i m e W + \\beta _ { 2 } B A N + \\beta _ { 3 } ( T i m e W \\ast B A N ) + \\beta _ { k } ( S P , I , S e a s o n ) + e</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=699x128 at 0x7F96D7B15CD0>)]
2025-06-10 20:15:22,928 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:15:22,932 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=699.0, b=128.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 171))], orig='L o g ( E ( Y ) ) = \\beta _ { 0 } + \\beta _ { 1 } \\, T i m e W + \\beta _ { 2 } B A N + \\beta _ { 3 } ( T i m e W \\ast B A N ) + \\beta _ { k } ( S P , I , S e a s o n ) + e', text='L o g ( E ( Y ) ) = \\beta _ { 0 } + \\beta _ { 1 } \\, T i m e W + \\beta _ { 2 } B A N + \\beta _ { 3 } ( T i m e W \\ast B A N ) + \\beta _ { k } ( S P , I , S e a s o n ) + e', formatting=None, hyperlink=None)]
2025-06-10 20:15:22,932 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:15:22,932 - DEBUG - Processing text item: label=formula, text=L o g ( E ( Y ) ) = \beta _ { 0 } + \beta _ { 1 } \, T i m e W + \beta _ { 2 } B A N + \beta _ { 3 } ( T i m e W \ast B A N ) + \beta _ { k } ( S P , I , S e a s o n ) + e
2025-06-10 20:15:22,932 - DEBUG - Recognized string extracted: L o g ( E ( Y ) ) = \beta _ { 0 } + \beta _ { 1 } \, T i m e W + \beta _ { 2 } B A N + \beta _ { 3 } ( T i m e W \ast B A N ) + \beta _ { k } ( S P , I , S e a s o n ) + e
2025-06-10 20:15:22,933 - DEBUG - Generating chat message for label: formula
2025-06-10 20:15:22,933 - DEBUG - Snippet 10.1371_journal.pone.0062063_278_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:15:22,948 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:15:22,954 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:15:22,975 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:15:22,997 - DEBUG - Snippet 10.1371_journal.pone.0062063_278_item_1 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:15:23,160 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:23,163 - DEBUG - Finished converting page batch time=3654.154
2025-06-10 20:15:23,162 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:23,170 - DEBUG - Finished converting page batch time=3654.161
2025-06-10 20:15:23,312 - INFO - Finished converting document 10.1186_1476-069X-9-8_287.pdf in 15.53 sec.
2025-06-10 20:15:23,361 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:15:23,366 - INFO - Processing document 10.1016_s0140-67361832225-6_386.pdf
2025-06-10 20:15:23,422 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:15:23,423 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:15:23,423 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:15:23,425 - INFO - Extraction successful row 57, tokens=19972
2025-06-10 20:15:23,449 - INFO - Going to convert document batch...
2025-06-10 20:15:23,450 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:15:23,450 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:15:23,499 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:15:23,502 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:15:23,581 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:15:23,610 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:23,619 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:15:23,647 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:23,667 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:15:23,705 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:15:23,716 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:15:23,717 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:15:23,717 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:15:23,741 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:15:23,760 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:15:23,797 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:15:23,838 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:15:23,894 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:23,897 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:15:23,912 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:15:23,934 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:15:23,951 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:15:23,972 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:15:23,991 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:15:24,150 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:15:24,162 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:24,164 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:15:24,196 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:15:24,203 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:15:24,223 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:24,336 - DEBUG - Dynamic vertical threshold: 59.96879999999985, Overlap threshold: 0.7
2025-06-10 20:15:24,337 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:24,446 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:15:24,448 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:15:24,592 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:24,643 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:15:24,643 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:15:24,643 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:15:24,649 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:15:24,650 - INFO - Processing document 10.3389_fimmu.2019.02518_391.pdf
2025-06-10 20:15:24,715 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:15:24,787 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:15:24,829 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:15:24,833 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:24,834 - DEBUG - Finished converting page batch time=3655.825
2025-06-10 20:15:24,852 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:15:24,938 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:24,942 - DEBUG - Finished converting page batch time=3655.933
2025-06-10 20:15:24,973 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:15:24,977 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:15:25,020 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:15:25,067 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:15:25,087 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:25,098 - DEBUG - Creating masked image for page 2 with 16 clusters.
2025-06-10 20:15:25,099 - DEBUG - Snippet 10.1371_journal.pone.0062063_278_item_1: generation shape=torch.Size([1, 417])
2025-06-10 20:15:25,099 - INFO - Masked image successfully created for page 2.
2025-06-10 20:15:25,100 - DEBUG - Snippet 10.1371_journal.pone.0062063_278_item_1 raw docling: (tokens=71)
<formula><loc_0><loc_0><loc_500><loc_500>L o g ( E ( Y ) ) = \beta _ { 0 } + \beta _ { 1 } T i m e W + \beta _ { k } ( S P , I , S e a s o n ) + e</formula><end_of_utterance>
2025-06-10 20:15:25,100 - DEBUG - Starting _parse_docling_output
2025-06-10 20:15:25,100 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>L o g ( E ( Y ) ) = \beta _ { 0 } + \beta _ { 1 } T i m e W + \beta _ { k } ( S P , I , S e a s o n ) + e</formula><end_of_utterance>
2025-06-10 20:15:25,100 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:15:25,101 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>L o g ( E ( Y ) ) = \\beta _ { 0 } + \\beta _ { 1 } T i m e W + \\beta _ { k } ( S P , I , S e a s o n ) + e</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=629x55 at 0x7F96CF9A6360>)]
2025-06-10 20:15:25,101 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:15:25,103 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=629.0, b=55.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 105))], orig='L o g ( E ( Y ) ) = \\beta _ { 0 } + \\beta _ { 1 } T i m e W + \\beta _ { k } ( S P , I , S e a s o n ) + e', text='L o g ( E ( Y ) ) = \\beta _ { 0 } + \\beta _ { 1 } T i m e W + \\beta _ { k } ( S P , I , S e a s o n ) + e', formatting=None, hyperlink=None)]
2025-06-10 20:15:25,104 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:15:25,104 - DEBUG - Processing text item: label=formula, text=L o g ( E ( Y ) ) = \beta _ { 0 } + \beta _ { 1 } T i m e W + \beta _ { k } ( S P , I , S e a s o n ) + e
2025-06-10 20:15:25,104 - DEBUG - Recognized string extracted: L o g ( E ( Y ) ) = \beta _ { 0 } + \beta _ { 1 } T i m e W + \beta _ { k } ( S P , I , S e a s o n ) + e
2025-06-10 20:15:25,104 - DEBUG - Generating chat message for label: formula
2025-06-10 20:15:25,105 - DEBUG - Snippet 10.1371_journal.pone.0062063_278_item_2 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:15:25,109 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:15:25,120 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:25,143 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:25,177 - DEBUG - Snippet 10.1371_journal.pone.0062063_278_item_2 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:15:25,218 - DEBUG - Creating masked image for page 3 with 11 clusters.
2025-06-10 20:15:25,219 - INFO - Masked image successfully created for page 3.
2025-06-10 20:15:25,228 - INFO - Starting prediction for 5 images with labels: ['formula', 'formula', 'formula', 'formula', 'formula']
2025-06-10 20:15:25,228 - DEBUG - Generating chat message for label: formula
2025-06-10 20:15:25,228 - DEBUG - Snippet 10.3390_ijerph17103591_317_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:15:25,252 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:15:25,256 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:25,257 - DEBUG - Finished converting page batch time=3656.248
2025-06-10 20:15:25,279 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:15:25,299 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:15:25,322 - DEBUG - Snippet 10.3390_ijerph17103591_317_item_0 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:15:25,335 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:15:25,418 - INFO - Finished converting document 10.2147_JMDH.S412394_303.pdf in 15.66 sec.
2025-06-10 20:15:25,481 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:15:25,482 - INFO - Processing document 10.1371_journal.pone.0157014_404.pdf
2025-06-10 20:15:25,491 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:15:25,514 - DEBUG - Dynamic vertical threshold: 75.98610000000004, Overlap threshold: 0.7
2025-06-10 20:15:25,514 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:25,515 - DEBUG - Finished converting page batch time=3656.506
2025-06-10 20:15:25,516 - INFO - Extraction successful row 58, tokens=13789
2025-06-10 20:15:25,541 - INFO - Going to convert document batch...
2025-06-10 20:15:25,541 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:15:25,542 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:15:25,593 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:15:25,864 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:15:26,065 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:15:26,066 - INFO - Processing document 10.1079_phn2003543_411.pdf
2025-06-10 20:15:26,158 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:26,222 - DEBUG - Dynamic vertical threshold: 64.05840000000005, Overlap threshold: 0.7
2025-06-10 20:15:26,222 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:26,318 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:26,394 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:15:26,438 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:15:26,444 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:15:26,598 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:26,792 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:26,937 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:27,026 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:15:27,033 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:15:27,034 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:15:27,042 - DEBUG - Dynamic vertical threshold: 76.5305999999999, Overlap threshold: 0.7
2025-06-10 20:15:27,042 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:27,053 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:15:27,079 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:15:27,101 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 429 0
2025-06-10 20:15:27,122 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 429 0
2025-06-10 20:15:27,148 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 429 0
2025-06-10 20:15:27,171 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 429 0
2025-06-10 20:15:27,221 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:27,243 - DEBUG - Finished converting page batch time=3658.234
2025-06-10 20:15:27,290 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:15:27,312 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 429 0
2025-06-10 20:15:27,333 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 429 0
2025-06-10 20:15:27,454 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:27,466 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 429 0
2025-06-10 20:15:27,468 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:27,480 - DEBUG - Dynamic vertical threshold: 76.52880000000015, Overlap threshold: 0.7
2025-06-10 20:15:27,481 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:27,483 - DEBUG - Finished converting page batch time=3658.474
2025-06-10 20:15:27,515 - DEBUG - Snippet 10.3390_ijerph17103591_317_item_0: generation shape=torch.Size([1, 418])
2025-06-10 20:15:27,515 - DEBUG - Snippet 10.3390_ijerph17103591_317_item_0 raw docling: (tokens=72)
<formula><loc_0><loc_0><loc_500><loc_500>y _ { t } = \varepsilon _ { t } + \sum _ { l = 0 } ^ { \underline { L } } \beta _ { l } p _ { l } ( x _ { t } ) .</formula><end_of_utterance>
2025-06-10 20:15:27,516 - DEBUG - Starting _parse_docling_output
2025-06-10 20:15:27,516 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>y _ { t } = \varepsilon _ { t } + \sum _ { l = 0 } ^ { \underline { L } } \beta _ { l } p _ { l } ( x _ { t } ) .</formula><end_of_utterance>
2025-06-10 20:15:27,516 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:15:27,516 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>y _ { t } = \\varepsilon _ { t } + \\sum _ { l = 0 } ^ { \\underline { L } } \\beta _ { l } p _ { l } ( x _ { t } ) .</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=787x157 at 0x7F96D4586E70>)]
2025-06-10 20:15:27,517 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:15:27,520 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=787.0, b=157.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 113))], orig='y _ { t } = \\varepsilon _ { t } + \\sum _ { l = 0 } ^ { \\underline { L } } \\beta _ { l } p _ { l } ( x _ { t } ) .', text='y _ { t } = \\varepsilon _ { t } + \\sum _ { l = 0 } ^ { \\underline { L } } \\beta _ { l } p _ { l } ( x _ { t } ) .', formatting=None, hyperlink=None)]
2025-06-10 20:15:27,520 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:15:27,521 - DEBUG - Processing text item: label=formula, text=y _ { t } = \varepsilon _ { t } + \sum _ { l = 0 } ^ { \underline { L } } \beta _ { l } p _ { l } ( x _ { t } ) .
2025-06-10 20:15:27,521 - DEBUG - Recognized string extracted: y _ { t } = \varepsilon _ { t } + \sum _ { l = 0 } ^ { \underline { L } } \beta _ { l } p _ { l } ( x _ { t } ) .
2025-06-10 20:15:27,521 - DEBUG - Generating chat message for label: formula
2025-06-10 20:15:27,521 - DEBUG - Snippet 10.3390_ijerph17103591_317_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:15:27,585 - DEBUG - Snippet 10.3390_ijerph17103591_317_item_1 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:15:27,618 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:27,708 - DEBUG - Dynamic vertical threshold: 77.70060000000005, Overlap threshold: 0.7
2025-06-10 20:15:27,708 - DEBUG - Checking merge:
  Current: 9, Next: 5
2025-06-10 20:15:27,709 - DEBUG -   Vertical gap: 26.108999999999924, Overlap ratio: 0.9236207009929638
2025-06-10 20:15:27,709 - DEBUG -   Left boundary diff: 25.552999999999997, Right boundary diff: 51.38100000000003
2025-06-10 20:15:27,709 - DEBUG -   Alignment factor (ratio): 0.20762684468294904
2025-06-10 20:15:27,709 - DEBUG -   -> c1 9 formula number: None, c2 5 formula number: 3
2025-06-10 20:15:27,709 - DEBUG -   -> Not merging 9 and 5 (one missing, gap 26.108999999999924 > 12.8)
2025-06-10 20:15:27,709 - DEBUG - Checking merge:
  Current: 5, Next: 4
2025-06-10 20:15:27,710 - DEBUG -   Vertical gap: 64.18799999999999, Overlap ratio: 1.0
2025-06-10 20:15:27,710 - DEBUG -   Left boundary diff: 33.49799999999999, Right boundary diff: 0.0020000000000095497
2025-06-10 20:15:27,710 - DEBUG -   Alignment factor (ratio): 0.12087380742750743
2025-06-10 20:15:27,710 - DEBUG -   -> c1 5 formula number: 3, c2 4 formula number: 4
2025-06-10 20:15:27,710 - DEBUG -   -> Not merging clusters 5 and 4 due to different formula numbers: 3 vs 4
2025-06-10 20:15:27,710 - DEBUG - Checking merge:
  Current: 4, Next: 8
2025-06-10 20:15:27,711 - DEBUG -   Vertical gap: 53.46300000000002, Overlap ratio: 0.9474411118050584
2025-06-10 20:15:27,711 - DEBUG -   Left boundary diff: 22.73400000000001, Right boundary diff: 20.701999999999998
2025-06-10 20:15:27,711 - DEBUG -   Alignment factor (ratio): 0.0770910619943167
2025-06-10 20:15:27,711 - DEBUG -   -> c1 4 formula number: 4, c2 8 formula number: None
2025-06-10 20:15:27,711 - DEBUG -   -> Not merging 4 and 8 (one missing, gap 53.46300000000002 > 12.8)
2025-06-10 20:15:27,711 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:27,746 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 429 0
2025-06-10 20:15:27,928 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:15:27,928 - INFO - Processing document 10.1136_oem.2007.033175_418.pdf
2025-06-10 20:15:27,950 - DEBUG - Snippet 10.1371_journal.pone.0062063_278_item_2: generation shape=torch.Size([1, 437])
2025-06-10 20:15:27,951 - DEBUG - Snippet 10.1371_journal.pone.0062063_278_item_2 raw docling: (tokens=91)
<formula><loc_0><loc_0><loc_500><loc_500>L o g ( E ( Y ) ) = ( \beta _ { 0 } + \beta _ { 2 } ) + ( \beta _ { 1 } + \beta _ { 3 } ) T i m e W + \beta _ { k } ( S P , I , S e a s o n ) + e</formula><end_of_utterance>
2025-06-10 20:15:27,951 - DEBUG - Starting _parse_docling_output
2025-06-10 20:15:27,952 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>L o g ( E ( Y ) ) = ( \beta _ { 0 } + \beta _ { 2 } ) + ( \beta _ { 1 } + \beta _ { 3 } ) T i m e W + \beta _ { k } ( S P , I , S e a s o n ) + e</formula><end_of_utterance>
2025-06-10 20:15:27,952 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:15:27,952 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>L o g ( E ( Y ) ) = ( \\beta _ { 0 } + \\beta _ { 2 } ) + ( \\beta _ { 1 } + \\beta _ { 3 } ) T i m e W + \\beta _ { k } ( S P , I , S e a s o n ) + e</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=589x128 at 0x7F96DE7D0740>)]
2025-06-10 20:15:27,952 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:15:27,955 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=589.0, b=128.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 145))], orig='L o g ( E ( Y ) ) = ( \\beta _ { 0 } + \\beta _ { 2 } ) + ( \\beta _ { 1 } + \\beta _ { 3 } ) T i m e W + \\beta _ { k } ( S P , I , S e a s o n ) + e', text='L o g ( E ( Y ) ) = ( \\beta _ { 0 } + \\beta _ { 2 } ) + ( \\beta _ { 1 } + \\beta _ { 3 } ) T i m e W + \\beta _ { k } ( S P , I , S e a s o n ) + e', formatting=None, hyperlink=None)]
2025-06-10 20:15:27,956 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:15:27,956 - DEBUG - Processing text item: label=formula, text=L o g ( E ( Y ) ) = ( \beta _ { 0 } + \beta _ { 2 } ) + ( \beta _ { 1 } + \beta _ { 3 } ) T i m e W + \beta _ { k } ( S P , I , S e a s o n ) + e
2025-06-10 20:15:27,956 - DEBUG - Recognized string extracted: L o g ( E ( Y ) ) = ( \beta _ { 0 } + \beta _ { 2 } ) + ( \beta _ { 1 } + \beta _ { 3 } ) T i m e W + \beta _ { k } ( S P , I , S e a s o n ) + e
2025-06-10 20:15:27,956 - INFO - All done. Returning 3 recognized text results.
2025-06-10 20:15:27,956 - DEBUG - Snippet 10.1371_journal.pone.0062063_278_item_0 recognized text:
L o g ( E ( Y ) ) = \beta _ { 0 } + \beta _ { 1 } \, T i m e W + \beta _ { 2 } B A N + \beta _ { 3 } ( T i m e W \ast B A N ) + \beta _ { k } ( S P , I , S e a s o n ) + e
2025-06-10 20:15:27,957 - DEBUG - Snippet 10.1371_journal.pone.0062063_278_item_1 recognized text:
L o g ( E ( Y ) ) = \beta _ { 0 } + \beta _ { 1 } T i m e W + \beta _ { k } ( S P , I , S e a s o n ) + e
2025-06-10 20:15:27,957 - DEBUG - Snippet 10.1371_journal.pone.0062063_278_item_2 recognized text:
L o g ( E ( Y ) ) = ( \beta _ { 0 } + \beta _ { 2 } ) + ( \beta _ { 1 } + \beta _ { 3 } ) T i m e W + \beta _ { k } ( S P , I , S e a s o n ) + e
2025-06-10 20:15:28,036 - INFO - Finished converting document 10.1371_journal.pone.0062063_278.pdf in 21.65 sec.
2025-06-10 20:15:28,110 - INFO - Extraction successful row 55, tokens=12045
2025-06-10 20:15:28,137 - INFO - Going to convert document batch...
2025-06-10 20:15:28,138 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:15:28,138 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:15:28,163 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 429 3243
2025-06-10 20:15:28,408 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:28,409 - DEBUG - Finished converting page batch time=3659.400
2025-06-10 20:15:28,455 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:28,457 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:28,467 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:28,699 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:28,828 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:15:28,844 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:28,850 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 429 3243
2025-06-10 20:15:28,850 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:15:28,861 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:28,983 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:29,221 - DEBUG - Dynamic vertical threshold: 75.45959999999995, Overlap threshold: 0.7
2025-06-10 20:15:29,222 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:29,226 - DEBUG - Finished converting page batch time=3660.217
2025-06-10 20:15:29,272 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:29,274 - DEBUG - Finished converting page batch time=3660.265
2025-06-10 20:15:27,458 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:27,531 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:15:27,531 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:15:27,532 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:15:27,553 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:15:27,582 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:15:27,603 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 429 0
2025-06-10 20:15:27,624 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 429 0
2025-06-10 20:15:27,647 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 429 0
2025-06-10 20:15:27,668 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 429 0
2025-06-10 20:15:27,775 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:15:27,795 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:27,799 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 429 0
2025-06-10 20:15:27,820 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 429 0
2025-06-10 20:15:27,946 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 429 0
2025-06-10 20:15:28,073 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:28,238 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 429 0
2025-06-10 20:15:28,468 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:15:28,469 - INFO - Processing document 10.1136_bmjopen-2015-009493_420.pdf
2025-06-10 20:15:28,509 - DEBUG - Snippet 10.3390_ijerph17103591_317_item_1: generation shape=torch.Size([1, 456])
2025-06-10 20:15:28,510 - DEBUG - Snippet 10.3390_ijerph17103591_317_item_1 raw docling: (tokens=110)
<formula><loc_0><loc_0><loc_500><loc_500>\beta _ { l } = \alpha _ { 0 } + \alpha _ { 1 } l + \alpha _ { 2 } l ^ { 2 } + \dots + \alpha _ { p } l ^ { p } , \, l = 1 , 2 , \dots , L ; \, p = 1 , 2 , \dots , n ; \, n < l .</formula><end_of_utterance>
2025-06-10 20:15:28,510 - DEBUG - Starting _parse_docling_output
2025-06-10 20:15:28,510 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>\beta _ { l } = \alpha _ { 0 } + \alpha _ { 1 } l + \alpha _ { 2 } l ^ { 2 } + \dots + \alpha _ { p } l ^ { p } , \, l = 1 , 2 , \dots , L ; \, p = 1 , 2 , \dots , n ; \, n < l .</formula><end_of_utterance>
2025-06-10 20:15:28,510 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:15:28,511 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>\\beta _ { l } = \\alpha _ { 0 } + \\alpha _ { 1 } l + \\alpha _ { 2 } l ^ { 2 } + \\dots + \\alpha _ { p } l ^ { p } , \\, l = 1 , 2 , \\dots , L ; \\, p = 1 , 2 , \\dots , n ; \\, n < l .</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=1090x71 at 0x7F96E7D510D0>)]
2025-06-10 20:15:28,511 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:15:28,515 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=1090.0, b=71.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 172))], orig='\\beta _ { l } = \\alpha _ { 0 } + \\alpha _ { 1 } l + \\alpha _ { 2 } l ^ { 2 } + \\dots + \\alpha _ { p } l ^ { p } , \\, l = 1 , 2 , \\dots , L ; \\, p = 1 , 2 , \\dots , n ; \\, n', text='\\beta _ { l } = \\alpha _ { 0 } + \\alpha _ { 1 } l + \\alpha _ { 2 } l ^ { 2 } + \\dots + \\alpha _ { p } l ^ { p } , \\, l = 1 , 2 , \\dots , L ; \\, p = 1 , 2 , \\dots , n ; \\, n', formatting=None, hyperlink=None)]
2025-06-10 20:15:28,515 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:15:28,515 - DEBUG - Processing text item: label=formula, text=\beta _ { l } = \alpha _ { 0 } + \alpha _ { 1 } l + \alpha _ { 2 } l ^ { 2 } + \dots + \alpha _ { p } l ^ { p } , \, l = 1 , 2 , \dots , L ; \, p = 1 , 2 , \dots , n ; \, n
2025-06-10 20:15:28,515 - DEBUG - Recognized string extracted: \beta _ { l } = \alpha _ { 0 } + \alpha _ { 1 } l + \alpha _ { 2 } l ^ { 2 } + \dots + \alpha _ { p } l ^ { p } , \, l = 1 , 2 , \dots , L ; \, p = 1 , 2 , \dots , n ; \, n
2025-06-10 20:15:28,516 - DEBUG - Generating chat message for label: formula
2025-06-10 20:15:28,516 - DEBUG - Snippet 10.3390_ijerph17103591_317_item_2 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:15:28,557 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:28,587 - DEBUG - Snippet 10.3390_ijerph17103591_317_item_2 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:15:28,613 - DEBUG - [Page 14] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:28,870 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:28,872 - DEBUG - Finished converting page batch time=3662.027
2025-06-10 20:15:28,985 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:29,054 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:29,187 - DEBUG - Dynamic vertical threshold: 78.8886, Overlap threshold: 0.7
2025-06-10 20:15:29,188 - DEBUG - [Page 15] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:29,190 - DEBUG - Finished converting page batch time=3662.345
2025-06-10 20:15:29,319 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:29,452 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:29,590 - DEBUG - Dynamic vertical threshold: 140.6502, Overlap threshold: 0.7
2025-06-10 20:15:29,590 - DEBUG - [Page 16] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:29,669 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:29,914 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:29,960 - DEBUG - Dynamic vertical threshold: 77.10479999999997, Overlap threshold: 0.7
2025-06-10 20:15:29,960 - DEBUG - Checking merge:
  Current: 8, Next: 7
2025-06-10 20:15:29,960 - DEBUG -   Vertical gap: 12.518000000000029, Overlap ratio: 0.9613367292177508
2025-06-10 20:15:29,960 - DEBUG -   Left boundary diff: 13.039999999999992, Right boundary diff: 49.61800000000005
2025-06-10 20:15:29,960 - DEBUG -   Alignment factor (ratio): 0.19415401471278781
2025-06-10 20:15:29,961 - DEBUG -   -> c1 8 formula number: 6, c2 7 formula number: None
2025-06-10 20:15:29,961 - DEBUG -   -> Merging clusters 8 and 7 with vertical gap 12.518000000000029 and overlap ratio 0.9613367292177508
2025-06-10 20:15:29,961 - DEBUG - [Page 17] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:29,966 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:30,228 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:30,228 - DEBUG - Finished converting page batch time=3663.384
2025-06-10 20:15:30,300 - DEBUG - Dynamic vertical threshold: 142.64100000000002, Overlap threshold: 0.7
2025-06-10 20:15:30,300 - DEBUG - [Page 18] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:30,452 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:30,584 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:30,686 - DEBUG - Snippet 10.3390_ijerph17103591_317_item_2: generation shape=torch.Size([1, 423])
2025-06-10 20:15:30,687 - DEBUG - Snippet 10.3390_ijerph17103591_317_item_2 raw docling: (tokens=77)
<formula><loc_0><loc_0><loc_500><loc_500>\log ( E ( y _ { t } ) ) = \varepsilon _ { t } + \sum _ { i = 1 } ^ { m } \beta _ { i , l } p _ { i , l } ( x _ { t } ) .</formula><end_of_utterance>
2025-06-10 20:15:30,687 - DEBUG - Starting _parse_docling_output
2025-06-10 20:15:30,688 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>\log ( E ( y _ { t } ) ) = \varepsilon _ { t } + \sum _ { i = 1 } ^ { m } \beta _ { i , l } p _ { i , l } ( x _ { t } ) .</formula><end_of_utterance>
2025-06-10 20:15:30,688 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:15:30,688 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>\\log ( E ( y _ { t } ) ) = \\varepsilon _ { t } + \\sum _ { i = 1 } ^ { m } \\beta _ { i , l } p _ { i , l } ( x _ { t } ) .</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=852x157 at 0x7F96E7D53230>)]
2025-06-10 20:15:30,688 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:15:30,692 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=852.0, b=157.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 121))], orig='\\log ( E ( y _ { t } ) ) = \\varepsilon _ { t } + \\sum _ { i = 1 } ^ { m } \\beta _ { i , l } p _ { i , l } ( x _ { t } ) .', text='\\log ( E ( y _ { t } ) ) = \\varepsilon _ { t } + \\sum _ { i = 1 } ^ { m } \\beta _ { i , l } p _ { i , l } ( x _ { t } ) .', formatting=None, hyperlink=None)]
2025-06-10 20:15:30,693 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:15:30,693 - DEBUG - Processing text item: label=formula, text=\log ( E ( y _ { t } ) ) = \varepsilon _ { t } + \sum _ { i = 1 } ^ { m } \beta _ { i , l } p _ { i , l } ( x _ { t } ) .
2025-06-10 20:15:30,693 - DEBUG - Recognized string extracted: \log ( E ( y _ { t } ) ) = \varepsilon _ { t } + \sum _ { i = 1 } ^ { m } \beta _ { i , l } p _ { i , l } ( x _ { t } ) .
2025-06-10 20:15:30,693 - DEBUG - Generating chat message for label: formula
2025-06-10 20:15:30,694 - DEBUG - Snippet 10.3390_ijerph17103591_317_item_3 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:15:30,760 - DEBUG - Snippet 10.3390_ijerph17103591_317_item_3 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:15:30,809 - DEBUG - [Page 19] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:30,810 - DEBUG - Finished converting page batch time=3663.965
2025-06-10 20:15:30,820 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:31,040 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:31,100 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:31,269 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:31,271 - DEBUG - Finished converting page batch time=3664.426
2025-06-10 20:15:31,343 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:31,453 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:31,797 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:31,951 - DEBUG - [Page 20] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:32,198 - DEBUG - Snippet 10.3390_ijerph17103591_317_item_3: generation shape=torch.Size([1, 394])
2025-06-10 20:15:32,199 - DEBUG - Snippet 10.3390_ijerph17103591_317_item_3 raw docling: (tokens=48)
<formula><loc_0><loc_0><loc_500><loc_500>R R _ { i , l } = e ^ { c o n s t \cdot \beta _ { i , l } } .</formula><end_of_utterance>
2025-06-10 20:15:32,201 - DEBUG - Starting _parse_docling_output
2025-06-10 20:15:32,202 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>R R _ { i , l } = e ^ { c o n s t \cdot \beta _ { i , l } } .</formula><end_of_utterance>
2025-06-10 20:15:32,202 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:15:32,202 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>R R _ { i , l } = e ^ { c o n s t \\cdot \\beta _ { i , l } } .</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=752x75 at 0x7F96E7D52870>)]
2025-06-10 20:15:32,202 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:15:32,205 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=752.0, b=75.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 61))], orig='R R _ { i , l } = e ^ { c o n s t \\cdot \\beta _ { i , l } } .', text='R R _ { i , l } = e ^ { c o n s t \\cdot \\beta _ { i , l } } .', formatting=None, hyperlink=None)]
2025-06-10 20:15:32,205 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:15:32,205 - DEBUG - Processing text item: label=formula, text=R R _ { i , l } = e ^ { c o n s t \cdot \beta _ { i , l } } .
2025-06-10 20:15:32,206 - DEBUG - Recognized string extracted: R R _ { i , l } = e ^ { c o n s t \cdot \beta _ { i , l } } .
2025-06-10 20:15:32,206 - DEBUG - Generating chat message for label: formula
2025-06-10 20:15:32,206 - DEBUG - Snippet 10.3390_ijerph17103591_317_item_4 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:15:32,212 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:32,276 - DEBUG - Snippet 10.3390_ijerph17103591_317_item_4 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:15:32,358 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:32,440 - DEBUG - Dynamic vertical threshold: 64.05840000000005, Overlap threshold: 0.7
2025-06-10 20:15:32,440 - DEBUG - [Page 21] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:32,511 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:32,512 - DEBUG - Finished converting page batch time=3665.668
2025-06-10 20:15:32,681 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:32,682 - DEBUG - Finished converting page batch time=3665.837
2025-06-10 20:15:32,949 - DEBUG - [Page 22] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:33,404 - DEBUG - Dynamic vertical threshold: 64.05839999999993, Overlap threshold: 0.7
2025-06-10 20:15:33,405 - DEBUG - [Page 23] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:33,406 - DEBUG - Finished converting page batch time=3666.562
2025-06-10 20:15:33,445 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:33,447 - DEBUG - Finished converting page batch time=3666.602
2025-06-10 20:15:33,447 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:33,448 - DEBUG - Finished converting page batch time=3666.604
2025-06-10 20:15:33,597 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:33,675 - DEBUG - Finished converting page batch time=3666.830
2025-06-10 20:15:33,675 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:33,764 - DEBUG - [Page 24] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:33,869 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:33,870 - DEBUG - Finished converting page batch time=3667.026
2025-06-10 20:15:33,983 - INFO - Finished converting document 10.1371_journal.pone.0157014_404.pdf in 14.13 sec.
2025-06-10 20:15:34,099 - INFO - Extraction successful row 64, tokens=13380
2025-06-10 20:15:34,124 - INFO - Going to convert document batch...
2025-06-10 20:15:34,124 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:15:34,125 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:15:34,147 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 429 3243
2025-06-10 20:15:34,325 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:34,382 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:34,627 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:34,829 - DEBUG - [Page 25] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:34,901 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:15:34,922 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 429 3243
2025-06-10 20:15:34,923 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:15:35,038 - DEBUG - [Page 26] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:35,192 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:35,198 - DEBUG - Finished converting page batch time=3668.353
2025-06-10 20:15:35,219 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:35,263 - DEBUG - [Page 27] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:35,264 - DEBUG - Finished converting page batch time=3668.419
2025-06-10 20:15:35,361 - DEBUG - Snippet 10.3390_ijerph17103591_317_item_4: generation shape=torch.Size([1, 449])
2025-06-10 20:15:35,362 - DEBUG - Snippet 10.3390_ijerph17103591_317_item_4 raw docling: (tokens=103)
<formula><loc_0><loc_0><loc_500><loc_500>\log ( E ( y _ { t } ) ) = \varepsilon _ { t } + \sum _ { i = 1 } ^ { m } \beta _ { i } p _ { i } ( x _ { t } ) + \sum _ { i = m + 1 } ^ { p } s _ { i } ( x _ { t , l } ) .</formula><end_of_utterance>
2025-06-10 20:15:35,362 - DEBUG - Starting _parse_docling_output
2025-06-10 20:15:35,363 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>\log ( E ( y _ { t } ) ) = \varepsilon _ { t } + \sum _ { i = 1 } ^ { m } \beta _ { i } p _ { i } ( x _ { t } ) + \sum _ { i = m + 1 } ^ { p } s _ { i } ( x _ { t , l } ) .</formula><end_of_utterance>
2025-06-10 20:15:35,363 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:15:35,363 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>\\log ( E ( y _ { t } ) ) = \\varepsilon _ { t } + \\sum _ { i = 1 } ^ { m } \\beta _ { i } p _ { i } ( x _ { t } ) + \\sum _ { i = m + 1 } ^ { p } s _ { i } ( x _ { t , l } ) .</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=934x161 at 0x7F96E7D52C30>)]
2025-06-10 20:15:35,363 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:15:35,368 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=934.0, b=161.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 172))], orig='\\log ( E ( y _ { t } ) ) = \\varepsilon _ { t } + \\sum _ { i = 1 } ^ { m } \\beta _ { i } p _ { i } ( x _ { t } ) + \\sum _ { i = m + 1 } ^ { p } s _ { i } ( x _ { t , l } ) .', text='\\log ( E ( y _ { t } ) ) = \\varepsilon _ { t } + \\sum _ { i = 1 } ^ { m } \\beta _ { i } p _ { i } ( x _ { t } ) + \\sum _ { i = m + 1 } ^ { p } s _ { i } ( x _ { t , l } ) .', formatting=None, hyperlink=None)]
2025-06-10 20:15:35,369 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:15:35,369 - DEBUG - Processing text item: label=formula, text=\log ( E ( y _ { t } ) ) = \varepsilon _ { t } + \sum _ { i = 1 } ^ { m } \beta _ { i } p _ { i } ( x _ { t } ) + \sum _ { i = m + 1 } ^ { p } s _ { i } ( x _ { t , l } ) .
2025-06-10 20:15:35,369 - DEBUG - Recognized string extracted: \log ( E ( y _ { t } ) ) = \varepsilon _ { t } + \sum _ { i = 1 } ^ { m } \beta _ { i } p _ { i } ( x _ { t } ) + \sum _ { i = m + 1 } ^ { p } s _ { i } ( x _ { t , l } ) .
2025-06-10 20:15:35,369 - INFO - All done. Returning 5 recognized text results.
2025-06-10 20:15:35,369 - DEBUG - Snippet 10.3390_ijerph17103591_317_item_0 recognized text:
y _ { t } = \varepsilon _ { t } + \sum _ { l = 0 } ^ { \underline { L } } \beta _ { l } p _ { l } ( x _ { t } ) .
2025-06-10 20:15:35,370 - DEBUG - Snippet 10.3390_ijerph17103591_317_item_1 recognized text:
\beta _ { l } = \alpha _ { 0 } + \alpha _ { 1 } l + \alpha _ { 2 } l ^ { 2 } + \dots + \alpha _ { p } l ^ { p } , \, l = 1 , 2 , \dots , L ; \, p = 1 , 2 , \dots , n ; \, n
2025-06-10 20:15:35,370 - DEBUG - Snippet 10.3390_ijerph17103591_317_item_2 recognized text:
\log ( E ( y _ { t } ) ) = \varepsilon _ { t } + \sum _ { i = 1 } ^ { m } \beta _ { i , l } p _ { i , l } ( x _ { t } ) .
2025-06-10 20:15:35,370 - DEBUG - Snippet 10.3390_ijerph17103591_317_item_3 recognized text:
R R _ { i , l } = e ^ { c o n s t \cdot \beta _ { i , l } } .
2025-06-10 20:15:35,370 - DEBUG - Snippet 10.3390_ijerph17103591_317_item_4 recognized text:
\log ( E ( y _ { t } ) ) = \varepsilon _ { t } + \sum _ { i = 1 } ^ { m } \beta _ { i } p _ { i } ( x _ { t } ) + \sum _ { i = m + 1 } ^ { p } s _ { i } ( x _ { t , l } ) .
2025-06-10 20:15:35,423 - DEBUG - Creating masked image for page 5 with 18 clusters.
2025-06-10 20:15:35,425 - INFO - Masked image successfully created for page 5.
2025-06-10 20:15:35,427 - INFO - Starting prediction for 1 images with labels: ['formula']
2025-06-10 20:15:35,427 - DEBUG - Generating chat message for label: formula
2025-06-10 20:15:35,427 - DEBUG - Snippet 10.7196_samj.2022.v112i8b.16483_384_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:15:35,468 - INFO - Finished converting document 10.3390_ijerph17103591_317.pdf in 25.63 sec.
2025-06-10 20:15:35,476 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:15:35,477 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:15:35,477 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:15:35,498 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:15:35,519 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:15:35,540 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 429 0
2025-06-10 20:15:35,564 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 429 0
2025-06-10 20:15:35,587 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 429 0
2025-06-10 20:15:35,589 - INFO - Extraction successful row 60, tokens=21597
2025-06-10 20:15:35,608 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 429 0
2025-06-10 20:15:35,628 - INFO - Going to convert document batch...
2025-06-10 20:15:35,628 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:15:35,629 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:15:35,652 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 429 3243
2025-06-10 20:15:35,732 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:15:35,755 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 429 0
2025-06-10 20:15:35,776 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 429 0
2025-06-10 20:15:35,778 - DEBUG - Snippet 10.7196_samj.2022.v112i8b.16483_384_item_0 => input_ids shape=torch.Size([1, 1140]), prompt_len=1140
2025-06-10 20:15:35,797 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:35,910 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 429 0
2025-06-10 20:15:35,987 - DEBUG - [Page 28] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:36,053 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:36,088 - DEBUG - [Page 29] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:36,197 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 429 0
2025-06-10 20:15:36,205 - DEBUG - [Page 30] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:36,312 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:15:36,334 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 429 3243
2025-06-10 20:15:36,335 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:15:36,351 - DEBUG - [Page 31] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:36,353 - DEBUG - Finished converting page batch time=3669.508
2025-06-10 20:15:36,355 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:36,357 - DEBUG - Finished converting page batch time=3669.512
2025-06-10 20:15:36,390 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:15:36,390 - INFO - Processing document 10.1007_s12199-007-0018-5_428.pdf
2025-06-10 20:15:36,461 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:36,462 - DEBUG - Finished converting page batch time=3669.617
2025-06-10 20:15:36,619 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:36,646 - INFO - Finished converting document 10.3389_fimmu.2019.02518_391.pdf in 16.89 sec.
2025-06-10 20:15:36,652 - DEBUG - Dynamic vertical threshold: 296.3277, Overlap threshold: 0.7
2025-06-10 20:15:36,652 - DEBUG - [Page 32] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:36,733 - INFO - Extraction successful row 63, tokens=15181
2025-06-10 20:15:36,761 - INFO - Going to convert document batch...
2025-06-10 20:15:36,761 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:15:36,762 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:15:36,784 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 429 3243
2025-06-10 20:15:36,847 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:15:36,848 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:15:36,848 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:15:36,869 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:15:36,891 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:15:36,913 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 429 0
2025-06-10 20:15:36,936 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 429 0
2025-06-10 20:15:36,945 - DEBUG - [Page 33] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:36,946 - DEBUG - Finished converting page batch time=3670.101
2025-06-10 20:15:36,959 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 429 0
2025-06-10 20:15:36,990 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 429 0
2025-06-10 20:15:37,056 - DEBUG - Creating masked image for page 3 with 12 clusters.
2025-06-10 20:15:37,057 - INFO - Masked image successfully created for page 3.
2025-06-10 20:15:37,108 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:15:37,118 - DEBUG - Creating masked image for page 4 with 9 clusters.
2025-06-10 20:15:37,119 - INFO - Masked image successfully created for page 4.
2025-06-10 20:15:37,130 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 429 0
2025-06-10 20:15:37,152 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 429 0
2025-06-10 20:15:37,179 - DEBUG - Creating masked image for page 6 with 11 clusters.
2025-06-10 20:15:37,180 - INFO - Masked image successfully created for page 6.
2025-06-10 20:15:37,241 - DEBUG - Creating masked image for page 7 with 11 clusters.
2025-06-10 20:15:37,242 - INFO - Masked image successfully created for page 7.
2025-06-10 20:15:37,252 - INFO - Starting prediction for 5 images with labels: ['formula', 'formula', 'formula', 'formula', 'formula']
2025-06-10 20:15:37,252 - DEBUG - Generating chat message for label: formula
2025-06-10 20:15:37,253 - DEBUG - Snippet 10.1016_s0140-67361832225-6_386_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:15:37,263 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:37,281 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 429 0
2025-06-10 20:15:37,334 - DEBUG - Snippet 10.1016_s0140-67361832225-6_386_item_0 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:15:37,431 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:15:37,452 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 429 3243
2025-06-10 20:15:37,453 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:15:37,492 - DEBUG - Snippet 10.7196_samj.2022.v112i8b.16483_384_item_0: generation shape=torch.Size([1, 1187])
2025-06-10 20:15:37,494 - DEBUG - Snippet 10.7196_samj.2022.v112i8b.16483_384_item_0 raw docling: (tokens=46)
<formula><loc_0><loc_0><loc_500><loc_500>\frac { \sum ( P _ { i } x C _ { i } ) } { \sum P _ { i } }</formula><end_of_utterance>
2025-06-10 20:15:37,494 - DEBUG - Starting _parse_docling_output
2025-06-10 20:15:37,494 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>\frac { \sum ( P _ { i } x C _ { i } ) } { \sum P _ { i } }</formula><end_of_utterance>
2025-06-10 20:15:37,494 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:15:37,495 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>\\frac { \\sum ( P _ { i } x C _ { i } ) } { \\sum P _ { i } }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=128x148 at 0x7F96D62DFF20>)]
2025-06-10 20:15:37,495 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:15:37,496 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=128.0, b=148.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 59))], orig='\\frac { \\sum ( P _ { i } x C _ { i } ) } { \\sum P _ { i } }', text='\\frac { \\sum ( P _ { i } x C _ { i } ) } { \\sum P _ { i } }', formatting=None, hyperlink=None)]
2025-06-10 20:15:37,497 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:15:37,497 - DEBUG - Processing text item: label=formula, text=\frac { \sum ( P _ { i } x C _ { i } ) } { \sum P _ { i } }
2025-06-10 20:15:37,497 - DEBUG - Recognized string extracted: \frac { \sum ( P _ { i } x C _ { i } ) } { \sum P _ { i } }
2025-06-10 20:15:37,497 - INFO - All done. Returning 1 recognized text results.
2025-06-10 20:15:37,498 - DEBUG - Snippet 10.7196_samj.2022.v112i8b.16483_384_item_0 recognized text:
\frac { \sum ( P _ { i } x C _ { i } ) } { \sum P _ { i } }
2025-06-10 20:15:37,498 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:37,499 - DEBUG - Finished converting page batch time=3670.655
2025-06-10 20:15:37,542 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 429 0
2025-06-10 20:15:37,687 - INFO - Finished converting document 10.7196_samj.2022.v112i8b.16483_384.pdf in 24.55 sec.
2025-06-10 20:15:37,753 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:15:37,754 - INFO - Processing document 10.3390_ijms20030634_429.pdf
2025-06-10 20:15:37,794 - INFO - Finished converting document 10.1136_oem.2007.033175_418.pdf in 14.44 sec.
2025-06-10 20:15:37,884 - INFO - Extraction successful row 66, tokens=14919
2025-06-10 20:15:37,901 - INFO - Extraction successful row 61, tokens=24560
2025-06-10 20:15:37,905 - INFO - Going to convert document batch...
2025-06-10 20:15:37,906 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:15:37,906 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:15:37,924 - INFO - Going to convert document batch...
2025-06-10 20:15:37,924 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:15:37,925 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:15:37,929 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 429 3243
2025-06-10 20:15:37,947 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 429 3243
2025-06-10 20:15:38,011 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:15:38,012 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:15:38,012 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:15:38,035 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:15:38,058 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:15:38,077 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:38,087 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 429 0
2025-06-10 20:15:38,109 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 429 0
2025-06-10 20:15:38,132 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 429 0
2025-06-10 20:15:38,154 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 429 0
2025-06-10 20:15:38,206 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:38,233 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:38,234 - DEBUG - Finished converting page batch time=3671.389
2025-06-10 20:15:38,258 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:15:38,282 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 429 0
2025-06-10 20:15:38,305 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 429 0
2025-06-10 20:15:38,431 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 429 0
2025-06-10 20:15:38,613 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:15:38,637 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 429 3243
2025-06-10 20:15:38,638 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:15:38,684 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 429 0
2025-06-10 20:15:38,838 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:15:38,862 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 429 3243
2025-06-10 20:15:38,863 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:15:38,868 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:38,895 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:38,895 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:15:38,896 - INFO - Processing document 10.3390_ijms21124306_444.pdf
2025-06-10 20:15:39,137 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:15:39,137 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:15:39,138 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:15:39,167 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:15:39,191 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:15:39,212 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 429 0
2025-06-10 20:15:39,234 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 429 0
2025-06-10 20:15:39,256 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 429 0
2025-06-10 20:15:39,276 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 429 0
2025-06-10 20:15:39,284 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:39,342 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:39,388 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:15:39,408 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 429 0
2025-06-10 20:15:39,427 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:15:39,428 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:15:39,428 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:15:39,430 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 429 0
2025-06-10 20:15:39,450 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:15:39,472 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:15:39,496 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 429 0
2025-06-10 20:15:39,517 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 429 0
2025-06-10 20:15:39,540 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 429 0
2025-06-10 20:15:39,563 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 429 0
2025-06-10 20:15:39,566 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 429 0
2025-06-10 20:15:39,629 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:39,670 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:15:39,691 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 429 0
2025-06-10 20:15:39,712 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 429 0
2025-06-10 20:15:39,833 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 429 0
2025-06-10 20:15:39,849 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 429 0
2025-06-10 20:15:40,011 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:40,012 - DEBUG - Finished converting page batch time=3673.167
2025-06-10 20:15:40,017 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:15:40,017 - INFO - Processing document 10.1289_ehp1390_448.pdf
2025-06-10 20:15:40,028 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:40,116 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 429 0
2025-06-10 20:15:40,138 - INFO - Finished converting document 10.1136_bmjopen-2015-009493_420.pdf in 14.19 sec.
2025-06-10 20:15:40,167 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:40,197 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:40,218 - INFO - Extraction successful row 67, tokens=9465
2025-06-10 20:15:40,233 - DEBUG - Snippet 10.1016_s0140-67361832225-6_386_item_0: generation shape=torch.Size([1, 446])
2025-06-10 20:15:40,234 - DEBUG - Snippet 10.1016_s0140-67361832225-6_386_item_0 raw docling: (tokens=100)
<formula><loc_0><loc_0><loc_500><loc_500>O P T ( \sigma ) \geq \frac { 1 } { 1 + \frac { k - 1 } { k } - \frac { k - 1 } { p - 1 } } \sum _ { l = k } ^ { p - 1 } \frac { l - k + 1 } { l } c _ { l } .</formula><end_of_utterance>
2025-06-10 20:15:40,234 - DEBUG - Starting _parse_docling_output
2025-06-10 20:15:40,235 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>O P T ( \sigma ) \geq \frac { 1 } { 1 + \frac { k - 1 } { k } - \frac { k - 1 } { p - 1 } } \sum _ { l = k } ^ { p - 1 } \frac { l - k + 1 } { l } c _ { l } .</formula><end_of_utterance>
2025-06-10 20:15:40,235 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:15:40,235 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>O P T ( \\sigma ) \\geq \\frac { 1 } { 1 + \\frac { k - 1 } { k } - \\frac { k - 1 } { p - 1 } } \\sum _ { l = k } ^ { p - 1 } \\frac { l - k + 1 } { l } c _ { l } .</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=755x188 at 0x7F97159E4A40>)]
2025-06-10 20:15:40,236 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:15:40,240 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=755.0, b=188.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 158))], orig='O P T ( \\sigma ) \\geq \\frac { 1 } { 1 + \\frac { k - 1 } { k } - \\frac { k - 1 } { p - 1 } } \\sum _ { l = k } ^ { p - 1 } \\frac { l - k + 1 } { l } c _ { l } .', text='O P T ( \\sigma ) \\geq \\frac { 1 } { 1 + \\frac { k - 1 } { k } - \\frac { k - 1 } { p - 1 } } \\sum _ { l = k } ^ { p - 1 } \\frac { l - k + 1 } { l } c _ { l } .', formatting=None, hyperlink=None)]
2025-06-10 20:15:40,240 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:15:40,240 - DEBUG - Processing text item: label=formula, text=O P T ( \sigma ) \geq \frac { 1 } { 1 + \frac { k - 1 } { k } - \frac { k - 1 } { p - 1 } } \sum _ { l = k } ^ { p - 1 } \frac { l - k + 1 } { l } c _ { l } .
2025-06-10 20:15:40,241 - DEBUG - Recognized string extracted: O P T ( \sigma ) \geq \frac { 1 } { 1 + \frac { k - 1 } { k } - \frac { k - 1 } { p - 1 } } \sum _ { l = k } ^ { p - 1 } \frac { l - k + 1 } { l } c _ { l } .
2025-06-10 20:15:40,241 - DEBUG - Generating chat message for label: formula
2025-06-10 20:15:40,241 - DEBUG - Snippet 10.1016_s0140-67361832225-6_386_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:15:40,243 - INFO - Going to convert document batch...
2025-06-10 20:15:40,244 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:15:40,244 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:15:40,271 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 429 3243
2025-06-10 20:15:40,305 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:40,307 - DEBUG - Finished converting page batch time=3673.462
2025-06-10 20:15:40,313 - DEBUG - Snippet 10.1016_s0140-67361832225-6_386_item_1 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:15:40,318 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:15:40,319 - INFO - Processing document 10.1146_annurev-publhealth-052120-101420_449.pdf
2025-06-10 20:15:40,389 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:40,429 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:40,804 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:41,001 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:41,090 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:41,092 - DEBUG - Finished converting page batch time=3674.247
2025-06-10 20:15:41,101 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:15:41,121 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 429 3243
2025-06-10 20:15:41,122 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:15:41,283 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:41,397 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:41,422 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:41,631 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:15:41,631 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:15:41,632 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:15:41,653 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:15:41,685 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:15:41,707 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 429 0
2025-06-10 20:15:41,729 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 429 0
2025-06-10 20:15:41,751 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 429 0
2025-06-10 20:15:41,775 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 429 0
2025-06-10 20:15:41,890 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:15:41,922 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 429 0
2025-06-10 20:15:41,945 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 429 0
2025-06-10 20:15:42,018 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:42,019 - DEBUG - Finished converting page batch time=3675.174
2025-06-10 20:15:42,081 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 429 0
2025-06-10 20:15:42,088 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:42,132 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:42,133 - DEBUG - Finished converting page batch time=3675.288
2025-06-10 20:15:42,147 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:42,370 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 429 0
2025-06-10 20:15:42,401 - DEBUG - [Page 14] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:42,533 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:15:42,533 - INFO - Processing document 10.1186_1476-7120-7-30_452.pdf
2025-06-10 20:15:42,555 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:42,689 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:42,701 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:42,745 - DEBUG - [Page 15] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:42,746 - DEBUG - Finished converting page batch time=3675.901
2025-06-10 20:15:43,110 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:43,190 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:43,211 - INFO - Finished converting document 10.1079_phn2003543_411.pdf in 21.95 sec.
2025-06-10 20:15:43,267 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:43,351 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:43,375 - DEBUG - Dynamic vertical threshold: 25.494299999999896, Overlap threshold: 0.7
2025-06-10 20:15:43,375 - DEBUG - Checking merge:
  Current: 12, Next: 13
2025-06-10 20:15:43,375 - DEBUG -   Vertical gap: 9.958000000000084, Overlap ratio: 1.0
2025-06-10 20:15:43,375 - DEBUG -   Left boundary diff: 33.84700000000004, Right boundary diff: 0.00100000000009004
2025-06-10 20:15:43,376 - DEBUG -   Alignment factor (ratio): 0.20335368051717118
2025-06-10 20:15:43,376 - DEBUG -   -> c1 12 formula number: None, c2 13 formula number: None
2025-06-10 20:15:43,376 - DEBUG -   -> Not merging clusters 12 and 13 because vertical_gap 9.958000000000084 > 3 with no numbers
2025-06-10 20:15:43,376 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:43,442 - INFO - Extraction successful row 65, tokens=25904
2025-06-10 20:15:43,455 - DEBUG - Snippet 10.1016_s0140-67361832225-6_386_item_1: generation shape=torch.Size([1, 455])
2025-06-10 20:15:43,456 - DEBUG - Snippet 10.1016_s0140-67361832225-6_386_item_1 raw docling: (tokens=109)
<formula><loc_0><loc_0><loc_500><loc_500>O P T ( \sigma ) \geq \max \left \{ p , k + \sum _ { l = k } ^ { \lambda - 1 } c _ { l } \frac { l - k + 1 } { k - 1 } + c _ { \lambda } ^ { * } \frac { \lambda - k + 1 } { k - 1 } \right \} .</formula><end_of_utterance>
2025-06-10 20:15:43,456 - DEBUG - Starting _parse_docling_output
2025-06-10 20:15:43,456 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>O P T ( \sigma ) \geq \max \left \{ p , k + \sum _ { l = k } ^ { \lambda - 1 } c _ { l } \frac { l - k + 1 } { k - 1 } + c _ { \lambda } ^ { * } \frac { \lambda - k + 1 } { k - 1 } \right \} .</formula><end_of_utterance>
2025-06-10 20:15:43,457 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:15:43,457 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>O P T ( \\sigma ) \\geq \\max \\left \\{ p , k + \\sum _ { l = k } ^ { \\lambda - 1 } c _ { l } \\frac { l - k + 1 } { k - 1 } + c _ { \\lambda } ^ { * } \\frac { \\lambda - k + 1 } { k - 1 } \\right \\} .</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=841x186 at 0x7F96B85BA6C0>)]
2025-06-10 20:15:43,457 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:15:43,462 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=841.0, b=186.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 192))], orig='O P T ( \\sigma ) \\geq \\max \\left \\{ p , k + \\sum _ { l = k } ^ { \\lambda - 1 } c _ { l } \\frac { l - k + 1 } { k - 1 } + c _ { \\lambda } ^ { * } \\frac { \\lambda - k + 1 } { k - 1 } \\right \\} .', text='O P T ( \\sigma ) \\geq \\max \\left \\{ p , k + \\sum _ { l = k } ^ { \\lambda - 1 } c _ { l } \\frac { l - k + 1 } { k - 1 } + c _ { \\lambda } ^ { * } \\frac { \\lambda - k + 1 } { k - 1 } \\right \\} .', formatting=None, hyperlink=None)]
2025-06-10 20:15:43,463 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:15:43,463 - DEBUG - Processing text item: label=formula, text=O P T ( \sigma ) \geq \max \left \{ p , k + \sum _ { l = k } ^ { \lambda - 1 } c _ { l } \frac { l - k + 1 } { k - 1 } + c _ { \lambda } ^ { * } \frac { \lambda - k + 1 } { k - 1 } \right \} .
2025-06-10 20:15:43,463 - DEBUG - Recognized string extracted: O P T ( \sigma ) \geq \max \left \{ p , k + \sum _ { l = k } ^ { \lambda - 1 } c _ { l } \frac { l - k + 1 } { k - 1 } + c _ { \lambda } ^ { * } \frac { \lambda - k + 1 } { k - 1 } \right \} .
2025-06-10 20:15:43,463 - DEBUG - Generating chat message for label: formula
2025-06-10 20:15:43,464 - DEBUG - Snippet 10.1016_s0140-67361832225-6_386_item_2 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:15:43,470 - INFO - Going to convert document batch...
2025-06-10 20:15:43,470 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:15:43,471 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:15:43,510 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 429 3243
2025-06-10 20:15:43,536 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:43,537 - DEBUG - Finished converting page batch time=3676.692
2025-06-10 20:15:43,604 - DEBUG - Snippet 10.1016_s0140-67361832225-6_386_item_2 => input_ids shape=torch.Size([1, 610]), prompt_len=610
2025-06-10 20:15:43,747 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:43,995 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:44,115 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:15:44,138 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 429 3243
2025-06-10 20:15:44,139 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:15:44,182 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:44,189 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:44,547 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:44,637 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:44,638 - DEBUG - Finished converting page batch time=3677.793
2025-06-10 20:15:44,675 - DEBUG - Dynamic vertical threshold: 41.713199999999965, Overlap threshold: 0.7
2025-06-10 20:15:44,676 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:44,783 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:15:44,784 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:15:44,784 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:15:44,786 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:44,805 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:15:44,829 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:15:44,849 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:44,850 - DEBUG - Finished converting page batch time=3678.005
2025-06-10 20:15:44,850 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 429 0
2025-06-10 20:15:44,873 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 429 0
2025-06-10 20:15:44,895 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 429 0
2025-06-10 20:15:44,916 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 429 0
2025-06-10 20:15:45,034 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:15:45,056 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 429 0
2025-06-10 20:15:45,077 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 429 0
2025-06-10 20:15:45,144 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:45,167 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:45,214 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 429 0
2025-06-10 20:15:45,328 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:45,330 - DEBUG - Finished converting page batch time=3678.485
2025-06-10 20:15:45,397 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:45,399 - DEBUG - Finished converting page batch time=3678.554
2025-06-10 20:15:45,472 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:45,485 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 429 0
2025-06-10 20:15:45,496 - INFO - Finished converting document 10.1007_s12199-007-0018-5_428.pdf in 11.40 sec.
2025-06-10 20:15:45,559 - INFO - Extraction successful row 68, tokens=9959
2025-06-10 20:15:45,585 - INFO - Going to convert document batch...
2025-06-10 20:15:45,585 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:15:45,585 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:15:45,610 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 429 3243
2025-06-10 20:15:45,667 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:15:45,668 - INFO - Processing document 10.1016_j.waojou.2020.100106_455.pdf
2025-06-10 20:15:45,674 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:45,744 - DEBUG - Snippet 10.1016_s0140-67361832225-6_386_item_2: generation shape=torch.Size([1, 685])
2025-06-10 20:15:45,746 - DEBUG - Snippet 10.1016_s0140-67361832225-6_386_item_2 raw docling: (tokens=74)
<formula><loc_0><loc_0><loc_500><loc_500>R _ { F I F O } ( C ) \geq \frac { L R U ( C ) + c ( k - 1 ) } { O P T ( C ) + c ( 1 - 1 / k ) + 1 } ,</formula><end_of_utterance>
2025-06-10 20:15:45,746 - DEBUG - Starting _parse_docling_output
2025-06-10 20:15:45,746 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>R _ { F I F O } ( C ) \geq \frac { L R U ( C ) + c ( k - 1 ) } { O P T ( C ) + c ( 1 - 1 / k ) + 1 } ,</formula><end_of_utterance>
2025-06-10 20:15:45,746 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:15:45,747 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>R _ { F I F O } ( C ) \\geq \\frac { L R U ( C ) + c ( k - 1 ) } { O P T ( C ) + c ( 1 - 1 / k ) + 1 } ,</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=453x158 at 0x7F96B85BA7B0>)]
2025-06-10 20:15:45,747 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:15:45,750 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=453.0, b=158.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 102))], orig='R _ { F I F O } ( C ) \\geq \\frac { L R U ( C ) + c ( k - 1 ) } { O P T ( C ) + c ( 1 - 1 / k ) + 1 } ,', text='R _ { F I F O } ( C ) \\geq \\frac { L R U ( C ) + c ( k - 1 ) } { O P T ( C ) + c ( 1 - 1 / k ) + 1 } ,', formatting=None, hyperlink=None)]
2025-06-10 20:15:45,751 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:15:45,751 - DEBUG - Processing text item: label=formula, text=R _ { F I F O } ( C ) \geq \frac { L R U ( C ) + c ( k - 1 ) } { O P T ( C ) + c ( 1 - 1 / k ) + 1 } ,
2025-06-10 20:15:45,751 - DEBUG - Recognized string extracted: R _ { F I F O } ( C ) \geq \frac { L R U ( C ) + c ( k - 1 ) } { O P T ( C ) + c ( 1 - 1 / k ) + 1 } ,
2025-06-10 20:15:45,751 - DEBUG - Generating chat message for label: formula
2025-06-10 20:15:45,752 - DEBUG - Snippet 10.1016_s0140-67361832225-6_386_item_3 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:15:45,863 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:45,877 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:45,886 - DEBUG - Snippet 10.1016_s0140-67361832225-6_386_item_3 => input_ids shape=torch.Size([1, 610]), prompt_len=610
2025-06-10 20:15:45,994 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:46,128 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:46,195 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:46,282 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:15:46,289 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:46,305 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 429 3243
2025-06-10 20:15:46,306 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:15:46,319 - DEBUG - Finished converting page batch time=3679.474
2025-06-10 20:15:46,507 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:46,514 - DEBUG - Finished converting page batch time=3679.669
2025-06-10 20:15:46,682 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:46,783 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:46,784 - DEBUG - Finished converting page batch time=3679.939
2025-06-10 20:15:46,813 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:46,814 - DEBUG - Finished converting page batch time=3679.969
2025-06-10 20:15:46,911 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:15:46,912 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:15:46,912 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:15:46,936 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:15:46,953 - INFO - Finished converting document 10.3390_ijms20030634_429.pdf in 11.36 sec.
2025-06-10 20:15:46,958 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:15:46,979 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 429 0
2025-06-10 20:15:47,001 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 429 0
2025-06-10 20:15:47,025 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 429 0
2025-06-10 20:15:47,048 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 429 0
2025-06-10 20:15:47,058 - INFO - Extraction successful row 69, tokens=15055
2025-06-10 20:15:47,088 - INFO - Going to convert document batch...
2025-06-10 20:15:47,089 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:15:47,089 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:15:47,105 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:47,113 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 429 3243
2025-06-10 20:15:47,168 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:47,175 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:15:47,196 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 429 0
2025-06-10 20:15:47,208 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:47,217 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 429 0
2025-06-10 20:15:47,351 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 429 0
2025-06-10 20:15:47,409 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:47,410 - DEBUG - Finished converting page batch time=3680.565
2025-06-10 20:15:47,611 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:47,635 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 429 0
2025-06-10 20:15:47,775 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:15:47,776 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:47,796 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 429 3243
2025-06-10 20:15:47,797 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:15:47,838 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:15:47,839 - INFO - Processing document 10.1186_s12940-017-0335-0_457.pdf
2025-06-10 20:15:48,193 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:48,329 - DEBUG - Finished converting page batch time=3681.485
2025-06-10 20:15:48,333 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:48,424 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:15:48,425 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:15:48,425 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:15:48,448 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:15:48,463 - DEBUG - Snippet 10.1016_s0140-67361832225-6_386_item_3: generation shape=torch.Size([1, 699])
2025-06-10 20:15:48,464 - DEBUG - Snippet 10.1016_s0140-67361832225-6_386_item_3 raw docling: (tokens=88)
<formula><loc_0><loc_0><loc_500><loc_500>\sum _ { l = k } ^ { p - 1 } h _ { l } ( l - k + 1 ) \leq ( p - k ) ( k - 1 ) + \sum _ { l = k } ^ { p - 1 } f _ { l } ( k - 1 ) .</formula><end_of_utterance>
2025-06-10 20:15:48,464 - DEBUG - Starting _parse_docling_output
2025-06-10 20:15:48,464 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>\sum _ { l = k } ^ { p - 1 } h _ { l } ( l - k + 1 ) \leq ( p - k ) ( k - 1 ) + \sum _ { l = k } ^ { p - 1 } f _ { l } ( k - 1 ) .</formula><end_of_utterance>
2025-06-10 20:15:48,464 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:15:48,465 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>\\sum _ { l = k } ^ { p - 1 } h _ { l } ( l - k + 1 ) \\leq ( p - k ) ( k - 1 ) + \\sum _ { l = k } ^ { p - 1 } f _ { l } ( k - 1 ) .</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=626x188 at 0x7F96B85BB170>)]
2025-06-10 20:15:48,465 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:15:48,469 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=626.0, b=188.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 130))], orig='\\sum _ { l = k } ^ { p - 1 } h _ { l } ( l - k + 1 ) \\leq ( p - k ) ( k - 1 ) + \\sum _ { l = k } ^ { p - 1 } f _ { l } ( k - 1 ) .', text='\\sum _ { l = k } ^ { p - 1 } h _ { l } ( l - k + 1 ) \\leq ( p - k ) ( k - 1 ) + \\sum _ { l = k } ^ { p - 1 } f _ { l } ( k - 1 ) .', formatting=None, hyperlink=None)]
2025-06-10 20:15:48,469 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:15:48,469 - DEBUG - Processing text item: label=formula, text=\sum _ { l = k } ^ { p - 1 } h _ { l } ( l - k + 1 ) \leq ( p - k ) ( k - 1 ) + \sum _ { l = k } ^ { p - 1 } f _ { l } ( k - 1 ) .
2025-06-10 20:15:48,469 - DEBUG - Recognized string extracted: \sum _ { l = k } ^ { p - 1 } h _ { l } ( l - k + 1 ) \leq ( p - k ) ( k - 1 ) + \sum _ { l = k } ^ { p - 1 } f _ { l } ( k - 1 ) .
2025-06-10 20:15:48,470 - DEBUG - Generating chat message for label: formula
2025-06-10 20:15:48,470 - DEBUG - Snippet 10.1016_s0140-67361832225-6_386_item_4 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:15:48,472 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:15:48,514 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 429 0
2025-06-10 20:15:48,536 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 429 0
2025-06-10 20:15:48,541 - DEBUG - Snippet 10.1016_s0140-67361832225-6_386_item_4 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:15:48,561 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 429 0
2025-06-10 20:15:48,568 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:48,589 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 429 0
2025-06-10 20:15:48,713 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:15:48,725 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:48,740 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 429 0
2025-06-10 20:15:48,763 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 429 0
2025-06-10 20:15:48,838 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:48,882 - DEBUG - [Page 14] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:48,900 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 429 0
2025-06-10 20:15:49,143 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:49,163 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 429 0
2025-06-10 20:15:49,174 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:49,331 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:15:49,331 - INFO - Processing document 10.1186_1465-9921-9-77_470.pdf
2025-06-10 20:15:49,433 - DEBUG - [Page 15] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:49,434 - DEBUG - Finished converting page batch time=3682.589
2025-06-10 20:15:49,491 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:49,756 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:49,758 - DEBUG - Finished converting page batch time=3682.913
2025-06-10 20:15:49,801 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:49,841 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:49,874 - INFO - Finished converting document 10.1186_1476-7120-7-30_452.pdf in 9.65 sec.
2025-06-10 20:15:49,880 - DEBUG - [Page 16] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:49,931 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:49,951 - INFO - Extraction successful row 73, tokens=9355
2025-06-10 20:15:49,973 - INFO - Going to convert document batch...
2025-06-10 20:15:49,973 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:15:49,974 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:15:49,998 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 429 3243
2025-06-10 20:15:50,149 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:50,150 - DEBUG - Finished converting page batch time=3683.305
2025-06-10 20:15:50,427 - DEBUG - [Page 14] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:50,601 - DEBUG - [Page 17] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:50,603 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:15:50,626 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 429 3243
2025-06-10 20:15:50,627 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:15:50,804 - DEBUG - [Page 15] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:50,814 - DEBUG - Finished converting page batch time=3683.969
2025-06-10 20:15:50,984 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:51,082 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:51,252 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:51,254 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:51,345 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:15:51,345 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:15:51,346 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:15:51,369 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:15:51,403 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:15:51,426 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 429 0
2025-06-10 20:15:51,448 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 429 0
2025-06-10 20:15:51,472 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 429 0
2025-06-10 20:15:51,495 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 429 0
2025-06-10 20:15:51,615 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:15:51,637 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 429 0
2025-06-10 20:15:51,660 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 429 0
2025-06-10 20:15:51,780 - DEBUG - [Page 18] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:51,787 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 429 0
2025-06-10 20:15:51,793 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:51,896 - DEBUG - [Page 16] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:51,939 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:52,048 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 429 0
2025-06-10 20:15:52,200 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:52,256 - DEBUG - Snippet 10.1016_s0140-67361832225-6_386_item_4: generation shape=torch.Size([1, 478])
2025-06-10 20:15:52,257 - DEBUG - Snippet 10.1016_s0140-67361832225-6_386_item_4 raw docling: (tokens=132)
<formula><loc_0><loc_0><loc_500><loc_500>f ( j , \gamma ) = k + \sum _ { l = k } ^ { j - 1 } c l \frac { l - k + 1 } { k - 1 } + \gamma \frac { j - k + 1 } { k - 1 } \text { and } \, \, g ( j , \gamma ) = p + ( c _ { j } - \gamma ) + \sum _ { l = j + 1 } ^ { p - 1 } c l .</formula><end_of_utterance>
2025-06-10 20:15:52,257 - DEBUG - Starting _parse_docling_output
2025-06-10 20:15:52,258 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>f ( j , \gamma ) = k + \sum _ { l = k } ^ { j - 1 } c l \frac { l - k + 1 } { k - 1 } + \gamma \frac { j - k + 1 } { k - 1 } \text { and } \, \, g ( j , \gamma ) = p + ( c _ { j } - \gamma ) + \sum _ { l = j + 1 } ^ { p - 1 } c l .</formula><end_of_utterance>
2025-06-10 20:15:52,258 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:15:52,258 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>f ( j , \\gamma ) = k + \\sum _ { l = k } ^ { j - 1 } c l \\frac { l - k + 1 } { k - 1 } + \\gamma \\frac { j - k + 1 } { k - 1 } \\text { and } \\, \\, g ( j , \\gamma ) = p + ( c _ { j } - \\gamma ) + \\sum _ { l = j + 1 } ^ { p - 1 } c l .</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=986x189 at 0x7F96B85BB650>)]
2025-06-10 20:15:52,258 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:15:52,261 - DEBUG - Finished converting page batch time=3685.416
2025-06-10 20:15:52,264 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=986.0, b=189.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 231))], orig='f ( j , \\gamma ) = k + \\sum _ { l = k } ^ { j - 1 } c l \\frac { l - k + 1 } { k - 1 } + \\gamma \\frac { j - k + 1 } { k - 1 } \\text { and } \\, \\, g ( j , \\gamma ) = p + ( c _ { j } - \\gamma ) + \\sum _ { l = j + 1 } ^ { p - 1 } c l .', text='f ( j , \\gamma ) = k + \\sum _ { l = k } ^ { j - 1 } c l \\frac { l - k + 1 } { k - 1 } + \\gamma \\frac { j - k + 1 } { k - 1 } \\text { and } \\, \\, g ( j , \\gamma ) = p + ( c _ { j } - \\gamma ) + \\sum _ { l = j + 1 } ^ { p - 1 } c l .', formatting=None, hyperlink=None)]
2025-06-10 20:15:52,264 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:15:52,265 - DEBUG - Processing text item: label=formula, text=f ( j , \gamma ) = k + \sum _ { l = k } ^ { j - 1 } c l \frac { l - k + 1 } { k - 1 } + \gamma \frac { j - k + 1 } { k - 1 } \text { and } \, \, g ( j , \gamma ) = p + ( c _ { j } - \gamma ) + \sum _ { l = j + 1 } ^ { p - 1 } c l .
2025-06-10 20:15:52,265 - DEBUG - Recognized string extracted: f ( j , \gamma ) = k + \sum _ { l = k } ^ { j - 1 } c l \frac { l - k + 1 } { k - 1 } + \gamma \frac { j - k + 1 } { k - 1 } \text { and } \, \, g ( j , \gamma ) = p + ( c _ { j } - \gamma ) + \sum _ { l = j + 1 } ^ { p - 1 } c l .
2025-06-10 20:15:52,265 - INFO - All done. Returning 5 recognized text results.
2025-06-10 20:15:52,265 - DEBUG - Snippet 10.1016_s0140-67361832225-6_386_item_0 recognized text:
O P T ( \sigma ) \geq \frac { 1 } { 1 + \frac { k - 1 } { k } - \frac { k - 1 } { p - 1 } } \sum _ { l = k } ^ { p - 1 } \frac { l - k + 1 } { l } c _ { l } .
2025-06-10 20:15:52,266 - DEBUG - Snippet 10.1016_s0140-67361832225-6_386_item_1 recognized text:
O P T ( \sigma ) \geq \max \left \{ p , k + \sum _ { l = k } ^ { \lambda - 1 } c _ { l } \frac { l - k + 1 } { k - 1 } + c _ { \lambda } ^ { * } \frac { \lambda - k + 1 } { k - 1 } \right \} .
2025-06-10 20:15:52,266 - DEBUG - Snippet 10.1016_s0140-67361832225-6_386_item_2 recognized text:
R _ { F I F O } ( C ) \geq \frac { L R U ( C ) + c ( k - 1 ) } { O P T ( C ) + c ( 1 - 1 / k ) + 1 } ,
2025-06-10 20:15:52,266 - DEBUG - Snippet 10.1016_s0140-67361832225-6_386_item_3 recognized text:
\sum _ { l = k } ^ { p - 1 } h _ { l } ( l - k + 1 ) \leq ( p - k ) ( k - 1 ) + \sum _ { l = k } ^ { p - 1 } f _ { l } ( k - 1 ) .
2025-06-10 20:15:52,266 - DEBUG - Snippet 10.1016_s0140-67361832225-6_386_item_4 recognized text:
f ( j , \gamma ) = k + \sum _ { l = k } ^ { j - 1 } c l \frac { l - k + 1 } { k - 1 } + \gamma \frac { j - k + 1 } { k - 1 } \text { and } \, \, g ( j , \gamma ) = p + ( c _ { j } - \gamma ) + \sum _ { l = j + 1 } ^ { p - 1 } c l .
2025-06-10 20:15:52,268 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:15:52,268 - INFO - Processing document 10.3390_su14159234_475.pdf
2025-06-10 20:15:52,323 - DEBUG - Creating masked image for page 8 with 16 clusters.
2025-06-10 20:15:52,323 - INFO - Masked image successfully created for page 8.
2025-06-10 20:15:52,385 - DEBUG - Creating masked image for page 11 with 22 clusters.
2025-06-10 20:15:52,386 - INFO - Masked image successfully created for page 11.
2025-06-10 20:15:52,396 - INFO - Starting prediction for 5 images with labels: ['formula', 'formula', 'formula', 'formula', 'formula']
2025-06-10 20:15:52,396 - DEBUG - Generating chat message for label: formula
2025-06-10 20:15:52,396 - DEBUG - Snippet 10.1016_s0140-67361832225-6_386_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:15:52,528 - DEBUG - Snippet 10.1016_s0140-67361832225-6_386_item_0 => input_ids shape=torch.Size([1, 610]), prompt_len=610
2025-06-10 20:15:52,645 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:52,707 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:52,708 - DEBUG - Finished converting page batch time=3685.863
2025-06-10 20:15:52,760 - DEBUG - [Page 19] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:52,761 - DEBUG - Finished converting page batch time=3685.916
2025-06-10 20:15:52,774 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:52,849 - DEBUG - [Page 17] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:52,931 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:52,992 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:52,993 - DEBUG - Finished converting page batch time=3686.148
2025-06-10 20:15:53,518 - DEBUG - [Page 18] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:53,526 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:53,527 - DEBUG - Finished converting page batch time=3686.683
2025-06-10 20:15:53,612 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:53,664 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:53,713 - DEBUG - [Page 20] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:53,982 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:54,084 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:54,192 - DEBUG - [Page 19] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:54,193 - DEBUG - Finished converting page batch time=3687.348
2025-06-10 20:15:54,374 - DEBUG - [Page 21] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:54,804 - DEBUG - [Page 20] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:54,868 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:54,871 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:54,884 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:54,964 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:55,215 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:55,347 - DEBUG - [Page 22] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:55,547 - DEBUG - [Page 14] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:55,552 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:55,574 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:55,575 - DEBUG - Finished converting page batch time=3688.730
2025-06-10 20:15:55,597 - DEBUG - Snippet 10.1016_s0140-67361832225-6_386_item_0: generation shape=torch.Size([1, 718])
2025-06-10 20:15:55,598 - DEBUG - Snippet 10.1016_s0140-67361832225-6_386_item_0 raw docling: (tokens=107)
<formula><loc_0><loc_0><loc_500><loc_500>O P ( \sigma ) \geq \max \left \{ p , k + \sum _ { l = k } ^ { \lambda - 1 } c _ { l } \frac { l - k + 1 } { k - 1 } + c _ { l } ^ { * } \frac { \lambda - k + 1 } { k - 1 } \right \} .</formula><end_of_utterance>
2025-06-10 20:15:55,598 - DEBUG - Starting _parse_docling_output
2025-06-10 20:15:55,599 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>O P ( \sigma ) \geq \max \left \{ p , k + \sum _ { l = k } ^ { \lambda - 1 } c _ { l } \frac { l - k + 1 } { k - 1 } + c _ { l } ^ { * } \frac { \lambda - k + 1 } { k - 1 } \right \} .</formula><end_of_utterance>
2025-06-10 20:15:55,599 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:15:55,599 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>O P ( \\sigma ) \\geq \\max \\left \\{ p , k + \\sum _ { l = k } ^ { \\lambda - 1 } c _ { l } \\frac { l - k + 1 } { k - 1 } + c _ { l } ^ { * } \\frac { \\lambda - k + 1 } { k - 1 } \\right \\} .</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=691x186 at 0x7F96B85CF560>)]
2025-06-10 20:15:55,599 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:15:55,604 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=691.0, b=186.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 184))], orig='O P ( \\sigma ) \\geq \\max \\left \\{ p , k + \\sum _ { l = k } ^ { \\lambda - 1 } c _ { l } \\frac { l - k + 1 } { k - 1 } + c _ { l } ^ { * } \\frac { \\lambda - k + 1 } { k - 1 } \\right \\} .', text='O P ( \\sigma ) \\geq \\max \\left \\{ p , k + \\sum _ { l = k } ^ { \\lambda - 1 } c _ { l } \\frac { l - k + 1 } { k - 1 } + c _ { l } ^ { * } \\frac { \\lambda - k + 1 } { k - 1 } \\right \\} .', formatting=None, hyperlink=None)]
2025-06-10 20:15:55,604 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:15:55,604 - DEBUG - [Page 21] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:55,605 - DEBUG - Processing text item: label=formula, text=O P ( \sigma ) \geq \max \left \{ p , k + \sum _ { l = k } ^ { \lambda - 1 } c _ { l } \frac { l - k + 1 } { k - 1 } + c _ { l } ^ { * } \frac { \lambda - k + 1 } { k - 1 } \right \} .
2025-06-10 20:15:55,605 - DEBUG - Recognized string extracted: O P ( \sigma ) \geq \max \left \{ p , k + \sum _ { l = k } ^ { \lambda - 1 } c _ { l } \frac { l - k + 1 } { k - 1 } + c _ { l } ^ { * } \frac { \lambda - k + 1 } { k - 1 } \right \} .
2025-06-10 20:15:55,605 - DEBUG - Generating chat message for label: formula
2025-06-10 20:15:55,605 - DEBUG - Snippet 10.1016_s0140-67361832225-6_386_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:15:55,680 - DEBUG - Snippet 10.1016_s0140-67361832225-6_386_item_1 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:15:55,931 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:55,933 - DEBUG - Finished converting page batch time=3689.088
2025-06-10 20:15:55,997 - DEBUG - [Page 15] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:55,998 - DEBUG - Finished converting page batch time=3689.153
2025-06-10 20:15:56,004 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:56,006 - DEBUG - Finished converting page batch time=3689.161
2025-06-10 20:15:56,191 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:56,453 - DEBUG - [Page 16] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:56,545 - DEBUG - [Page 23] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:56,652 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:56,718 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:56,720 - DEBUG - Finished converting page batch time=3689.875
2025-06-10 20:15:56,874 - DEBUG - Creating masked image for page 2 with 14 clusters.
2025-06-10 20:15:56,876 - INFO - Masked image successfully created for page 2.
2025-06-10 20:15:56,882 - DEBUG - [Page 22] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:56,989 - DEBUG - Creating masked image for page 3 with 14 clusters.
2025-06-10 20:15:56,990 - INFO - Masked image successfully created for page 3.
2025-06-10 20:15:56,991 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:56,998 - INFO - Starting prediction for 3 images with labels: ['formula', 'formula', 'formula']
2025-06-10 20:15:56,998 - DEBUG - Generating chat message for label: formula
2025-06-10 20:15:56,999 - DEBUG - Snippet 10.1289_ehp1390_448_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:15:57,050 - DEBUG - Finished converting page batch time=3690.205
2025-06-10 20:15:57,066 - DEBUG - Snippet 10.1289_ehp1390_448_item_0 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:15:57,197 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:57,486 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:57,525 - DEBUG - [Page 17] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:57,654 - DEBUG - [Page 23] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:57,655 - DEBUG - Finished converting page batch time=3690.811
2025-06-10 20:15:57,746 - DEBUG - [Page 24] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:57,924 - DEBUG - [Page 25] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:57,925 - DEBUG - Finished converting page batch time=3691.080
2025-06-10 20:15:57,987 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:58,014 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:58,021 - INFO - Finished converting document 10.3390_ijms21124306_444.pdf in 21.29 sec.
2025-06-10 20:15:58,122 - INFO - Finished converting document 10.1146_annurev-publhealth-052120-101420_449.pdf in 20.22 sec.
2025-06-10 20:15:58,197 - DEBUG - Snippet 10.1016_s0140-67361832225-6_386_item_1: generation shape=torch.Size([1, 437])
2025-06-10 20:15:58,198 - DEBUG - Snippet 10.1016_s0140-67361832225-6_386_item_1 raw docling: (tokens=91)
<formula><loc_0><loc_0><loc_500><loc_500>O P T ( \sigma ) = p + \sum _ { l = k } ^ { p - 1 } f _ { l } \geq k + \sum _ { l = k } ^ { p - 1 } h _ { l } \frac { l - k + 1 } { k - 1 } .</formula><end_of_utterance>
2025-06-10 20:15:58,198 - DEBUG - Starting _parse_docling_output
2025-06-10 20:15:58,198 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>O P T ( \sigma ) = p + \sum _ { l = k } ^ { p - 1 } f _ { l } \geq k + \sum _ { l = k } ^ { p - 1 } h _ { l } \frac { l - k + 1 } { k - 1 } .</formula><end_of_utterance>
2025-06-10 20:15:58,199 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:15:58,199 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>O P T ( \\sigma ) = p + \\sum _ { l = k } ^ { p - 1 } f _ { l } \\geq k + \\sum _ { l = k } ^ { p - 1 } h _ { l } \\frac { l - k + 1 } { k - 1 } .</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=766x188 at 0x7F96B85CE7E0>)]
2025-06-10 20:15:58,199 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:15:58,205 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=766.0, b=188.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 141))], orig='O P T ( \\sigma ) = p + \\sum _ { l = k } ^ { p - 1 } f _ { l } \\geq k + \\sum _ { l = k } ^ { p - 1 } h _ { l } \\frac { l - k + 1 } { k - 1 } .', text='O P T ( \\sigma ) = p + \\sum _ { l = k } ^ { p - 1 } f _ { l } \\geq k + \\sum _ { l = k } ^ { p - 1 } h _ { l } \\frac { l - k + 1 } { k - 1 } .', formatting=None, hyperlink=None)]
2025-06-10 20:15:58,205 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:15:58,205 - DEBUG - Processing text item: label=formula, text=O P T ( \sigma ) = p + \sum _ { l = k } ^ { p - 1 } f _ { l } \geq k + \sum _ { l = k } ^ { p - 1 } h _ { l } \frac { l - k + 1 } { k - 1 } .
2025-06-10 20:15:58,205 - DEBUG - Recognized string extracted: O P T ( \sigma ) = p + \sum _ { l = k } ^ { p - 1 } f _ { l } \geq k + \sum _ { l = k } ^ { p - 1 } h _ { l } \frac { l - k + 1 } { k - 1 } .
2025-06-10 20:15:58,206 - DEBUG - Generating chat message for label: formula
2025-06-10 20:15:58,206 - DEBUG - Snippet 10.1016_s0140-67361832225-6_386_item_2 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:15:58,321 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:58,322 - DEBUG - Finished converting page batch time=3691.477
2025-06-10 20:15:58,346 - DEBUG - Snippet 10.1016_s0140-67361832225-6_386_item_2 => input_ids shape=torch.Size([1, 610]), prompt_len=610
2025-06-10 20:15:58,350 - INFO - Extraction successful row 70, tokens=38803
2025-06-10 20:15:58,354 - INFO - Extraction successful row 72, tokens=24088
2025-06-10 20:15:58,391 - INFO - Going to convert document batch...
2025-06-10 20:15:58,391 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:15:58,391 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:15:58,411 - INFO - Going to convert document batch...
2025-06-10 20:15:58,412 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:15:58,412 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:15:58,415 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 429 3243
2025-06-10 20:15:58,440 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 429 3243
2025-06-10 20:15:58,539 - DEBUG - [Page 18] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:58,555 - DEBUG - Snippet 10.1289_ehp1390_448_item_0: generation shape=torch.Size([1, 397])
2025-06-10 20:15:58,556 - DEBUG - Snippet 10.1289_ehp1390_448_item_0 raw docling: (tokens=51)
<formula><loc_0><loc_0><loc_500><loc_500>\Delta M o r t = y _ { 0 } ( 1 - \exp ^ { - \beta \Delta X } ) P o p .</formula><end_of_utterance>
2025-06-10 20:15:58,556 - DEBUG - Starting _parse_docling_output
2025-06-10 20:15:58,557 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>\Delta M o r t = y _ { 0 } ( 1 - \exp ^ { - \beta \Delta X } ) P o p .</formula><end_of_utterance>
2025-06-10 20:15:58,557 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:15:58,557 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>\\Delta M o r t = y _ { 0 } ( 1 - \\exp ^ { - \\beta \\Delta X } ) P o p .</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=540x63 at 0x7F96D573E0C0>)]
2025-06-10 20:15:58,557 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:15:58,562 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=540.0, b=63.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 70))], orig='\\Delta M o r t = y _ { 0 } ( 1 - \\exp ^ { - \\beta \\Delta X } ) P o p .', text='\\Delta M o r t = y _ { 0 } ( 1 - \\exp ^ { - \\beta \\Delta X } ) P o p .', formatting=None, hyperlink=None)]
2025-06-10 20:15:58,562 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:15:58,563 - DEBUG - Processing text item: label=formula, text=\Delta M o r t = y _ { 0 } ( 1 - \exp ^ { - \beta \Delta X } ) P o p .
2025-06-10 20:15:58,563 - DEBUG - Recognized string extracted: \Delta M o r t = y _ { 0 } ( 1 - \exp ^ { - \beta \Delta X } ) P o p .
2025-06-10 20:15:58,563 - DEBUG - Generating chat message for label: formula
2025-06-10 20:15:58,563 - DEBUG - Snippet 10.1289_ehp1390_448_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:15:58,614 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:58,614 - DEBUG - Finished converting page batch time=3691.770
2025-06-10 20:15:58,631 - DEBUG - Snippet 10.1289_ehp1390_448_item_1 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:15:59,226 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:15:59,249 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 429 3243
2025-06-10 20:15:59,250 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:15:59,303 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:15:59,325 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 429 3243
2025-06-10 20:15:59,326 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:15:59,424 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:59,441 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:57,501 - DEBUG - Snippet 10.1289_ehp1390_448_item_1: generation shape=torch.Size([1, 379])
2025-06-10 20:15:57,502 - DEBUG - Snippet 10.1289_ehp1390_448_item_1 raw docling: (tokens=33)
<formula><loc_0><loc_0><loc_500><loc_500>H R = e x p ^ { \beta \Delta Y }</formula><end_of_utterance>
2025-06-10 20:15:57,502 - DEBUG - Starting _parse_docling_output
2025-06-10 20:15:57,503 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>H R = e x p ^ { \beta \Delta Y }</formula><end_of_utterance>
2025-06-10 20:15:57,503 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:15:57,503 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>H R = e x p ^ { \\beta \\Delta Y }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=440x61 at 0x7F96CEDFD370>)]
2025-06-10 20:15:57,503 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:15:57,505 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=440.0, b=61.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 32))], orig='H R = e x p ^ { \\beta \\Delta Y }', text='H R = e x p ^ { \\beta \\Delta Y }', formatting=None, hyperlink=None)]
2025-06-10 20:15:57,505 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:15:57,505 - DEBUG - Processing text item: label=formula, text=H R = e x p ^ { \beta \Delta Y }
2025-06-10 20:15:57,505 - DEBUG - Recognized string extracted: H R = e x p ^ { \beta \Delta Y }
2025-06-10 20:15:57,505 - DEBUG - Generating chat message for label: formula
2025-06-10 20:15:57,506 - DEBUG - Snippet 10.1289_ehp1390_448_item_2 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:15:57,520 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:57,521 - DEBUG - Finished converting page batch time=3692.907
2025-06-10 20:15:57,575 - DEBUG - Snippet 10.1289_ehp1390_448_item_2 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:15:57,702 - INFO - Finished converting document 10.1186_s12940-017-0335-0_457.pdf in 14.37 sec.
2025-06-10 20:15:57,773 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:15:57,773 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:15:57,774 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:15:57,784 - INFO - Extraction successful row 75, tokens=13563
2025-06-10 20:15:57,795 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:15:57,808 - INFO - Going to convert document batch...
2025-06-10 20:15:57,808 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:15:57,808 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:15:57,820 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:15:57,832 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 429 3243
2025-06-10 20:15:57,844 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 429 0
2025-06-10 20:15:57,846 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:15:57,847 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:15:57,847 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:15:57,872 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 429 0
2025-06-10 20:15:57,879 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:15:57,898 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 429 0
2025-06-10 20:15:57,912 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:15:57,932 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 429 0
2025-06-10 20:15:57,934 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 429 0
2025-06-10 20:15:57,955 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 429 0
2025-06-10 20:15:57,967 - DEBUG - [Page 19] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:57,968 - DEBUG - Finished converting page batch time=3693.354
2025-06-10 20:15:57,978 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 429 0
2025-06-10 20:15:57,998 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 429 0
2025-06-10 20:15:58,047 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:15:58,069 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 429 0
2025-06-10 20:15:58,090 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 429 0
2025-06-10 20:15:58,100 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:15:58,121 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 429 0
2025-06-10 20:15:58,145 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 429 0
2025-06-10 20:15:58,172 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:58,222 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 429 0
2025-06-10 20:15:58,279 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:58,300 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 429 0
2025-06-10 20:15:58,459 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:15:58,481 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 429 3243
2025-06-10 20:15:58,482 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:15:58,492 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 429 0
2025-06-10 20:15:58,610 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 429 0
2025-06-10 20:15:58,714 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:15:58,715 - INFO - Processing document 10.5194_acp-18-16173-2018_487.pdf
2025-06-10 20:15:58,812 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:58,826 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:15:58,827 - INFO - Processing document 10.1016_j.freeradbiomed.2020.01.004_485.pdf
2025-06-10 20:15:58,851 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:15:58,852 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:15:58,852 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:15:58,875 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:15:58,906 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:15:58,928 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 429 0
2025-06-10 20:15:58,950 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 429 0
2025-06-10 20:15:58,967 - DEBUG - [Page 20] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:58,975 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 429 0
2025-06-10 20:15:58,996 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 429 0
2025-06-10 20:15:59,111 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:15:59,132 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 429 0
2025-06-10 20:15:59,154 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 429 0
2025-06-10 20:15:59,158 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:59,282 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 429 0
2025-06-10 20:15:59,303 - WARNING - Repetitive generation detected with pattern: ' \quad'
2025-06-10 20:15:59,304 - DEBUG - Snippet 10.1289_ehp1390_448_item_2: generation shape=torch.Size([1, 406])
2025-06-10 20:15:59,305 - DEBUG - Snippet 10.1289_ehp1390_448_item_2 raw docling: (tokens=60)
<formula><loc_0><loc_0><loc_500><loc_500>\Delta X = \{ \begin{matrix} 0 , \\ 0 3 _ { - } G C - L C C , \end{matrix} , \quad \quad \quad \quad
2025-06-10 20:15:59,305 - DEBUG - Starting _parse_docling_output
2025-06-10 20:15:59,305 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>\Delta X = \{ \begin{matrix} 0 , \\ 0 3 _ { - } G C - L C C , \end{matrix} , \quad \quad \quad \quad
2025-06-10 20:15:59,305 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:15:59,305 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>\\Delta X = \\{ \\begin{matrix} 0 , \\\\ 0 3 _ { - } G C - L C C , \\end{matrix} , \\quad \\quad \\quad \\quad', image=<PIL.Image.Image image mode=RGB size=649x102 at 0x7F96CE58C7A0>)]
2025-06-10 20:15:59,306 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:15:59,308 - DEBUG - DoclingDocument loaded successfully. Extracted texts: []
2025-06-10 20:15:59,309 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:15:59,309 - WARNING - Extracted text is empty or malformed. Skipping formula.
2025-06-10 20:15:59,309 - INFO - All done. Returning 3 recognized text results.
2025-06-10 20:15:59,309 - DEBUG - Snippet 10.1289_ehp1390_448_item_0 recognized text:
\Delta M o r t = y _ { 0 } ( 1 - \exp ^ { - \beta \Delta X } ) P o p .
2025-06-10 20:15:59,310 - DEBUG - Snippet 10.1289_ehp1390_448_item_1 recognized text:
H R = e x p ^ { \beta \Delta Y }
2025-06-10 20:15:59,310 - DEBUG - Snippet 10.1289_ehp1390_448_item_2 recognized text:
MALFORMED_FORMULA
2025-06-10 20:15:59,410 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:59,410 - DEBUG - Finished converting page batch time=3694.797
2025-06-10 20:15:59,421 - INFO - Finished converting document 10.1289_ehp1390_448.pdf in 23.77 sec.
2025-06-10 20:15:59,512 - INFO - Extraction successful row 71, tokens=21888
2025-06-10 20:15:59,534 - INFO - Going to convert document batch...
2025-06-10 20:15:59,535 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:15:59,535 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:15:59,558 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 429 3243
2025-06-10 20:15:59,568 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 429 0
2025-06-10 20:15:59,600 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:59,757 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:15:59,758 - INFO - Processing document 10.3390_antiox10081220_490.pdf
2025-06-10 20:15:59,904 - DEBUG - [Page 14] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:59,938 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:15:59,954 - DEBUG - [Page 21] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:00,159 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:00,300 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:16:00,321 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 429 3243
2025-06-10 20:16:00,322 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:16:00,416 - DEBUG - [Page 22] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:00,417 - DEBUG - Finished converting page batch time=3695.804
2025-06-10 20:16:00,560 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:00,570 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:00,726 - INFO - Finished converting document 10.1016_j.waojou.2020.100106_455.pdf in 19.51 sec.
2025-06-10 20:16:00,793 - DEBUG - Snippet 10.1016_s0140-67361832225-6_386_item_2: generation shape=torch.Size([1, 776])
2025-06-10 20:16:00,794 - DEBUG - Snippet 10.1016_s0140-67361832225-6_386_item_2 raw docling: (tokens=165)
<formula><loc_0><loc_0><loc_500><loc_500>O P T ( \sigma ) = p + \sum _ { l = k } ^ { p - 1 } f _ { l } = p + \sum _ { l = k } ^ { p - 1 } c _ { l } - \sum _ { l = k } ^ { p - 1 } h _ { l } = p + ( c _ { j ^ { \prime } } - \gamma ^ { \prime } ) \\ + \sum _ { l = j ^ { \prime } + 1 } ^ { p - 1 } c _ { l } = g ( j ^ { \prime } , \gamma ^ { \prime } ) .</formula><end_of_utterance>
2025-06-10 20:16:00,794 - DEBUG - Starting _parse_docling_output
2025-06-10 20:16:00,794 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>O P T ( \sigma ) = p + \sum _ { l = k } ^ { p - 1 } f _ { l } = p + \sum _ { l = k } ^ { p - 1 } c _ { l } - \sum _ { l = k } ^ { p - 1 } h _ { l } = p + ( c _ { j ^ { \prime } } - \gamma ^ { \prime } ) \\ + \sum _ { l = j ^ { \prime } + 1 } ^ { p - 1 } c _ { l } = g ( j ^ { \prime } , \gamma ^ { \prime } ) .</formula><end_of_utterance>
2025-06-10 20:16:00,794 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:16:00,795 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>O P T ( \\sigma ) = p + \\sum _ { l = k } ^ { p - 1 } f _ { l } = p + \\sum _ { l = k } ^ { p - 1 } c _ { l } - \\sum _ { l = k } ^ { p - 1 } h _ { l } = p + ( c _ { j ^ { \\prime } } - \\gamma ^ { \\prime } ) \\\\ + \\sum _ { l = j ^ { \\prime } + 1 } ^ { p - 1 } c _ { l } = g ( j ^ { \\prime } , \\gamma ^ { \\prime } ) .</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=866x353 at 0x7F96B85CE8A0>)]
2025-06-10 20:16:00,795 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:16:00,803 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=866.0, b=353.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 310))], orig='O P T ( \\sigma ) = p + \\sum _ { l = k } ^ { p - 1 } f _ { l } = p + \\sum _ { l = k } ^ { p - 1 } c _ { l } - \\sum _ { l = k } ^ { p - 1 } h _ { l } = p + ( c _ { j ^ { \\prime } } - \\gamma ^ { \\prime } ) \\\\ + \\sum _ { l = j ^ { \\prime } + 1 } ^ { p - 1 } c _ { l } = g ( j ^ { \\prime } , \\gamma ^ { \\prime } ) .', text='O P T ( \\sigma ) = p + \\sum _ { l = k } ^ { p - 1 } f _ { l } = p + \\sum _ { l = k } ^ { p - 1 } c _ { l } - \\sum _ { l = k } ^ { p - 1 } h _ { l } = p + ( c _ { j ^ { \\prime } } - \\gamma ^ { \\prime } ) \\\\ + \\sum _ { l = j ^ { \\prime } + 1 } ^ { p - 1 } c _ { l } = g ( j ^ { \\prime } , \\gamma ^ { \\prime } ) .', formatting=None, hyperlink=None)]
2025-06-10 20:16:00,804 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:16:00,804 - DEBUG - Processing text item: label=formula, text=O P T ( \sigma ) = p + \sum _ { l = k } ^ { p - 1 } f _ { l } = p + \sum _ { l = k } ^ { p - 1 } c _ { l } - \sum _ { l = k } ^ { p - 1 } h _ { l } = p + ( c _ { j ^ { \prime } } - \gamma ^ { \prime } ) \\ + \sum _ { l = j ^ { \prime } + 1 } ^ { p - 1 } c _ { l } = g ( j ^ { \prime } , \gamma ^ { \prime } ) .
2025-06-10 20:16:00,804 - DEBUG - Recognized string extracted: O P T ( \sigma ) = p + \sum _ { l = k } ^ { p - 1 } f _ { l } = p + \sum _ { l = k } ^ { p - 1 } c _ { l } - \sum _ { l = k } ^ { p - 1 } h _ { l } = p + ( c _ { j ^ { \prime } } - \gamma ^ { \prime } ) \\ + \sum _ { l = j ^ { \prime } + 1 } ^ { p - 1 } c _ { l } = g ( j ^ { \prime } , \gamma ^ { \prime } ) .
2025-06-10 20:16:00,805 - DEBUG - Generating chat message for label: formula
2025-06-10 20:16:00,805 - DEBUG - Snippet 10.1016_s0140-67361832225-6_386_item_3 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:16:00,881 - DEBUG - Snippet 10.1016_s0140-67361832225-6_386_item_3 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:16:01,043 - INFO - Extraction successful row 74, tokens=24514
2025-06-10 20:16:01,069 - INFO - Going to convert document batch...
2025-06-10 20:16:01,069 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:16:01,070 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:16:01,093 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 429 3243
2025-06-10 20:16:01,099 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:16:01,099 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:16:01,100 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:16:01,122 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:16:01,144 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:01,146 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:16:01,168 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 429 0
2025-06-10 20:16:01,173 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:01,189 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 429 0
2025-06-10 20:16:01,212 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 429 0
2025-06-10 20:16:01,233 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 429 0
2025-06-10 20:16:01,374 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:16:01,397 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 429 0
2025-06-10 20:16:01,419 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 429 0
2025-06-10 20:16:01,559 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 429 0
2025-06-10 20:16:01,671 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:01,765 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:16:01,783 - DEBUG - [Page 15] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:01,784 - DEBUG - Finished converting page batch time=3697.171
2025-06-10 20:16:01,788 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 429 3243
2025-06-10 20:16:01,789 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:16:01,805 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 429 0
2025-06-10 20:16:02,004 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:16:02,010 - INFO - Processing document 10.1017_s2045796019000623_492.pdf
2025-06-10 20:16:02,067 - INFO - Finished converting document 10.1186_1465-9921-9-77_470.pdf in 17.24 sec.
2025-06-10 20:16:02,239 - INFO - Extraction successful row 76, tokens=18632
2025-06-10 20:16:02,248 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:02,262 - INFO - Going to convert document batch...
2025-06-10 20:16:02,263 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:16:02,263 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:16:02,284 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:02,286 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 429 3243
2025-06-10 20:16:02,326 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:16:02,327 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:16:02,327 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:16:02,348 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:16:02,370 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:16:02,390 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 429 0
2025-06-10 20:16:02,411 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 429 0
2025-06-10 20:16:02,433 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 429 0
2025-06-10 20:16:02,454 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 429 0
2025-06-10 20:16:02,534 - DEBUG - [Page 14] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:02,579 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:16:02,599 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 429 0
2025-06-10 20:16:02,619 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:02,620 - DEBUG - Finished converting page batch time=3698.006
2025-06-10 20:16:02,621 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 429 0
2025-06-10 20:16:02,761 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 429 0
2025-06-10 20:16:02,924 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:02,991 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:03,044 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 429 0
2025-06-10 20:16:03,044 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:16:03,068 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 429 3243
2025-06-10 20:16:03,069 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:16:03,216 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:16:03,222 - INFO - Processing document 10.1186_1476-069x-13-67_495.pdf
2025-06-10 20:16:03,297 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:03,303 - DEBUG - Finished converting page batch time=3698.690
2025-06-10 20:16:03,323 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:03,402 - DEBUG - [Page 15] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:03,402 - DEBUG - Finished converting page batch time=3698.789
2025-06-10 20:16:03,590 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:16:03,590 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:16:03,590 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:16:03,611 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:16:03,633 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:16:03,655 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 429 0
2025-06-10 20:16:03,675 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 429 0
2025-06-10 20:16:03,699 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 429 0
2025-06-10 20:16:03,719 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 429 0
2025-06-10 20:16:03,839 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:03,841 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:16:03,861 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 429 0
2025-06-10 20:16:03,882 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 429 0
2025-06-10 20:16:04,033 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 429 0
2025-06-10 20:16:04,040 - DEBUG - Finished converting page batch time=3699.427
2025-06-10 20:16:04,302 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 429 0
2025-06-10 20:16:04,310 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:04,476 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:16:04,476 - INFO - Processing document 10.15585_mmwr.ss6613a1_497.pdf
2025-06-10 20:16:04,531 - DEBUG - [Page 16] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:04,588 - DEBUG - Dynamic vertical threshold: 46.582199999999936, Overlap threshold: 0.7
2025-06-10 20:16:04,588 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:04,602 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:04,929 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:04,952 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:04,953 - DEBUG - Dynamic vertical threshold: 34.75979999999996, Overlap threshold: 0.7
2025-06-10 20:16:04,954 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:05,034 - DEBUG - Snippet 10.1016_s0140-67361832225-6_386_item_3: generation shape=torch.Size([1, 497])
2025-06-10 20:16:05,036 - DEBUG - Snippet 10.1016_s0140-67361832225-6_386_item_3 raw docling: (tokens=151)
<formula><loc_0><loc_0><loc_500><loc_500>k + \sum _ { l = k } ^ { p - 1 } h _ { l } \frac { l - k + 1 } { k - 1 } \geq k + \sum _ { l = k } ^ { j ^ { \prime } - 1 } c _ { l } \frac { l - k + 1 } { k - 1 } + \gamma ^ { \prime } \frac { j ^ { \prime } - k + 1 } { k - 1 } = f ( j ^ { \prime } , \gamma ^ { \prime } ) .</formula><end_of_utterance>
2025-06-10 20:16:05,036 - DEBUG - Starting _parse_docling_output
2025-06-10 20:16:05,036 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>k + \sum _ { l = k } ^ { p - 1 } h _ { l } \frac { l - k + 1 } { k - 1 } \geq k + \sum _ { l = k } ^ { j ^ { \prime } - 1 } c _ { l } \frac { l - k + 1 } { k - 1 } + \gamma ^ { \prime } \frac { j ^ { \prime } - k + 1 } { k - 1 } = f ( j ^ { \prime } , \gamma ^ { \prime } ) .</formula><end_of_utterance>
2025-06-10 20:16:05,036 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:16:05,037 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>k + \\sum _ { l = k } ^ { p - 1 } h _ { l } \\frac { l - k + 1 } { k - 1 } \\geq k + \\sum _ { l = k } ^ { j ^ { \\prime } - 1 } c _ { l } \\frac { l - k + 1 } { k - 1 } + \\gamma ^ { \\prime } \\frac { j ^ { \\prime } - k + 1 } { k - 1 } = f ( j ^ { \\prime } , \\gamma ^ { \\prime } ) .</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=871x195 at 0x7F96B85CD070>)]
2025-06-10 20:16:05,037 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:16:05,042 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=871.0, b=195.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 275))], orig='k + \\sum _ { l = k } ^ { p - 1 } h _ { l } \\frac { l - k + 1 } { k - 1 } \\geq k + \\sum _ { l = k } ^ { j ^ { \\prime } - 1 } c _ { l } \\frac { l - k + 1 } { k - 1 } + \\gamma ^ { \\prime } \\frac { j ^ { \\prime } - k + 1 } { k - 1 } = f ( j ^ { \\prime } , \\gamma ^ { \\prime } ) .', text='k + \\sum _ { l = k } ^ { p - 1 } h _ { l } \\frac { l - k + 1 } { k - 1 } \\geq k + \\sum _ { l = k } ^ { j ^ { \\prime } - 1 } c _ { l } \\frac { l - k + 1 } { k - 1 } + \\gamma ^ { \\prime } \\frac { j ^ { \\prime } - k + 1 } { k - 1 } = f ( j ^ { \\prime } , \\gamma ^ { \\prime } ) .', formatting=None, hyperlink=None)]
2025-06-10 20:16:05,042 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:16:05,043 - DEBUG - Processing text item: label=formula, text=k + \sum _ { l = k } ^ { p - 1 } h _ { l } \frac { l - k + 1 } { k - 1 } \geq k + \sum _ { l = k } ^ { j ^ { \prime } - 1 } c _ { l } \frac { l - k + 1 } { k - 1 } + \gamma ^ { \prime } \frac { j ^ { \prime } - k + 1 } { k - 1 } = f ( j ^ { \prime } , \gamma ^ { \prime } ) .
2025-06-10 20:16:05,043 - DEBUG - Recognized string extracted: k + \sum _ { l = k } ^ { p - 1 } h _ { l } \frac { l - k + 1 } { k - 1 } \geq k + \sum _ { l = k } ^ { j ^ { \prime } - 1 } c _ { l } \frac { l - k + 1 } { k - 1 } + \gamma ^ { \prime } \frac { j ^ { \prime } - k + 1 } { k - 1 } = f ( j ^ { \prime } , \gamma ^ { \prime } ) .
2025-06-10 20:16:05,043 - DEBUG - Generating chat message for label: formula
2025-06-10 20:16:05,043 - DEBUG - Snippet 10.1016_s0140-67361832225-6_386_item_4 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:16:05,056 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:05,117 - DEBUG - Snippet 10.1016_s0140-67361832225-6_386_item_4 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:16:05,250 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:05,356 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:05,490 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:05,490 - DEBUG - Finished converting page batch time=3700.877
2025-06-10 20:16:05,886 - DEBUG - [Page 17] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:05,954 - DEBUG - Dynamic vertical threshold: 66.47399999999992, Overlap threshold: 0.7
2025-06-10 20:16:05,955 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:06,066 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:06,301 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:06,389 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:06,390 - DEBUG - Finished converting page batch time=3701.777
2025-06-10 20:16:06,502 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:06,589 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:06,664 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:06,949 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:07,113 - DEBUG - [Page 18] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:07,114 - DEBUG - Finished converting page batch time=3702.500
2025-06-10 20:16:07,337 - INFO - Finished converting document 10.3390_su14159234_475.pdf in 19.62 sec.
2025-06-10 20:16:07,454 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:07,496 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:07,534 - INFO - Extraction successful row 77, tokens=21799
2025-06-10 20:16:07,567 - INFO - Going to convert document batch...
2025-06-10 20:16:07,567 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:16:07,567 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:16:07,682 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 429 3243
2025-06-10 20:16:07,828 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:07,829 - DEBUG - Finished converting page batch time=3703.216
2025-06-10 20:16:07,831 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:08,002 - DEBUG - Snippet 10.1016_s0140-67361832225-6_386_item_4: generation shape=torch.Size([1, 455])
2025-06-10 20:16:08,003 - DEBUG - Snippet 10.1016_s0140-67361832225-6_386_item_4 raw docling: (tokens=109)
<formula><loc_0><loc_0><loc_500><loc_500>O P T ( \sigma ) \leq k + \sum _ { l = k } ^ { \lambda - 1 } c _ { l } \frac { l - k + 1 } { k - 1 } + c _ { \lambda } ^ { * } \frac { \lambda - k + 1 } { k - 1 } + 2 ( \lambda - k + 1 ) .</formula><end_of_utterance>
2025-06-10 20:16:08,004 - DEBUG - Starting _parse_docling_output
2025-06-10 20:16:08,004 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>O P T ( \sigma ) \leq k + \sum _ { l = k } ^ { \lambda - 1 } c _ { l } \frac { l - k + 1 } { k - 1 } + c _ { \lambda } ^ { * } \frac { \lambda - k + 1 } { k - 1 } + 2 ( \lambda - k + 1 ) .</formula><end_of_utterance>
2025-06-10 20:16:08,004 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:16:08,004 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>O P T ( \\sigma ) \\leq k + \\sum _ { l = k } ^ { \\lambda - 1 } c _ { l } \\frac { l - k + 1 } { k - 1 } + c _ { \\lambda } ^ { * } \\frac { \\lambda - k + 1 } { k - 1 } + 2 ( \\lambda - k + 1 ) .</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=747x186 at 0x7F96B85B80B0>)]
2025-06-10 20:16:08,004 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:16:08,009 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=747.0, b=186.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 188))], orig='O P T ( \\sigma ) \\leq k + \\sum _ { l = k } ^ { \\lambda - 1 } c _ { l } \\frac { l - k + 1 } { k - 1 } + c _ { \\lambda } ^ { * } \\frac { \\lambda - k + 1 } { k - 1 } + 2 ( \\lambda - k + 1 ) .', text='O P T ( \\sigma ) \\leq k + \\sum _ { l = k } ^ { \\lambda - 1 } c _ { l } \\frac { l - k + 1 } { k - 1 } + c _ { \\lambda } ^ { * } \\frac { \\lambda - k + 1 } { k - 1 } + 2 ( \\lambda - k + 1 ) .', formatting=None, hyperlink=None)]
2025-06-10 20:16:08,009 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:16:08,009 - DEBUG - Processing text item: label=formula, text=O P T ( \sigma ) \leq k + \sum _ { l = k } ^ { \lambda - 1 } c _ { l } \frac { l - k + 1 } { k - 1 } + c _ { \lambda } ^ { * } \frac { \lambda - k + 1 } { k - 1 } + 2 ( \lambda - k + 1 ) .
2025-06-10 20:16:08,009 - DEBUG - Recognized string extracted: O P T ( \sigma ) \leq k + \sum _ { l = k } ^ { \lambda - 1 } c _ { l } \frac { l - k + 1 } { k - 1 } + c _ { \lambda } ^ { * } \frac { \lambda - k + 1 } { k - 1 } + 2 ( \lambda - k + 1 ) .
2025-06-10 20:16:08,009 - INFO - All done. Returning 5 recognized text results.
2025-06-10 20:16:08,010 - DEBUG - Snippet 10.1016_s0140-67361832225-6_386_item_0 recognized text:
O P ( \sigma ) \geq \max \left \{ p , k + \sum _ { l = k } ^ { \lambda - 1 } c _ { l } \frac { l - k + 1 } { k - 1 } + c _ { l } ^ { * } \frac { \lambda - k + 1 } { k - 1 } \right \} .
2025-06-10 20:16:08,010 - DEBUG - Snippet 10.1016_s0140-67361832225-6_386_item_1 recognized text:
O P T ( \sigma ) = p + \sum _ { l = k } ^ { p - 1 } f _ { l } \geq k + \sum _ { l = k } ^ { p - 1 } h _ { l } \frac { l - k + 1 } { k - 1 } .
2025-06-10 20:16:08,010 - DEBUG - Snippet 10.1016_s0140-67361832225-6_386_item_2 recognized text:
O P T ( \sigma ) = p + \sum _ { l = k } ^ { p - 1 } f _ { l } = p + \sum _ { l = k } ^ { p - 1 } c _ { l } - \sum _ { l = k } ^ { p - 1 } h _ { l } = p + ( c _ { j ^ { \prime } } - \gamma ^ { \prime } ) \\ + \sum _ { l = j ^ { \prime } + 1 } ^ { p - 1 } c _ { l } = g ( j ^ { \prime } , \gamma ^ { \prime } ) .
2025-06-10 20:16:08,010 - DEBUG - Snippet 10.1016_s0140-67361832225-6_386_item_3 recognized text:
k + \sum _ { l = k } ^ { p - 1 } h _ { l } \frac { l - k + 1 } { k - 1 } \geq k + \sum _ { l = k } ^ { j ^ { \prime } - 1 } c _ { l } \frac { l - k + 1 } { k - 1 } + \gamma ^ { \prime } \frac { j ^ { \prime } - k + 1 } { k - 1 } = f ( j ^ { \prime } , \gamma ^ { \prime } ) .
2025-06-10 20:16:08,010 - DEBUG - Snippet 10.1016_s0140-67361832225-6_386_item_4 recognized text:
O P T ( \sigma ) \leq k + \sum _ { l = k } ^ { \lambda - 1 } c _ { l } \frac { l - k + 1 } { k - 1 } + c _ { \lambda } ^ { * } \frac { \lambda - k + 1 } { k - 1 } + 2 ( \lambda - k + 1 ) .
2025-06-10 20:16:08,074 - DEBUG - Creating masked image for page 15 with 14 clusters.
2025-06-10 20:16:08,075 - INFO - Masked image successfully created for page 15.
2025-06-10 20:16:08,132 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:08,134 - DEBUG - Finished converting page batch time=3703.520
2025-06-10 20:16:08,134 - DEBUG - Creating masked image for page 16 with 10 clusters.
2025-06-10 20:16:08,136 - INFO - Masked image successfully created for page 16.
2025-06-10 20:16:08,196 - DEBUG - Creating masked image for page 17 with 13 clusters.
2025-06-10 20:16:08,197 - INFO - Masked image successfully created for page 17.
2025-06-10 20:16:08,265 - DEBUG - Creating masked image for page 18 with 11 clusters.
2025-06-10 20:16:08,266 - INFO - Masked image successfully created for page 18.
2025-06-10 20:16:08,269 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:08,339 - DEBUG - Creating masked image for page 21 with 11 clusters.
2025-06-10 20:16:08,340 - INFO - Masked image successfully created for page 21.
2025-06-10 20:16:08,350 - INFO - Starting prediction for 5 images with labels: ['formula', 'formula', 'formula', 'formula', 'formula']
2025-06-10 20:16:08,350 - DEBUG - Generating chat message for label: formula
2025-06-10 20:16:08,351 - DEBUG - Snippet 10.1016_s0140-67361832225-6_386_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:16:08,358 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:16:08,382 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 429 3243
2025-06-10 20:16:08,383 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:16:08,520 - DEBUG - Snippet 10.1016_s0140-67361832225-6_386_item_0 => input_ids shape=torch.Size([1, 610]), prompt_len=610
2025-06-10 20:16:08,650 - DEBUG - Dynamic vertical threshold: 81.31680000000009, Overlap threshold: 0.7
2025-06-10 20:16:08,650 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:08,652 - DEBUG - Finished converting page batch time=3704.038
2025-06-10 20:16:08,805 - DEBUG - Finished converting page batch time=3704.191
2025-06-10 20:16:08,861 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:16:08,861 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:16:08,861 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:16:08,884 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:16:08,910 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:16:08,938 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 429 0
2025-06-10 20:16:08,966 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 429 0
2025-06-10 20:16:08,976 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:08,989 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 429 0
2025-06-10 20:16:09,015 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 429 0
2025-06-10 20:16:09,138 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:16:09,163 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 429 0
2025-06-10 20:16:09,187 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 429 0
2025-06-10 20:16:09,201 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:09,216 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:09,397 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 429 0
2025-06-10 20:16:09,413 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:09,665 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 429 0
2025-06-10 20:16:09,813 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:09,881 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:16:09,881 - INFO - Processing document 10.1016_s2213-26002030105-3_499.pdf
2025-06-10 20:16:09,916 - DEBUG - Dynamic vertical threshold: 55.458000000000105, Overlap threshold: 0.7
2025-06-10 20:16:09,917 - DEBUG - Checking merge:
  Current: 11, Next: 18
2025-06-10 20:16:09,917 - DEBUG -   Vertical gap: 28.55499999999995, Overlap ratio: 0.23510312543995487
2025-06-10 20:16:09,917 - DEBUG -   Left boundary diff: 260.788, Right boundary diff: 260.78700000000003
2025-06-10 20:16:09,917 - DEBUG -   Alignment factor (ratio): 1.0823571403372976
2025-06-10 20:16:09,918 - DEBUG -   -> c1 11 formula number: 7, c2 18 formula number: 5
2025-06-10 20:16:09,918 - DEBUG -   -> Not merging clusters 11 and 18 due to different formula numbers: 7 vs 5
2025-06-10 20:16:09,918 - DEBUG - Checking merge:
  Current: 11, Next: 10
2025-06-10 20:16:09,918 - DEBUG -   Vertical gap: 44.053999999999974, Overlap ratio: 0.2394404483104717
2025-06-10 20:16:09,918 - DEBUG -   Left boundary diff: 254.61100000000002, Right boundary diff: 260.78700000000003
2025-06-10 20:16:09,919 - DEBUG -   Alignment factor (ratio): 1.0964070698237591
2025-06-10 20:16:09,919 - DEBUG -   -> c1 11 formula number: 7, c2 10 formula number: 6
2025-06-10 20:16:09,919 - DEBUG -   -> Not merging clusters 11 and 10 due to different formula numbers: 7 vs 6
2025-06-10 20:16:09,919 - DEBUG - Checking merge:
  Current: 18, Next: 10
2025-06-10 20:16:09,919 - DEBUG -   Vertical gap: 3.758000000000038, Overlap ratio: 1.0
2025-06-10 20:16:09,920 - DEBUG -   Left boundary diff: 6.177, Right boundary diff: 0.0
2025-06-10 20:16:09,920 - DEBUG -   Alignment factor (ratio): 0.02596943955704385
2025-06-10 20:16:09,920 - DEBUG -   -> c1 18 formula number: 5, c2 10 formula number: 6
2025-06-10 20:16:09,920 - DEBUG -   -> Not merging clusters 18 and 10 due to different formula numbers: 5 vs 6
2025-06-10 20:16:09,921 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:10,428 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:10,850 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:11,060 - DEBUG - Snippet 10.1016_s0140-67361832225-6_386_item_0: generation shape=torch.Size([1, 697])
2025-06-10 20:16:11,061 - DEBUG - Snippet 10.1016_s0140-67361832225-6_386_item_0 raw docling: (tokens=86)
<formula><loc_0><loc_0><loc_500><loc_500>\sum _ { l = k } ^ { j ^ { * } - 1 } c _ { l } \frac { l - k + 1 } { k - 1 } + \gamma ^ { * } \frac { j ^ { * } - k + 1 } { k - 1 } .</formula><end_of_utterance>
2025-06-10 20:16:11,061 - DEBUG - Starting _parse_docling_output
2025-06-10 20:16:11,062 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>\sum _ { l = k } ^ { j ^ { * } - 1 } c _ { l } \frac { l - k + 1 } { k - 1 } + \gamma ^ { * } \frac { j ^ { * } - k + 1 } { k - 1 } .</formula><end_of_utterance>
2025-06-10 20:16:11,062 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:16:11,062 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>\\sum _ { l = k } ^ { j ^ { * } - 1 } c _ { l } \\frac { l - k + 1 } { k - 1 } + \\gamma ^ { * } \\frac { j ^ { * } - k + 1 } { k - 1 } .</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=405x195 at 0x7F96D7ACFB00>)]
2025-06-10 20:16:11,063 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:16:11,065 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=405.0, b=195.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 133))], orig='\\sum _ { l = k } ^ { j ^ { * } - 1 } c _ { l } \\frac { l - k + 1 } { k - 1 } + \\gamma ^ { * } \\frac { j ^ { * } - k + 1 } { k - 1 } .', text='\\sum _ { l = k } ^ { j ^ { * } - 1 } c _ { l } \\frac { l - k + 1 } { k - 1 } + \\gamma ^ { * } \\frac { j ^ { * } - k + 1 } { k - 1 } .', formatting=None, hyperlink=None)]
2025-06-10 20:16:11,066 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:16:11,066 - DEBUG - Processing text item: label=formula, text=\sum _ { l = k } ^ { j ^ { * } - 1 } c _ { l } \frac { l - k + 1 } { k - 1 } + \gamma ^ { * } \frac { j ^ { * } - k + 1 } { k - 1 } .
2025-06-10 20:16:11,066 - DEBUG - Recognized string extracted: \sum _ { l = k } ^ { j ^ { * } - 1 } c _ { l } \frac { l - k + 1 } { k - 1 } + \gamma ^ { * } \frac { j ^ { * } - k + 1 } { k - 1 } .
2025-06-10 20:16:11,067 - DEBUG - Generating chat message for label: formula
2025-06-10 20:16:11,067 - DEBUG - Snippet 10.1016_s0140-67361832225-6_386_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:16:11,183 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:11,184 - DEBUG - Finished converting page batch time=3706.571
2025-06-10 20:16:11,249 - DEBUG - Snippet 10.1016_s0140-67361832225-6_386_item_1 => input_ids shape=torch.Size([1, 610]), prompt_len=610
2025-06-10 20:16:11,265 - DEBUG - [Page 14] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:11,457 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:11,578 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:11,741 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:11,746 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:11,812 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:11,814 - DEBUG - Finished converting page batch time=3707.201
2025-06-10 20:16:11,955 - DEBUG - Creating masked image for page 1 with 20 clusters.
2025-06-10 20:16:11,957 - INFO - Masked image successfully created for page 1.
2025-06-10 20:16:11,960 - INFO - Starting prediction for 1 images with labels: ['formula']
2025-06-10 20:16:11,960 - DEBUG - Generating chat message for label: formula
2025-06-10 20:16:11,961 - DEBUG - Snippet 10.1017_s2045796019000623_492_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:16:12,028 - DEBUG - Snippet 10.1017_s2045796019000623_492_item_0 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:16:12,223 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:12,354 - DEBUG - Dynamic vertical threshold: 58.67639999999992, Overlap threshold: 0.7
2025-06-10 20:16:12,355 - DEBUG - Checking merge:
  Current: 15, Next: 13
2025-06-10 20:16:12,355 - DEBUG -   Vertical gap: 45.714000000000055, Overlap ratio: 1.0
2025-06-10 20:16:12,355 - DEBUG -   Left boundary diff: 0.4440000000000026, Right boundary diff: 0.0
2025-06-10 20:16:12,356 - DEBUG -   Alignment factor (ratio): 0.0020598182349584678
2025-06-10 20:16:12,356 - DEBUG -   -> c1 15 formula number: 8, c2 13 formula number: 9
2025-06-10 20:16:12,356 - DEBUG -   -> Not merging clusters 15 and 13 due to different formula numbers: 8 vs 9
2025-06-10 20:16:12,356 - DEBUG - Checking merge:
  Current: 15, Next: 11
2025-06-10 20:16:12,357 - DEBUG -   Vertical gap: 54.724000000000046, Overlap ratio: 0.2538453012429737
2025-06-10 20:16:12,357 - DEBUG -   Left boundary diff: 235.61699999999996, Right boundary diff: 260.788
2025-06-10 20:16:12,357 - DEBUG -   Alignment factor (ratio): 1.1420013531236795
2025-06-10 20:16:12,357 - DEBUG -   -> c1 15 formula number: 8, c2 11 formula number: 12
2025-06-10 20:16:12,357 - DEBUG -   -> Not merging clusters 15 and 11 due to different formula numbers: 8 vs 12
2025-06-10 20:16:12,358 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:12,387 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:12,541 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:12,542 - DEBUG - Finished converting page batch time=3707.929
2025-06-10 20:16:12,621 - DEBUG - [Page 15] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:12,622 - DEBUG - Finished converting page batch time=3708.008
2025-06-10 20:16:12,880 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:12,881 - DEBUG - Finished converting page batch time=3708.267
2025-06-10 20:16:12,929 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:12,965 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:13,049 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:13,448 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:13,449 - DEBUG - Finished converting page batch time=3708.836
2025-06-10 20:16:13,693 - DEBUG - [Page 16] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:14,023 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:14,484 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:14,583 - DEBUG - [Page 17] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:14,612 - DEBUG - Snippet 10.1017_s2045796019000623_492_item_0: generation shape=torch.Size([1, 420])
2025-06-10 20:16:14,613 - DEBUG - Snippet 10.1017_s2045796019000623_492_item_0 raw docling: (tokens=74)
<formula><loc_0><loc_0><loc_500><loc_500>A d m i s s i o n _ { t } = \alpha + \overline { \beta P o l l u t a n t _ { t } } + \delta X _ { t } + \varepsilon _ { t }</formula><end_of_utterance>
2025-06-10 20:16:14,614 - DEBUG - Starting _parse_docling_output
2025-06-10 20:16:14,614 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>A d m i s s i o n _ { t } = \alpha + \overline { \beta P o l l u t a n t _ { t } } + \delta X _ { t } + \varepsilon _ { t }</formula><end_of_utterance>
2025-06-10 20:16:14,614 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:16:14,615 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>A d m i s s i o n _ { t } = \\alpha + \\overline { \\beta P o l l u t a n t _ { t } } + \\delta X _ { t } + \\varepsilon _ { t }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=604x85 at 0x7F96D346DA60>)]
2025-06-10 20:16:14,615 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:16:14,617 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=604.0, b=85.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 123))], orig='A d m i s s i o n _ { t } = \\alpha + \\overline { \\beta P o l l u t a n t _ { t } } + \\delta X _ { t } + \\varepsilon _ { t }', text='A d m i s s i o n _ { t } = \\alpha + \\overline { \\beta P o l l u t a n t _ { t } } + \\delta X _ { t } + \\varepsilon _ { t }', formatting=None, hyperlink=None)]
2025-06-10 20:16:14,618 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:16:14,618 - DEBUG - Processing text item: label=formula, text=A d m i s s i o n _ { t } = \alpha + \overline { \beta P o l l u t a n t _ { t } } + \delta X _ { t } + \varepsilon _ { t }
2025-06-10 20:16:14,618 - DEBUG - Recognized string extracted: A d m i s s i o n _ { t } = \alpha + \overline { \beta P o l l u t a n t _ { t } } + \delta X _ { t } + \varepsilon _ { t }
2025-06-10 20:16:14,618 - INFO - All done. Returning 1 recognized text results.
2025-06-10 20:16:14,618 - DEBUG - Snippet 10.1017_s2045796019000623_492_item_0 recognized text:
A d m i s s i o n _ { t } = \alpha + \overline { \beta P o l l u t a n t _ { t } } + \delta X _ { t } + \varepsilon _ { t }
2025-06-10 20:16:14,662 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:14,686 - INFO - Finished converting document 10.1017_s2045796019000623_492.pdf in 15.17 sec.
2025-06-10 20:16:14,757 - INFO - Extraction successful row 81, tokens=10391
2025-06-10 20:16:14,804 - INFO - Going to convert document batch...
2025-06-10 20:16:14,805 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:16:14,805 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:16:14,830 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 429 3243
2025-06-10 20:16:15,081 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:15,181 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:15,315 - DEBUG - [Page 18] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:15,318 - DEBUG - Finished converting page batch time=3710.705
2025-06-10 20:16:15,540 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:16:15,558 - INFO - Finished converting document 10.3390_antiox10081220_490.pdf in 17.77 sec.
2025-06-10 20:16:15,562 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 429 3243
2025-06-10 20:16:15,563 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:16:15,775 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:15,825 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:15,830 - DEBUG - Finished converting page batch time=3711.217
2025-06-10 20:16:15,829 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:15,838 - DEBUG - Finished converting page batch time=3711.225
2025-06-10 20:16:15,851 - INFO - Extraction successful row 80, tokens=24800
2025-06-10 20:16:15,859 - DEBUG - [Page 14] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:15,886 - INFO - Going to convert document batch...
2025-06-10 20:16:15,887 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:16:15,887 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:16:15,910 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 429 3243
2025-06-10 20:16:16,109 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:16:16,110 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:16:16,110 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:16:16,131 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:16:16,153 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:16:16,174 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 429 0
2025-06-10 20:16:16,195 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 429 0
2025-06-10 20:16:16,216 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 429 0
2025-06-10 20:16:16,237 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 429 0
2025-06-10 20:16:16,355 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:16:16,358 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:16,376 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 429 0
2025-06-10 20:16:16,399 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 429 0
2025-06-10 20:16:16,524 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 429 0
2025-06-10 20:16:16,576 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:16:16,598 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 429 3243
2025-06-10 20:16:16,599 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:16:16,715 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:16,886 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 429 0
2025-06-10 20:16:16,886 - DEBUG - [Page 15] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:16,900 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:17,097 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:16:17,098 - INFO - Processing document 10.1371_journal.pmed.1002598_506.pdf
2025-06-10 20:16:17,212 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:16:17,212 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:16:17,212 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:16:17,235 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:16:17,258 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:16:17,280 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:17,280 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 429 0
2025-06-10 20:16:17,282 - DEBUG - Finished converting page batch time=3712.668
2025-06-10 20:16:17,301 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 429 0
2025-06-10 20:16:17,326 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 429 0
2025-06-10 20:16:17,348 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 429 0
2025-06-10 20:16:17,423 - INFO - Finished converting document 10.1186_1476-069x-13-67_495.pdf in 16.38 sec.
2025-06-10 20:16:17,453 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:16:17,477 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 429 0
2025-06-10 20:16:17,498 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 429 0
2025-06-10 20:16:17,526 - INFO - Extraction successful row 82, tokens=18765
2025-06-10 20:16:17,572 - INFO - Going to convert document batch...
2025-06-10 20:16:17,572 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:16:17,573 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:16:17,597 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 429 3243
2025-06-10 20:16:17,633 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 429 0
2025-06-10 20:16:17,972 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:18,174 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 429 0
2025-06-10 20:16:18,202 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:16:18,222 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 429 3243
2025-06-10 20:16:18,223 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:16:18,331 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:18,353 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:16:18,362 - INFO - Processing document 10.1016_j.envint.2015.12.001_510.pdf
2025-06-10 20:16:18,426 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:18,513 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:18,738 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:18,758 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:16:18,759 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:16:18,759 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:16:18,783 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:16:18,811 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:16:18,834 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 429 0
2025-06-10 20:16:18,856 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 429 0
2025-06-10 20:16:18,877 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 429 0
2025-06-10 20:16:18,900 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 429 0
2025-06-10 20:16:18,921 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:19,010 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:16:19,031 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 429 0
2025-06-10 20:16:19,054 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 429 0
2025-06-10 20:16:19,199 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 429 0
2025-06-10 20:16:19,394 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:19,425 - DEBUG - Finished converting page batch time=3714.811
2025-06-10 20:16:19,514 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 429 0
2025-06-10 20:16:19,728 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:16:19,728 - INFO - Processing document 10.1016_s2542-51962100195-9_512.pdf
2025-06-10 20:16:19,750 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:19,754 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:19,788 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:19,789 - DEBUG - Finished converting page batch time=3715.176
2025-06-10 20:16:19,827 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:19,886 - DEBUG - Snippet 10.1016_s0140-67361832225-6_386_item_1: generation shape=torch.Size([1, 887])
2025-06-10 20:16:19,887 - DEBUG - Snippet 10.1016_s0140-67361832225-6_386_item_1 raw docling: (tokens=276)
<formula><loc_0><loc_0><loc_500><loc_500>O P T ( \sigma ) \leq k + \sum _ { i = 1 } ^ { r } ( l _ { i } ^ { * } - k + 1 ) = k + \sum _ { i = 1 } ^ { r - 1 } ( l _ { i } ^ { \prime } - k + 1 ) + \sum _ { i = 1 } ^ { r - 1 } ( l _ { i } ^ { * } - l _ { i } ^ { \prime } ) + l _ { r } ^ { * } - k + 1 \\ \leq k + \sum _ { l = k } ^ { \lambda - 1 } c _ { l } \frac { l - k + 1 } { k - 1 } + c _ { \lambda } ^ { * } \frac { \lambda - k + 1 } { k - 1 } + \sum _ { i = 1 } ^ { r - 1 } ( l _ { i } ^ { * } - l _ { i } ^ { \prime } ) + l _ { r } ^ { * } - k + 1 .</formula><end_of_utterance>
2025-06-10 20:16:19,887 - DEBUG - Starting _parse_docling_output
2025-06-10 20:16:19,887 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>O P T ( \sigma ) \leq k + \sum _ { i = 1 } ^ { r } ( l _ { i } ^ { * } - k + 1 ) = k + \sum _ { i = 1 } ^ { r - 1 } ( l _ { i } ^ { \prime } - k + 1 ) + \sum _ { i = 1 } ^ { r - 1 } ( l _ { i } ^ { * } - l _ { i } ^ { \prime } ) + l _ { r } ^ { * } - k + 1 \\ \leq k + \sum _ { l = k } ^ { \lambda - 1 } c _ { l } \frac { l - k + 1 } { k - 1 } + c _ { \lambda } ^ { * } \frac { \lambda - k + 1 } { k - 1 } + \sum _ { i = 1 } ^ { r - 1 } ( l _ { i } ^ { * } - l _ { i } ^ { \prime } ) + l _ { r } ^ { * } - k + 1 .</formula><end_of_utterance>
2025-06-10 20:16:19,888 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:16:19,888 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>O P T ( \\sigma ) \\leq k + \\sum _ { i = 1 } ^ { r } ( l _ { i } ^ { * } - k + 1 ) = k + \\sum _ { i = 1 } ^ { r - 1 } ( l _ { i } ^ { \\prime } - k + 1 ) + \\sum _ { i = 1 } ^ { r - 1 } ( l _ { i } ^ { * } - l _ { i } ^ { \\prime } ) + l _ { r } ^ { * } - k + 1 \\\\ \\leq k + \\sum _ { l = k } ^ { \\lambda - 1 } c _ { l } \\frac { l - k + 1 } { k - 1 } + c _ { \\lambda } ^ { * } \\frac { \\lambda - k + 1 } { k - 1 } + \\sum _ { i = 1 } ^ { r - 1 } ( l _ { i } ^ { * } - l _ { i } ^ { \\prime } ) + l _ { r } ^ { * } - k + 1 .</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=991x346 at 0x7F96D6666240>)]
2025-06-10 20:16:19,888 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:16:19,898 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=991.0, b=346.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 513))], orig='O P T ( \\sigma ) \\leq k + \\sum _ { i = 1 } ^ { r } ( l _ { i } ^ { * } - k + 1 ) = k + \\sum _ { i = 1 } ^ { r - 1 } ( l _ { i } ^ { \\prime } - k + 1 ) + \\sum _ { i = 1 } ^ { r - 1 } ( l _ { i } ^ { * } - l _ { i } ^ { \\prime } ) + l _ { r } ^ { * } - k + 1 \\\\ \\leq k + \\sum _ { l = k } ^ { \\lambda - 1 } c _ { l } \\frac { l - k + 1 } { k - 1 } + c _ { \\lambda } ^ { * } \\frac { \\lambda - k + 1 } { k - 1 } + \\sum _ { i = 1 } ^ { r - 1 } ( l _ { i } ^ { * } - l _ { i } ^ { \\prime } ) + l _ { r } ^ { * } - k + 1 .', text='O P T ( \\sigma ) \\leq k + \\sum _ { i = 1 } ^ { r } ( l _ { i } ^ { * } - k + 1 ) = k + \\sum _ { i = 1 } ^ { r - 1 } ( l _ { i } ^ { \\prime } - k + 1 ) + \\sum _ { i = 1 } ^ { r - 1 } ( l _ { i } ^ { * } - l _ { i } ^ { \\prime } ) + l _ { r } ^ { * } - k + 1 \\\\ \\leq k + \\sum _ { l = k } ^ { \\lambda - 1 } c _ { l } \\frac { l - k + 1 } { k - 1 } + c _ { \\lambda } ^ { * } \\frac { \\lambda - k + 1 } { k - 1 } + \\sum _ { i = 1 } ^ { r - 1 } ( l _ { i } ^ { * } - l _ { i } ^ { \\prime } ) + l _ { r } ^ { * } - k + 1 .', formatting=None, hyperlink=None)]
2025-06-10 20:16:19,898 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:16:19,899 - DEBUG - Processing text item: label=formula, text=O P T ( \sigma ) \leq k + \sum _ { i = 1 } ^ { r } ( l _ { i } ^ { * } - k + 1 ) = k + \sum _ { i = 1 } ^ { r - 1 } ( l _ { i } ^ { \prime } - k + 1 ) + \sum _ { i = 1 } ^ { r - 1 } ( l _ { i } ^ { * } - l _ { i } ^ { \prime } ) + l _ { r } ^ { * } - k + 1 \\ \leq k + \sum _ { l = k } ^ { \lambda - 1 } c _ { l } \frac { l - k + 1 } { k - 1 } + c _ { \lambda } ^ { * } \frac { \lambda - k + 1 } { k - 1 } + \sum _ { i = 1 } ^ { r - 1 } ( l _ { i } ^ { * } - l _ { i } ^ { \prime } ) + l _ { r } ^ { * } - k + 1 .
2025-06-10 20:16:19,899 - DEBUG - Recognized string extracted: O P T ( \sigma ) \leq k + \sum _ { i = 1 } ^ { r } ( l _ { i } ^ { * } - k + 1 ) = k + \sum _ { i = 1 } ^ { r - 1 } ( l _ { i } ^ { \prime } - k + 1 ) + \sum _ { i = 1 } ^ { r - 1 } ( l _ { i } ^ { * } - l _ { i } ^ { \prime } ) + l _ { r } ^ { * } - k + 1 \\ \leq k + \sum _ { l = k } ^ { \lambda - 1 } c _ { l } \frac { l - k + 1 } { k - 1 } + c _ { \lambda } ^ { * } \frac { \lambda - k + 1 } { k - 1 } + \sum _ { i = 1 } ^ { r - 1 } ( l _ { i } ^ { * } - l _ { i } ^ { \prime } ) + l _ { r } ^ { * } - k + 1 .
2025-06-10 20:16:19,899 - DEBUG - Generating chat message for label: formula
2025-06-10 20:16:19,899 - DEBUG - Snippet 10.1016_s0140-67361832225-6_386_item_2 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:16:19,903 - DEBUG - [Page 16] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:20,074 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:20,179 - DEBUG - Snippet 10.1016_s0140-67361832225-6_386_item_2 => input_ids shape=torch.Size([1, 875]), prompt_len=875
2025-06-10 20:16:20,304 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:20,330 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:20,354 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:20,356 - DEBUG - Finished converting page batch time=3715.743
2025-06-10 20:16:20,765 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:20,860 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:20,918 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:21,013 - DEBUG - Finished converting page batch time=3716.400
2025-06-10 20:16:21,068 - DEBUG - [Page 12] Reclassifying cluster 0 from form to TEXT (area ratio: 1.00, cells: 0, density: 0.000000).
2025-06-10 20:16:21,068 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 1
2025-06-10 20:16:21,127 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:21,128 - DEBUG - Finished converting page batch time=3716.514
2025-06-10 20:16:21,130 - DEBUG - [Page 13] Reclassifying cluster 0 from form to TEXT (area ratio: 1.00, cells: 0, density: 0.000000).
2025-06-10 20:16:21,131 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 1
2025-06-10 20:16:21,180 - DEBUG - [Page 14] Reclassifying cluster 0 from form to TEXT (area ratio: 1.00, cells: 0, density: 0.000000).
2025-06-10 20:16:21,181 - DEBUG - [Page 14] Total clusters reclassified from large size labels to TEXT: 1
2025-06-10 20:16:21,332 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:21,361 - DEBUG - [Page 15] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:21,362 - DEBUG - Finished converting page batch time=3716.749
2025-06-10 20:16:21,487 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:21,515 - INFO - Finished converting document 10.15585_mmwr.ss6613a1_497.pdf in 19.27 sec.
2025-06-10 20:16:21,622 - INFO - Extraction successful row 83, tokens=22126
2025-06-10 20:16:21,645 - INFO - Going to convert document batch...
2025-06-10 20:16:21,646 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:16:21,646 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:16:21,670 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 429 3243
2025-06-10 20:16:21,736 - DEBUG - Dynamic vertical threshold: 25.799399999999945, Overlap threshold: 0.7
2025-06-10 20:16:21,737 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:21,910 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:22,203 - DEBUG - Dynamic vertical threshold: 37.71450000000003, Overlap threshold: 0.7
2025-06-10 20:16:22,203 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:22,204 - DEBUG - Finished converting page batch time=3717.591
2025-06-10 20:16:22,400 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:16:22,426 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 429 3243
2025-06-10 20:16:22,427 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:16:22,458 - DEBUG - Finished converting page batch time=3717.845
2025-06-10 20:16:22,596 - DEBUG - [Page 14] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:22,905 - DEBUG - [Page 17] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:22,971 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:23,232 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:16:23,232 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:16:23,233 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:16:23,253 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:16:23,274 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:16:23,296 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 429 0
2025-06-10 20:16:23,317 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 429 0
2025-06-10 20:16:23,341 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 429 0
2025-06-10 20:16:23,362 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 429 0
2025-06-10 20:16:23,393 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:23,417 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:23,484 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:16:23,519 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 429 0
2025-06-10 20:16:23,545 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 429 0
2025-06-10 20:16:23,597 - DEBUG - [Page 18] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:23,653 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:23,679 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 429 0
2025-06-10 20:16:23,934 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:24,124 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 429 0
2025-06-10 20:16:24,166 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:24,349 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:16:24,350 - INFO - Processing document 10.2188_jea.je20080047_517.pdf
2025-06-10 20:16:24,412 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:24,835 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:24,890 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:24,891 - DEBUG - Finished converting page batch time=3720.278
2025-06-10 20:16:25,121 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:25,282 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:25,431 - DEBUG - Finished converting page batch time=3720.818
2025-06-10 20:16:25,716 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:25,755 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:25,888 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:25,917 - DEBUG - [Page 15] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:25,919 - DEBUG - Finished converting page batch time=3721.305
2025-06-10 20:16:26,407 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:26,456 - DEBUG - [Page 14] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:26,553 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:26,612 - INFO - Finished converting document 10.1016_s2213-26002030105-3_499.pdf in 19.08 sec.
2025-06-10 20:16:26,777 - INFO - Extraction successful row 84, tokens=16191
2025-06-10 20:16:26,804 - INFO - Going to convert document batch...
2025-06-10 20:16:26,805 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:16:26,805 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:16:26,828 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 429 3243
2025-06-10 20:16:26,897 - DEBUG - [Page 19] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:27,421 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:16:27,442 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 429 3243
2025-06-10 20:16:27,443 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:16:27,471 - DEBUG - [Page 15] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:27,472 - DEBUG - Finished converting page batch time=3722.859
2025-06-10 20:16:27,606 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:27,710 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:27,714 - DEBUG - Finished converting page batch time=3723.101
2025-06-10 20:16:28,019 - DEBUG - [Page 16] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:28,019 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:16:28,020 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:16:28,020 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:16:28,043 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:16:28,064 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:16:28,086 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 429 0
2025-06-10 20:16:28,109 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 429 0
2025-06-10 20:16:28,132 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 429 0
2025-06-10 20:16:28,153 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 429 0
2025-06-10 20:16:28,265 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:16:28,286 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 429 0
2025-06-10 20:16:28,309 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 429 0
2025-06-10 20:16:28,331 - DEBUG - [Page 17] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:28,435 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 429 0
2025-06-10 20:16:28,590 - DEBUG - Finished converting page batch time=3723.976
2025-06-10 20:16:28,645 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:28,647 - DEBUG - Finished converting page batch time=3724.033
2025-06-10 20:16:28,694 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 429 0
2025-06-10 20:16:28,698 - DEBUG - Finished converting page batch time=3724.085
2025-06-10 20:16:28,790 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:28,821 - DEBUG - [Page 18] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:28,875 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:16:28,876 - INFO - Processing document 10.3389_fpubh.2022.869656_518.pdf
2025-06-10 20:16:28,954 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:29,133 - DEBUG - [Page 20] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:29,363 - DEBUG - Snippet 10.1016_s0140-67361832225-6_386_item_2: generation shape=torch.Size([1, 1139])
2025-06-10 20:16:29,364 - DEBUG - Snippet 10.1016_s0140-67361832225-6_386_item_2 raw docling: (tokens=263)
<formula><loc_0><loc_0><loc_500><loc_500>R _ { L R U } ( C ) \leq \max \left \{ p , k + \sum _ { l = k } ^ { p + \sum _ { l = k } ^ { p - 1 } C l } c _ { l } ^ { * } \frac { \lambda - 1 } { k - 1 } + c _ { \lambda } ^ { * } \frac { \lambda - k + 1 } { k - 1 } \right \} \\ R _ { L R U } ( C ) \geq \frac { p + \sum _ { l = k } ^ { p - 1 } C l } { k + \sum _ { l = k } ^ { \lambda - 1 } c _ { l } ^ { \frac { p - 1 } { k - 1 } } \frac { \lambda - k + 1 } { k - 1 } + c _ { \lambda } ^ { * } \frac { \lambda - k + 1 } { k - 1 } + 2 ( \lambda - k + 1 )</formula><end_of_utterance>
2025-06-10 20:16:29,364 - DEBUG - Starting _parse_docling_output
2025-06-10 20:16:29,364 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>R _ { L R U } ( C ) \leq \max \left \{ p , k + \sum _ { l = k } ^ { p + \sum _ { l = k } ^ { p - 1 } C l } c _ { l } ^ { * } \frac { \lambda - 1 } { k - 1 } + c _ { \lambda } ^ { * } \frac { \lambda - k + 1 } { k - 1 } \right \} \\ R _ { L R U } ( C ) \geq \frac { p + \sum _ { l = k } ^ { p - 1 } C l } { k + \sum _ { l = k } ^ { \lambda - 1 } c _ { l } ^ { \frac { p - 1 } { k - 1 } } \frac { \lambda - k + 1 } { k - 1 } + c _ { \lambda } ^ { * } \frac { \lambda - k + 1 } { k - 1 } + 2 ( \lambda - k + 1 )</formula><end_of_utterance>
2025-06-10 20:16:29,364 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:16:29,364 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>R _ { L R U } ( C ) \\leq \\max \\left \\{ p , k + \\sum _ { l = k } ^ { p + \\sum _ { l = k } ^ { p - 1 } C l } c _ { l } ^ { * } \\frac { \\lambda - 1 } { k - 1 } + c _ { \\lambda } ^ { * } \\frac { \\lambda - k + 1 } { k - 1 } \\right \\} \\\\ R _ { L R U } ( C ) \\geq \\frac { p + \\sum _ { l = k } ^ { p - 1 } C l } { k + \\sum _ { l = k } ^ { \\lambda - 1 } c _ { l } ^ { \\frac { p - 1 } { k - 1 } } \\frac { \\lambda - k + 1 } { k - 1 } + c _ { \\lambda } ^ { * } \\frac { \\lambda - k + 1 } { k - 1 } + 2 ( \\lambda - k + 1 )</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=844x437 at 0x7F96B85B9BE0>)]
2025-06-10 20:16:29,365 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:16:29,375 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=844.0, b=437.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 508))], orig='R _ { L R U } ( C ) \\leq \\max \\left \\{ p , k + \\sum _ { l = k } ^ { p + \\sum _ { l = k } ^ { p - 1 } C l } c _ { l } ^ { * } \\frac { \\lambda - 1 } { k - 1 } + c _ { \\lambda } ^ { * } \\frac { \\lambda - k + 1 } { k - 1 } \\right \\} \\\\ R _ { L R U } ( C ) \\geq \\frac { p + \\sum _ { l = k } ^ { p - 1 } C l } { k + \\sum _ { l = k } ^ { \\lambda - 1 } c _ { l } ^ { \\frac { p - 1 } { k - 1 } } \\frac { \\lambda - k + 1 } { k - 1 } + c _ { \\lambda } ^ { * } \\frac { \\lambda - k + 1 } { k - 1 } + 2 ( \\lambda - k + 1 )', text='R _ { L R U } ( C ) \\leq \\max \\left \\{ p , k + \\sum _ { l = k } ^ { p + \\sum _ { l = k } ^ { p - 1 } C l } c _ { l } ^ { * } \\frac { \\lambda - 1 } { k - 1 } + c _ { \\lambda } ^ { * } \\frac { \\lambda - k + 1 } { k - 1 } \\right \\} \\\\ R _ { L R U } ( C ) \\geq \\frac { p + \\sum _ { l = k } ^ { p - 1 } C l } { k + \\sum _ { l = k } ^ { \\lambda - 1 } c _ { l } ^ { \\frac { p - 1 } { k - 1 } } \\frac { \\lambda - k + 1 } { k - 1 } + c _ { \\lambda } ^ { * } \\frac { \\lambda - k + 1 } { k - 1 } + 2 ( \\lambda - k + 1 )', formatting=None, hyperlink=None)]
2025-06-10 20:16:29,375 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:16:29,375 - DEBUG - Processing text item: label=formula, text=R _ { L R U } ( C ) \leq \max \left \{ p , k + \sum _ { l = k } ^ { p + \sum _ { l = k } ^ { p - 1 } C l } c _ { l } ^ { * } \frac { \lambda - 1 } { k - 1 } + c _ { \lambda } ^ { * } \frac { \lambda - k + 1 } { k - 1 } \right \} \\ R _ { L R U } ( C ) \geq \frac { p + \sum _ { l = k } ^ { p - 1 } C l } { k + \sum _ { l = k } ^ { \lambda - 1 } c _ { l } ^ { \frac { p - 1 } { k - 1 } } \frac { \lambda - k + 1 } { k - 1 } + c _ { \lambda } ^ { * } \frac { \lambda - k + 1 } { k - 1 } + 2 ( \lambda - k + 1 )
2025-06-10 20:16:29,376 - DEBUG - Recognized string extracted: R _ { L R U } ( C ) \leq \max \left \{ p , k + \sum _ { l = k } ^ { p + \sum _ { l = k } ^ { p - 1 } C l } c _ { l } ^ { * } \frac { \lambda - 1 } { k - 1 } + c _ { \lambda } ^ { * } \frac { \lambda - k + 1 } { k - 1 } \right \} \\ R _ { L R U } ( C ) \geq \frac { p + \sum _ { l = k } ^ { p - 1 } C l } { k + \sum _ { l = k } ^ { \lambda - 1 } c _ { l } ^ { \frac { p - 1 } { k - 1 } } \frac { \lambda - k + 1 } { k - 1 } + c _ { \lambda } ^ { * } \frac { \lambda - k + 1 } { k - 1 } + 2 ( \lambda - k + 1 )
2025-06-10 20:16:29,376 - DEBUG - Generating chat message for label: formula
2025-06-10 20:16:29,376 - DEBUG - Snippet 10.1016_s0140-67361832225-6_386_item_3 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:16:29,409 - DEBUG - [Page 16] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:29,411 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:29,546 - DEBUG - Snippet 10.1016_s0140-67361832225-6_386_item_3 => input_ids shape=torch.Size([1, 610]), prompt_len=610
2025-06-10 20:16:29,572 - DEBUG - [Page 21] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:27,509 - DEBUG - [Page 19] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:27,510 - DEBUG - Finished converting page batch time=3725.104
2025-06-10 20:16:27,588 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:27,589 - DEBUG - Finished converting page batch time=3725.184
2025-06-10 20:16:27,662 - DEBUG - [Page 22] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:28,174 - DEBUG - Creating masked image for page 3 with 20 clusters.
2025-06-10 20:16:28,176 - INFO - Masked image successfully created for page 3.
2025-06-10 20:16:28,180 - INFO - Starting prediction for 2 images with labels: ['formula', 'formula']
2025-06-10 20:16:28,180 - DEBUG - Generating chat message for label: formula
2025-06-10 20:16:28,180 - DEBUG - Snippet 10.1016_j.envint.2015.12.001_510_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:16:28,245 - DEBUG - [Page 23] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:28,272 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:28,348 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:28,467 - DEBUG - Snippet 10.1016_j.envint.2015.12.001_510_item_0 => input_ids shape=torch.Size([1, 1140]), prompt_len=1140
2025-06-10 20:16:28,684 - DEBUG - Dynamic vertical threshold: 27.917999999999985, Overlap threshold: 0.7
2025-06-10 20:16:28,684 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:29,103 - DEBUG - [Page 20] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:29,454 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:30,034 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:30,191 - DEBUG - Snippet 10.1016_j.envint.2015.12.001_510_item_0: generation shape=torch.Size([1, 1185])
2025-06-10 20:16:30,193 - DEBUG - Snippet 10.1016_j.envint.2015.12.001_510_item_0 raw docling: (tokens=44)
<formula><loc_0><loc_0><loc_500><loc_500>D _ { r i } = \frac { l _ { r i } } { A _ { i } } ,</formula><end_of_utterance>
2025-06-10 20:16:30,193 - DEBUG - Starting _parse_docling_output
2025-06-10 20:16:30,193 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>D _ { r i } = \frac { l _ { r i } } { A _ { i } } ,</formula><end_of_utterance>
2025-06-10 20:16:30,194 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:16:30,194 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>D _ { r i } = \\frac { l _ { r i } } { A _ { i } } ,</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=89x99 at 0x7F96CFB1B3B0>)]
2025-06-10 20:16:30,194 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:16:30,195 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=89.0, b=99.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 51))], orig='D _ { r i } = \\frac { l _ { r i } } { A _ { i } } ,', text='D _ { r i } = \\frac { l _ { r i } } { A _ { i } } ,', formatting=None, hyperlink=None)]
2025-06-10 20:16:30,196 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:16:30,196 - DEBUG - Processing text item: label=formula, text=D _ { r i } = \frac { l _ { r i } } { A _ { i } } ,
2025-06-10 20:16:30,196 - DEBUG - Recognized string extracted: D _ { r i } = \frac { l _ { r i } } { A _ { i } } ,
2025-06-10 20:16:30,196 - DEBUG - Generating chat message for label: formula
2025-06-10 20:16:30,196 - DEBUG - Snippet 10.1016_j.envint.2015.12.001_510_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:16:30,288 - DEBUG - [Page 21] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:30,382 - DEBUG - Snippet 10.1016_j.envint.2015.12.001_510_item_1 => input_ids shape=torch.Size([1, 875]), prompt_len=875
2025-06-10 20:16:30,408 - DEBUG - [Page 22] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:30,408 - DEBUG - Finished converting page batch time=3728.003
2025-06-10 20:16:30,554 - DEBUG - Creating masked image for page 7 with 17 clusters.
2025-06-10 20:16:30,556 - INFO - Masked image successfully created for page 7.
2025-06-10 20:16:30,561 - INFO - Starting prediction for 2 images with labels: ['formula', 'formula']
2025-06-10 20:16:30,561 - DEBUG - Generating chat message for label: formula
2025-06-10 20:16:30,561 - DEBUG - Snippet 10.1371_journal.pmed.1002598_506_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:16:30,614 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:30,615 - DEBUG - Finished converting page batch time=3728.210
2025-06-10 20:16:30,643 - DEBUG - Snippet 10.1371_journal.pmed.1002598_506_item_0 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:16:31,128 - DEBUG - Dynamic vertical threshold: 23.32170000000001, Overlap threshold: 0.7
2025-06-10 20:16:31,129 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:31,130 - DEBUG - Finished converting page batch time=3728.725
2025-06-10 20:16:31,154 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:31,158 - DEBUG - Finished converting page batch time=3728.753
2025-06-10 20:16:31,215 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:31,258 - INFO - Finished converting document 10.2188_jea.je20080047_517.pdf in 11.84 sec.
2025-06-10 20:16:31,319 - INFO - Extraction successful row 88, tokens=10839
2025-06-10 20:16:31,321 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:31,353 - INFO - Going to convert document batch...
2025-06-10 20:16:31,354 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:16:31,354 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:16:31,378 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 429 3243
2025-06-10 20:16:31,403 - DEBUG - [Page 14] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:31,496 - DEBUG - [Page 15] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:31,496 - DEBUG - Finished converting page batch time=3729.091
2025-06-10 20:16:31,643 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:31,687 - DEBUG - Snippet 10.1371_journal.pmed.1002598_506_item_0: generation shape=torch.Size([1, 382])
2025-06-10 20:16:31,688 - DEBUG - Snippet 10.1371_journal.pmed.1002598_506_item_0 raw docling: (tokens=36)
<formula><loc_0><loc_0><loc_500><loc_500>A F = 1 - \exp ^ { - \beta \times C }</formula><end_of_utterance>
2025-06-10 20:16:31,688 - DEBUG - Starting _parse_docling_output
2025-06-10 20:16:31,688 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>A F = 1 - \exp ^ { - \beta \times C }</formula><end_of_utterance>
2025-06-10 20:16:31,688 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:16:31,688 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>A F = 1 - \\exp ^ { - \\beta \\times C }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=681x60 at 0x7F96D685F050>)]
2025-06-10 20:16:31,689 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:16:31,691 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=681.0, b=60.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 37))], orig='A F = 1 - \\exp ^ { - \\beta \\times C }', text='A F = 1 - \\exp ^ { - \\beta \\times C }', formatting=None, hyperlink=None)]
2025-06-10 20:16:31,691 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:16:31,692 - DEBUG - Processing text item: label=formula, text=A F = 1 - \exp ^ { - \beta \times C }
2025-06-10 20:16:31,692 - DEBUG - Recognized string extracted: A F = 1 - \exp ^ { - \beta \times C }
2025-06-10 20:16:31,692 - DEBUG - Generating chat message for label: formula
2025-06-10 20:16:31,692 - DEBUG - Snippet 10.1371_journal.pmed.1002598_506_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:16:31,759 - DEBUG - Snippet 10.1371_journal.pmed.1002598_506_item_1 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:16:31,760 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:31,806 - DEBUG - Snippet 10.1016_j.envint.2015.12.001_510_item_1: generation shape=torch.Size([1, 917])
2025-06-10 20:16:31,806 - DEBUG - Snippet 10.1016_j.envint.2015.12.001_510_item_1 raw docling: (tokens=41)
<formula><loc_0><loc_0><loc_500><loc_500>V K T _ { t i } = \sum _ { i } V _ { t } l ,</formula><end_of_utterance>
2025-06-10 20:16:31,807 - DEBUG - Starting _parse_docling_output
2025-06-10 20:16:31,807 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>V K T _ { t i } = \sum _ { i } V _ { t } l ,</formula><end_of_utterance>
2025-06-10 20:16:31,807 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:16:31,807 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>V K T _ { t i } = \\sum _ { i } V _ { t } l ,</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=155x85 at 0x7F971C4329F0>)]
2025-06-10 20:16:31,808 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:16:31,809 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=155.0, b=85.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 44))], orig='V K T _ { t i } = \\sum _ { i } V _ { t } l ,', text='V K T _ { t i } = \\sum _ { i } V _ { t } l ,', formatting=None, hyperlink=None)]
2025-06-10 20:16:31,809 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:16:31,809 - DEBUG - Processing text item: label=formula, text=V K T _ { t i } = \sum _ { i } V _ { t } l ,
2025-06-10 20:16:31,809 - DEBUG - Recognized string extracted: V K T _ { t i } = \sum _ { i } V _ { t } l ,
2025-06-10 20:16:31,810 - INFO - All done. Returning 2 recognized text results.
2025-06-10 20:16:31,810 - DEBUG - Snippet 10.1016_j.envint.2015.12.001_510_item_0 recognized text:
D _ { r i } = \frac { l _ { r i } } { A _ { i } } ,
2025-06-10 20:16:31,810 - DEBUG - Snippet 10.1016_j.envint.2015.12.001_510_item_1 recognized text:
V K T _ { t i } = \sum _ { i } V _ { t } l ,
2025-06-10 20:16:31,837 - DEBUG - [Page 16] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:31,895 - INFO - Finished converting document 10.1016_j.envint.2015.12.001_510.pdf in 18.25 sec.
2025-06-10 20:16:31,968 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:16:31,975 - INFO - Extraction successful row 86, tokens=13403
2025-06-10 20:16:31,990 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 429 3243
2025-06-10 20:16:31,991 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:16:32,000 - DEBUG - Finished converting page batch time=3729.595
2025-06-10 20:16:32,045 - INFO - Going to convert document batch...
2025-06-10 20:16:32,046 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:16:32,046 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:16:32,069 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 429 3243
2025-06-10 20:16:32,527 - DEBUG - [Page 24] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:32,777 - DEBUG - [Page 17] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:32,802 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:16:32,822 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 429 3243
2025-06-10 20:16:32,823 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:16:32,845 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:16:32,845 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:16:32,845 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:16:32,866 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:16:32,888 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:16:32,910 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 429 0
2025-06-10 20:16:32,946 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 429 0
2025-06-10 20:16:32,968 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 429 0
2025-06-10 20:16:32,990 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 429 0
2025-06-10 20:16:33,081 - DEBUG - [Page 18] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:33,112 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:16:33,132 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 429 0
2025-06-10 20:16:33,152 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 429 0
2025-06-10 20:16:33,186 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:16:33,187 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:16:33,187 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:16:33,208 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:16:33,232 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:16:33,254 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 429 0
2025-06-10 20:16:33,272 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:33,276 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 429 0
2025-06-10 20:16:33,285 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 429 0
2025-06-10 20:16:33,296 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 429 0
2025-06-10 20:16:33,318 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 429 0
2025-06-10 20:16:33,386 - DEBUG - [Page 17] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:33,434 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:16:33,455 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 429 0
2025-06-10 20:16:33,478 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 429 0
2025-06-10 20:16:33,487 - DEBUG - [Page 19] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:33,566 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 429 0
2025-06-10 20:16:33,614 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 429 0
2025-06-10 20:16:33,648 - DEBUG - Snippet 10.1371_journal.pmed.1002598_506_item_1: generation shape=torch.Size([1, 410])
2025-06-10 20:16:33,648 - DEBUG - Snippet 10.1371_journal.pmed.1002598_506_item_1 raw docling: (tokens=64)
<formula><loc_0><loc_0><loc_500><loc_500>A D D = Y _ { b } \times P O P \times A F = Y _ { b } \times P O P \times ( 1 - e ^ { - \beta x C } )</formula><end_of_utterance>
2025-06-10 20:16:33,649 - DEBUG - Starting _parse_docling_output
2025-06-10 20:16:33,649 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>A D D = Y _ { b } \times P O P \times A F = Y _ { b } \times P O P \times ( 1 - e ^ { - \beta x C } )</formula><end_of_utterance>
2025-06-10 20:16:33,649 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:16:33,649 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>A D D = Y _ { b } \\times P O P \\times A F = Y _ { b } \\times P O P \\times ( 1 - e ^ { - \\beta x C } )</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=884x68 at 0x7F96D685D8E0>)]
2025-06-10 20:16:33,649 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:16:33,652 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=884.0, b=68.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 101))], orig='A D D = Y _ { b } \\times P O P \\times A F = Y _ { b } \\times P O P \\times ( 1 - e ^ { - \\beta x C } )', text='A D D = Y _ { b } \\times P O P \\times A F = Y _ { b } \\times P O P \\times ( 1 - e ^ { - \\beta x C } )', formatting=None, hyperlink=None)]
2025-06-10 20:16:33,652 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:16:33,652 - DEBUG - Processing text item: label=formula, text=A D D = Y _ { b } \times P O P \times A F = Y _ { b } \times P O P \times ( 1 - e ^ { - \beta x C } )
2025-06-10 20:16:33,652 - DEBUG - Recognized string extracted: A D D = Y _ { b } \times P O P \times A F = Y _ { b } \times P O P \times ( 1 - e ^ { - \beta x C } )
2025-06-10 20:16:33,653 - INFO - All done. Returning 2 recognized text results.
2025-06-10 20:16:33,653 - DEBUG - Snippet 10.1371_journal.pmed.1002598_506_item_0 recognized text:
A F = 1 - \exp ^ { - \beta \times C }
2025-06-10 20:16:33,653 - DEBUG - Snippet 10.1371_journal.pmed.1002598_506_item_1 recognized text:
A D D = Y _ { b } \times P O P \times A F = Y _ { b } \times P O P \times ( 1 - e ^ { - \beta x C } )
2025-06-10 20:16:33,767 - DEBUG - [Page 25] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:33,771 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:16:33,771 - INFO - Processing document 10.3389_fpubh.2022.864537_523.pdf
2025-06-10 20:16:33,791 - INFO - Finished converting document 10.1371_journal.pmed.1002598_506.pdf in 21.24 sec.
2025-06-10 20:16:33,844 - DEBUG - Finished converting page batch time=3731.438
2025-06-10 20:16:33,891 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 429 0
2025-06-10 20:16:34,039 - INFO - Extraction successful row 85, tokens=23488
2025-06-10 20:16:34,060 - INFO - Going to convert document batch...
2025-06-10 20:16:34,060 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:16:34,061 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:16:34,064 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:16:34,064 - INFO - Processing document 10.1016_s0140-67361631679-8_532.pdf
2025-06-10 20:16:34,094 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 429 3243
2025-06-10 20:16:34,228 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:34,399 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:34,599 - DEBUG - [Page 20] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:34,798 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:34,799 - DEBUG - Finished converting page batch time=3732.394
2025-06-10 20:16:35,041 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:16:35,087 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:16:35,093 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:16:35,171 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:35,307 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:35,497 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:35,498 - DEBUG - Finished converting page batch time=3733.093
2025-06-10 20:16:35,659 - DEBUG - Creating masked image for page 2 with 16 clusters.
2025-06-10 20:16:35,660 - INFO - Masked image successfully created for page 2.
2025-06-10 20:16:35,756 - DEBUG - Creating masked image for page 3 with 27 clusters.
2025-06-10 20:16:35,758 - INFO - Masked image successfully created for page 3.
2025-06-10 20:16:35,764 - INFO - Starting prediction for 4 images with labels: ['formula', 'formula', 'formula', 'formula']
2025-06-10 20:16:35,765 - DEBUG - Generating chat message for label: formula
2025-06-10 20:16:35,765 - DEBUG - Snippet 10.3389_fpubh.2022.869656_518_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:16:35,834 - DEBUG - Snippet 10.3389_fpubh.2022.869656_518_item_0 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:16:35,836 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:16:35,836 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:16:35,837 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:16:35,857 - DEBUG - Snippet 10.1016_s0140-67361832225-6_386_item_3: generation shape=torch.Size([1, 868])
2025-06-10 20:16:35,858 - DEBUG - Snippet 10.1016_s0140-67361832225-6_386_item_3 raw docling: (tokens=257)
<formula><loc_0><loc_0><loc_500><loc_500>p _ { - 1 } \\ p + \sum _ { l = k } c _ { l } = p + \sum _ { l = k } c _ { l } + c _ { \lambda } ^ { * } + ( c _ { \lambda } - c _ { \lambda } ^ { * } ) + \sum _ { l = \lambda + 1 } c _ { l } = \sum _ { l = k } c _ { l } + c _ { \lambda } ^ { * } + g ( \lambda , c _ { \lambda } ^ { * } ) \\ = \sum _ { l = k } ^ { l - 1 } c _ { l } + c _ { \lambda } ^ { * } + f ( \lambda , c _ { \lambda } ^ { * } ) = k + \sum _ { l = k } ^ { l - 1 } c _ { l } \frac { l } { k - 1 } + c _ { \lambda } ^ { * } \frac { \lambda } { k - 1 } .</formula><end_of_utterance>
2025-06-10 20:16:35,858 - DEBUG - Starting _parse_docling_output
2025-06-10 20:16:35,858 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>p _ { - 1 } \\ p + \sum _ { l = k } c _ { l } = p + \sum _ { l = k } c _ { l } + c _ { \lambda } ^ { * } + ( c _ { \lambda } - c _ { \lambda } ^ { * } ) + \sum _ { l = \lambda + 1 } c _ { l } = \sum _ { l = k } c _ { l } + c _ { \lambda } ^ { * } + g ( \lambda , c _ { \lambda } ^ { * } ) \\ = \sum _ { l = k } ^ { l - 1 } c _ { l } + c _ { \lambda } ^ { * } + f ( \lambda , c _ { \lambda } ^ { * } ) = k + \sum _ { l = k } ^ { l - 1 } c _ { l } \frac { l } { k - 1 } + c _ { \lambda } ^ { * } \frac { \lambda } { k - 1 } .</formula><end_of_utterance>
2025-06-10 20:16:35,858 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:16:35,859 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>p _ { - 1 } \\\\ p + \\sum _ { l = k } c _ { l } = p + \\sum _ { l = k } c _ { l } + c _ { \\lambda } ^ { * } + ( c _ { \\lambda } - c _ { \\lambda } ^ { * } ) + \\sum _ { l = \\lambda + 1 } c _ { l } = \\sum _ { l = k } c _ { l } + c _ { \\lambda } ^ { * } + g ( \\lambda , c _ { \\lambda } ^ { * } ) \\\\ = \\sum _ { l = k } ^ { l - 1 } c _ { l } + c _ { \\lambda } ^ { * } + f ( \\lambda , c _ { \\lambda } ^ { * } ) = k + \\sum _ { l = k } ^ { l - 1 } c _ { l } \\frac { l } { k - 1 } + c _ { \\lambda } ^ { * } \\frac { \\lambda } { k - 1 } .</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=936x352 at 0x7F96B85BA7B0>)]
2025-06-10 20:16:35,859 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:16:35,869 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=936.0, b=352.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 523))], orig='p _ { - 1 } \\\\ p + \\sum _ { l = k } c _ { l } = p + \\sum _ { l = k } c _ { l } + c _ { \\lambda } ^ { * } + ( c _ { \\lambda } - c _ { \\lambda } ^ { * } ) + \\sum _ { l = \\lambda + 1 } c _ { l } = \\sum _ { l = k } c _ { l } + c _ { \\lambda } ^ { * } + g ( \\lambda , c _ { \\lambda } ^ { * } ) \\\\ = \\sum _ { l = k } ^ { l - 1 } c _ { l } + c _ { \\lambda } ^ { * } + f ( \\lambda , c _ { \\lambda } ^ { * } ) = k + \\sum _ { l = k } ^ { l - 1 } c _ { l } \\frac { l } { k - 1 } + c _ { \\lambda } ^ { * } \\frac { \\lambda } { k - 1 } .', text='p _ { - 1 } \\\\ p + \\sum _ { l = k } c _ { l } = p + \\sum _ { l = k } c _ { l } + c _ { \\lambda } ^ { * } + ( c _ { \\lambda } - c _ { \\lambda } ^ { * } ) + \\sum _ { l = \\lambda + 1 } c _ { l } = \\sum _ { l = k } c _ { l } + c _ { \\lambda } ^ { * } + g ( \\lambda , c _ { \\lambda } ^ { * } ) \\\\ = \\sum _ { l = k } ^ { l - 1 } c _ { l } + c _ { \\lambda } ^ { * } + f ( \\lambda , c _ { \\lambda } ^ { * } ) = k + \\sum _ { l = k } ^ { l - 1 } c _ { l } \\frac { l } { k - 1 } + c _ { \\lambda } ^ { * } \\frac { \\lambda } { k - 1 } .', formatting=None, hyperlink=None)]
2025-06-10 20:16:35,869 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:16:35,869 - DEBUG - Processing text item: label=formula, text=p _ { - 1 } \\ p + \sum _ { l = k } c _ { l } = p + \sum _ { l = k } c _ { l } + c _ { \lambda } ^ { * } + ( c _ { \lambda } - c _ { \lambda } ^ { * } ) + \sum _ { l = \lambda + 1 } c _ { l } = \sum _ { l = k } c _ { l } + c _ { \lambda } ^ { * } + g ( \lambda , c _ { \lambda } ^ { * } ) \\ = \sum _ { l = k } ^ { l - 1 } c _ { l } + c _ { \lambda } ^ { * } + f ( \lambda , c _ { \lambda } ^ { * } ) = k + \sum _ { l = k } ^ { l - 1 } c _ { l } \frac { l } { k - 1 } + c _ { \lambda } ^ { * } \frac { \lambda } { k - 1 } .
2025-06-10 20:16:35,869 - DEBUG - Recognized string extracted: p _ { - 1 } \\ p + \sum _ { l = k } c _ { l } = p + \sum _ { l = k } c _ { l } + c _ { \lambda } ^ { * } + ( c _ { \lambda } - c _ { \lambda } ^ { * } ) + \sum _ { l = \lambda + 1 } c _ { l } = \sum _ { l = k } c _ { l } + c _ { \lambda } ^ { * } + g ( \lambda , c _ { \lambda } ^ { * } ) \\ = \sum _ { l = k } ^ { l - 1 } c _ { l } + c _ { \lambda } ^ { * } + f ( \lambda , c _ { \lambda } ^ { * } ) = k + \sum _ { l = k } ^ { l - 1 } c _ { l } \frac { l } { k - 1 } + c _ { \lambda } ^ { * } \frac { \lambda } { k - 1 } .
2025-06-10 20:16:35,870 - DEBUG - Generating chat message for label: formula
2025-06-10 20:16:35,870 - DEBUG - Snippet 10.1016_s0140-67361832225-6_386_item_4 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:16:35,870 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:16:35,907 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:16:35,970 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:16:36,010 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:16:36,026 - DEBUG - Snippet 10.1016_s0140-67361832225-6_386_item_4 => input_ids shape=torch.Size([1, 610]), prompt_len=610
2025-06-10 20:16:36,047 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:16:36,082 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:16:36,139 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:36,186 - DEBUG - [Page 26] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:36,213 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:16:36,251 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:16:36,342 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:16:36,487 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:16:36,559 - DEBUG - Dynamic vertical threshold: 47.95920000000001, Overlap threshold: 0.7
2025-06-10 20:16:36,559 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:36,811 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:16:37,027 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:16:37,028 - INFO - Processing document 10.3389_fpubh.2020.00014_533.pdf
2025-06-10 20:16:37,430 - DEBUG - Snippet 10.3389_fpubh.2022.869656_518_item_0: generation shape=torch.Size([1, 403])
2025-06-10 20:16:37,431 - DEBUG - Snippet 10.3389_fpubh.2022.869656_518_item_0 raw docling: (tokens=57)
<formula><loc_0><loc_0><loc_500><loc_500>A P = \sum ( [ R R ( c ) - 1 ] * P ( c ) ] ) / \sum [ R R ( c ) * P ( c ) ]</formula><end_of_utterance>
2025-06-10 20:16:37,432 - DEBUG - Starting _parse_docling_output
2025-06-10 20:16:37,432 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>A P = \sum ( [ R R ( c ) - 1 ] * P ( c ) ] ) / \sum [ R R ( c ) * P ( c ) ]</formula><end_of_utterance>
2025-06-10 20:16:37,432 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:16:37,432 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>A P = \\sum ( [ R R ( c ) - 1 ] * P ( c ) ] ) / \\sum [ R R ( c ) * P ( c ) ]</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=664x80 at 0x7F96D663C740>)]
2025-06-10 20:16:37,433 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:16:37,435 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=664.0, b=80.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 75))], orig='A P = \\sum ( [ R R ( c ) - 1 ] * P ( c ) ] ) / \\sum [ R R ( c ) * P ( c ) ]', text='A P = \\sum ( [ R R ( c ) - 1 ] * P ( c ) ] ) / \\sum [ R R ( c ) * P ( c ) ]', formatting=None, hyperlink=None)]
2025-06-10 20:16:37,436 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:16:37,436 - DEBUG - Processing text item: label=formula, text=A P = \sum ( [ R R ( c ) - 1 ] * P ( c ) ] ) / \sum [ R R ( c ) * P ( c ) ]
2025-06-10 20:16:37,436 - DEBUG - Recognized string extracted: A P = \sum ( [ R R ( c ) - 1 ] * P ( c ) ] ) / \sum [ R R ( c ) * P ( c ) ]
2025-06-10 20:16:37,436 - DEBUG - Generating chat message for label: formula
2025-06-10 20:16:37,436 - DEBUG - Snippet 10.3389_fpubh.2022.869656_518_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:16:37,501 - DEBUG - Snippet 10.3389_fpubh.2022.869656_518_item_1 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:16:37,514 - DEBUG - Dynamic vertical threshold: 59.46390000000007, Overlap threshold: 0.7
2025-06-10 20:16:37,515 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:37,516 - DEBUG - Finished converting page batch time=3735.110
2025-06-10 20:16:37,521 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:38,001 - DEBUG - Snippet 10.1016_s0140-67361832225-6_386_item_4: generation shape=torch.Size([1, 685])
2025-06-10 20:16:38,002 - DEBUG - Snippet 10.1016_s0140-67361832225-6_386_item_4 raw docling: (tokens=74)
<formula><loc_0><loc_0><loc_500><loc_500>R _ { F I F O } ( C ) \geq \frac { L R U ( C ) + c ( k - 1 ) } { O P T ( C ) + c ( 1 - 1 / k ) + 1 } .</formula><end_of_utterance>
2025-06-10 20:16:38,002 - DEBUG - Starting _parse_docling_output
2025-06-10 20:16:38,002 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>R _ { F I F O } ( C ) \geq \frac { L R U ( C ) + c ( k - 1 ) } { O P T ( C ) + c ( 1 - 1 / k ) + 1 } .</formula><end_of_utterance>
2025-06-10 20:16:38,003 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:16:38,003 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>R _ { F I F O } ( C ) \\geq \\frac { L R U ( C ) + c ( k - 1 ) } { O P T ( C ) + c ( 1 - 1 / k ) + 1 } .</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=451x158 at 0x7F971D381430>)]
2025-06-10 20:16:38,003 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:16:38,006 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=451.0, b=158.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 102))], orig='R _ { F I F O } ( C ) \\geq \\frac { L R U ( C ) + c ( k - 1 ) } { O P T ( C ) + c ( 1 - 1 / k ) + 1 } .', text='R _ { F I F O } ( C ) \\geq \\frac { L R U ( C ) + c ( k - 1 ) } { O P T ( C ) + c ( 1 - 1 / k ) + 1 } .', formatting=None, hyperlink=None)]
2025-06-10 20:16:38,007 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:16:38,007 - DEBUG - Processing text item: label=formula, text=R _ { F I F O } ( C ) \geq \frac { L R U ( C ) + c ( k - 1 ) } { O P T ( C ) + c ( 1 - 1 / k ) + 1 } .
2025-06-10 20:16:38,007 - DEBUG - Recognized string extracted: R _ { F I F O } ( C ) \geq \frac { L R U ( C ) + c ( k - 1 ) } { O P T ( C ) + c ( 1 - 1 / k ) + 1 } .
2025-06-10 20:16:38,007 - INFO - All done. Returning 5 recognized text results.
2025-06-10 20:16:38,007 - DEBUG - Snippet 10.1016_s0140-67361832225-6_386_item_0 recognized text:
\sum _ { l = k } ^ { j ^ { * } - 1 } c _ { l } \frac { l - k + 1 } { k - 1 } + \gamma ^ { * } \frac { j ^ { * } - k + 1 } { k - 1 } .
2025-06-10 20:16:38,008 - DEBUG - Snippet 10.1016_s0140-67361832225-6_386_item_1 recognized text:
O P T ( \sigma ) \leq k + \sum _ { i = 1 } ^ { r } ( l _ { i } ^ { * } - k + 1 ) = k + \sum _ { i = 1 } ^ { r - 1 } ( l _ { i } ^ { \prime } - k + 1 ) + \sum _ { i = 1 } ^ { r - 1 } ( l _ { i } ^ { * } - l _ { i } ^ { \prime } ) + l _ { r } ^ { * } - k + 1 \\ \leq k + \sum _ { l = k } ^ { \lambda - 1 } c _ { l } \frac { l - k + 1 } { k - 1 } + c _ { \lambda } ^ { * } \frac { \lambda - k + 1 } { k - 1 } + \sum _ { i = 1 } ^ { r - 1 } ( l _ { i } ^ { * } - l _ { i } ^ { \prime } ) + l _ { r } ^ { * } - k + 1 .
2025-06-10 20:16:38,008 - DEBUG - Snippet 10.1016_s0140-67361832225-6_386_item_2 recognized text:
R _ { L R U } ( C ) \leq \max \left \{ p , k + \sum _ { l = k } ^ { p + \sum _ { l = k } ^ { p - 1 } C l } c _ { l } ^ { * } \frac { \lambda - 1 } { k - 1 } + c _ { \lambda } ^ { * } \frac { \lambda - k + 1 } { k - 1 } \right \} \\ R _ { L R U } ( C ) \geq \frac { p + \sum _ { l = k } ^ { p - 1 } C l } { k + \sum _ { l = k } ^ { \lambda - 1 } c _ { l } ^ { \frac { p - 1 } { k - 1 } } \frac { \lambda - k + 1 } { k - 1 } + c _ { \lambda } ^ { * } \frac { \lambda - k + 1 } { k - 1 } + 2 ( \lambda - k + 1 )
2025-06-10 20:16:38,008 - DEBUG - Snippet 10.1016_s0140-67361832225-6_386_item_3 recognized text:
p _ { - 1 } \\ p + \sum _ { l = k } c _ { l } = p + \sum _ { l = k } c _ { l } + c _ { \lambda } ^ { * } + ( c _ { \lambda } - c _ { \lambda } ^ { * } ) + \sum _ { l = \lambda + 1 } c _ { l } = \sum _ { l = k } c _ { l } + c _ { \lambda } ^ { * } + g ( \lambda , c _ { \lambda } ^ { * } ) \\ = \sum _ { l = k } ^ { l - 1 } c _ { l } + c _ { \lambda } ^ { * } + f ( \lambda , c _ { \lambda } ^ { * } ) = k + \sum _ { l = k } ^ { l - 1 } c _ { l } \frac { l } { k - 1 } + c _ { \lambda } ^ { * } \frac { \lambda } { k - 1 } .
2025-06-10 20:16:38,008 - DEBUG - Snippet 10.1016_s0140-67361832225-6_386_item_4 recognized text:
R _ { F I F O } ( C ) \geq \frac { L R U ( C ) + c ( k - 1 ) } { O P T ( C ) + c ( 1 - 1 / k ) + 1 } .
2025-06-10 20:16:38,058 - DEBUG - [Page 21] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:38,079 - DEBUG - Creating masked image for page 23 with 10 clusters.
2025-06-10 20:16:38,080 - INFO - Masked image successfully created for page 23.
2025-06-10 20:16:38,124 - DEBUG - [Page 18] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:38,165 - DEBUG - Creating masked image for page 32 with 14 clusters.
2025-06-10 20:16:38,165 - INFO - Masked image successfully created for page 32.
2025-06-10 20:16:38,174 - INFO - Starting prediction for 3 images with labels: ['formula', 'formula', 'formula']
2025-06-10 20:16:38,175 - DEBUG - Generating chat message for label: formula
2025-06-10 20:16:38,175 - DEBUG - Snippet 10.1016_s0140-67361832225-6_386_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:16:38,285 - DEBUG - [Page 4] Keeping cluster 0 as table (area ratio: 0.70, cells: 476, density: 0.001428).
2025-06-10 20:16:38,286 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:38,308 - DEBUG - Snippet 10.3389_fpubh.2022.869656_518_item_1: generation shape=torch.Size([1, 373])
2025-06-10 20:16:38,309 - DEBUG - Snippet 10.3389_fpubh.2022.869656_518_item_1 raw docling: (tokens=27)
<formula><loc_0><loc_0><loc_500><loc_500>B E = B \times A P</formula><end_of_utterance>
2025-06-10 20:16:38,309 - DEBUG - Starting _parse_docling_output
2025-06-10 20:16:38,309 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>B E = B \times A P</formula><end_of_utterance>
2025-06-10 20:16:38,309 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:16:38,310 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>B E = B \\times A P</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=450x56 at 0x7F971D7414C0>)]
2025-06-10 20:16:38,310 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:16:38,312 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=450.0, b=56.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 18))], orig='B E = B \\times A P', text='B E = B \\times A P', formatting=None, hyperlink=None)]
2025-06-10 20:16:38,312 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:16:38,312 - DEBUG - Processing text item: label=formula, text=B E = B \times A P
2025-06-10 20:16:38,312 - DEBUG - Recognized string extracted: B E = B \times A P
2025-06-10 20:16:38,312 - DEBUG - Generating chat message for label: formula
2025-06-10 20:16:38,313 - DEBUG - Snippet 10.3389_fpubh.2022.869656_518_item_2 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:16:38,349 - DEBUG - Dynamic vertical threshold: 23.466600000000064, Overlap threshold: 0.7
2025-06-10 20:16:38,350 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:38,351 - DEBUG - Finished converting page batch time=3735.945
2025-06-10 20:16:38,380 - DEBUG - Snippet 10.3389_fpubh.2022.869656_518_item_2 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:16:38,393 - DEBUG - Snippet 10.1016_s0140-67361832225-6_386_item_0 => input_ids shape=torch.Size([1, 610]), prompt_len=610
2025-06-10 20:16:38,498 - DEBUG - [Page 27] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:38,500 - DEBUG - Finished converting page batch time=3736.095
2025-06-10 20:16:38,552 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:38,857 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:38,916 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:39,249 - DEBUG - [Page 22] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:39,328 - DEBUG - Snippet 10.3389_fpubh.2022.869656_518_item_2: generation shape=torch.Size([1, 373])
2025-06-10 20:16:39,329 - DEBUG - Snippet 10.3389_fpubh.2022.869656_518_item_2 raw docling: (tokens=27)
<formula><loc_0><loc_0><loc_500><loc_500>I E = I \times A P</formula><end_of_utterance>
2025-06-10 20:16:39,329 - DEBUG - Starting _parse_docling_output
2025-06-10 20:16:39,330 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>I E = I \times A P</formula><end_of_utterance>
2025-06-10 20:16:39,330 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:16:39,330 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>I E = I \\times A P</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=446x55 at 0x7F96D6648AD0>)]
2025-06-10 20:16:39,331 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:16:39,332 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=446.0, b=55.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 18))], orig='I E = I \\times A P', text='I E = I \\times A P', formatting=None, hyperlink=None)]
2025-06-10 20:16:39,332 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:16:39,338 - DEBUG - Processing text item: label=formula, text=I E = I \times A P
2025-06-10 20:16:39,338 - DEBUG - Recognized string extracted: I E = I \times A P
2025-06-10 20:16:39,339 - DEBUG - Generating chat message for label: formula
2025-06-10 20:16:39,339 - DEBUG - Snippet 10.3389_fpubh.2022.869656_518_item_3 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:16:39,410 - DEBUG - Snippet 10.3389_fpubh.2022.869656_518_item_3 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:16:39,890 - DEBUG - [Page 28] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:40,361 - DEBUG - Snippet 10.3389_fpubh.2022.869656_518_item_3: generation shape=torch.Size([1, 373])
2025-06-10 20:16:40,362 - DEBUG - Snippet 10.3389_fpubh.2022.869656_518_item_3 raw docling: (tokens=27)
<formula><loc_0><loc_0><loc_500><loc_500>N E = I E \times N</formula><end_of_utterance>
2025-06-10 20:16:40,362 - DEBUG - Starting _parse_docling_output
2025-06-10 20:16:40,363 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>N E = I E \times N</formula><end_of_utterance>
2025-06-10 20:16:40,363 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:16:40,363 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>N E = I E \\times N</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=448x56 at 0x7F96D66485F0>)]
2025-06-10 20:16:40,363 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:16:40,365 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=448.0, b=56.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 18))], orig='N E = I E \\times N', text='N E = I E \\times N', formatting=None, hyperlink=None)]
2025-06-10 20:16:40,365 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:16:40,365 - DEBUG - Processing text item: label=formula, text=N E = I E \times N
2025-06-10 20:16:40,365 - DEBUG - Recognized string extracted: N E = I E \times N
2025-06-10 20:16:40,365 - INFO - All done. Returning 4 recognized text results.
2025-06-10 20:16:40,366 - DEBUG - Snippet 10.3389_fpubh.2022.869656_518_item_0 recognized text:
A P = \sum ( [ R R ( c ) - 1 ] * P ( c ) ] ) / \sum [ R R ( c ) * P ( c ) ]
2025-06-10 20:16:40,366 - DEBUG - Snippet 10.3389_fpubh.2022.869656_518_item_1 recognized text:
B E = B \times A P
2025-06-10 20:16:40,366 - DEBUG - Snippet 10.3389_fpubh.2022.869656_518_item_2 recognized text:
I E = I \times A P
2025-06-10 20:16:40,366 - DEBUG - Snippet 10.3389_fpubh.2022.869656_518_item_3 recognized text:
N E = I E \times N
2025-06-10 20:16:40,367 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:40,408 - DEBUG - [Page 19] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:40,437 - DEBUG - [Page 23] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:40,443 - INFO - Finished converting document 10.3389_fpubh.2022.869656_518.pdf in 15.87 sec.
2025-06-10 20:16:40,472 - DEBUG - [Page 29] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:40,525 - INFO - Extraction successful row 89, tokens=12608
2025-06-10 20:16:40,587 - INFO - Going to convert document batch...
2025-06-10 20:16:40,588 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:16:40,588 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:16:40,626 - DEBUG - Snippet 10.1016_s0140-67361832225-6_386_item_0: generation shape=torch.Size([1, 684])
2025-06-10 20:16:40,627 - DEBUG - Snippet 10.1016_s0140-67361832225-6_386_item_0 raw docling: (tokens=73)
<formula><loc_0><loc_0><loc_500><loc_500>R _ { F W F } ( C ) \geq \frac { L R U ( C ) + c ( k - 1 ) } { O P T ( C ) + c ( 1 - 1 / k ) + 1 } .</formula><end_of_utterance>
2025-06-10 20:16:40,628 - DEBUG - Starting _parse_docling_output
2025-06-10 20:16:40,628 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>R _ { F W F } ( C ) \geq \frac { L R U ( C ) + c ( k - 1 ) } { O P T ( C ) + c ( 1 - 1 / k ) + 1 } .</formula><end_of_utterance>
2025-06-10 20:16:40,628 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:16:40,628 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>R _ { F W F } ( C ) \\geq \\frac { L R U ( C ) + c ( k - 1 ) } { O P T ( C ) + c ( 1 - 1 / k ) + 1 } .</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=449x157 at 0x7F96B840AEA0>)]
2025-06-10 20:16:40,629 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:16:40,631 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=449.0, b=157.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 100))], orig='R _ { F W F } ( C ) \\geq \\frac { L R U ( C ) + c ( k - 1 ) } { O P T ( C ) + c ( 1 - 1 / k ) + 1 } .', text='R _ { F W F } ( C ) \\geq \\frac { L R U ( C ) + c ( k - 1 ) } { O P T ( C ) + c ( 1 - 1 / k ) + 1 } .', formatting=None, hyperlink=None)]
2025-06-10 20:16:40,632 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:16:40,632 - DEBUG - Processing text item: label=formula, text=R _ { F W F } ( C ) \geq \frac { L R U ( C ) + c ( k - 1 ) } { O P T ( C ) + c ( 1 - 1 / k ) + 1 } .
2025-06-10 20:16:40,632 - DEBUG - Recognized string extracted: R _ { F W F } ( C ) \geq \frac { L R U ( C ) + c ( k - 1 ) } { O P T ( C ) + c ( 1 - 1 / k ) + 1 } .
2025-06-10 20:16:40,632 - DEBUG - Generating chat message for label: formula
2025-06-10 20:16:40,633 - DEBUG - Snippet 10.1016_s0140-67361832225-6_386_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:16:40,929 - DEBUG - Snippet 10.1016_s0140-67361832225-6_386_item_1 => input_ids shape=torch.Size([1, 876]), prompt_len=876
2025-06-10 20:16:41,080 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:16:41,238 - DEBUG - Finished converting page batch time=3738.833
2025-06-10 20:16:41,250 - DEBUG - Finished converting page batch time=3738.844
2025-06-10 20:16:41,285 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:41,465 - DEBUG - [Page 24] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:41,662 - INFO - Finished converting document 10.1016_j.freeradbiomed.2020.01.004_485.pdf in 47.75 sec.
2025-06-10 20:16:41,699 - DEBUG - [Page 30] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:41,902 - INFO - Extraction successful row 78, tokens=65148
2025-06-10 20:16:41,930 - INFO - Going to convert document batch...
2025-06-10 20:16:41,930 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:16:41,931 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:16:41,956 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:16:41,978 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:16:42,198 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:16:42,205 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:16:42,686 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:42,687 - DEBUG - Finished converting page batch time=3740.281
2025-06-10 20:16:42,687 - DEBUG - [Page 31] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:42,688 - DEBUG - Finished converting page batch time=3740.282
2025-06-10 20:16:42,745 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:42,759 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:16:42,780 - DEBUG - [Page 25] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:42,810 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:16:42,816 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:16:42,989 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:16:42,989 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:16:42,994 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:16:43,032 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:16:43,082 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:16:43,121 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:16:43,158 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:16:43,199 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:16:43,343 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:16:43,343 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:16:43,343 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:16:43,351 - DEBUG - [Page 26] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:43,388 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:16:43,432 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:16:43,444 - DEBUG - [Page 27] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:43,445 - DEBUG - Finished converting page batch time=3741.039
2025-06-10 20:16:43,446 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:16:43,470 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:43,473 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:16:43,510 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:16:43,547 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:16:43,555 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:43,575 - DEBUG - [Page 28] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:43,584 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:16:43,586 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:16:43,623 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:16:43,664 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:16:43,719 - DEBUG - [Page 29] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:43,723 - DEBUG - [Page 32] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:43,727 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:16:43,830 - DEBUG - [Page 30] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:43,830 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:16:43,930 - DEBUG - Finished converting page batch time=3741.524
2025-06-10 20:16:43,943 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:16:43,985 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:16:44,133 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:16:44,229 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:16:44,234 - DEBUG - [Page 6] Keeping cluster 0 as table (area ratio: 0.71, cells: 424, density: 0.001264).
2025-06-10 20:16:44,234 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:44,448 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:16:44,452 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:16:44,453 - INFO - Processing document 10.1371_journal.pone.0137832_537.pdf
2025-06-10 20:16:44,571 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:44,632 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:16:44,633 - INFO - Processing document 10.1108_ijccsm-08-2021-0090_539.pdf
2025-06-10 20:16:45,025 - DEBUG - [Page 33] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:45,228 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:45,399 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:45,587 - DEBUG - [Page 31] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:45,848 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:45,865 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:46,031 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:46,044 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:46,255 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:46,340 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:46,623 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:46,697 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:46,777 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:46,779 - DEBUG - Finished converting page batch time=3744.374
2025-06-10 20:16:46,923 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:46,951 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:47,134 - DEBUG - [Page 34] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:47,164 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:47,348 - DEBUG - Finished converting page batch time=3744.943
2025-06-10 20:16:47,580 - DEBUG - Finished converting page batch time=3745.174
2025-06-10 20:16:47,711 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:47,712 - DEBUG - Finished converting page batch time=3745.306
2025-06-10 20:16:47,838 - DEBUG - Finished converting page batch time=3745.432
2025-06-10 20:16:47,995 - DEBUG - [Page 32] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:47,996 - DEBUG - Finished converting page batch time=3745.590
2025-06-10 20:16:48,129 - INFO - Finished converting document 10.1016_s2542-51962100195-9_512.pdf in 32.81 sec.
2025-06-10 20:16:48,227 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:48,295 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:48,296 - DEBUG - Finished converting page batch time=3745.891
2025-06-10 20:16:48,322 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:48,459 - DEBUG - [Page 35] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:48,460 - DEBUG - Finished converting page batch time=3746.054
2025-06-10 20:16:48,466 - INFO - Extraction successful row 87, tokens=43797
2025-06-10 20:16:48,487 - INFO - Going to convert document batch...
2025-06-10 20:16:48,488 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:16:48,488 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:16:48,490 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:48,541 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:16:48,603 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:48,652 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:48,761 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:48,851 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:48,986 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:49,157 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:49,211 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:16:49,264 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:16:49,271 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:16:49,851 - DEBUG - [Page 36] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:50,107 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:50,109 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:16:50,110 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:16:50,110 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:16:50,145 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:16:50,163 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:50,180 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:16:50,468 - DEBUG - [Page 14] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:50,505 - DEBUG - Dynamic vertical threshold: 49.18499999999998, Overlap threshold: 0.7
2025-06-10 20:16:50,506 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:50,649 - DEBUG - [Page 15] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:50,649 - DEBUG - Finished converting page batch time=3748.244
2025-06-10 20:16:50,665 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:16:50,695 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:50,697 - DEBUG - Finished converting page batch time=3748.291
2025-06-10 20:16:50,831 - DEBUG - Creating masked image for page 2 with 16 clusters.
2025-06-10 20:16:50,833 - INFO - Masked image successfully created for page 2.
2025-06-10 20:16:50,844 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:16:50,890 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:16:50,955 - DEBUG - Creating masked image for page 3 with 17 clusters.
2025-06-10 20:16:50,956 - INFO - Masked image successfully created for page 3.
2025-06-10 20:16:50,962 - INFO - Starting prediction for 2 images with labels: ['formula', 'formula']
2025-06-10 20:16:50,963 - DEBUG - Generating chat message for label: formula
2025-06-10 20:16:50,963 - DEBUG - Snippet 10.3389_fpubh.2022.864537_523_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:16:50,964 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:16:51,034 - DEBUG - Snippet 10.3389_fpubh.2022.864537_523_item_0 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:16:51,099 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:16:51,133 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:16:51,166 - DEBUG - [Page 37] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:51,200 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:16:51,219 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:51,318 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:51,394 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:16:51,692 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:16:51,727 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:51,870 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:51,923 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:16:51,923 - INFO - Processing document 10.3390_biology11081122_540.pdf
2025-06-10 20:16:52,015 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:52,070 - DEBUG - [Page 38] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:52,071 - DEBUG - Finished converting page batch time=3749.666
2025-06-10 20:16:52,330 - DEBUG - Creating masked image for page 4 with 14 clusters.
2025-06-10 20:16:52,331 - INFO - Masked image successfully created for page 4.
2025-06-10 20:16:52,450 - DEBUG - Creating masked image for page 5 with 16 clusters.
2025-06-10 20:16:52,453 - INFO - Masked image successfully created for page 5.
2025-06-10 20:16:52,578 - DEBUG - Creating masked image for page 7 with 15 clusters.
2025-06-10 20:16:52,580 - INFO - Masked image successfully created for page 7.
2025-06-10 20:16:52,601 - DEBUG - Finished converting page batch time=3750.195
2025-06-10 20:16:52,704 - DEBUG - Creating masked image for page 8 with 20 clusters.
2025-06-10 20:16:52,706 - INFO - Masked image successfully created for page 8.
2025-06-10 20:16:52,715 - INFO - Starting prediction for 5 images with labels: ['formula', 'formula', 'formula', 'formula', 'formula']
2025-06-10 20:16:52,716 - DEBUG - Generating chat message for label: formula
2025-06-10 20:16:52,716 - DEBUG - Snippet 10.5194_acp-18-16173-2018_487_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:16:52,761 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:52,785 - DEBUG - Snippet 10.5194_acp-18-16173-2018_487_item_0 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:16:52,883 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:53,223 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:53,245 - DEBUG - Finished converting page batch time=3750.839
2025-06-10 20:16:53,301 - DEBUG - Snippet 10.1016_s0140-67361832225-6_386_item_1: generation shape=torch.Size([1, 1276])
2025-06-10 20:16:53,302 - DEBUG - Snippet 10.1016_s0140-67361832225-6_386_item_1 raw docling: (tokens=399)
<formula><loc_0><loc_0><loc_500><loc_500>\frac { 1 } { d } \sum _ { c l } \frac { l - k + 1 } { c l } \\ \frac { 1 } { d } \sum _ { c l } \frac { \lambda - 1 } { l - k + 1 } \frac { l - k + 1 } { l } + c _ { i } ^ { \lambda } \left ( \frac { \lambda - k + 1 } { \lambda } \right ) + ( c _ { i } \lambda - c _ { i } ^ { \lambda } ) ^ { * } \left ( \frac { \lambda - k + 1 } { \lambda } \right ) + \sum _ { l = \lambda + 1 } ^ { p - 1 } c _ { l } ^ { \lambda } \frac { l - k + 1 } { l } \\ \leq \frac { 1 } { d } \sum _ { c l } \frac { l - k + 1 } { k } + c _ { i } ^ { \lambda } \left ( \frac { \lambda - k + 1 } { k } \right ) + ( c _ { i } \lambda - c _ { i } ^ { \lambda } ) ^ { * } ( \frac { \lambda - k + 1 } { \lambda } \right ) + \sum _ { l = \lambda + 1 } ^ { p - 1 } c _ { l } ^ { \lambda } \frac { l - k + 1 } { l } \\ \leq \frac { 1 } { d } \left ( \frac { k - 1 } { k } \left ( p - k \
2025-06-10 20:16:53,302 - DEBUG - Starting _parse_docling_output
2025-06-10 20:16:53,303 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>\frac { 1 } { d } \sum _ { c l } \frac { l - k + 1 } { c l } \\ \frac { 1 } { d } \sum _ { c l } \frac { \lambda - 1 } { l - k + 1 } \frac { l - k + 1 } { l } + c _ { i } ^ { \lambda } \left ( \frac { \lambda - k + 1 } { \lambda } \right ) + ( c _ { i } \lambda - c _ { i } ^ { \lambda } ) ^ { * } \left ( \frac { \lambda - k + 1 } { \lambda } \right ) + \sum _ { l = \lambda + 1 } ^ { p - 1 } c _ { l } ^ { \lambda } \frac { l - k + 1 } { l } \\ \leq \frac { 1 } { d } \sum _ { c l } \frac { l - k + 1 } { k } + c _ { i } ^ { \lambda } \left ( \frac { \lambda - k + 1 } { k } \right ) + ( c _ { i } \lambda - c _ { i } ^ { \lambda } ) ^ { * } ( \frac { \lambda - k + 1 } { \lambda } \right ) + \sum _ { l = \lambda + 1 } ^ { p - 1 } c _ { l } ^ { \lambda } \frac { l - k + 1 } { l } \\ \leq \frac { 1 } { d } \left ( \frac { k - 1 } { k } \left ( p - k \
2025-06-10 20:16:53,303 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:16:53,303 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>\\frac { 1 } { d } \\sum _ { c l } \\frac { l - k + 1 } { c l } \\\\ \\frac { 1 } { d } \\sum _ { c l } \\frac { \\lambda - 1 } { l - k + 1 } \\frac { l - k + 1 } { l } + c _ { i } ^ { \\lambda } \\left ( \\frac { \\lambda - k + 1 } { \\lambda } \\right ) + ( c _ { i } \\lambda - c _ { i } ^ { \\lambda } ) ^ { * } \\left ( \\frac { \\lambda - k + 1 } { \\lambda } \\right ) + \\sum _ { l = \\lambda + 1 } ^ { p - 1 } c _ { l } ^ { \\lambda } \\frac { l - k + 1 } { l } \\\\ \\leq \\frac { 1 } { d } \\sum _ { c l } \\frac { l - k + 1 } { k } + c _ { i } ^ { \\lambda } \\left ( \\frac { \\lambda - k + 1 } { k } \\right ) + ( c _ { i } \\lambda - c _ { i } ^ { \\lambda } ) ^ { * } ( \\frac { \\lambda - k + 1 } { \\lambda } \\right ) + \\sum _ { l = \\lambda + 1 } ^ { p - 1 } c _ { l } ^ { \\lambda } \\frac { l - k + 1 } { l } \\\\ \\leq \\frac { 1 } { d } \\left ( \\frac { k - 1 } { k } \\left ( p - k \\', image=<PIL.Image.Image image mode=RGB size=1012x1398 at 0x7F96DDF538C0>)]
2025-06-10 20:16:53,303 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:16:53,334 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:53,344 - DEBUG - DoclingDocument loaded successfully. Extracted texts: []
2025-06-10 20:16:53,345 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:16:53,345 - WARNING - Extracted text is empty or malformed. Skipping formula.
2025-06-10 20:16:53,345 - DEBUG - Generating chat message for label: formula
2025-06-10 20:16:53,346 - DEBUG - Snippet 10.1016_s0140-67361832225-6_386_item_2 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:16:53,397 - DEBUG - Snippet 10.3389_fpubh.2022.864537_523_item_0: generation shape=torch.Size([1, 426])
2025-06-10 20:16:53,398 - DEBUG - Snippet 10.3389_fpubh.2022.864537_523_item_0 raw docling: (tokens=80)
<formula><loc_0><loc_0><loc_500><loc_500>L o g [ E ( y _ { i } ) ] = \alpha + \beta _ { i } X _ { i } + n s ( t i m e , d f ) + n s ( Z _ { i } , d f ) \\ + D O W + P H</formula><end_of_utterance>
2025-06-10 20:16:53,398 - DEBUG - Starting _parse_docling_output
2025-06-10 20:16:53,399 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>L o g [ E ( y _ { i } ) ] = \alpha + \beta _ { i } X _ { i } + n s ( t i m e , d f ) + n s ( Z _ { i } , d f ) \\ + D O W + P H</formula><end_of_utterance>
2025-06-10 20:16:53,399 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:16:53,399 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>L o g [ E ( y _ { i } ) ] = \\alpha + \\beta _ { i } X _ { i } + n s ( t i m e , d f ) + n s ( Z _ { i } , d f ) \\\\ + D O W + P H</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=642x118 at 0x7F971C5D0B30>)]
2025-06-10 20:16:53,399 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:16:53,402 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=642.0, b=118.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 127))], orig='L o g [ E ( y _ { i } ) ] = \\alpha + \\beta _ { i } X _ { i } + n s ( t i m e , d f ) + n s ( Z _ { i } , d f ) \\\\ + D O W + P H', text='L o g [ E ( y _ { i } ) ] = \\alpha + \\beta _ { i } X _ { i } + n s ( t i m e , d f ) + n s ( Z _ { i } , d f ) \\\\ + D O W + P H', formatting=None, hyperlink=None)]
2025-06-10 20:16:53,403 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:16:53,403 - DEBUG - Processing text item: label=formula, text=L o g [ E ( y _ { i } ) ] = \alpha + \beta _ { i } X _ { i } + n s ( t i m e , d f ) + n s ( Z _ { i } , d f ) \\ + D O W + P H
2025-06-10 20:16:53,403 - DEBUG - Recognized string extracted: L o g [ E ( y _ { i } ) ] = \alpha + \beta _ { i } X _ { i } + n s ( t i m e , d f ) + n s ( Z _ { i } , d f ) \\ + D O W + P H
2025-06-10 20:16:53,403 - DEBUG - Generating chat message for label: formula
2025-06-10 20:16:53,404 - DEBUG - Snippet 10.3389_fpubh.2022.864537_523_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:16:53,428 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:53,444 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:53,468 - DEBUG - Snippet 10.3389_fpubh.2022.864537_523_item_1 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:16:53,486 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:53,488 - DEBUG - Finished converting page batch time=3751.082
2025-06-10 20:16:53,726 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:53,786 - DEBUG - Snippet 10.1016_s0140-67361832225-6_386_item_2 => input_ids shape=torch.Size([1, 1140]), prompt_len=1140
2025-06-10 20:16:53,932 - DEBUG - [Page 14] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:54,027 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:54,083 - DEBUG - Finished converting page batch time=3751.677
2025-06-10 20:16:54,150 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:54,239 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:54,380 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:54,381 - DEBUG - Finished converting page batch time=3751.975
2025-06-10 20:16:54,625 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:54,674 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:54,686 - DEBUG - Snippet 10.1016_s0140-67361832225-6_386_item_2: generation shape=torch.Size([1, 1167])
2025-06-10 20:16:54,687 - DEBUG - Snippet 10.1016_s0140-67361832225-6_386_item_2 raw docling: (tokens=26)
<formula><loc_0><loc_0><loc_500><loc_500>l = \lambda + 1</formula><end_of_utterance>
2025-06-10 20:16:54,689 - DEBUG - Starting _parse_docling_output
2025-06-10 20:16:54,689 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>l = \lambda + 1</formula><end_of_utterance>
2025-06-10 20:16:54,690 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:16:54,690 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>l = \\lambda + 1</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=58x69 at 0x7F96BB45F200>)]
2025-06-10 20:16:54,690 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:16:54,691 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=58.0, b=69.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 15))], orig='l = \\lambda + 1', text='l = \\lambda + 1', formatting=None, hyperlink=None)]
2025-06-10 20:16:54,692 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:16:54,692 - DEBUG - Processing text item: label=formula, text=l = \lambda + 1
2025-06-10 20:16:54,692 - DEBUG - Recognized string extracted: l = \lambda + 1
2025-06-10 20:16:54,692 - INFO - All done. Returning 3 recognized text results.
2025-06-10 20:16:54,692 - DEBUG - Snippet 10.1016_s0140-67361832225-6_386_item_0 recognized text:
R _ { F W F } ( C ) \geq \frac { L R U ( C ) + c ( k - 1 ) } { O P T ( C ) + c ( 1 - 1 / k ) + 1 } .
2025-06-10 20:16:54,693 - DEBUG - Snippet 10.1016_s0140-67361832225-6_386_item_1 recognized text:
MALFORMED_FORMULA
2025-06-10 20:16:54,693 - DEBUG - Snippet 10.1016_s0140-67361832225-6_386_item_2 recognized text:
l = \lambda + 1
2025-06-10 20:16:54,856 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:54,869 - INFO - Finished converting document 10.1016_s0140-67361832225-6_386.pdf in 100.98 sec.
2025-06-10 20:16:54,977 - DEBUG - [Page 14] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:55,003 - DEBUG - Snippet 10.3389_fpubh.2022.864537_523_item_1: generation shape=torch.Size([1, 399])
2025-06-10 20:16:55,004 - DEBUG - Snippet 10.3389_fpubh.2022.864537_523_item_1 raw docling: (tokens=53)
<formula><loc_0><loc_0><loc_500><loc_500>E R = [ \exp ( \beta _ { i } \times 1 0 ) - 1 ] \times 1 0 0 \%</formula><end_of_utterance>
2025-06-10 20:16:55,004 - DEBUG - Starting _parse_docling_output
2025-06-10 20:16:55,004 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>E R = [ \exp ( \beta _ { i } \times 1 0 ) - 1 ] \times 1 0 0 \%</formula><end_of_utterance>
2025-06-10 20:16:55,004 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:16:55,005 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>E R = [ \\exp ( \\beta _ { i } \\times 1 0 ) - 1 ] \\times 1 0 0 \\%</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=559x56 at 0x7F971C5D3E90>)]
2025-06-10 20:16:55,005 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:16:55,007 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=559.0, b=56.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 63))], orig='E R = [ \\exp ( \\beta _ { i } \\times 1 0 ) - 1 ] \\times 1 0 0 \\%', text='E R = [ \\exp ( \\beta _ { i } \\times 1 0 ) - 1 ] \\times 1 0 0 \\%', formatting=None, hyperlink=None)]
2025-06-10 20:16:55,007 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:16:55,007 - DEBUG - Processing text item: label=formula, text=E R = [ \exp ( \beta _ { i } \times 1 0 ) - 1 ] \times 1 0 0 \%
2025-06-10 20:16:55,007 - DEBUG - Recognized string extracted: E R = [ \exp ( \beta _ { i } \times 1 0 ) - 1 ] \times 1 0 0 \%
2025-06-10 20:16:55,007 - INFO - All done. Returning 2 recognized text results.
2025-06-10 20:16:55,008 - DEBUG - Snippet 10.3389_fpubh.2022.864537_523_item_0 recognized text:
L o g [ E ( y _ { i } ) ] = \alpha + \beta _ { i } X _ { i } + n s ( t i m e , d f ) + n s ( Z _ { i } , d f ) \\ + D O W + P H
2025-06-10 20:16:55,008 - DEBUG - Snippet 10.3389_fpubh.2022.864537_523_item_1 recognized text:
E R = [ \exp ( \beta _ { i } \times 1 0 ) - 1 ] \times 1 0 0 \%
2025-06-10 20:16:55,078 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:55,079 - DEBUG - Finished converting page batch time=3752.673
2025-06-10 20:16:55,107 - INFO - Finished converting document 10.3389_fpubh.2022.864537_523.pdf in 23.79 sec.
2025-06-10 20:16:55,191 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:55,252 - DEBUG - [Page 15] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:55,253 - DEBUG - Finished converting page batch time=3752.847
2025-06-10 20:16:55,257 - INFO - Extraction successful row 90, tokens=19890
2025-06-10 20:16:55,278 - INFO - Going to convert document batch...
2025-06-10 20:16:55,278 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:16:55,279 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:16:55,293 - INFO - Extraction successful row 62, tokens=29132
2025-06-10 20:16:55,324 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:16:55,388 - DEBUG - Snippet 10.5194_acp-18-16173-2018_487_item_0: generation shape=torch.Size([1, 436])
2025-06-10 20:16:55,389 - DEBUG - Snippet 10.5194_acp-18-16173-2018_487_item_0 raw docling: (tokens=90)
<formula><loc_0><loc_0><loc_500><loc_500>A _ { i j } [ x , y ] = \frac { \Delta C _ { j } ( y ) } { \Lambda F _ { i } ( x ) } \text { with } \Delta E _ { i } ( x ) = 0 . 2 E _ { i , base } ( x ) .</formula><end_of_utterance>
2025-06-10 20:16:55,389 - DEBUG - Starting _parse_docling_output
2025-06-10 20:16:55,390 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>A _ { i j } [ x , y ] = \frac { \Delta C _ { j } ( y ) } { \Lambda F _ { i } ( x ) } \text { with } \Delta E _ { i } ( x ) = 0 . 2 E _ { i , base } ( x ) .</formula><end_of_utterance>
2025-06-10 20:16:55,390 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:16:55,390 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>A _ { i j } [ x , y ] = \\frac { \\Delta C _ { j } ( y ) } { \\Lambda F _ { i } ( x ) } \\text { with } \\Delta E _ { i } ( x ) = 0 . 2 E _ { i , base } ( x ) .</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=710x113 at 0x7F96AA7C1190>)]
2025-06-10 20:16:55,391 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:16:55,394 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=710.0, b=113.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 155))], orig='A _ { i j } [ x , y ] = \\frac { \\Delta C _ { j } ( y ) } { \\Lambda F _ { i } ( x ) } \\text { with } \\Delta E _ { i } ( x ) = 0 . 2 E _ { i , base } ( x ) .', text='A _ { i j } [ x , y ] = \\frac { \\Delta C _ { j } ( y ) } { \\Lambda F _ { i } ( x ) } \\text { with } \\Delta E _ { i } ( x ) = 0 . 2 E _ { i , base } ( x ) .', formatting=None, hyperlink=None)]
2025-06-10 20:16:55,394 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:16:55,394 - DEBUG - Processing text item: label=formula, text=A _ { i j } [ x , y ] = \frac { \Delta C _ { j } ( y ) } { \Lambda F _ { i } ( x ) } \text { with } \Delta E _ { i } ( x ) = 0 . 2 E _ { i , base } ( x ) .
2025-06-10 20:16:55,395 - DEBUG - Recognized string extracted: A _ { i j } [ x , y ] = \frac { \Delta C _ { j } ( y ) } { \Lambda F _ { i } ( x ) } \text { with } \Delta E _ { i } ( x ) = 0 . 2 E _ { i , base } ( x ) .
2025-06-10 20:16:55,395 - DEBUG - Generating chat message for label: formula
2025-06-10 20:16:55,395 - DEBUG - Snippet 10.5194_acp-18-16173-2018_487_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:16:55,481 - INFO - Going to convert document batch...
2025-06-10 20:16:55,482 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:16:55,482 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:16:55,492 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:55,516 - DEBUG - [Page 16] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:55,555 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:16:55,562 - DEBUG - Snippet 10.5194_acp-18-16173-2018_487_item_1 => input_ids shape=torch.Size([1, 610]), prompt_len=610
2025-06-10 20:16:55,656 - DEBUG - [Page 14] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:55,662 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:55,664 - DEBUG - Finished converting page batch time=3753.258
2025-06-10 20:16:55,826 - DEBUG - [Page 15] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:55,960 - INFO - Finished converting document 10.3389_fpubh.2020.00014_533.pdf in 21.92 sec.
2025-06-10 20:16:56,124 - INFO - Extraction successful row 92, tokens=20765
2025-06-10 20:16:56,147 - DEBUG - [Page 15] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:56,148 - DEBUG - Finished converting page batch time=3753.742
2025-06-10 20:16:56,169 - INFO - Going to convert document batch...
2025-06-10 20:16:56,169 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:16:56,170 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:16:56,178 - DEBUG - [Page 17] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:56,192 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:16:56,242 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:16:56,256 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:16:56,263 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:16:56,271 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:16:56,434 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:16:56,443 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:16:56,676 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:56,772 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:16:56,782 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:16:56,782 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:16:56,815 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:16:56,857 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:16:56,865 - DEBUG - [Page 18] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:56,893 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:16:56,966 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:16:56,989 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:16:57,026 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:16:57,026 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:16:57,039 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:16:57,072 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:16:57,092 - DEBUG - Finished converting page batch time=3754.686
2025-06-10 20:16:57,129 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:16:57,129 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:16:57,129 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:16:57,165 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:16:57,204 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:16:57,212 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:16:57,240 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:16:57,249 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:16:57,280 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:16:57,287 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:16:57,369 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:16:57,405 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:16:57,447 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:16:57,477 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:16:57,477 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:16:57,477 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:16:57,513 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:16:57,535 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:16:57,558 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:16:57,561 - DEBUG - [Page 16] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:57,587 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:16:57,632 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:16:57,678 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:16:57,679 - DEBUG - [Page 19] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:57,680 - DEBUG - Finished converting page batch time=3755.274
2025-06-10 20:16:57,718 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:16:57,753 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:16:57,800 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:16:57,801 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:16:57,854 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:16:57,918 - DEBUG - [Page 20] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:57,933 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:16:57,933 - INFO - Processing document 10.3390_ijerph191811186_544.pdf
2025-06-10 20:16:57,989 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:16:58,034 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:16:58,076 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:16:58,099 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:16:58,111 - DEBUG - [Page 17] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:58,203 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:58,228 - DEBUG - Snippet 10.5194_acp-18-16173-2018_487_item_1: generation shape=torch.Size([1, 698])
2025-06-10 20:16:58,229 - DEBUG - Snippet 10.5194_acp-18-16173-2018_487_item_1 raw docling: (tokens=87)
<formula><loc_0><loc_0><loc_500><loc_500>y ) = C _ { j , base } ( y ) + \sum _ { k = 1 } ^ { n _ { x } } \sum _ { i = 1 } ^ { n _ { i } } A _ { i j } \left [ x _ { k } , y \right ]</formula>
<end_of_utterance>
2025-06-10 20:16:58,230 - DEBUG - Starting _parse_docling_output
2025-06-10 20:16:58,230 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>y ) = C _ { j , base } ( y ) + \sum _ { k = 1 } ^ { n _ { x } } \sum _ { i = 1 } ^ { n _ { i } } A _ { i j } \left [ x _ { k } , y \right ]</formula>
<end_of_utterance>
2025-06-10 20:16:58,230 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:16:58,230 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>y ) = C _ { j , base } ( y ) + \\sum _ { k = 1 } ^ { n _ { x } } \\sum _ { i = 1 } ^ { n _ { i } } A _ { i j } \\left [ x _ { k } , y \\right ]</formula>\n<end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=632x214 at 0x7F96DE597B90>)]
2025-06-10 20:16:58,231 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:16:58,236 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=632.0, b=214.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 139))], orig='y ) = C _ { j , base } ( y ) + \\sum _ { k = 1 } ^ { n _ { x } } \\sum _ { i = 1 } ^ { n _ { i } } A _ { i j } \\left [ x _ { k } , y \\right ]', text='y ) = C _ { j , base } ( y ) + \\sum _ { k = 1 } ^ { n _ { x } } \\sum _ { i = 1 } ^ { n _ { i } } A _ { i j } \\left [ x _ { k } , y \\right ]', formatting=None, hyperlink=None)]
2025-06-10 20:16:58,236 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:16:58,236 - DEBUG - Processing text item: label=formula, text=y ) = C _ { j , base } ( y ) + \sum _ { k = 1 } ^ { n _ { x } } \sum _ { i = 1 } ^ { n _ { i } } A _ { i j } \left [ x _ { k } , y \right ]
2025-06-10 20:16:58,236 - DEBUG - Recognized string extracted: y ) = C _ { j , base } ( y ) + \sum _ { k = 1 } ^ { n _ { x } } \sum _ { i = 1 } ^ { n _ { i } } A _ { i j } \left [ x _ { k } , y \right ]
2025-06-10 20:16:58,236 - DEBUG - Generating chat message for label: formula
2025-06-10 20:16:58,237 - DEBUG - Snippet 10.5194_acp-18-16173-2018_487_item_2 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:16:58,283 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:16:58,284 - INFO - Processing document 10.3390_atmos13050788_558.pdf
2025-06-10 20:16:58,286 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:16:58,304 - DEBUG - Snippet 10.5194_acp-18-16173-2018_487_item_2 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:16:58,310 - DEBUG - [Page 21] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:58,403 - DEBUG - [Page 16] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:58,645 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:16:58,725 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:58,729 - DEBUG - [Page 18] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:58,842 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:16:58,843 - INFO - Processing document 10.1116_1.2815690_576.pdf
2025-06-10 20:16:58,981 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:59,006 - DEBUG - [Page 22] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:59,090 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:59,232 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:59,233 - DEBUG - Finished converting page batch time=3756.828
2025-06-10 20:16:59,417 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:57,571 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:57,621 - DEBUG - [Page 23] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:57,622 - DEBUG - Finished converting page batch time=3757.324
2025-06-10 20:16:57,683 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:57,792 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:57,917 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:57,943 - DEBUG - Snippet 10.5194_acp-18-16173-2018_487_item_2: generation shape=torch.Size([1, 409])
2025-06-10 20:16:57,944 - DEBUG - Snippet 10.5194_acp-18-16173-2018_487_item_2 raw docling: (tokens=63)
<formula><loc_0><loc_0><loc_500><loc_500>C _ { O P P } ( y ) = \sum _ { n _ { x } } A _ { B C } [ x , y ] \cdot E _ { O P P } ( x )</formula><end_of_utterance>
2025-06-10 20:16:57,944 - DEBUG - Starting _parse_docling_output
2025-06-10 20:16:57,945 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>C _ { O P P } ( y ) = \sum _ { n _ { x } } A _ { B C } [ x , y ] \cdot E _ { O P P } ( x )</formula><end_of_utterance>
2025-06-10 20:16:57,945 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:16:57,945 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>C _ { O P P } ( y ) = \\sum _ { n _ { x } } A _ { B C } [ x , y ] \\cdot E _ { O P P } ( x )</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=690x113 at 0x7F96AA7C1130>)]
2025-06-10 20:16:57,945 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:16:57,948 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=690.0, b=113.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 90))], orig='C _ { O P P } ( y ) = \\sum _ { n _ { x } } A _ { B C } [ x , y ] \\cdot E _ { O P P } ( x )', text='C _ { O P P } ( y ) = \\sum _ { n _ { x } } A _ { B C } [ x , y ] \\cdot E _ { O P P } ( x )', formatting=None, hyperlink=None)]
2025-06-10 20:16:57,949 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:16:57,949 - DEBUG - Processing text item: label=formula, text=C _ { O P P } ( y ) = \sum _ { n _ { x } } A _ { B C } [ x , y ] \cdot E _ { O P P } ( x )
2025-06-10 20:16:57,949 - DEBUG - Recognized string extracted: C _ { O P P } ( y ) = \sum _ { n _ { x } } A _ { B C } [ x , y ] \cdot E _ { O P P } ( x )
2025-06-10 20:16:57,949 - DEBUG - Generating chat message for label: formula
2025-06-10 20:16:57,949 - DEBUG - Snippet 10.5194_acp-18-16173-2018_487_item_3 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:16:58,035 - DEBUG - [Page 19] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:58,036 - DEBUG - Finished converting page batch time=3757.738
2025-06-10 20:16:58,042 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:58,064 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:58,107 - DEBUG - Snippet 10.5194_acp-18-16173-2018_487_item_3 => input_ids shape=torch.Size([1, 610]), prompt_len=610
2025-06-10 20:16:58,253 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:58,253 - DEBUG - Finished converting page batch time=3757.956
2025-06-10 20:16:58,263 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:58,263 - DEBUG - [Page 24] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:58,264 - DEBUG - Finished converting page batch time=3757.966
2025-06-10 20:16:58,370 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:58,371 - DEBUG - Finished converting page batch time=3758.073
2025-06-10 20:16:58,448 - INFO - Finished converting document 10.1371_journal.pone.0137832_537.pdf in 20.03 sec.
2025-06-10 20:16:58,507 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:58,511 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:58,512 - DEBUG - Finished converting page batch time=3758.214
2025-06-10 20:16:58,557 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:58,658 - DEBUG - [Page 20] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:58,746 - INFO - Extraction successful row 93, tokens=28552
2025-06-10 20:16:58,772 - INFO - Going to convert document batch...
2025-06-10 20:16:58,773 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:16:58,773 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:16:58,819 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:16:58,899 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:58,964 - DEBUG - [Page 17] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:59,182 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:59,242 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:59,680 - DEBUG - [Page 21] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:16:59,765 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:16:59,819 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:16:59,826 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:16:59,855 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:00,010 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:00,441 - DEBUG - [Page 22] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:00,463 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:17:00,463 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:17:00,463 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:17:00,499 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:17:00,536 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:17:00,572 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:17:00,585 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:00,586 - DEBUG - Finished converting page batch time=3760.288
2025-06-10 20:17:00,608 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:17:00,645 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:17:00,684 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:17:00,814 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:17:00,882 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:17:00,921 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:17:00,934 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:00,935 - DEBUG - Finished converting page batch time=3760.637
2025-06-10 20:17:00,977 - DEBUG - [Page 23] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:00,978 - DEBUG - Finished converting page batch time=3760.680
2025-06-10 20:17:00,988 - DEBUG - Dynamic vertical threshold: 48.51540000000016, Overlap threshold: 0.7
2025-06-10 20:17:00,988 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:01,034 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:01,162 - INFO - Finished converting document 10.1108_ijccsm-08-2021-0090_539.pdf in 21.37 sec.
2025-06-10 20:17:01,167 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:17:01,250 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:01,251 - DEBUG - Finished converting page batch time=3760.953
2025-06-10 20:17:01,385 - INFO - Extraction successful row 94, tokens=44998
2025-06-10 20:17:01,396 - INFO - Finished converting document 10.3390_biology11081122_540.pdf in 15.04 sec.
2025-06-10 20:17:01,415 - INFO - Going to convert document batch...
2025-06-10 20:17:01,416 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:17:01,416 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:17:01,450 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:17:01,470 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:17:01,508 - INFO - Extraction successful row 95, tokens=17899
2025-06-10 20:17:01,528 - INFO - Going to convert document batch...
2025-06-10 20:17:01,528 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:17:01,529 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:17:01,612 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:17:01,613 - INFO - Processing document 10.1038_ncomms2832_588.pdf
2025-06-10 20:17:01,621 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:17:01,690 - DEBUG - Dynamic vertical threshold: 49.59719999999995, Overlap threshold: 0.7
2025-06-10 20:17:01,690 - DEBUG - Checking merge:
  Current: 14, Next: 6
2025-06-10 20:17:01,691 - DEBUG -   Vertical gap: 26.13900000000001, Overlap ratio: 1.0
2025-06-10 20:17:01,691 - DEBUG -   Left boundary diff: 1.1949999999999932, Right boundary diff: 0.0
2025-06-10 20:17:01,691 - DEBUG -   Alignment factor (ratio): 0.005236118261783975
2025-06-10 20:17:01,691 - DEBUG -   -> c1 14 formula number: 3, c2 6 formula number: 4
2025-06-10 20:17:01,691 - DEBUG -   -> Not merging clusters 14 and 6 due to different formula numbers: 3 vs 4
2025-06-10 20:17:01,692 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:01,878 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:01,973 - DEBUG - [Page 18] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:02,059 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:02,070 - DEBUG - Dynamic vertical threshold: 22.96440000000007, Overlap threshold: 0.7
2025-06-10 20:17:02,070 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:02,071 - DEBUG - Finished converting page batch time=3761.773
2025-06-10 20:17:02,085 - DEBUG - Snippet 10.5194_acp-18-16173-2018_487_item_3: generation shape=torch.Size([1, 751])
2025-06-10 20:17:02,086 - DEBUG - Snippet 10.5194_acp-18-16173-2018_487_item_3 raw docling: (tokens=140)
<formula><loc_0><loc_0><loc_500><loc_500>\Lambda _ { 2 . 5 , i n c } = D U + S S + S O _ { 4 } ^ { 2 - } + N O _ { 3 } ^ { - } + N H _ { 4 } ^ { + } \\ + ( 1 - k _ { B C } ) B C + ( 1 - k _ { P O M } ) P O M \\ + I N C R \left ( k _ { B C } B C + k _ { P O M } P O M \right ) ,</formula><end_of_utterance>
2025-06-10 20:17:02,086 - DEBUG - Starting _parse_docling_output
2025-06-10 20:17:02,086 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>\Lambda _ { 2 . 5 , i n c } = D U + S S + S O _ { 4 } ^ { 2 - } + N O _ { 3 } ^ { - } + N H _ { 4 } ^ { + } \\ + ( 1 - k _ { B C } ) B C + ( 1 - k _ { P O M } ) P O M \\ + I N C R \left ( k _ { B C } B C + k _ { P O M } P O M \right ) ,</formula><end_of_utterance>
2025-06-10 20:17:02,087 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:17:02,087 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>\\Lambda _ { 2 . 5 , i n c } = D U + S S + S O _ { 4 } ^ { 2 - } + N O _ { 3 } ^ { - } + N H _ { 4 } ^ { + } \\\\ + ( 1 - k _ { B C } ) B C + ( 1 - k _ { P O M } ) P O M \\\\ + I N C R \\left ( k _ { B C } B C + k _ { P O M } P O M \\right ) ,</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=656x200 at 0x7F96AA7C37D0>)]
2025-06-10 20:17:02,087 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:17:02,092 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=656.0, b=200.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 236))], orig='\\Lambda _ { 2 . 5 , i n c } = D U + S S + S O _ { 4 } ^ { 2 - } + N O _ { 3 } ^ { - } + N H _ { 4 } ^ { + } \\\\ + ( 1 - k _ { B C } ) B C + ( 1 - k _ { P O M } ) P O M \\\\ + I N C R \\left ( k _ { B C } B C + k _ { P O M } P O M \\right ) ,', text='\\Lambda _ { 2 . 5 , i n c } = D U + S S + S O _ { 4 } ^ { 2 - } + N O _ { 3 } ^ { - } + N H _ { 4 } ^ { + } \\\\ + ( 1 - k _ { B C } ) B C + ( 1 - k _ { P O M } ) P O M \\\\ + I N C R \\left ( k _ { B C } B C + k _ { P O M } P O M \\right ) ,', formatting=None, hyperlink=None)]
2025-06-10 20:17:02,092 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:17:02,093 - DEBUG - Processing text item: label=formula, text=\Lambda _ { 2 . 5 , i n c } = D U + S S + S O _ { 4 } ^ { 2 - } + N O _ { 3 } ^ { - } + N H _ { 4 } ^ { + } \\ + ( 1 - k _ { B C } ) B C + ( 1 - k _ { P O M } ) P O M \\ + I N C R \left ( k _ { B C } B C + k _ { P O M } P O M \right ) ,
2025-06-10 20:17:02,093 - DEBUG - Recognized string extracted: \Lambda _ { 2 . 5 , i n c } = D U + S S + S O _ { 4 } ^ { 2 - } + N O _ { 3 } ^ { - } + N H _ { 4 } ^ { + } \\ + ( 1 - k _ { B C } ) B C + ( 1 - k _ { P O M } ) P O M \\ + I N C R \left ( k _ { B C } B C + k _ { P O M } P O M \right ) ,
2025-06-10 20:17:02,093 - DEBUG - Generating chat message for label: formula
2025-06-10 20:17:02,093 - DEBUG - Snippet 10.5194_acp-18-16173-2018_487_item_4 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:17:02,097 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:02,158 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:17:02,160 - DEBUG - Snippet 10.5194_acp-18-16173-2018_487_item_4 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:17:02,244 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:02,331 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:17:02,344 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:17:02,350 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:17:02,395 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:17:02,402 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:17:02,413 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:02,661 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:02,902 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:03,006 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:17:03,006 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:17:03,007 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:17:03,045 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:17:03,073 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:03,081 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:17:03,119 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:17:03,163 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:17:03,200 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:17:03,207 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:17:03,207 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:17:03,208 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:17:03,237 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:17:03,243 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:17:03,282 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:17:03,317 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:17:03,360 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:17:03,364 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:03,366 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:17:03,395 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:17:03,437 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:17:03,451 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:17:03,474 - DEBUG - Snippet 10.5194_acp-18-16173-2018_487_item_4: generation shape=torch.Size([1, 389])
2025-06-10 20:17:03,475 - DEBUG - Snippet 10.5194_acp-18-16173-2018_487_item_4 raw docling: (tokens=43)
<formula><loc_0><loc_0><loc_500><loc_500>R Y L [ A O T 4 0 ] = a \times A O T 4 0 ,</formula><end_of_utterance>
2025-06-10 20:17:03,476 - DEBUG - Starting _parse_docling_output
2025-06-10 20:17:03,476 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>R Y L [ A O T 4 0 ] = a \times A O T 4 0 ,</formula><end_of_utterance>
2025-06-10 20:17:03,476 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:17:03,476 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>R Y L [ A O T 4 0 ] = a \\times A O T 4 0 ,</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=710x52 at 0x7F96AA7C17F0>)]
2025-06-10 20:17:03,476 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:17:03,478 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=710.0, b=52.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 42))], orig='R Y L [ A O T 4 0 ] = a \\times A O T 4 0 ,', text='R Y L [ A O T 4 0 ] = a \\times A O T 4 0 ,', formatting=None, hyperlink=None)]
2025-06-10 20:17:03,479 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:17:03,479 - DEBUG - Processing text item: label=formula, text=R Y L [ A O T 4 0 ] = a \times A O T 4 0 ,
2025-06-10 20:17:03,479 - DEBUG - Recognized string extracted: R Y L [ A O T 4 0 ] = a \times A O T 4 0 ,
2025-06-10 20:17:03,479 - INFO - All done. Returning 5 recognized text results.
2025-06-10 20:17:03,479 - DEBUG - Snippet 10.5194_acp-18-16173-2018_487_item_0 recognized text:
A _ { i j } [ x , y ] = \frac { \Delta C _ { j } ( y ) } { \Lambda F _ { i } ( x ) } \text { with } \Delta E _ { i } ( x ) = 0 . 2 E _ { i , base } ( x ) .
2025-06-10 20:17:03,480 - DEBUG - Snippet 10.5194_acp-18-16173-2018_487_item_1 recognized text:
y ) = C _ { j , base } ( y ) + \sum _ { k = 1 } ^ { n _ { x } } \sum _ { i = 1 } ^ { n _ { i } } A _ { i j } \left [ x _ { k } , y \right ]
2025-06-10 20:17:03,480 - DEBUG - Snippet 10.5194_acp-18-16173-2018_487_item_2 recognized text:
C _ { O P P } ( y ) = \sum _ { n _ { x } } A _ { B C } [ x , y ] \cdot E _ { O P P } ( x )
2025-06-10 20:17:03,480 - DEBUG - Snippet 10.5194_acp-18-16173-2018_487_item_3 recognized text:
\Lambda _ { 2 . 5 , i n c } = D U + S S + S O _ { 4 } ^ { 2 - } + N O _ { 3 } ^ { - } + N H _ { 4 } ^ { + } \\ + ( 1 - k _ { B C } ) B C + ( 1 - k _ { P O M } ) P O M \\ + I N C R \left ( k _ { B C } B C + k _ { P O M } P O M \right ) ,
2025-06-10 20:17:03,480 - DEBUG - Snippet 10.5194_acp-18-16173-2018_487_item_4 recognized text:
R Y L [ A O T 4 0 ] = a \times A O T 4 0 ,
2025-06-10 20:17:03,492 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:17:03,495 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:03,497 - DEBUG - Finished converting page batch time=3763.199
2025-06-10 20:17:03,594 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:17:03,597 - DEBUG - Creating masked image for page 10 with 23 clusters.
2025-06-10 20:17:03,599 - INFO - Masked image successfully created for page 10.
2025-06-10 20:17:03,608 - INFO - Starting prediction for 5 images with labels: ['formula', 'formula', 'formula', 'formula', 'formula']
2025-06-10 20:17:03,608 - DEBUG - Generating chat message for label: formula
2025-06-10 20:17:03,608 - DEBUG - Snippet 10.5194_acp-18-16173-2018_487_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:17:03,629 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:03,630 - DEBUG - Finished converting page batch time=3763.332
2025-06-10 20:17:03,633 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:17:03,735 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:17:03,771 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:03,775 - DEBUG - Snippet 10.5194_acp-18-16173-2018_487_item_0 => input_ids shape=torch.Size([1, 610]), prompt_len=610
2025-06-10 20:17:03,806 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:03,939 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:17:04,010 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:17:04,150 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:17:04,150 - INFO - Processing document 10.3389_fphys.2020.00694_591.pdf
2025-06-10 20:17:04,174 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:17:04,224 - DEBUG - Finished converting page batch time=3763.927
2025-06-10 20:17:04,462 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:04,465 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:04,468 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:17:04,655 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:17:04,656 - INFO - Processing document 10.5812_jhealthscope.105567_595.pdf
2025-06-10 20:17:04,675 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:04,776 - DEBUG - [Page 19] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:04,995 - DEBUG - Dynamic vertical threshold: 34.70580000000012, Overlap threshold: 0.7
2025-06-10 20:17:04,996 - DEBUG - Checking merge:
  Current: 6, Next: 8
2025-06-10 20:17:04,996 - DEBUG -   Vertical gap: 21.310999999999922, Overlap ratio: 0.9999960585075145
2025-06-10 20:17:04,996 - DEBUG -   Left boundary diff: 15.759999999999991, Right boundary diff: 0.0009999999999763531
2025-06-10 20:17:04,996 - DEBUG -   Alignment factor (ratio): 0.09753048601248214
2025-06-10 20:17:04,997 - DEBUG -   -> c1 6 formula number: None, c2 8 formula number: None
2025-06-10 20:17:04,997 - DEBUG -   -> Not merging clusters 6 and 8 because vertical_gap 21.310999999999922 > 3 with no numbers
2025-06-10 20:17:04,997 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:05,040 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:05,190 - DEBUG - [Page 14] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:05,281 - DEBUG - [Page 14] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:05,328 - DEBUG - [Page 15] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:05,329 - DEBUG - Finished converting page batch time=3765.031
2025-06-10 20:17:05,627 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:05,641 - DEBUG - Finished converting page batch time=3765.343
2025-06-10 20:17:05,669 - DEBUG - [Page 16] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:05,731 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:06,046 - DEBUG - [Page 17] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:06,211 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:06,212 - DEBUG - Finished converting page batch time=3765.915
2025-06-10 20:17:06,299 - DEBUG - [Page 18] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:06,365 - DEBUG - [Page 15] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:06,371 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:06,432 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:06,626 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:06,748 - DEBUG - [Page 19] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:06,749 - DEBUG - Finished converting page batch time=3766.451
2025-06-10 20:17:06,992 - DEBUG - [Page 20] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:07,258 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:07,330 - DEBUG - Finished converting page batch time=3767.033
2025-06-10 20:17:07,901 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:07,901 - DEBUG - [Page 16] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:08,128 - DEBUG - [Page 21] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:08,276 - DEBUG - [Page 22] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:08,317 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:08,319 - DEBUG - Finished converting page batch time=3768.021
2025-06-10 20:17:08,385 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:08,419 - DEBUG - [Page 23] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:08,420 - DEBUG - Snippet 10.5194_acp-18-16173-2018_487_item_0: generation shape=torch.Size([1, 767])
2025-06-10 20:17:08,420 - DEBUG - Finished converting page batch time=3768.122
2025-06-10 20:17:08,421 - DEBUG - Snippet 10.5194_acp-18-16173-2018_487_item_0 raw docling: (tokens=156)
<formula><loc_0><loc_0><loc_500><loc_500>K I L _ { L } A U 1 4 U J = a \times A U 1 4 U , \\ & R Y L ( M _ { i } ) = 1 - \frac { \exp \left [ - \left ( \frac { M _ { i } } { a } \right ) ^ { b } \right ] } { \exp \left [ - \left ( \frac { c } { a } \right ) ^ { b } \right ] } \ M _ { i } > c \quad . \\ & R Y L ( M _ { i } ) = 0 \quad \\ &</formula><end_of_utterance>
2025-06-10 20:17:08,421 - DEBUG - Starting _parse_docling_output
2025-06-10 20:17:08,422 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>K I L _ { L } A U 1 4 U J = a \times A U 1 4 U , \\ & R Y L ( M _ { i } ) = 1 - \frac { \exp \left [ - \left ( \frac { M _ { i } } { a } \right ) ^ { b } \right ] } { \exp \left [ - \left ( \frac { c } { a } \right ) ^ { b } \right ] } \ M _ { i } > c \quad . \\ & R Y L ( M _ { i } ) = 0 \quad \\ &</formula><end_of_utterance>
2025-06-10 20:17:08,422 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:17:08,422 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>K I L _ { L } A U 1 4 U J = a \\times A U 1 4 U , \\\\ & R Y L ( M _ { i } ) = 1 - \\frac { \\exp \\left [ - \\left ( \\frac { M _ { i } } { a } \\right ) ^ { b } \\right ] } { \\exp \\left [ - \\left ( \\frac { c } { a } \\right ) ^ { b } \\right ] } \\ M _ { i } > c \\quad . \\\\ & R Y L ( M _ { i } ) = 0 \\quad \\\\ &</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=691x259 at 0x7F96AA7C3F20>)]
2025-06-10 20:17:08,422 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:17:08,431 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=691.0, b=259.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 299))], orig='K I L _ { L } A U 1 4 U J = a \\times A U 1 4 U , \\\\ & R Y L ( M _ { i } ) = 1 - \\frac { \\exp \\left [ - \\left ( \\frac { M _ { i } } { a } \\right ) ^ { b } \\right ] } { \\exp \\left [ - \\left ( \\frac { c } { a } \\right ) ^ { b } \\right ] } \\ M _ { i } > c \\quad . \\\\ & R Y L ( M _ { i } ) = 0 \\quad \\\\ &', text='K I L _ { L } A U 1 4 U J = a \\times A U 1 4 U , \\\\ & R Y L ( M _ { i } ) = 1 - \\frac { \\exp \\left [ - \\left ( \\frac { M _ { i } } { a } \\right ) ^ { b } \\right ] } { \\exp \\left [ - \\left ( \\frac { c } { a } \\right ) ^ { b } \\right ] } \\ M _ { i } > c \\quad . \\\\ & R Y L ( M _ { i } ) = 0 \\quad \\\\ &', formatting=None, hyperlink=None)]
2025-06-10 20:17:08,431 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:17:08,431 - DEBUG - Processing text item: label=formula, text=K I L _ { L } A U 1 4 U J = a \times A U 1 4 U , \\ & R Y L ( M _ { i } ) = 1 - \frac { \exp \left [ - \left ( \frac { M _ { i } } { a } \right ) ^ { b } \right ] } { \exp \left [ - \left ( \frac { c } { a } \right ) ^ { b } \right ] } \ M _ { i } > c \quad . \\ & R Y L ( M _ { i } ) = 0 \quad \\ &
2025-06-10 20:17:08,432 - DEBUG - Recognized string extracted: K I L _ { L } A U 1 4 U J = a \times A U 1 4 U , \\ & R Y L ( M _ { i } ) = 1 - \frac { \exp \left [ - \left ( \frac { M _ { i } } { a } \right ) ^ { b } \right ] } { \exp \left [ - \left ( \frac { c } { a } \right ) ^ { b } \right ] } \ M _ { i } > c \quad . \\ & R Y L ( M _ { i } ) = 0 \quad \\ &
2025-06-10 20:17:08,432 - DEBUG - Generating chat message for label: formula
2025-06-10 20:17:08,432 - DEBUG - Snippet 10.5194_acp-18-16173-2018_487_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:17:08,463 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:08,504 - DEBUG - Snippet 10.5194_acp-18-16173-2018_487_item_1 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:17:08,596 - DEBUG - [Page 17] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:08,611 - DEBUG - [Page 24] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:08,760 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:08,761 - DEBUG - Finished converting page batch time=3768.463
2025-06-10 20:17:08,920 - DEBUG - [Page 18] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:08,921 - DEBUG - Finished converting page batch time=3768.623
2025-06-10 20:17:09,105 - DEBUG - Creating masked image for page 5 with 13 clusters.
2025-06-10 20:17:09,106 - INFO - Masked image successfully created for page 5.
2025-06-10 20:17:09,219 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:09,234 - DEBUG - Creating masked image for page 6 with 22 clusters.
2025-06-10 20:17:09,235 - INFO - Masked image successfully created for page 6.
2025-06-10 20:17:09,245 - INFO - Starting prediction for 5 images with labels: ['formula', 'formula', 'formula', 'formula', 'formula']
2025-06-10 20:17:09,246 - DEBUG - Generating chat message for label: formula
2025-06-10 20:17:09,246 - DEBUG - Snippet 10.3390_atmos13050788_558_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:17:09,249 - DEBUG - [Page 25] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:09,321 - DEBUG - Snippet 10.3390_atmos13050788_558_item_0 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:17:09,393 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:09,436 - DEBUG - [Page 26] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:09,527 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:09,762 - DEBUG - [Page 27] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:09,763 - DEBUG - Finished converting page batch time=3769.465
2025-06-10 20:17:09,967 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:10,316 - DEBUG - [Page 28] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:10,477 - DEBUG - [Page 29] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:10,653 - DEBUG - [Page 14] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:10,848 - DEBUG - [Page 30] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:10,868 - DEBUG - Finished converting page batch time=3770.570
2025-06-10 20:17:11,042 - DEBUG - Dynamic vertical threshold: 48.342600000000154, Overlap threshold: 0.7
2025-06-10 20:17:11,043 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:11,065 - DEBUG - Snippet 10.3390_atmos13050788_558_item_0: generation shape=torch.Size([1, 409])
2025-06-10 20:17:11,066 - DEBUG - Snippet 10.3390_atmos13050788_558_item_0 raw docling: (tokens=63)
<formula><loc_0><loc_0><loc_500><loc_500>A C F ( n ) = \frac { \langle \sigma v ( x _ { t } , x _ { t - n } ) } { V a r ( x _ { t } ) }</formula><end_of_utterance>
2025-06-10 20:17:11,066 - DEBUG - Starting _parse_docling_output
2025-06-10 20:17:11,067 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>A C F ( n ) = \frac { \langle \sigma v ( x _ { t } , x _ { t - n } ) } { V a r ( x _ { t } ) }</formula><end_of_utterance>
2025-06-10 20:17:11,067 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:17:11,067 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>A C F ( n ) = \\frac { \\langle \\sigma v ( x _ { t } , x _ { t - n } ) } { V a r ( x _ { t } ) }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=742x119 at 0x7F96BB5D7620>)]
2025-06-10 20:17:11,067 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:17:11,070 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=742.0, b=119.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 94))], orig='A C F ( n ) = \\frac { \\langle \\sigma v ( x _ { t } , x _ { t - n } ) } { V a r ( x _ { t } ) }', text='A C F ( n ) = \\frac { \\langle \\sigma v ( x _ { t } , x _ { t - n } ) } { V a r ( x _ { t } ) }', formatting=None, hyperlink=None)]
2025-06-10 20:17:11,071 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:17:11,071 - DEBUG - Processing text item: label=formula, text=A C F ( n ) = \frac { \langle \sigma v ( x _ { t } , x _ { t - n } ) } { V a r ( x _ { t } ) }
2025-06-10 20:17:11,071 - DEBUG - Recognized string extracted: A C F ( n ) = \frac { \langle \sigma v ( x _ { t } , x _ { t - n } ) } { V a r ( x _ { t } ) }
2025-06-10 20:17:11,071 - DEBUG - Generating chat message for label: formula
2025-06-10 20:17:11,072 - DEBUG - Snippet 10.3390_atmos13050788_558_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:17:11,138 - DEBUG - Snippet 10.3390_atmos13050788_558_item_1 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:17:11,423 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:11,582 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:11,698 - DEBUG - Snippet 10.5194_acp-18-16173-2018_487_item_1: generation shape=torch.Size([1, 429])
2025-06-10 20:17:11,699 - DEBUG - Snippet 10.5194_acp-18-16173-2018_487_item_1 raw docling: (tokens=83)
<formula><loc_0><loc_0><loc_500><loc_500>S R _ { - } R F _ { k } ^ { j } = \frac { R F _ { - } P E R T [ j , k ] - R F _ { - } B A S E } { 0 . 2 E _ { k } ^ { j } } ,</formula><end_of_utterance>
2025-06-10 20:17:11,700 - DEBUG - Starting _parse_docling_output
2025-06-10 20:17:11,700 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>S R _ { - } R F _ { k } ^ { j } = \frac { R F _ { - } P E R T [ j , k ] - R F _ { - } B A S E } { 0 . 2 E _ { k } ^ { j } } ,</formula><end_of_utterance>
2025-06-10 20:17:11,700 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:17:11,701 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>S R _ { - } R F _ { k } ^ { j } = \\frac { R F _ { - } P E R T [ j , k ] - R F _ { - } B A S E } { 0 . 2 E _ { k } ^ { j } } ,</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=710x137 at 0x7F96AA7C2D80>)]
2025-06-10 20:17:11,701 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:17:11,705 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=710.0, b=137.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 125))], orig='S R _ { - } R F _ { k } ^ { j } = \\frac { R F _ { - } P E R T [ j , k ] - R F _ { - } B A S E } { 0 . 2 E _ { k } ^ { j } } ,', text='S R _ { - } R F _ { k } ^ { j } = \\frac { R F _ { - } P E R T [ j , k ] - R F _ { - } B A S E } { 0 . 2 E _ { k } ^ { j } } ,', formatting=None, hyperlink=None)]
2025-06-10 20:17:11,705 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:17:11,705 - DEBUG - Processing text item: label=formula, text=S R _ { - } R F _ { k } ^ { j } = \frac { R F _ { - } P E R T [ j , k ] - R F _ { - } B A S E } { 0 . 2 E _ { k } ^ { j } } ,
2025-06-10 20:17:11,705 - DEBUG - Recognized string extracted: S R _ { - } R F _ { k } ^ { j } = \frac { R F _ { - } P E R T [ j , k ] - R F _ { - } B A S E } { 0 . 2 E _ { k } ^ { j } } ,
2025-06-10 20:17:11,705 - DEBUG - Generating chat message for label: formula
2025-06-10 20:17:11,706 - DEBUG - Snippet 10.5194_acp-18-16173-2018_487_item_2 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:17:11,771 - DEBUG - Snippet 10.5194_acp-18-16173-2018_487_item_2 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:17:12,112 - DEBUG - [Page 15] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:12,113 - DEBUG - Finished converting page batch time=3771.815
2025-06-10 20:17:12,374 - DEBUG - [Page 31] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:12,375 - DEBUG - Finished converting page batch time=3772.077
2025-06-10 20:17:12,493 - DEBUG - [Page 16] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:12,495 - DEBUG - Finished converting page batch time=3772.197
2025-06-10 20:17:12,519 - DEBUG - [Page 32] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:12,652 - INFO - Finished converting document 10.3390_ijerph191811186_544.pdf in 19.50 sec.
2025-06-10 20:17:12,655 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:13,047 - INFO - Extraction successful row 96, tokens=27851
2025-06-10 20:17:13,077 - INFO - Going to convert document batch...
2025-06-10 20:17:13,077 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:17:13,078 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:17:13,130 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:17:13,257 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:13,259 - DEBUG - Finished converting page batch time=3772.961
2025-06-10 20:17:13,280 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:13,421 - DEBUG - [Page 33] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:13,461 - DEBUG - Snippet 10.3390_atmos13050788_558_item_1: generation shape=torch.Size([1, 429])
2025-06-10 20:17:13,462 - DEBUG - Snippet 10.3390_atmos13050788_558_item_1 raw docling: (tokens=83)
<formula><loc_0><loc_0><loc_500><loc_500>P A C F ( n ) = C o r r [ x _ { t } - E ^ { * } ( x _ { t } | x _ { t - 1 } , \dots , x _ { t - n + 1 } ) , x _ { t - n } ]</formula><end_of_utterance>
2025-06-10 20:17:13,463 - DEBUG - Starting _parse_docling_output
2025-06-10 20:17:13,463 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>P A C F ( n ) = C o r r [ x _ { t } - E ^ { * } ( x _ { t } | x _ { t - 1 } , \dots , x _ { t - n + 1 } ) , x _ { t - n } ]</formula><end_of_utterance>
2025-06-10 20:17:13,463 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:17:13,463 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>P A C F ( n ) = C o r r [ x _ { t } - E ^ { * } ( x _ { t } | x _ { t - 1 } , \\dots , x _ { t - n + 1 } ) , x _ { t - n } ]</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=910x72 at 0x7F96BB5D75C0>)]
2025-06-10 20:17:13,464 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:17:13,466 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=910.0, b=72.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 123))], orig='P A C F ( n ) = C o r r [ x _ { t } - E ^ { * } ( x _ { t } | x _ { t - 1 } , \\dots , x _ { t - n + 1 } ) , x _ { t - n } ]', text='P A C F ( n ) = C o r r [ x _ { t } - E ^ { * } ( x _ { t } | x _ { t - 1 } , \\dots , x _ { t - n + 1 } ) , x _ { t - n } ]', formatting=None, hyperlink=None)]
2025-06-10 20:17:13,467 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:17:13,467 - DEBUG - Processing text item: label=formula, text=P A C F ( n ) = C o r r [ x _ { t } - E ^ { * } ( x _ { t } | x _ { t - 1 } , \dots , x _ { t - n + 1 } ) , x _ { t - n } ]
2025-06-10 20:17:13,467 - DEBUG - Recognized string extracted: P A C F ( n ) = C o r r [ x _ { t } - E ^ { * } ( x _ { t } | x _ { t - 1 } , \dots , x _ { t - n + 1 } ) , x _ { t - n } ]
2025-06-10 20:17:13,467 - DEBUG - Generating chat message for label: formula
2025-06-10 20:17:13,468 - DEBUG - Snippet 10.3390_atmos13050788_558_item_2 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:17:13,486 - DEBUG - Creating masked image for page 2 with 19 clusters.
2025-06-10 20:17:13,488 - INFO - Masked image successfully created for page 2.
2025-06-10 20:17:13,533 - DEBUG - Snippet 10.3390_atmos13050788_558_item_2 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:17:13,534 - DEBUG - [Page 34] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:13,591 - DEBUG - Creating masked image for page 6 with 23 clusters.
2025-06-10 20:17:13,593 - INFO - Masked image successfully created for page 6.
2025-06-10 20:17:13,597 - INFO - Starting prediction for 3 images with labels: ['formula', 'formula', 'formula']
2025-06-10 20:17:13,598 - DEBUG - Generating chat message for label: formula
2025-06-10 20:17:13,598 - DEBUG - Snippet 10.1038_ncomms2832_588_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:17:13,674 - DEBUG - Snippet 10.1038_ncomms2832_588_item_0 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:17:13,894 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:13,895 - DEBUG - Finished converting page batch time=3773.598
2025-06-10 20:17:13,963 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:17:14,010 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:17:14,017 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:17:14,203 - DEBUG - [Page 35] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:14,206 - DEBUG - Finished converting page batch time=3773.908
2025-06-10 20:17:14,889 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:17:14,889 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:17:14,890 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:17:14,927 - DEBUG - Snippet 10.3390_atmos13050788_558_item_2: generation shape=torch.Size([1, 385])
2025-06-10 20:17:14,928 - DEBUG - Snippet 10.3390_atmos13050788_558_item_2 raw docling: (tokens=39)
<formula><loc_0><loc_0><loc_500><loc_500>T _ { t } = S _ { t } - S _ { t - 1 }</formula><end_of_utterance>
2025-06-10 20:17:14,929 - DEBUG - Starting _parse_docling_output
2025-06-10 20:17:14,929 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>T _ { t } = S _ { t } - S _ { t - 1 }</formula><end_of_utterance>
2025-06-10 20:17:14,929 - DEBUG - [Page 36] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:14,929 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:17:14,929 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>T _ { t } = S _ { t } - S _ { t - 1 }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=669x61 at 0x7F96BB5D5C70>)]
2025-06-10 20:17:14,930 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:17:14,931 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=669.0, b=61.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 37))], orig='T _ { t } = S _ { t } - S _ { t - 1 }', text='T _ { t } = S _ { t } - S _ { t - 1 }', formatting=None, hyperlink=None)]
2025-06-10 20:17:14,932 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:17:14,932 - DEBUG - Processing text item: label=formula, text=T _ { t } = S _ { t } - S _ { t - 1 }
2025-06-10 20:17:14,932 - DEBUG - Recognized string extracted: T _ { t } = S _ { t } - S _ { t - 1 }
2025-06-10 20:17:14,932 - DEBUG - Generating chat message for label: formula
2025-06-10 20:17:14,933 - DEBUG - Snippet 10.3390_atmos13050788_558_item_3 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:17:14,933 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:17:14,970 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:17:15,004 - DEBUG - Snippet 10.3390_atmos13050788_558_item_3 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:17:15,006 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:17:15,053 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:17:15,092 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:17:15,128 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:17:15,152 - DEBUG - [Page 37] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:15,219 - DEBUG - Snippet 10.5194_acp-18-16173-2018_487_item_2: generation shape=torch.Size([1, 456])
2025-06-10 20:17:15,220 - DEBUG - Snippet 10.5194_acp-18-16173-2018_487_item_2 raw docling: (tokens=110)
<formula><loc_0><loc_0><loc_500><loc_500>\mathbb { V P } ( H ) = \int _ { 0 } ^ { H } A _ { x } \exp \left ( \frac { - t } { a _ { x } } \right ) d t = A _ { x } a _ { x } \left [ 1 - \exp \left ( \frac { - H } { a _ { x } } \right ) \right ] .</formula><end_of_utterance>
2025-06-10 20:17:15,221 - DEBUG - Starting _parse_docling_output
2025-06-10 20:17:15,221 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>\mathbb { V P } ( H ) = \int _ { 0 } ^ { H } A _ { x } \exp \left ( \frac { - t } { a _ { x } } \right ) d t = A _ { x } a _ { x } \left [ 1 - \exp \left ( \frac { - H } { a _ { x } } \right ) \right ] .</formula><end_of_utterance>
2025-06-10 20:17:15,221 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:17:15,221 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>\\mathbb { V P } ( H ) = \\int _ { 0 } ^ { H } A _ { x } \\exp \\left ( \\frac { - t } { a _ { x } } \\right ) d t = A _ { x } a _ { x } \\left [ 1 - \\exp \\left ( \\frac { - H } { a _ { x } } \\right ) \\right ] .</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=636x159 at 0x7F96AA7C3200>)]
2025-06-10 20:17:15,222 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:17:15,226 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=636.0, b=159.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 203))], orig='\\mathbb { V P } ( H ) = \\int _ { 0 } ^ { H } A _ { x } \\exp \\left ( \\frac { - t } { a _ { x } } \\right ) d t = A _ { x } a _ { x } \\left [ 1 - \\exp \\left ( \\frac { - H } { a _ { x } } \\right ) \\right ] .', text='\\mathbb { V P } ( H ) = \\int _ { 0 } ^ { H } A _ { x } \\exp \\left ( \\frac { - t } { a _ { x } } \\right ) d t = A _ { x } a _ { x } \\left [ 1 - \\exp \\left ( \\frac { - H } { a _ { x } } \\right ) \\right ] .', formatting=None, hyperlink=None)]
2025-06-10 20:17:15,226 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:17:15,226 - DEBUG - Processing text item: label=formula, text=\mathbb { V P } ( H ) = \int _ { 0 } ^ { H } A _ { x } \exp \left ( \frac { - t } { a _ { x } } \right ) d t = A _ { x } a _ { x } \left [ 1 - \exp \left ( \frac { - H } { a _ { x } } \right ) \right ] .
2025-06-10 20:17:15,227 - DEBUG - Recognized string extracted: \mathbb { V P } ( H ) = \int _ { 0 } ^ { H } A _ { x } \exp \left ( \frac { - t } { a _ { x } } \right ) d t = A _ { x } a _ { x } \left [ 1 - \exp \left ( \frac { - H } { a _ { x } } \right ) \right ] .
2025-06-10 20:17:15,227 - DEBUG - Generating chat message for label: formula
2025-06-10 20:17:15,227 - DEBUG - Snippet 10.5194_acp-18-16173-2018_487_item_3 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:17:15,251 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:17:15,276 - DEBUG - [Page 38] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:15,294 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:15,319 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:17:15,371 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:17:15,378 - DEBUG - Snippet 10.5194_acp-18-16173-2018_487_item_3 => input_ids shape=torch.Size([1, 610]), prompt_len=610
2025-06-10 20:17:15,532 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:17:15,549 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:15,830 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:17:15,881 - DEBUG - Dynamic vertical threshold: 32.14440000000011, Overlap threshold: 0.7
2025-06-10 20:17:15,881 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:15,905 - DEBUG - [Page 39] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:15,905 - DEBUG - Finished converting page batch time=3775.607
2025-06-10 20:17:15,911 - DEBUG - Snippet 10.1038_ncomms2832_588_item_0: generation shape=torch.Size([1, 424])
2025-06-10 20:17:15,912 - DEBUG - Snippet 10.1038_ncomms2832_588_item_0 raw docling: (tokens=78)
<formula><loc_0><loc_0><loc_500><loc_500>n _ { s } = \eta \, \frac { V _ { t h } c _ { a } } { 2 q } \exp \left ( \frac { V - V _ { T } } { \eta V _ { t h } } \right )</formula><end_of_utterance>
2025-06-10 20:17:15,912 - DEBUG - Starting _parse_docling_output
2025-06-10 20:17:15,913 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>n _ { s } = \eta \, \frac { V _ { t h } c _ { a } } { 2 q } \exp \left ( \frac { V - V _ { T } } { \eta V _ { t h } } \right )</formula><end_of_utterance>
2025-06-10 20:17:15,913 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:17:15,913 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>n _ { s } = \\eta \\, \\frac { V _ { t h } c _ { a } } { 2 q } \\exp \\left ( \\frac { V - V _ { T } } { \\eta V _ { t h } } \\right )</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=500x113 at 0x7F96DF29C2F0>)]
2025-06-10 20:17:15,913 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:17:15,916 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=500.0, b=113.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 126))], orig='n _ { s } = \\eta \\, \\frac { V _ { t h } c _ { a } } { 2 q } \\exp \\left ( \\frac { V - V _ { T } } { \\eta V _ { t h } } \\right )', text='n _ { s } = \\eta \\, \\frac { V _ { t h } c _ { a } } { 2 q } \\exp \\left ( \\frac { V - V _ { T } } { \\eta V _ { t h } } \\right )', formatting=None, hyperlink=None)]
2025-06-10 20:17:15,916 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:17:15,917 - DEBUG - Processing text item: label=formula, text=n _ { s } = \eta \, \frac { V _ { t h } c _ { a } } { 2 q } \exp \left ( \frac { V - V _ { T } } { \eta V _ { t h } } \right )
2025-06-10 20:17:15,917 - DEBUG - Recognized string extracted: n _ { s } = \eta \, \frac { V _ { t h } c _ { a } } { 2 q } \exp \left ( \frac { V - V _ { T } } { \eta V _ { t h } } \right )
2025-06-10 20:17:15,917 - DEBUG - Generating chat message for label: formula
2025-06-10 20:17:15,918 - DEBUG - Snippet 10.1038_ncomms2832_588_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:17:15,988 - DEBUG - Snippet 10.1038_ncomms2832_588_item_1 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:17:16,047 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:17:16,048 - INFO - Processing document 10.1186_1476-069x-8-40_601.pdf
2025-06-10 20:17:16,521 - DEBUG - Snippet 10.3390_atmos13050788_558_item_3: generation shape=torch.Size([1, 399])
2025-06-10 20:17:16,521 - DEBUG - Snippet 10.3390_atmos13050788_558_item_3 raw docling: (tokens=53)
<formula><loc_0><loc_0><loc_500><loc_500>T _ { t } = \frac { S _ { t } - S _ { t - 1 } } { S _ { t - 1 } }</formula><end_of_utterance>
2025-06-10 20:17:16,522 - DEBUG - Starting _parse_docling_output
2025-06-10 20:17:16,522 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>T _ { t } = \frac { S _ { t } - S _ { t - 1 } } { S _ { t - 1 } }</formula><end_of_utterance>
2025-06-10 20:17:16,522 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:17:16,522 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>T _ { t } = \\frac { S _ { t } - S _ { t - 1 } } { S _ { t - 1 } }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=675x121 at 0x7F96BB5D6120>)]
2025-06-10 20:17:16,523 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:17:16,525 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=675.0, b=121.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 65))], orig='T _ { t } = \\frac { S _ { t } - S _ { t - 1 } } { S _ { t - 1 } }', text='T _ { t } = \\frac { S _ { t } - S _ { t - 1 } } { S _ { t - 1 } }', formatting=None, hyperlink=None)]
2025-06-10 20:17:16,526 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:17:16,526 - DEBUG - Processing text item: label=formula, text=T _ { t } = \frac { S _ { t } - S _ { t - 1 } } { S _ { t - 1 } }
2025-06-10 20:17:16,526 - DEBUG - Recognized string extracted: T _ { t } = \frac { S _ { t } - S _ { t - 1 } } { S _ { t - 1 } }
2025-06-10 20:17:16,526 - DEBUG - Generating chat message for label: formula
2025-06-10 20:17:16,527 - DEBUG - Snippet 10.3390_atmos13050788_558_item_4 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:17:16,593 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:16,600 - DEBUG - Snippet 10.3390_atmos13050788_558_item_4 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:17:16,654 - DEBUG - [Page 40] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:16,873 - DEBUG - Dynamic vertical threshold: 27.818099999999994, Overlap threshold: 0.7
2025-06-10 20:17:16,874 - DEBUG - Checking merge:
  Current: 13, Next: 26
2025-06-10 20:17:16,874 - DEBUG -   Vertical gap: 3.7590000000000146, Overlap ratio: 0.19036798562497664
2025-06-10 20:17:16,874 - DEBUG -   Left boundary diff: 216.277, Right boundary diff: 258.68600000000004
2025-06-10 20:17:16,874 - DEBUG -   Alignment factor (ratio): 1.3735454736121104
2025-06-10 20:17:16,875 - DEBUG -   -> c1 13 formula number: 3, c2 26 formula number: 8
2025-06-10 20:17:16,875 - DEBUG -   -> Not merging clusters 13 and 26 due to different formula numbers: 3 vs 8
2025-06-10 20:17:16,875 - DEBUG - Checking merge:
  Current: 24, Next: 20
2025-06-10 20:17:16,876 - DEBUG -   Vertical gap: 25.099999999999966, Overlap ratio: 1.0
2025-06-10 20:17:16,876 - DEBUG -   Left boundary diff: 5.594000000000001, Right boundary diff: 0.0
2025-06-10 20:17:16,876 - DEBUG -   Alignment factor (ratio): 0.023722689645813547
2025-06-10 20:17:16,876 - DEBUG -   -> c1 24 formula number: 4, c2 20 formula number: 5
2025-06-10 20:17:16,877 - DEBUG -   -> Not merging clusters 24 and 20 due to different formula numbers: 4 vs 5
2025-06-10 20:17:16,877 - DEBUG - Checking merge:
  Current: 22, Next: 23
2025-06-10 20:17:16,877 - DEBUG -   Vertical gap: 15.795999999999935, Overlap ratio: 1.0
2025-06-10 20:17:16,877 - DEBUG -   Left boundary diff: 15.941000000000003, Right boundary diff: 0.0
2025-06-10 20:17:16,877 - DEBUG -   Alignment factor (ratio): 0.0793252304591767
2025-06-10 20:17:16,878 - DEBUG -   -> c1 22 formula number: 6, c2 23 formula number: 7
2025-06-10 20:17:16,878 - DEBUG -   -> Not merging clusters 22 and 23 due to different formula numbers: 6 vs 7
2025-06-10 20:17:16,878 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:16,989 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:17,160 - DEBUG - [Page 41] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:17,227 - DEBUG - Snippet 10.1038_ncomms2832_588_item_1: generation shape=torch.Size([1, 387])
2025-06-10 20:17:17,228 - DEBUG - Snippet 10.1038_ncomms2832_588_item_1 raw docling: (tokens=41)
<formula><loc_0><loc_0><loc_500><loc_500>\eta = 1 + C _ { d e p l } / C _ { d i e l }</formula><end_of_utterance>
2025-06-10 20:17:17,229 - DEBUG - Starting _parse_docling_output
2025-06-10 20:17:17,229 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>\eta = 1 + C _ { d e p l } / C _ { d i e l }</formula><end_of_utterance>
2025-06-10 20:17:17,229 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:17:17,230 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>\\eta = 1 + C _ { d e p l } / C _ { d i e l }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=451x55 at 0x7F96E046F0E0>)]
2025-06-10 20:17:17,230 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:17:17,232 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=451.0, b=55.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 44))], orig='\\eta = 1 + C _ { d e p l } / C _ { d i e l }', text='\\eta = 1 + C _ { d e p l } / C _ { d i e l }', formatting=None, hyperlink=None)]
2025-06-10 20:17:17,232 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:17:17,232 - DEBUG - Processing text item: label=formula, text=\eta = 1 + C _ { d e p l } / C _ { d i e l }
2025-06-10 20:17:17,232 - DEBUG - Recognized string extracted: \eta = 1 + C _ { d e p l } / C _ { d i e l }
2025-06-10 20:17:17,232 - DEBUG - Generating chat message for label: formula
2025-06-10 20:17:17,233 - DEBUG - Snippet 10.1038_ncomms2832_588_item_2 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:17:17,362 - DEBUG - Snippet 10.1038_ncomms2832_588_item_2 => input_ids shape=torch.Size([1, 610]), prompt_len=610
2025-06-10 20:17:17,599 - DEBUG - Snippet 10.5194_acp-18-16173-2018_487_item_3: generation shape=torch.Size([1, 685])
2025-06-10 20:17:17,601 - DEBUG - Snippet 10.5194_acp-18-16173-2018_487_item_3 raw docling: (tokens=74)
<formula><loc_0><loc_0><loc_500><loc_500>\mathbb { P } ( H ) = \int _ { 0 } ^ { H } A _ { x } \exp \left ( \frac { - t } { a _ { x } } \right ) R ( H - t ) d t ,</formula><end_of_utterance>
2025-06-10 20:17:17,601 - DEBUG - Starting _parse_docling_output
2025-06-10 20:17:17,601 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>\mathbb { P } ( H ) = \int _ { 0 } ^ { H } A _ { x } \exp \left ( \frac { - t } { a _ { x } } \right ) R ( H - t ) d t ,</formula><end_of_utterance>
2025-06-10 20:17:17,601 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:17:17,602 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>\\mathbb { P } ( H ) = \\int _ { 0 } ^ { H } A _ { x } \\exp \\left ( \\frac { - t } { a _ { x } } \\right ) R ( H - t ) d t ,</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=633x180 at 0x7F96AA7C1310>)]
2025-06-10 20:17:17,602 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:17:17,606 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=633.0, b=180.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 120))], orig='\\mathbb { P } ( H ) = \\int _ { 0 } ^ { H } A _ { x } \\exp \\left ( \\frac { - t } { a _ { x } } \\right ) R ( H - t ) d t ,', text='\\mathbb { P } ( H ) = \\int _ { 0 } ^ { H } A _ { x } \\exp \\left ( \\frac { - t } { a _ { x } } \\right ) R ( H - t ) d t ,', formatting=None, hyperlink=None)]
2025-06-10 20:17:17,607 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:17:17,607 - DEBUG - Processing text item: label=formula, text=\mathbb { P } ( H ) = \int _ { 0 } ^ { H } A _ { x } \exp \left ( \frac { - t } { a _ { x } } \right ) R ( H - t ) d t ,
2025-06-10 20:17:17,607 - DEBUG - Recognized string extracted: \mathbb { P } ( H ) = \int _ { 0 } ^ { H } A _ { x } \exp \left ( \frac { - t } { a _ { x } } \right ) R ( H - t ) d t ,
2025-06-10 20:17:17,607 - DEBUG - Generating chat message for label: formula
2025-06-10 20:17:17,608 - DEBUG - Snippet 10.5194_acp-18-16173-2018_487_item_4 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:17:17,638 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:17,682 - DEBUG - Snippet 10.5194_acp-18-16173-2018_487_item_4 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:17:17,781 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:17,891 - DEBUG - Finished converting page batch time=3777.593
2025-06-10 20:17:18,110 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:18,153 - DEBUG - Finished converting page batch time=3777.855
2025-06-10 20:17:18,396 - DEBUG - [Page 42] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:18,440 - DEBUG - Snippet 10.3390_atmos13050788_558_item_4: generation shape=torch.Size([1, 407])
2025-06-10 20:17:18,441 - DEBUG - Snippet 10.3390_atmos13050788_558_item_4 raw docling: (tokens=61)
<formula><loc_0><loc_0><loc_500><loc_500>y _ { t } = \alpha + \sum _ { i = 1 } ^ { p } \varphi _ { i } y _ { t - i } + e _ { t }</formula><end_of_utterance>
2025-06-10 20:17:18,441 - DEBUG - Starting _parse_docling_output
2025-06-10 20:17:18,442 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>y _ { t } = \alpha + \sum _ { i = 1 } ^ { p } \varphi _ { i } y _ { t - i } + e _ { t }</formula><end_of_utterance>
2025-06-10 20:17:18,442 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:17:18,442 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>y _ { t } = \\alpha + \\sum _ { i = 1 } ^ { p } \\varphi _ { i } y _ { t - i } + e _ { t }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=725x147 at 0x7F96BB5D4F20>)]
2025-06-10 20:17:18,442 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:17:18,449 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=725.0, b=147.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 87))], orig='y _ { t } = \\alpha + \\sum _ { i = 1 } ^ { p } \\varphi _ { i } y _ { t - i } + e _ { t }', text='y _ { t } = \\alpha + \\sum _ { i = 1 } ^ { p } \\varphi _ { i } y _ { t - i } + e _ { t }', formatting=None, hyperlink=None)]
2025-06-10 20:17:18,449 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:17:18,449 - DEBUG - Processing text item: label=formula, text=y _ { t } = \alpha + \sum _ { i = 1 } ^ { p } \varphi _ { i } y _ { t - i } + e _ { t }
2025-06-10 20:17:18,450 - DEBUG - Recognized string extracted: y _ { t } = \alpha + \sum _ { i = 1 } ^ { p } \varphi _ { i } y _ { t - i } + e _ { t }
2025-06-10 20:17:18,450 - INFO - All done. Returning 5 recognized text results.
2025-06-10 20:17:18,450 - DEBUG - Snippet 10.3390_atmos13050788_558_item_0 recognized text:
A C F ( n ) = \frac { \langle \sigma v ( x _ { t } , x _ { t - n } ) } { V a r ( x _ { t } ) }
2025-06-10 20:17:18,450 - DEBUG - Snippet 10.3390_atmos13050788_558_item_1 recognized text:
P A C F ( n ) = C o r r [ x _ { t } - E ^ { * } ( x _ { t } | x _ { t - 1 } , \dots , x _ { t - n + 1 } ) , x _ { t - n } ]
2025-06-10 20:17:18,450 - DEBUG - Snippet 10.3390_atmos13050788_558_item_2 recognized text:
T _ { t } = S _ { t } - S _ { t - 1 }
2025-06-10 20:17:18,451 - DEBUG - Snippet 10.3390_atmos13050788_558_item_3 recognized text:
T _ { t } = \frac { S _ { t } - S _ { t - 1 } } { S _ { t - 1 } }
2025-06-10 20:17:18,451 - DEBUG - Snippet 10.3390_atmos13050788_558_item_4 recognized text:
y _ { t } = \alpha + \sum _ { i = 1 } ^ { p } \varphi _ { i } y _ { t - i } + e _ { t }
2025-06-10 20:17:18,573 - DEBUG - Creating masked image for page 7 with 18 clusters.
2025-06-10 20:17:18,574 - INFO - Masked image successfully created for page 7.
2025-06-10 20:17:18,582 - INFO - Starting prediction for 4 images with labels: ['formula', 'formula', 'formula', 'formula']
2025-06-10 20:17:18,583 - DEBUG - Generating chat message for label: formula
2025-06-10 20:17:18,583 - DEBUG - Snippet 10.3390_atmos13050788_558_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:17:18,661 - DEBUG - Snippet 10.3390_atmos13050788_558_item_0 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:17:19,016 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:19,047 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:19,514 - DEBUG - [Page 43] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:19,515 - DEBUG - Finished converting page batch time=3779.217
2025-06-10 20:17:19,585 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:19,924 - DEBUG - Snippet 10.5194_acp-18-16173-2018_487_item_4: generation shape=torch.Size([1, 420])
2025-06-10 20:17:19,925 - DEBUG - Snippet 10.5194_acp-18-16173-2018_487_item_4 raw docling: (tokens=74)
<formula><loc_0><loc_0><loc_500><loc_500>t ) = \sum _ { j = 1 } ^ { 2 } \frac { c _ { j } } { d _ { j } } \exp \left ( - \frac { t } { d _ { j } } \right ) .</formula><end_of_utterance>
2025-06-10 20:17:19,925 - DEBUG - Starting _parse_docling_output
2025-06-10 20:17:19,925 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>t ) = \sum _ { j = 1 } ^ { 2 } \frac { c _ { j } } { d _ { j } } \exp \left ( - \frac { t } { d _ { j } } \right ) .</formula><end_of_utterance>
2025-06-10 20:17:19,926 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:17:19,926 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>t ) = \\sum _ { j = 1 } ^ { 2 } \\frac { c _ { j } } { d _ { j } } \\exp \\left ( - \\frac { t } { d _ { j } } \\right ) .</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=649x143 at 0x7F96AA7C3650>)]
2025-06-10 20:17:19,926 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:17:19,930 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=649.0, b=143.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 116))], orig='t ) = \\sum _ { j = 1 } ^ { 2 } \\frac { c _ { j } } { d _ { j } } \\exp \\left ( - \\frac { t } { d _ { j } } \\right ) .', text='t ) = \\sum _ { j = 1 } ^ { 2 } \\frac { c _ { j } } { d _ { j } } \\exp \\left ( - \\frac { t } { d _ { j } } \\right ) .', formatting=None, hyperlink=None)]
2025-06-10 20:17:19,930 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:17:19,931 - DEBUG - Processing text item: label=formula, text=t ) = \sum _ { j = 1 } ^ { 2 } \frac { c _ { j } } { d _ { j } } \exp \left ( - \frac { t } { d _ { j } } \right ) .
2025-06-10 20:17:19,931 - DEBUG - Recognized string extracted: t ) = \sum _ { j = 1 } ^ { 2 } \frac { c _ { j } } { d _ { j } } \exp \left ( - \frac { t } { d _ { j } } \right ) .
2025-06-10 20:17:19,931 - INFO - All done. Returning 5 recognized text results.
2025-06-10 20:17:19,931 - DEBUG - Snippet 10.5194_acp-18-16173-2018_487_item_0 recognized text:
K I L _ { L } A U 1 4 U J = a \times A U 1 4 U , \\ & R Y L ( M _ { i } ) = 1 - \frac { \exp \left [ - \left ( \frac { M _ { i } } { a } \right ) ^ { b } \right ] } { \exp \left [ - \left ( \frac { c } { a } \right ) ^ { b } \right ] } \ M _ { i } > c \quad . \\ & R Y L ( M _ { i } ) = 0 \quad \\ &
2025-06-10 20:17:19,931 - DEBUG - Snippet 10.5194_acp-18-16173-2018_487_item_1 recognized text:
S R _ { - } R F _ { k } ^ { j } = \frac { R F _ { - } P E R T [ j , k ] - R F _ { - } B A S E } { 0 . 2 E _ { k } ^ { j } } ,
2025-06-10 20:17:19,932 - DEBUG - Snippet 10.5194_acp-18-16173-2018_487_item_2 recognized text:
\mathbb { V P } ( H ) = \int _ { 0 } ^ { H } A _ { x } \exp \left ( \frac { - t } { a _ { x } } \right ) d t = A _ { x } a _ { x } \left [ 1 - \exp \left ( \frac { - H } { a _ { x } } \right ) \right ] .
2025-06-10 20:17:19,932 - DEBUG - Snippet 10.5194_acp-18-16173-2018_487_item_3 recognized text:
\mathbb { P } ( H ) = \int _ { 0 } ^ { H } A _ { x } \exp \left ( \frac { - t } { a _ { x } } \right ) R ( H - t ) d t ,
2025-06-10 20:17:19,932 - DEBUG - Snippet 10.5194_acp-18-16173-2018_487_item_4 recognized text:
t ) = \sum _ { j = 1 } ^ { 2 } \frac { c _ { j } } { d _ { j } } \exp \left ( - \frac { t } { d _ { j } } \right ) .
2025-06-10 20:17:19,938 - INFO - Starting prediction for 2 images with labels: ['formula', 'formula']
2025-06-10 20:17:19,938 - DEBUG - Generating chat message for label: formula
2025-06-10 20:17:19,939 - DEBUG - Snippet 10.5194_acp-18-16173-2018_487_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:17:20,018 - DEBUG - Snippet 10.5194_acp-18-16173-2018_487_item_0 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:17:20,109 - DEBUG - [Page 44] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:20,311 - DEBUG - Snippet 10.3390_atmos13050788_558_item_0: generation shape=torch.Size([1, 401])
2025-06-10 20:17:20,312 - DEBUG - Snippet 10.3390_atmos13050788_558_item_0 raw docling: (tokens=55)
<formula><loc_0><loc_0><loc_500><loc_500>y _ { t } = \mu + \sum _ { i - 1 } ^ { \nu } \theta _ { i } e _ { t - i }</formula><end_of_utterance>
2025-06-10 20:17:20,312 - DEBUG - Starting _parse_docling_output
2025-06-10 20:17:20,313 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>y _ { t } = \mu + \sum _ { i - 1 } ^ { \nu } \theta _ { i } e _ { t - i }</formula><end_of_utterance>
2025-06-10 20:17:20,313 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:17:20,313 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>y _ { t } = \\mu + \\sum _ { i - 1 } ^ { \\nu } \\theta _ { i } e _ { t - i }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=692x147 at 0x7F96D76A6F30>)]
2025-06-10 20:17:20,313 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:17:20,317 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=692.0, b=147.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 73))], orig='y _ { t } = \\mu + \\sum _ { i - 1 } ^ { \\nu } \\theta _ { i } e _ { t - i }', text='y _ { t } = \\mu + \\sum _ { i - 1 } ^ { \\nu } \\theta _ { i } e _ { t - i }', formatting=None, hyperlink=None)]
2025-06-10 20:17:20,317 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:17:20,317 - DEBUG - Processing text item: label=formula, text=y _ { t } = \mu + \sum _ { i - 1 } ^ { \nu } \theta _ { i } e _ { t - i }
2025-06-10 20:17:20,317 - DEBUG - Recognized string extracted: y _ { t } = \mu + \sum _ { i - 1 } ^ { \nu } \theta _ { i } e _ { t - i }
2025-06-10 20:17:20,317 - DEBUG - Generating chat message for label: formula
2025-06-10 20:17:20,318 - DEBUG - Snippet 10.3390_atmos13050788_558_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:17:20,382 - DEBUG - Snippet 10.3390_atmos13050788_558_item_1 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:17:20,459 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:20,461 - DEBUG - Finished converting page batch time=3780.163
2025-06-10 20:17:20,588 - DEBUG - Snippet 10.1038_ncomms2832_588_item_2: generation shape=torch.Size([1, 722])
2025-06-10 20:17:20,589 - DEBUG - Snippet 10.1038_ncomms2832_588_item_2 raw docling: (tokens=111)
<formula><loc_0><loc_0><loc_500><loc_500>C _ { p } = \frac { 2 \epsilon _ { 0 } \epsilon _ { 1 } \epsilon _ { 2 } } { h } \Big / \Big | d x d y \Big | \epsilon _ { 1 } + \frac { \sqrt { 2 } ( \epsilon _ { 2 } - \epsilon _ { 1 } ) } { h } | x + y |</formula><end_of_utterance>
2025-06-10 20:17:20,589 - DEBUG - Starting _parse_docling_output
2025-06-10 20:17:20,589 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>C _ { p } = \frac { 2 \epsilon _ { 0 } \epsilon _ { 1 } \epsilon _ { 2 } } { h } \Big / \Big | d x d y \Big | \epsilon _ { 1 } + \frac { \sqrt { 2 } ( \epsilon _ { 2 } - \epsilon _ { 1 } ) } { h } | x + y |</formula><end_of_utterance>
2025-06-10 20:17:20,589 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:17:20,590 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>C _ { p } = \\frac { 2 \\epsilon _ { 0 } \\epsilon _ { 1 } \\epsilon _ { 2 } } { h } \\Big / \\Big | d x d y \\Big | \\epsilon _ { 1 } + \\frac { \\sqrt { 2 } ( \\epsilon _ { 2 } - \\epsilon _ { 1 } ) } { h } | x + y |</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=461x119 at 0x7F96DE196510>)]
2025-06-10 20:17:20,590 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:17:20,592 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=461.0, b=119.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 206))], orig='C _ { p } = \\frac { 2 \\epsilon _ { 0 } \\epsilon _ { 1 } \\epsilon _ { 2 } } { h } \\Big / \\Big | d x d y \\Big | \\epsilon _ { 1 } + \\frac { \\sqrt { 2 } ( \\epsilon _ { 2 } - \\epsilon _ { 1 } ) } { h } | x + y |', text='C _ { p } = \\frac { 2 \\epsilon _ { 0 } \\epsilon _ { 1 } \\epsilon _ { 2 } } { h } \\Big / \\Big | d x d y \\Big | \\epsilon _ { 1 } + \\frac { \\sqrt { 2 } ( \\epsilon _ { 2 } - \\epsilon _ { 1 } ) } { h } | x + y |', formatting=None, hyperlink=None)]
2025-06-10 20:17:20,593 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:17:20,593 - DEBUG - Processing text item: label=formula, text=C _ { p } = \frac { 2 \epsilon _ { 0 } \epsilon _ { 1 } \epsilon _ { 2 } } { h } \Big / \Big | d x d y \Big | \epsilon _ { 1 } + \frac { \sqrt { 2 } ( \epsilon _ { 2 } - \epsilon _ { 1 } ) } { h } | x + y |
2025-06-10 20:17:20,593 - DEBUG - Recognized string extracted: C _ { p } = \frac { 2 \epsilon _ { 0 } \epsilon _ { 1 } \epsilon _ { 2 } } { h } \Big / \Big | d x d y \Big | \epsilon _ { 1 } + \frac { \sqrt { 2 } ( \epsilon _ { 2 } - \epsilon _ { 1 } ) } { h } | x + y |
2025-06-10 20:17:20,594 - INFO - All done. Returning 3 recognized text results.
2025-06-10 20:17:20,594 - DEBUG - Snippet 10.1038_ncomms2832_588_item_0 recognized text:
n _ { s } = \eta \, \frac { V _ { t h } c _ { a } } { 2 q } \exp \left ( \frac { V - V _ { T } } { \eta V _ { t h } } \right )
2025-06-10 20:17:20,594 - DEBUG - Snippet 10.1038_ncomms2832_588_item_1 recognized text:
\eta = 1 + C _ { d e p l } / C _ { d i e l }
2025-06-10 20:17:20,594 - DEBUG - Snippet 10.1038_ncomms2832_588_item_2 recognized text:
C _ { p } = \frac { 2 \epsilon _ { 0 } \epsilon _ { 1 } \epsilon _ { 2 } } { h } \Big / \Big | d x d y \Big | \epsilon _ { 1 } + \frac { \sqrt { 2 } ( \epsilon _ { 2 } - \epsilon _ { 1 } ) } { h } | x + y |
2025-06-10 20:17:20,610 - DEBUG - [Page 45] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:20,696 - INFO - Finished converting document 10.1038_ncomms2832_588.pdf in 21.95 sec.
2025-06-10 20:17:20,772 - INFO - Extraction successful row 99, tokens=11559
2025-06-10 20:17:20,798 - INFO - Going to convert document batch...
2025-06-10 20:17:20,798 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:17:20,798 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:17:20,849 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:17:20,973 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:21,008 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:21,232 - DEBUG - [Page 46] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:21,593 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:17:21,646 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:17:21,652 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:17:21,850 - DEBUG - [Page 14] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:21,902 - DEBUG - [Page 47] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:21,903 - DEBUG - Finished converting page batch time=3781.605
2025-06-10 20:17:21,991 - DEBUG - Snippet 10.3390_atmos13050788_558_item_1: generation shape=torch.Size([1, 404])
2025-06-10 20:17:21,992 - DEBUG - Snippet 10.3390_atmos13050788_558_item_1 raw docling: (tokens=58)
<formula><loc_0><loc_0><loc_500><loc_500>\varphi _ { p } ( B ) ( 1 - B ) ^ { d } y _ { t } = \theta _ { q } ( B ) e _ { t }</formula><end_of_utterance>
2025-06-10 20:17:21,992 - DEBUG - Starting _parse_docling_output
2025-06-10 20:17:21,992 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>\varphi _ { p } ( B ) ( 1 - B ) ^ { d } y _ { t } = \theta _ { q } ( B ) e _ { t }</formula><end_of_utterance>
2025-06-10 20:17:21,992 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:17:21,992 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>\\varphi _ { p } ( B ) ( 1 - B ) ^ { d } y _ { t } = \\theta _ { q } ( B ) e _ { t }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=749x72 at 0x7F96BA748B90>)]
2025-06-10 20:17:21,993 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:17:21,995 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=749.0, b=72.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 82))], orig='\\varphi _ { p } ( B ) ( 1 - B ) ^ { d } y _ { t } = \\theta _ { q } ( B ) e _ { t }', text='\\varphi _ { p } ( B ) ( 1 - B ) ^ { d } y _ { t } = \\theta _ { q } ( B ) e _ { t }', formatting=None, hyperlink=None)]
2025-06-10 20:17:21,995 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:17:21,996 - DEBUG - Processing text item: label=formula, text=\varphi _ { p } ( B ) ( 1 - B ) ^ { d } y _ { t } = \theta _ { q } ( B ) e _ { t }
2025-06-10 20:17:21,996 - DEBUG - Recognized string extracted: \varphi _ { p } ( B ) ( 1 - B ) ^ { d } y _ { t } = \theta _ { q } ( B ) e _ { t }
2025-06-10 20:17:21,996 - DEBUG - Generating chat message for label: formula
2025-06-10 20:17:21,996 - DEBUG - Snippet 10.3390_atmos13050788_558_item_2 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:17:22,062 - DEBUG - Snippet 10.3390_atmos13050788_558_item_2 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:17:22,104 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:17:22,105 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:17:22,105 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:17:22,147 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:17:22,203 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:17:22,238 - DEBUG - [Page 48] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:22,240 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:17:22,280 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:17:22,319 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:17:22,368 - DEBUG - [Page 49] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:22,392 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:17:22,406 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:22,529 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:17:22,564 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:17:22,604 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:17:22,613 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:22,755 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:17:22,832 - DEBUG - [Page 15] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:22,833 - DEBUG - Finished converting page batch time=3782.535
2025-06-10 20:17:22,960 - DEBUG - [Page 50] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:22,966 - DEBUG - Snippet 10.3390_atmos13050788_558_item_2: generation shape=torch.Size([1, 377])
2025-06-10 20:17:22,967 - DEBUG - Snippet 10.3390_atmos13050788_558_item_2 raw docling: (tokens=31)
<formula><loc_0><loc_0><loc_500><loc_500>A I C = - 2 l + 2 k</formula><end_of_utterance>
2025-06-10 20:17:22,967 - DEBUG - Starting _parse_docling_output
2025-06-10 20:17:22,967 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>A I C = - 2 l + 2 k</formula><end_of_utterance>
2025-06-10 20:17:22,967 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:17:22,968 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>A I C = - 2 l + 2 k</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=682x55 at 0x7F96BA749130>)]
2025-06-10 20:17:22,968 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:17:22,970 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=682.0, b=55.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 19))], orig='A I C = - 2 l + 2 k', text='A I C = - 2 l + 2 k', formatting=None, hyperlink=None)]
2025-06-10 20:17:22,970 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:17:22,970 - DEBUG - Processing text item: label=formula, text=A I C = - 2 l + 2 k
2025-06-10 20:17:22,970 - DEBUG - Recognized string extracted: A I C = - 2 l + 2 k
2025-06-10 20:17:22,970 - DEBUG - Generating chat message for label: formula
2025-06-10 20:17:22,971 - DEBUG - Snippet 10.3390_atmos13050788_558_item_3 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:17:23,034 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:17:23,038 - DEBUG - Snippet 10.3390_atmos13050788_558_item_3 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:17:23,161 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:23,162 - DEBUG - Finished converting page batch time=3782.864
2025-06-10 20:17:23,221 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:17:23,221 - INFO - Processing document 10.1038_s41370-019-0135-4_608.pdf
2025-06-10 20:17:23,280 - INFO - Finished converting document 10.5812_jhealthscope.105567_595.pdf in 21.77 sec.
2025-06-10 20:17:23,314 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:23,405 - INFO - Extraction successful row 101, tokens=29063
2025-06-10 20:17:23,453 - INFO - Going to convert document batch...
2025-06-10 20:17:23,453 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:17:23,453 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:17:23,503 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:17:23,614 - DEBUG - [Page 51] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:23,614 - DEBUG - Finished converting page batch time=3783.316
2025-06-10 20:17:23,874 - DEBUG - Snippet 10.5194_acp-18-16173-2018_487_item_0: generation shape=torch.Size([1, 471])
2025-06-10 20:17:23,875 - DEBUG - Snippet 10.5194_acp-18-16173-2018_487_item_0 raw docling: (tokens=125)
<formula><loc_0><loc_0><loc_500><loc_500>A G T P ( H ) = \sum _ { i = 1 } ^ { 2 } \frac { A _ { x } a _ { x } c _ { j } } { ( a _ { x } - d _ { j } ) } \left ( \exp \left ( \frac { - H } { a _ { x } } \right ) - \exp \left ( \frac { - H } { d _ { j } } \right ) \right ) .</formula><end_of_utterance>
2025-06-10 20:17:23,875 - DEBUG - Starting _parse_docling_output
2025-06-10 20:17:23,876 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>A G T P ( H ) = \sum _ { i = 1 } ^ { 2 } \frac { A _ { x } a _ { x } c _ { j } } { ( a _ { x } - d _ { j } ) } \left ( \exp \left ( \frac { - H } { a _ { x } } \right ) - \exp \left ( \frac { - H } { d _ { j } } \right ) \right ) .</formula><end_of_utterance>
2025-06-10 20:17:23,876 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:17:23,876 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>A G T P ( H ) = \\sum _ { i = 1 } ^ { 2 } \\frac { A _ { x } a _ { x } c _ { j } } { ( a _ { x } - d _ { j } ) } \\left ( \\exp \\left ( \\frac { - H } { a _ { x } } \\right ) - \\exp \\left ( \\frac { - H } { d _ { j } } \\right ) \\right ) .</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=710x137 at 0x7F96D073B890>)]
2025-06-10 20:17:23,877 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:17:23,879 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:23,881 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=710.0, b=137.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 231))], orig='A G T P ( H ) = \\sum _ { i = 1 } ^ { 2 } \\frac { A _ { x } a _ { x } c _ { j } } { ( a _ { x } - d _ { j } ) } \\left ( \\exp \\left ( \\frac { - H } { a _ { x } } \\right ) - \\exp \\left ( \\frac { - H } { d _ { j } } \\right ) \\right ) .', text='A G T P ( H ) = \\sum _ { i = 1 } ^ { 2 } \\frac { A _ { x } a _ { x } c _ { j } } { ( a _ { x } - d _ { j } ) } \\left ( \\exp \\left ( \\frac { - H } { a _ { x } } \\right ) - \\exp \\left ( \\frac { - H } { d _ { j } } \\right ) \\right ) .', formatting=None, hyperlink=None)]
2025-06-10 20:17:23,881 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:17:23,881 - DEBUG - Processing text item: label=formula, text=A G T P ( H ) = \sum _ { i = 1 } ^ { 2 } \frac { A _ { x } a _ { x } c _ { j } } { ( a _ { x } - d _ { j } ) } \left ( \exp \left ( \frac { - H } { a _ { x } } \right ) - \exp \left ( \frac { - H } { d _ { j } } \right ) \right ) .
2025-06-10 20:17:23,881 - DEBUG - Recognized string extracted: A G T P ( H ) = \sum _ { i = 1 } ^ { 2 } \frac { A _ { x } a _ { x } c _ { j } } { ( a _ { x } - d _ { j } ) } \left ( \exp \left ( \frac { - H } { a _ { x } } \right ) - \exp \left ( \frac { - H } { d _ { j } } \right ) \right ) .
2025-06-10 20:17:23,881 - DEBUG - Generating chat message for label: formula
2025-06-10 20:17:23,882 - DEBUG - Snippet 10.5194_acp-18-16173-2018_487_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:17:23,952 - DEBUG - Snippet 10.5194_acp-18-16173-2018_487_item_1 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:17:24,128 - DEBUG - [Page 52] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:24,134 - DEBUG - Snippet 10.3390_atmos13050788_558_item_3: generation shape=torch.Size([1, 378])
2025-06-10 20:17:24,134 - DEBUG - Snippet 10.3390_atmos13050788_558_item_3 raw docling: (tokens=32)
<formula><loc_0><loc_0><loc_500><loc_500>B I C = - 2 l + k \log n</formula><end_of_utterance>
2025-06-10 20:17:24,135 - DEBUG - Starting _parse_docling_output
2025-06-10 20:17:24,135 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>B I C = - 2 l + k \log n</formula><end_of_utterance>
2025-06-10 20:17:24,135 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:17:24,135 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>B I C = - 2 l + k \\log n</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=708x55 at 0x7F96BA74A6F0>)]
2025-06-10 20:17:24,136 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:17:24,137 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=708.0, b=55.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 24))], orig='B I C = - 2 l + k \\log n', text='B I C = - 2 l + k \\log n', formatting=None, hyperlink=None)]
2025-06-10 20:17:24,138 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:17:24,138 - DEBUG - Processing text item: label=formula, text=B I C = - 2 l + k \log n
2025-06-10 20:17:24,138 - DEBUG - Recognized string extracted: B I C = - 2 l + k \log n
2025-06-10 20:17:24,138 - INFO - All done. Returning 4 recognized text results.
2025-06-10 20:17:24,139 - DEBUG - Snippet 10.3390_atmos13050788_558_item_0 recognized text:
y _ { t } = \mu + \sum _ { i - 1 } ^ { \nu } \theta _ { i } e _ { t - i }
2025-06-10 20:17:24,139 - DEBUG - Snippet 10.3390_atmos13050788_558_item_1 recognized text:
\varphi _ { p } ( B ) ( 1 - B ) ^ { d } y _ { t } = \theta _ { q } ( B ) e _ { t }
2025-06-10 20:17:24,139 - DEBUG - Snippet 10.3390_atmos13050788_558_item_2 recognized text:
A I C = - 2 l + 2 k
2025-06-10 20:17:24,139 - DEBUG - Snippet 10.3390_atmos13050788_558_item_3 recognized text:
B I C = - 2 l + k \log n
2025-06-10 20:17:24,174 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:17:24,227 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:17:24,233 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:17:24,232 - INFO - Finished converting document 10.3390_atmos13050788_558.pdf in 31.04 sec.
2025-06-10 20:17:24,419 - DEBUG - [Page 53] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:24,476 - INFO - Extraction successful row 97, tokens=16048
2025-06-10 20:17:24,497 - INFO - Going to convert document batch...
2025-06-10 20:17:24,497 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:17:24,497 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:17:24,548 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:17:24,722 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:17:24,723 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:17:24,723 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:17:24,759 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:17:24,794 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:17:24,820 - DEBUG - [Page 16] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:24,831 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:17:24,863 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:24,909 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:17:24,952 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:17:24,993 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:17:25,000 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:25,152 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:17:25,169 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:17:25,187 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:17:25,227 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:17:25,233 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:17:25,257 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:17:25,302 - DEBUG - Finished converting page batch time=3785.005
2025-06-10 20:17:25,419 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:17:25,687 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:25,691 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:17:25,691 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:17:25,692 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:17:25,726 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:17:25,731 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:17:25,768 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:17:25,806 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:17:25,843 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:17:25,867 - DEBUG - Snippet 10.5194_acp-18-16173-2018_487_item_1: generation shape=torch.Size([1, 407])
2025-06-10 20:17:25,868 - DEBUG - Snippet 10.5194_acp-18-16173-2018_487_item_1 raw docling: (tokens=61)
<formula><loc_0><loc_0><loc_500><loc_500>\Delta T _ { x } ( H ) = \sum _ { t = 0 } ^ { H } \Delta E _ { x } ( t ) A G T P ( H - t )</formula><end_of_utterance>
2025-06-10 20:17:25,868 - DEBUG - Starting _parse_docling_output
2025-06-10 20:17:25,868 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>\Delta T _ { x } ( H ) = \sum _ { t = 0 } ^ { H } \Delta E _ { x } ( t ) A G T P ( H - t )</formula><end_of_utterance>
2025-06-10 20:17:25,868 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:17:25,869 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>\\Delta T _ { x } ( H ) = \\sum _ { t = 0 } ^ { H } \\Delta E _ { x } ( t ) A G T P ( H - t )</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=710x143 at 0x7F96A6061D00>)]
2025-06-10 20:17:25,869 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:17:25,872 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=710.0, b=143.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 90))], orig='\\Delta T _ { x } ( H ) = \\sum _ { t = 0 } ^ { H } \\Delta E _ { x } ( t ) A G T P ( H - t )', text='\\Delta T _ { x } ( H ) = \\sum _ { t = 0 } ^ { H } \\Delta E _ { x } ( t ) A G T P ( H - t )', formatting=None, hyperlink=None)]
2025-06-10 20:17:25,873 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:17:25,873 - DEBUG - Processing text item: label=formula, text=\Delta T _ { x } ( H ) = \sum _ { t = 0 } ^ { H } \Delta E _ { x } ( t ) A G T P ( H - t )
2025-06-10 20:17:25,873 - DEBUG - Recognized string extracted: \Delta T _ { x } ( H ) = \sum _ { t = 0 } ^ { H } \Delta E _ { x } ( t ) A G T P ( H - t )
2025-06-10 20:17:25,873 - INFO - All done. Returning 2 recognized text results.
2025-06-10 20:17:25,873 - DEBUG - Snippet 10.5194_acp-18-16173-2018_487_item_0 recognized text:
A G T P ( H ) = \sum _ { i = 1 } ^ { 2 } \frac { A _ { x } a _ { x } c _ { j } } { ( a _ { x } - d _ { j } ) } \left ( \exp \left ( \frac { - H } { a _ { x } } \right ) - \exp \left ( \frac { - H } { d _ { j } } \right ) \right ) .
2025-06-10 20:17:25,874 - DEBUG - Snippet 10.5194_acp-18-16173-2018_487_item_1 recognized text:
\Delta T _ { x } ( H ) = \sum _ { t = 0 } ^ { H } \Delta E _ { x } ( t ) A G T P ( H - t )
2025-06-10 20:17:25,885 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:17:25,998 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:17:25,999 - INFO - Processing document 10.1186_1476-069x-9-3_611.pdf
2025-06-10 20:17:26,103 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:26,176 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:17:26,195 - INFO - Finished converting document 10.5194_acp-18-16173-2018_487.pdf in 94.39 sec.
2025-06-10 20:17:26,217 - DEBUG - [Page 54] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:26,230 - DEBUG - [Page 20] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:26,299 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:17:26,350 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:17:26,375 - DEBUG - [Page 55] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:26,376 - DEBUG - Finished converting page batch time=3786.078
2025-06-10 20:17:26,436 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:17:26,581 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:17:26,802 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:26,809 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:26,887 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:17:26,943 - INFO - Extraction successful row 79, tokens=85330
2025-06-10 20:17:26,974 - DEBUG - Dynamic vertical threshold: 35.01720000000002, Overlap threshold: 0.7
2025-06-10 20:17:26,974 - DEBUG - [Page 56] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:26,976 - INFO - Going to convert document batch...
2025-06-10 20:17:26,976 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:17:26,977 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:17:27,026 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:17:27,225 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:17:27,225 - INFO - Processing document 10.3390_ijerph16071227_612.pdf
2025-06-10 20:17:27,316 - DEBUG - [Page 57] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:27,608 - DEBUG - [Page 17] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:27,682 - DEBUG - [Page 58] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:27,702 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:17:27,755 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:17:27,761 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:27,762 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:17:27,857 - DEBUG - [Page 59] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:27,858 - DEBUG - Finished converting page batch time=3787.560
2025-06-10 20:17:27,952 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:28,244 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:28,345 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:17:28,346 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:17:28,346 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:17:28,364 - DEBUG - Finished converting page batch time=3788.066
2025-06-10 20:17:28,380 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:17:28,412 - DEBUG - [Page 60] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:28,418 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:17:28,419 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:28,523 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:17:28,561 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:17:28,722 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:17:28,762 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:17:28,898 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:17:28,934 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:17:28,936 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:29,007 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:17:29,072 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:29,159 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:17:29,257 - DEBUG - [Page 61] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:29,400 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:29,453 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:17:29,584 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:29,738 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:29,740 - DEBUG - Finished converting page batch time=3789.442
2025-06-10 20:17:27,707 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:17:27,707 - INFO - Processing document 10.2739_kurumemedj.ms644002_614.pdf
2025-06-10 20:17:27,720 - DEBUG - [Page 62] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:27,721 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:27,932 - DEBUG - [Page 18] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:27,958 - DEBUG - [Page 63] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:27,959 - DEBUG - Finished converting page batch time=3789.865
2025-06-10 20:17:28,259 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:28,591 - DEBUG - Finished converting page batch time=3790.497
2025-06-10 20:17:28,593 - DEBUG - [Page 64] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:28,669 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:28,671 - DEBUG - Finished converting page batch time=3790.577
2025-06-10 20:17:28,723 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:28,724 - DEBUG - Finished converting page batch time=3790.630
2025-06-10 20:17:28,861 - DEBUG - [Page 65] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:28,860 - INFO - Finished converting document 10.1186_1476-069x-8-40_601.pdf in 18.02 sec.
2025-06-10 20:17:28,949 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:28,978 - INFO - Extraction successful row 102, tokens=30731
2025-06-10 20:17:29,022 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:29,022 - INFO - Going to convert document batch...
2025-06-10 20:17:29,022 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:17:29,023 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:17:29,081 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:17:29,093 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:29,230 - DEBUG - [Page 66] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:29,307 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:29,632 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:29,706 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:17:29,751 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:17:29,758 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:17:30,137 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:30,577 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:30,620 - DEBUG - [Page 67] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:30,621 - DEBUG - Finished converting page batch time=3792.527
2025-06-10 20:17:30,653 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:17:30,654 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:17:30,654 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:17:30,705 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:17:30,736 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:30,745 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:17:30,786 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:17:30,829 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:17:30,865 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:17:30,903 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:17:30,970 - DEBUG - [Page 68] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:31,036 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:31,042 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:17:31,074 - DEBUG - [Page 19] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:31,076 - DEBUG - Finished converting page batch time=3792.982
2025-06-10 20:17:31,079 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:17:31,107 - DEBUG - Finished converting page batch time=3793.013
2025-06-10 20:17:31,118 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:17:31,276 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:17:31,304 - DEBUG - [Page 69] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:31,546 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:31,556 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:17:31,731 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:17:31,732 - INFO - Processing document 10.3390_atmos15030380_624.pdf
2025-06-10 20:17:32,068 - DEBUG - [Page 70] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:32,121 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:32,211 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:32,214 - DEBUG - Finished converting page batch time=3794.120
2025-06-10 20:17:32,384 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:32,385 - DEBUG - Finished converting page batch time=3794.291
2025-06-10 20:17:32,389 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:32,426 - DEBUG - [Page 71] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:32,427 - DEBUG - Finished converting page batch time=3794.333
2025-06-10 20:17:32,484 - INFO - Finished converting document 10.1038_s41370-019-0135-4_608.pdf in 13.91 sec.
2025-06-10 20:17:32,554 - INFO - Extraction successful row 103, tokens=12858
2025-06-10 20:17:32,563 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:32,582 - INFO - Going to convert document batch...
2025-06-10 20:17:32,582 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:17:32,582 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:17:32,636 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:17:32,642 - DEBUG - [Page 20] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:32,644 - DEBUG - Finished converting page batch time=3794.550
2025-06-10 20:17:32,706 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:32,707 - DEBUG - Finished converting page batch time=3794.613
2025-06-10 20:17:32,780 - INFO - Finished converting document 10.2739_kurumemedj.ms644002_614.pdf in 8.04 sec.
2025-06-10 20:17:32,830 - INFO - Extraction successful row 106, tokens=6317
2025-06-10 20:17:32,860 - INFO - Going to convert document batch...
2025-06-10 20:17:32,861 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:17:32,861 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:17:32,907 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:17:32,974 - DEBUG - [Page 72] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:32,977 - DEBUG - [Page 21] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:33,028 - DEBUG - Creating masked image for page 9 with 12 clusters.
2025-06-10 20:17:33,029 - INFO - Masked image successfully created for page 9.
2025-06-10 20:17:33,153 - DEBUG - Creating masked image for page 10 with 29 clusters.
2025-06-10 20:17:33,155 - INFO - Masked image successfully created for page 10.
2025-06-10 20:17:33,162 - INFO - Starting prediction for 5 images with labels: ['formula', 'formula', 'formula', 'formula', 'formula']
2025-06-10 20:17:33,162 - DEBUG - Generating chat message for label: formula
2025-06-10 20:17:33,162 - DEBUG - Snippet 10.3389_fphys.2020.00694_591_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:17:33,236 - DEBUG - Snippet 10.3389_fphys.2020.00694_591_item_0 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:17:33,288 - DEBUG - [Page 73] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:33,292 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:33,359 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:17:33,416 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:17:33,423 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:17:33,676 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:17:33,716 - DEBUG - [Page 74] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:33,735 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:17:33,741 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:17:33,812 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:33,982 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:17:33,987 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:17:33,987 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:17:34,028 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:17:34,065 - DEBUG - [Page 75] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:34,066 - DEBUG - Finished converting page batch time=3795.972
2025-06-10 20:17:34,075 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:17:34,112 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:17:34,133 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:34,148 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:17:34,235 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:34,247 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:17:34,259 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:17:34,260 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:17:34,260 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:17:34,282 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:17:34,297 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:17:34,333 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:17:34,375 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:17:34,400 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:17:34,417 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:17:34,434 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:17:34,455 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:17:34,471 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:17:34,492 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:17:34,624 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:17:34,627 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:17:34,646 - DEBUG - [Page 76] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:34,752 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:34,753 - DEBUG - Finished converting page batch time=3796.659
2025-06-10 20:17:34,769 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:17:34,804 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:17:34,903 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:17:34,964 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:17:35,042 - DEBUG - [Page 77] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:35,169 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:17:35,169 - INFO - Processing document 10.30955_gnj.005358_627.pdf
2025-06-10 20:17:35,191 - DEBUG - Finished converting page batch time=3797.097
2025-06-10 20:17:35,258 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:17:35,350 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:35,361 - DEBUG - Snippet 10.3389_fphys.2020.00694_591_item_0: generation shape=torch.Size([1, 420])
2025-06-10 20:17:35,362 - DEBUG - Snippet 10.3389_fphys.2020.00694_591_item_0 raw docling: (tokens=74)
<formula><loc_0><loc_0><loc_500><loc_500>2 0 _ { 2 } ^ { - } \cdot + 2 H ^ { + } \stackrel { S O D } { \rightarrow } H _ { 2 } O _ { 2 } + 0 _ { 2 }</formula><end_of_utterance>
2025-06-10 20:17:35,362 - DEBUG - Starting _parse_docling_output
2025-06-10 20:17:35,362 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>2 0 _ { 2 } ^ { - } \cdot + 2 H ^ { + } \stackrel { S O D } { \rightarrow } H _ { 2 } O _ { 2 } + 0 _ { 2 }</formula><end_of_utterance>
2025-06-10 20:17:35,363 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:17:35,363 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>2 0 _ { 2 } ^ { - } \\cdot + 2 H ^ { + } \\stackrel { S O D } { \\rightarrow } H _ { 2 } O _ { 2 } + 0 _ { 2 }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=525x79 at 0x7F96AA475A60>)]
2025-06-10 20:17:35,363 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:17:35,365 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=525.0, b=79.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 107))], orig='2 0 _ { 2 } ^ { - } \\cdot + 2 H ^ { + } \\stackrel { S O D } { \\rightarrow } H _ { 2 } O _ { 2 } + 0 _ { 2 }', text='2 0 _ { 2 } ^ { - } \\cdot + 2 H ^ { + } \\stackrel { S O D } { \\rightarrow } H _ { 2 } O _ { 2 } + 0 _ { 2 }', formatting=None, hyperlink=None)]
2025-06-10 20:17:35,365 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:17:35,365 - DEBUG - Processing text item: label=formula, text=2 0 _ { 2 } ^ { - } \cdot + 2 H ^ { + } \stackrel { S O D } { \rightarrow } H _ { 2 } O _ { 2 } + 0 _ { 2 }
2025-06-10 20:17:35,365 - DEBUG - Recognized string extracted: 2 0 _ { 2 } ^ { - } \cdot + 2 H ^ { + } \stackrel { S O D } { \rightarrow } H _ { 2 } O _ { 2 } + 0 _ { 2 }
2025-06-10 20:17:35,366 - DEBUG - Generating chat message for label: formula
2025-06-10 20:17:35,366 - DEBUG - Snippet 10.3389_fphys.2020.00694_591_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:17:35,434 - DEBUG - Snippet 10.3389_fphys.2020.00694_591_item_1 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:17:35,437 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:17:35,443 - INFO - Processing document 10.31390_gradschool_theses.3567_628.pdf
2025-06-10 20:17:35,450 - DEBUG - [Page 78] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:35,610 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:35,676 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:35,720 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:35,801 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:36,002 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:36,009 - DEBUG - Finished converting page batch time=3797.915
2025-06-10 20:17:36,086 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:36,086 - DEBUG - Finished converting page batch time=3797.992
2025-06-10 20:17:36,108 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:36,131 - DEBUG - [Page 79] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:36,131 - DEBUG - Finished converting page batch time=3798.037
2025-06-10 20:17:36,183 - INFO - Finished converting document 10.3390_ijerph16071227_612.pdf in 13.91 sec.
2025-06-10 20:17:36,199 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:36,263 - INFO - Extraction successful row 105, tokens=16758
2025-06-10 20:17:36,310 - INFO - Going to convert document batch...
2025-06-10 20:17:36,310 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:17:36,311 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:17:36,366 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:17:36,438 - DEBUG - [Page 80] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:36,544 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:36,807 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:36,835 - DEBUG - Snippet 10.3389_fphys.2020.00694_591_item_1: generation shape=torch.Size([1, 393])
2025-06-10 20:17:36,837 - DEBUG - Snippet 10.3389_fphys.2020.00694_591_item_1 raw docling: (tokens=47)
<formula><loc_0><loc_0><loc_500><loc_500>O _ { 2 } ^ { - } \cdot + N O \cdot \rightarrow O N O O ^ { - }</formula><end_of_utterance>
2025-06-10 20:17:36,837 - DEBUG - Starting _parse_docling_output
2025-06-10 20:17:36,837 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>O _ { 2 } ^ { - } \cdot + N O \cdot \rightarrow O N O O ^ { - }</formula><end_of_utterance>
2025-06-10 20:17:36,837 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:17:36,837 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>O _ { 2 } ^ { - } \\cdot + N O \\cdot \\rightarrow O N O O ^ { - }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=499x62 at 0x7F96AA477230>)]
2025-06-10 20:17:36,838 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:17:36,839 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=499.0, b=62.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 63))], orig='O _ { 2 } ^ { - } \\cdot + N O \\cdot \\rightarrow O N O O ^ { - }', text='O _ { 2 } ^ { - } \\cdot + N O \\cdot \\rightarrow O N O O ^ { - }', formatting=None, hyperlink=None)]
2025-06-10 20:17:36,840 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:17:36,840 - DEBUG - Processing text item: label=formula, text=O _ { 2 } ^ { - } \cdot + N O \cdot \rightarrow O N O O ^ { - }
2025-06-10 20:17:36,840 - DEBUG - Recognized string extracted: O _ { 2 } ^ { - } \cdot + N O \cdot \rightarrow O N O O ^ { - }
2025-06-10 20:17:36,840 - DEBUG - Generating chat message for label: formula
2025-06-10 20:17:36,841 - DEBUG - Snippet 10.3389_fphys.2020.00694_591_item_2 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:17:36,908 - DEBUG - Snippet 10.3389_fphys.2020.00694_591_item_2 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:17:36,915 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:36,916 - DEBUG - Finished converting page batch time=3798.822
2025-06-10 20:17:36,920 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:36,926 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:36,927 - DEBUG - Finished converting page batch time=3798.833
2025-06-10 20:17:37,064 - INFO - Finished converting document 10.1186_1476-069x-9-3_611.pdf in 15.86 sec.
2025-06-10 20:17:37,153 - INFO - Extraction successful row 104, tokens=20136
2025-06-10 20:17:37,240 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:17:37,254 - INFO - Going to convert document batch...
2025-06-10 20:17:37,255 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:17:37,255 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:17:37,288 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:17:37,294 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:17:37,306 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:17:37,474 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:37,721 - DEBUG - Finished converting page batch time=3799.627
2025-06-10 20:17:37,842 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:37,877 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:37,903 - DEBUG - [Page 81] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:37,954 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:38,010 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:17:38,011 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:17:38,011 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:17:38,052 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:17:38,094 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:17:38,099 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:17:38,143 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:17:38,150 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:17:38,431 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:38,431 - DEBUG - [Page 82] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:38,640 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:38,660 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:38,776 - DEBUG - Snippet 10.3389_fphys.2020.00694_591_item_2: generation shape=torch.Size([1, 407])
2025-06-10 20:17:38,777 - DEBUG - Snippet 10.3389_fphys.2020.00694_591_item_2 raw docling: (tokens=61)
<formula><loc_0><loc_0><loc_500><loc_500>2 H _ { 2 } O _ { 2 } \stackrel { C A T } { \rightarrow } 2 H _ { 2 } O + O _ { 2 }</formula><end_of_utterance>
2025-06-10 20:17:38,777 - DEBUG - Starting _parse_docling_output
2025-06-10 20:17:38,777 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>2 H _ { 2 } O _ { 2 } \stackrel { C A T } { \rightarrow } 2 H _ { 2 } O + O _ { 2 }</formula><end_of_utterance>
2025-06-10 20:17:38,778 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:17:38,778 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>2 H _ { 2 } O _ { 2 } \\stackrel { C A T } { \\rightarrow } 2 H _ { 2 } O + O _ { 2 }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=490x72 at 0x7F96AA477A70>)]
2025-06-10 20:17:38,778 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:17:38,780 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=490.0, b=72.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 83))], orig='2 H _ { 2 } O _ { 2 } \\stackrel { C A T } { \\rightarrow } 2 H _ { 2 } O + O _ { 2 }', text='2 H _ { 2 } O _ { 2 } \\stackrel { C A T } { \\rightarrow } 2 H _ { 2 } O + O _ { 2 }', formatting=None, hyperlink=None)]
2025-06-10 20:17:38,780 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:17:38,780 - DEBUG - Processing text item: label=formula, text=2 H _ { 2 } O _ { 2 } \stackrel { C A T } { \rightarrow } 2 H _ { 2 } O + O _ { 2 }
2025-06-10 20:17:38,780 - DEBUG - Recognized string extracted: 2 H _ { 2 } O _ { 2 } \stackrel { C A T } { \rightarrow } 2 H _ { 2 } O + O _ { 2 }
2025-06-10 20:17:38,781 - DEBUG - Generating chat message for label: formula
2025-06-10 20:17:38,781 - DEBUG - Snippet 10.3389_fphys.2020.00694_591_item_3 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:17:38,781 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:17:38,781 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:17:38,782 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:17:38,817 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:17:38,845 - DEBUG - Snippet 10.3389_fphys.2020.00694_591_item_3 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:17:38,855 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:17:38,928 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:17:38,964 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:17:38,969 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:17:39,000 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:17:39,010 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:17:39,033 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:17:39,172 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:17:39,207 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:17:39,247 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:17:39,301 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:39,350 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:17:39,390 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:17:39,393 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:17:39,510 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:17:39,561 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:39,561 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:17:39,561 - DEBUG - Finished converting page batch time=3801.467
2025-06-10 20:17:39,596 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:17:39,667 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:17:39,754 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:17:39,830 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:17:39,831 - INFO - Processing document 10.20868_upm.thesis.32872_630.pdf
2025-06-10 20:17:39,883 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:39,919 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:39,920 - DEBUG - Finished converting page batch time=3801.826
2025-06-10 20:17:39,951 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:40,011 - DEBUG - [Page 1] Reclassifying cluster 0 from form to TEXT (area ratio: 1.00, cells: 0, density: 0.000000).
2025-06-10 20:17:40,012 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 1
2025-06-10 20:17:40,054 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:17:40,070 - DEBUG - Finished converting page batch time=3801.975
2025-06-10 20:17:40,076 - DEBUG - [Page 83] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:40,077 - DEBUG - Finished converting page batch time=3801.982
2025-06-10 20:17:40,077 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:40,110 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:40,176 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:40,177 - DEBUG - Finished converting page batch time=3802.083
2025-06-10 20:17:40,238 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:17:40,239 - INFO - Processing document 10.18297_etd_3639_629.pdf
2025-06-10 20:17:40,261 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:40,280 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:40,315 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:40,423 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:40,552 - DEBUG - [Page 84] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:40,567 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:40,579 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:40,592 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:40,637 - DEBUG - [Page 2] Reclassifying cluster 0 from form to TEXT (area ratio: 1.00, cells: 0, density: 0.000000).
2025-06-10 20:17:40,638 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 1
2025-06-10 20:17:40,765 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:40,766 - DEBUG - Finished converting page batch time=3802.672
2025-06-10 20:17:40,891 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:40,892 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:40,894 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:40,905 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:40,976 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:41,062 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:41,108 - DEBUG - [Page 85] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:41,135 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:41,321 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:41,322 - DEBUG - Finished converting page batch time=3803.228
2025-06-10 20:17:41,422 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:41,427 - DEBUG - Snippet 10.3389_fphys.2020.00694_591_item_3: generation shape=torch.Size([1, 441])
2025-06-10 20:17:41,429 - DEBUG - Snippet 10.3389_fphys.2020.00694_591_item_3 raw docling: (tokens=95)
<formula><loc_0><loc_0><loc_500><loc_500>C a t a l a s e \left ( F e ^ { 3 + } \right ) + H _ { 2 } O _ { 2 } \to C p d I ^ { + } \left ( F e ^ { 4 + } = 0 \right ) + H _ { 2 } O \quad ( 4 )</formula><end_of_utterance>
2025-06-10 20:17:41,429 - DEBUG - Starting _parse_docling_output
2025-06-10 20:17:41,429 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>C a t a l a s e \left ( F e ^ { 3 + } \right ) + H _ { 2 } O _ { 2 } \to C p d I ^ { + } \left ( F e ^ { 4 + } = 0 \right ) + H _ { 2 } O \quad ( 4 )</formula><end_of_utterance>
2025-06-10 20:17:41,429 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:17:41,430 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>C a t a l a s e \\left ( F e ^ { 3 + } \\right ) + H _ { 2 } O _ { 2 } \\to C p d I ^ { + } \\left ( F e ^ { 4 + } = 0 \\right ) + H _ { 2 } O \\quad ( 4 )</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=687x63 at 0x7F96AA477BF0>)]
2025-06-10 20:17:41,430 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:17:41,432 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=687.0, b=63.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 149))], orig='C a t a l a s e \\left ( F e ^ { 3 + } \\right ) + H _ { 2 } O _ { 2 } \\to C p d I ^ { + } \\left ( F e ^ { 4 + } = 0 \\right ) + H _ { 2 } O \\quad ( 4 )', text='C a t a l a s e \\left ( F e ^ { 3 + } \\right ) + H _ { 2 } O _ { 2 } \\to C p d I ^ { + } \\left ( F e ^ { 4 + } = 0 \\right ) + H _ { 2 } O \\quad ( 4 )', formatting=None, hyperlink=None)]
2025-06-10 20:17:41,433 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:17:41,433 - DEBUG - Processing text item: label=formula, text=C a t a l a s e \left ( F e ^ { 3 + } \right ) + H _ { 2 } O _ { 2 } \to C p d I ^ { + } \left ( F e ^ { 4 + } = 0 \right ) + H _ { 2 } O \quad ( 4 )
2025-06-10 20:17:41,433 - DEBUG - Recognized string extracted: C a t a l a s e \left ( F e ^ { 3 + } \right ) + H _ { 2 } O _ { 2 } \to C p d I ^ { + } \left ( F e ^ { 4 + } = 0 \right ) + H _ { 2 } O \quad ( 4 )
2025-06-10 20:17:41,433 - DEBUG - Generating chat message for label: formula
2025-06-10 20:17:41,434 - DEBUG - Snippet 10.3389_fphys.2020.00694_591_item_4 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:17:41,510 - DEBUG - Snippet 10.3389_fphys.2020.00694_591_item_4 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:17:41,567 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:41,568 - DEBUG - Finished converting page batch time=3803.474
2025-06-10 20:17:41,577 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:41,577 - DEBUG - Finished converting page batch time=3803.483
2025-06-10 20:17:41,596 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:41,767 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:41,771 - DEBUG - Finished converting page batch time=3803.677
2025-06-10 20:17:41,835 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:41,857 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:41,876 - DEBUG - [Page 86] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:41,890 - DEBUG - [Page 12] Reclassifying cluster 1 from document_index to TEXT (area ratio: 0.71, cells: 56, density: 0.000158).
2025-06-10 20:17:41,891 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 1
2025-06-10 20:17:41,894 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:42,017 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:42,084 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:42,129 - DEBUG - [Page 14] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:42,270 - DEBUG - [Page 14] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:42,490 - DEBUG - [Page 87] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:42,491 - DEBUG - Finished converting page batch time=3804.397
2025-06-10 20:17:42,624 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:42,626 - DEBUG - Finished converting page batch time=3804.532
2025-06-10 20:17:42,627 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:42,763 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:42,881 - DEBUG - [Page 15] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:43,052 - DEBUG - [Page 88] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:43,085 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:43,320 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:43,334 - DEBUG - [Page 15] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:43,335 - DEBUG - Finished converting page batch time=3805.241
2025-06-10 20:17:43,386 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:43,455 - DEBUG - Finished converting page batch time=3805.361
2025-06-10 20:17:43,597 - DEBUG - [Page 16] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:43,633 - DEBUG - [Page 16] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:43,643 - DEBUG - [Page 89] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:43,939 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:44,008 - DEBUG - Finished converting page batch time=3805.913
2025-06-10 20:17:44,194 - DEBUG - [Page 17] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:44,195 - DEBUG - [Page 17] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:44,202 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:44,261 - DEBUG - [Page 90] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:44,293 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:44,313 - DEBUG - Snippet 10.3389_fphys.2020.00694_591_item_4: generation shape=torch.Size([1, 445])
2025-06-10 20:17:44,314 - DEBUG - Snippet 10.3389_fphys.2020.00694_591_item_4 raw docling: (tokens=99)
<formula><loc_0><loc_0><loc_500><loc_500>C p d I ^ { + } \left ( F e ^ { 4 + } = 0 \right ) + H _ { 2 } O _ { 2 } \to \hat { C a l a s l e } \left ( F e ^ { 3 + } \right ) + H _ { 2 } O + O _ { 2 }</formula><end_of_utterance>
2025-06-10 20:17:44,314 - DEBUG - Starting _parse_docling_output
2025-06-10 20:17:44,314 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>C p d I ^ { + } \left ( F e ^ { 4 + } = 0 \right ) + H _ { 2 } O _ { 2 } \to \hat { C a l a s l e } \left ( F e ^ { 3 + } \right ) + H _ { 2 } O + O _ { 2 }</formula><end_of_utterance>
2025-06-10 20:17:44,315 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:17:44,315 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>C p d I ^ { + } \\left ( F e ^ { 4 + } = 0 \\right ) + H _ { 2 } O _ { 2 } \\to \\hat { C a l a s l e } \\left ( F e ^ { 3 + } \\right ) + H _ { 2 } O + O _ { 2 }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=702x110 at 0x7F96AA477DD0>)]
2025-06-10 20:17:44,315 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:17:44,318 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=702.0, b=110.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 156))], orig='C p d I ^ { + } \\left ( F e ^ { 4 + } = 0 \\right ) + H _ { 2 } O _ { 2 } \\to \\hat { C a l a s l e } \\left ( F e ^ { 3 + } \\right ) + H _ { 2 } O + O _ { 2 }', text='C p d I ^ { + } \\left ( F e ^ { 4 + } = 0 \\right ) + H _ { 2 } O _ { 2 } \\to \\hat { C a l a s l e } \\left ( F e ^ { 3 + } \\right ) + H _ { 2 } O + O _ { 2 }', formatting=None, hyperlink=None)]
2025-06-10 20:17:44,319 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:17:44,319 - DEBUG - Processing text item: label=formula, text=C p d I ^ { + } \left ( F e ^ { 4 + } = 0 \right ) + H _ { 2 } O _ { 2 } \to \hat { C a l a s l e } \left ( F e ^ { 3 + } \right ) + H _ { 2 } O + O _ { 2 }
2025-06-10 20:17:44,319 - DEBUG - Recognized string extracted: C p d I ^ { + } \left ( F e ^ { 4 + } = 0 \right ) + H _ { 2 } O _ { 2 } \to \hat { C a l a s l e } \left ( F e ^ { 3 + } \right ) + H _ { 2 } O + O _ { 2 }
2025-06-10 20:17:44,319 - INFO - All done. Returning 5 recognized text results.
2025-06-10 20:17:44,319 - DEBUG - Snippet 10.3389_fphys.2020.00694_591_item_0 recognized text:
2 0 _ { 2 } ^ { - } \cdot + 2 H ^ { + } \stackrel { S O D } { \rightarrow } H _ { 2 } O _ { 2 } + 0 _ { 2 }
2025-06-10 20:17:44,319 - DEBUG - Snippet 10.3389_fphys.2020.00694_591_item_1 recognized text:
O _ { 2 } ^ { - } \cdot + N O \cdot \rightarrow O N O O ^ { - }
2025-06-10 20:17:44,320 - DEBUG - Snippet 10.3389_fphys.2020.00694_591_item_2 recognized text:
2 H _ { 2 } O _ { 2 } \stackrel { C A T } { \rightarrow } 2 H _ { 2 } O + O _ { 2 }
2025-06-10 20:17:44,320 - DEBUG - Snippet 10.3389_fphys.2020.00694_591_item_3 recognized text:
C a t a l a s e \left ( F e ^ { 3 + } \right ) + H _ { 2 } O _ { 2 } \to C p d I ^ { + } \left ( F e ^ { 4 + } = 0 \right ) + H _ { 2 } O \quad ( 4 )
2025-06-10 20:17:44,320 - DEBUG - Snippet 10.3389_fphys.2020.00694_591_item_4 recognized text:
C p d I ^ { + } \left ( F e ^ { 4 + } = 0 \right ) + H _ { 2 } O _ { 2 } \to \hat { C a l a s l e } \left ( F e ^ { 3 + } \right ) + H _ { 2 } O + O _ { 2 }
2025-06-10 20:17:44,327 - INFO - Starting prediction for 4 images with labels: ['formula', 'formula', 'formula', 'formula']
2025-06-10 20:17:44,328 - DEBUG - Generating chat message for label: formula
2025-06-10 20:17:44,328 - DEBUG - Snippet 10.3389_fphys.2020.00694_591_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:17:44,396 - DEBUG - Snippet 10.3389_fphys.2020.00694_591_item_0 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:17:44,400 - DEBUG - [Page 18] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:44,676 - DEBUG - [Page 19] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:44,677 - DEBUG - Finished converting page batch time=3806.582
2025-06-10 20:17:44,927 - DEBUG - [Page 20] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:44,960 - DEBUG - [Page 91] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:44,961 - DEBUG - Finished converting page batch time=3806.867
2025-06-10 20:17:45,077 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:45,089 - DEBUG - [Page 18] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:45,115 - DEBUG - [Page 21] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:45,230 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:45,339 - DEBUG - [Page 22] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:45,520 - DEBUG - [Page 23] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:45,520 - DEBUG - Finished converting page batch time=3807.426
2025-06-10 20:17:45,681 - DEBUG - Finished converting page batch time=3807.587
2025-06-10 20:17:45,781 - DEBUG - [Page 24] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:45,819 - DEBUG - [Page 14] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:45,851 - DEBUG - [Page 19] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:45,852 - DEBUG - Finished converting page batch time=3807.758
2025-06-10 20:17:45,855 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:45,951 - DEBUG - [Page 15] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:45,952 - DEBUG - Finished converting page batch time=3807.858
2025-06-10 20:17:45,997 - DEBUG - [Page 92] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:46,052 - DEBUG - [Page 25] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:46,099 - DEBUG - [Page 14] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:46,178 - INFO - Finished converting document 10.3390_atmos15030380_624.pdf in 17.20 sec.
2025-06-10 20:17:46,288 - DEBUG - [Page 26] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:46,369 - INFO - Extraction successful row 107, tokens=18499
2025-06-10 20:17:46,439 - DEBUG - Snippet 10.3389_fphys.2020.00694_591_item_0: generation shape=torch.Size([1, 411])
2025-06-10 20:17:46,440 - DEBUG - Snippet 10.3389_fphys.2020.00694_591_item_0 raw docling: (tokens=65)
<formula><loc_0><loc_0><loc_500><loc_500>H _ { 2 } O _ { 2 } + 2 G S H \stackrel { G P x } { \rightarrow } 2 H _ { 2 } O + G S - S G</formula><end_of_utterance>
2025-06-10 20:17:46,440 - DEBUG - Starting _parse_docling_output
2025-06-10 20:17:46,440 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>H _ { 2 } O _ { 2 } + 2 G S H \stackrel { G P x } { \rightarrow } 2 H _ { 2 } O + G S - S G</formula><end_of_utterance>
2025-06-10 20:17:46,441 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:17:46,441 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>H _ { 2 } O _ { 2 } + 2 G S H \\stackrel { G P x } { \\rightarrow } 2 H _ { 2 } O + G S - S G</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=569x72 at 0x7F96DBABB410>)]
2025-06-10 20:17:46,441 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:17:46,444 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=569.0, b=72.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 91))], orig='H _ { 2 } O _ { 2 } + 2 G S H \\stackrel { G P x } { \\rightarrow } 2 H _ { 2 } O + G S - S G', text='H _ { 2 } O _ { 2 } + 2 G S H \\stackrel { G P x } { \\rightarrow } 2 H _ { 2 } O + G S - S G', formatting=None, hyperlink=None)]
2025-06-10 20:17:46,444 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:17:46,445 - DEBUG - Processing text item: label=formula, text=H _ { 2 } O _ { 2 } + 2 G S H \stackrel { G P x } { \rightarrow } 2 H _ { 2 } O + G S - S G
2025-06-10 20:17:46,445 - DEBUG - Recognized string extracted: H _ { 2 } O _ { 2 } + 2 G S H \stackrel { G P x } { \rightarrow } 2 H _ { 2 } O + G S - S G
2025-06-10 20:17:46,445 - DEBUG - Generating chat message for label: formula
2025-06-10 20:17:46,445 - DEBUG - Snippet 10.3389_fphys.2020.00694_591_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:17:46,477 - DEBUG - [Page 27] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:46,478 - DEBUG - Finished converting page batch time=3808.383
2025-06-10 20:17:46,485 - INFO - Going to convert document batch...
2025-06-10 20:17:46,486 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:17:46,486 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:17:46,515 - DEBUG - Snippet 10.3389_fphys.2020.00694_591_item_1 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:17:46,535 - DEBUG - [Page 20] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:46,540 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:17:46,712 - DEBUG - [Page 93] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:46,777 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:46,939 - DEBUG - [Page 14] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:47,118 - DEBUG - [Page 15] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:47,149 - DEBUG - [Page 15] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:47,150 - DEBUG - Finished converting page batch time=3809.056
2025-06-10 20:17:47,184 - DEBUG - [Page 28] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:47,214 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:17:47,264 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:17:47,271 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:17:47,308 - DEBUG - [Page 21] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:47,380 - DEBUG - [Page 94] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:47,397 - DEBUG - [Page 16] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:47,431 - DEBUG - [Page 29] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:47,499 - DEBUG - Finished converting page batch time=3809.405
2025-06-10 20:17:47,716 - DEBUG - [Page 30] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:47,837 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:17:47,838 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:17:47,838 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:17:47,865 - DEBUG - [Page 16] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:47,873 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:17:47,911 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:17:47,948 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:17:47,967 - DEBUG - [Page 31] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:47,968 - DEBUG - Finished converting page batch time=3809.873
2025-06-10 20:17:47,988 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:17:48,004 - DEBUG - [Page 17] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:48,029 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:17:48,127 - DEBUG - [Page 95] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:48,128 - DEBUG - Finished converting page batch time=3810.033
2025-06-10 20:17:48,219 - DEBUG - [Page 22] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:48,228 - DEBUG - [Page 32] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:48,238 - DEBUG - Snippet 10.3389_fphys.2020.00694_591_item_1: generation shape=torch.Size([1, 407])
2025-06-10 20:17:48,238 - DEBUG - Snippet 10.3389_fphys.2020.00694_591_item_1 raw docling: (tokens=61)
<formula><loc_0><loc_0><loc_500><loc_500>R O O H + 2 G S H \stackrel { G P _ { x } } { \to } R O H + H _ { 2 } O + G S - S G</formula><end_of_utterance>
2025-06-10 20:17:48,239 - DEBUG - Starting _parse_docling_output
2025-06-10 20:17:48,239 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>R O O H + 2 G S H \stackrel { G P _ { x } } { \to } R O H + H _ { 2 } O + G S - S G</formula><end_of_utterance>
2025-06-10 20:17:48,239 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:17:48,239 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>R O O H + 2 G S H \\stackrel { G P _ { x } } { \\to } R O H + H _ { 2 } O + G S - S G</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=615x73 at 0x7F96AED6BE00>)]
2025-06-10 20:17:48,240 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:17:48,242 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=615.0, b=73.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 83))], orig='R O O H + 2 G S H \\stackrel { G P _ { x } } { \\to } R O H + H _ { 2 } O + G S - S G', text='R O O H + 2 G S H \\stackrel { G P _ { x } } { \\to } R O H + H _ { 2 } O + G S - S G', formatting=None, hyperlink=None)]
2025-06-10 20:17:48,242 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:17:48,242 - DEBUG - Processing text item: label=formula, text=R O O H + 2 G S H \stackrel { G P _ { x } } { \to } R O H + H _ { 2 } O + G S - S G
2025-06-10 20:17:48,242 - DEBUG - Recognized string extracted: R O O H + 2 G S H \stackrel { G P _ { x } } { \to } R O H + H _ { 2 } O + G S - S G
2025-06-10 20:17:48,242 - DEBUG - Generating chat message for label: formula
2025-06-10 20:17:48,243 - DEBUG - Snippet 10.3389_fphys.2020.00694_591_item_2 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:17:48,256 - DEBUG - [Page 18] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:48,308 - DEBUG - Snippet 10.3389_fphys.2020.00694_591_item_2 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:17:48,388 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:17:48,467 - DEBUG - [Page 33] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:48,533 - DEBUG - [Page 19] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:48,534 - DEBUG - Finished converting page batch time=3810.439
2025-06-10 20:17:48,540 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:17:48,586 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:17:48,628 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:17:48,641 - DEBUG - [Page 34] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:48,793 - DEBUG - [Page 20] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:48,811 - DEBUG - [Page 96] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:48,839 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:17:48,889 - DEBUG - [Page 35] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:48,889 - DEBUG - Finished converting page batch time=3810.795
2025-06-10 20:17:48,994 - DEBUG - [Page 23] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:49,038 - DEBUG - [Page 21] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:49,124 - DEBUG - [Page 36] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:49,150 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:17:49,248 - DEBUG - [Page 37] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:49,319 - DEBUG - [Page 22] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:49,381 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:17:49,381 - INFO - Processing document 10.1186_s12940-021-00708-z_631.pdf
2025-06-10 20:17:49,486 - DEBUG - [Page 38] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:49,549 - DEBUG - Finished converting page batch time=3811.455
2025-06-10 20:17:49,609 - DEBUG - [Page 23] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:49,609 - DEBUG - Finished converting page batch time=3811.515
2025-06-10 20:17:49,612 - DEBUG - [Page 39] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:49,612 - DEBUG - Finished converting page batch time=3811.518
2025-06-10 20:17:49,784 - DEBUG - [Page 24] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:49,834 - DEBUG - [Page 40] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:49,896 - DEBUG - [Page 24] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:49,992 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:50,028 - DEBUG - [Page 41] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:50,044 - DEBUG - [Page 25] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:50,172 - DEBUG - [Page 25] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:50,335 - DEBUG - Snippet 10.3389_fphys.2020.00694_591_item_2: generation shape=torch.Size([1, 418])
2025-06-10 20:17:50,336 - DEBUG - Snippet 10.3389_fphys.2020.00694_591_item_2 raw docling: (tokens=72)
<formula><loc_0><loc_0><loc_500><loc_500>R D X _ { r e d u c e d } + H _ { 2 } O _ { 2 } \to P R D X _ { o x i d i z e d } + 2 H _ { 2 } O</formula><end_of_utterance>
2025-06-10 20:17:50,336 - DEBUG - Starting _parse_docling_output
2025-06-10 20:17:50,336 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>R D X _ { r e d u c e d } + H _ { 2 } O _ { 2 } \to P R D X _ { o x i d i z e d } + 2 H _ { 2 } O</formula><end_of_utterance>
2025-06-10 20:17:50,337 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:17:50,337 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>R D X _ { r e d u c e d } + H _ { 2 } O _ { 2 } \\to P R D X _ { o x i d i z e d } + 2 H _ { 2 } O</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=617x53 at 0x7F96BA16E5A0>)]
2025-06-10 20:17:50,337 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:17:50,339 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=617.0, b=53.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 97))], orig='R D X _ { r e d u c e d } + H _ { 2 } O _ { 2 } \\to P R D X _ { o x i d i z e d } + 2 H _ { 2 } O', text='R D X _ { r e d u c e d } + H _ { 2 } O _ { 2 } \\to P R D X _ { o x i d i z e d } + 2 H _ { 2 } O', formatting=None, hyperlink=None)]
2025-06-10 20:17:50,339 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:17:50,340 - DEBUG - Processing text item: label=formula, text=R D X _ { r e d u c e d } + H _ { 2 } O _ { 2 } \to P R D X _ { o x i d i z e d } + 2 H _ { 2 } O
2025-06-10 20:17:50,340 - DEBUG - Recognized string extracted: R D X _ { r e d u c e d } + H _ { 2 } O _ { 2 } \to P R D X _ { o x i d i z e d } + 2 H _ { 2 } O
2025-06-10 20:17:50,340 - DEBUG - Generating chat message for label: formula
2025-06-10 20:17:50,340 - DEBUG - Snippet 10.3389_fphys.2020.00694_591_item_3 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:17:50,410 - DEBUG - Snippet 10.3389_fphys.2020.00694_591_item_3 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:17:50,424 - DEBUG - [Page 26] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:50,813 - DEBUG - [Page 97] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:50,821 - DEBUG - [Page 26] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:50,865 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:51,098 - DEBUG - [Page 27] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:51,099 - DEBUG - Finished converting page batch time=3813.005
2025-06-10 20:17:51,209 - DEBUG - [Page 42] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:51,345 - DEBUG - [Page 28] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:51,399 - DEBUG - [Page 43] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:51,400 - DEBUG - Finished converting page batch time=3813.305
2025-06-10 20:17:51,563 - DEBUG - [Page 98] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:51,585 - DEBUG - [Page 29] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:51,590 - DEBUG - [Page 27] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:51,639 - DEBUG - [Page 44] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:51,830 - DEBUG - [Page 30] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:51,964 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:52,143 - DEBUG - [Page 31] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:52,144 - DEBUG - Finished converting page batch time=3814.050
2025-06-10 20:17:52,144 - DEBUG - Finished converting page batch time=3814.050
2025-06-10 20:17:52,304 - DEBUG - [Page 45] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:52,319 - DEBUG - [Page 99] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:52,320 - DEBUG - Finished converting page batch time=3814.226
2025-06-10 20:17:52,378 - DEBUG - [Page 28] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:52,382 - DEBUG - [Page 32] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:52,583 - DEBUG - Snippet 10.3389_fphys.2020.00694_591_item_3: generation shape=torch.Size([1, 425])
2025-06-10 20:17:52,584 - DEBUG - Snippet 10.3389_fphys.2020.00694_591_item_3 raw docling: (tokens=79)
<formula><loc_0><loc_0><loc_500><loc_500>P R D X _ { o x i d i z e d } + T r x _ { r e d u c e d } \to P R D X _ { r e d u c e d } + T r x _ { o x i d i z e d }</formula><end_of_utterance>
2025-06-10 20:17:52,584 - DEBUG - Starting _parse_docling_output
2025-06-10 20:17:52,584 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>P R D X _ { o x i d i z e d } + T r x _ { r e d u c e d } \to P R D X _ { r e d u c e d } + T r x _ { o x i d i z e d }</formula><end_of_utterance>
2025-06-10 20:17:52,584 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:17:52,585 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>P R D X _ { o x i d i z e d } + T r x _ { r e d u c e d } \\to P R D X _ { r e d u c e d } + T r x _ { o x i d i z e d }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=687x54 at 0x7F96BA16E120>)]
2025-06-10 20:17:52,585 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:17:52,587 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=687.0, b=54.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 119))], orig='P R D X _ { o x i d i z e d } + T r x _ { r e d u c e d } \\to P R D X _ { r e d u c e d } + T r x _ { o x i d i z e d }', text='P R D X _ { o x i d i z e d } + T r x _ { r e d u c e d } \\to P R D X _ { r e d u c e d } + T r x _ { o x i d i z e d }', formatting=None, hyperlink=None)]
2025-06-10 20:17:52,587 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:17:52,588 - DEBUG - Processing text item: label=formula, text=P R D X _ { o x i d i z e d } + T r x _ { r e d u c e d } \to P R D X _ { r e d u c e d } + T r x _ { o x i d i z e d }
2025-06-10 20:17:52,588 - DEBUG - Recognized string extracted: P R D X _ { o x i d i z e d } + T r x _ { r e d u c e d } \to P R D X _ { r e d u c e d } + T r x _ { o x i d i z e d }
2025-06-10 20:17:52,588 - INFO - All done. Returning 4 recognized text results.
2025-06-10 20:17:52,588 - DEBUG - Snippet 10.3389_fphys.2020.00694_591_item_0 recognized text:
H _ { 2 } O _ { 2 } + 2 G S H \stackrel { G P x } { \rightarrow } 2 H _ { 2 } O + G S - S G
2025-06-10 20:17:52,588 - DEBUG - Snippet 10.3389_fphys.2020.00694_591_item_1 recognized text:
R O O H + 2 G S H \stackrel { G P _ { x } } { \to } R O H + H _ { 2 } O + G S - S G
2025-06-10 20:17:52,589 - DEBUG - Snippet 10.3389_fphys.2020.00694_591_item_2 recognized text:
R D X _ { r e d u c e d } + H _ { 2 } O _ { 2 } \to P R D X _ { o x i d i z e d } + 2 H _ { 2 } O
2025-06-10 20:17:52,589 - DEBUG - Snippet 10.3389_fphys.2020.00694_591_item_3 recognized text:
P R D X _ { o x i d i z e d } + T r x _ { r e d u c e d } \to P R D X _ { r e d u c e d } + T r x _ { o x i d i z e d }
2025-06-10 20:17:52,609 - DEBUG - [Page 29] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:52,643 - DEBUG - [Page 33] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:52,718 - DEBUG - [Page 30] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:52,748 - DEBUG - [Page 34] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:52,812 - INFO - Finished converting document 10.3389_fphys.2020.00694_591.pdf in 53.63 sec.
2025-06-10 20:17:52,914 - DEBUG - [Page 35] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:52,915 - DEBUG - Finished converting page batch time=3814.821
2025-06-10 20:17:52,963 - DEBUG - Finished converting page batch time=3814.868
2025-06-10 20:17:53,054 - DEBUG - [Page 100] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:53,061 - DEBUG - [Page 22] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:53,123 - INFO - Finished converting document 10.30955_gnj.005358_627.pdf in 20.57 sec.
2025-06-10 20:17:53,131 - DEBUG - [Page 36] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:53,171 - INFO - Extraction successful row 100, tokens=34277
2025-06-10 20:17:53,197 - INFO - Going to convert document batch...
2025-06-10 20:17:53,197 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:17:53,197 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:17:53,241 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:53,242 - DEBUG - Finished converting page batch time=3815.147
2025-06-10 20:17:53,242 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:17:53,369 - DEBUG - [Page 37] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:53,402 - INFO - Extraction successful row 108, tokens=27033
2025-06-10 20:17:53,441 - INFO - Going to convert document batch...
2025-06-10 20:17:53,442 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:17:53,442 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:17:53,493 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:17:53,502 - DEBUG - [Page 38] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:53,647 - DEBUG - [Page 101] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:53,893 - DEBUG - [Page 102] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:53,894 - DEBUG - Finished converting page batch time=3815.800
2025-06-10 20:17:53,903 - DEBUG - [Page 39] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:53,904 - DEBUG - Finished converting page batch time=3815.810
2025-06-10 20:17:53,983 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:17:54,026 - DEBUG - [Page 40] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:54,033 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:17:54,040 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:17:54,128 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:54,260 - DEBUG - Creating masked image for page 56 with 17 clusters.
2025-06-10 20:17:54,268 - INFO - Masked image successfully created for page 56.
2025-06-10 20:17:54,272 - INFO - Starting prediction for 1 images with labels: ['formula']
2025-06-10 20:17:54,272 - DEBUG - Generating chat message for label: formula
2025-06-10 20:17:54,273 - DEBUG - Snippet 10.1116_1.2815690_576_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:17:54,361 - DEBUG - Snippet 10.1116_1.2815690_576_item_0 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:17:54,570 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:17:54,624 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:17:54,624 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:17:54,625 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:17:54,642 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:17:54,648 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:17:54,660 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:17:54,697 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:17:54,724 - DEBUG - [Page 41] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:54,733 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:17:54,770 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:17:54,811 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:17:54,869 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:17:54,974 - DEBUG - [Page 42] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:55,012 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:17:55,059 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:17:55,176 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:17:55,283 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:17:55,284 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:17:55,284 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:17:55,318 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:17:55,323 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:17:55,330 - DEBUG - [Page 43] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:55,331 - DEBUG - Finished converting page batch time=3817.236
2025-06-10 20:17:55,360 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:17:55,395 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:17:55,433 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:17:55,471 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:17:55,507 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:17:55,612 - DEBUG - [Page 44] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:55,619 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:17:55,636 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:17:55,673 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:17:55,715 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:17:55,832 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:17:55,833 - INFO - Processing document 10.3390_nu7125539_632.pdf
2025-06-10 20:17:55,863 - DEBUG - [Page 45] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:55,882 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:17:56,004 - DEBUG - [Page 46] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:56,109 - DEBUG - [Page 17] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:56,158 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:17:56,218 - DEBUG - [Page 47] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:56,219 - DEBUG - Finished converting page batch time=3818.125
2025-06-10 20:17:56,289 - DEBUG - Snippet 10.1116_1.2815690_576_item_0: generation shape=torch.Size([1, 413])
2025-06-10 20:17:56,290 - DEBUG - Snippet 10.1116_1.2815690_576_item_0 raw docling: (tokens=67)
<formula><loc_0><loc_0><loc_500><loc_500> O _ { 2 } ^ { - } + H _ { 2 } O _ { 2 } { \longrightarrow } \cdot O H + O H ^ { - } + O _ { 2 }</formula><end_of_utterance>
2025-06-10 20:17:56,291 - DEBUG - Starting _parse_docling_output
2025-06-10 20:17:56,291 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500> O _ { 2 } ^ { - } + H _ { 2 } O _ { 2 } { \longrightarrow } \cdot O H + O H ^ { - } + O _ { 2 }</formula><end_of_utterance>
2025-06-10 20:17:56,291 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:17:56,291 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500> O _ { 2 } ^ { - } + H _ { 2 } O _ { 2 } { \\longrightarrow } \\cdot O H + O H ^ { - } + O _ { 2 }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=427x85 at 0x7F9680927020>)]
2025-06-10 20:17:56,292 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:17:56,293 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=427.0, b=85.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 97))], orig=' O _ { 2 } ^ { - } + H _ { 2 } O _ { 2 } { \\longrightarrow } \\cdot O H + O H ^ { - } + O _ { 2 }', text=' O _ { 2 } ^ { - } + H _ { 2 } O _ { 2 } { \\longrightarrow } \\cdot O H + O H ^ { - } + O _ { 2 }', formatting=None, hyperlink=None)]
2025-06-10 20:17:56,294 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:17:56,294 - DEBUG - Processing text item: label=formula, text= O _ { 2 } ^ { - } + H _ { 2 } O _ { 2 } { \longrightarrow } \cdot O H + O H ^ { - } + O _ { 2 }
2025-06-10 20:17:56,294 - DEBUG - Recognized string extracted:  O _ { 2 } ^ { - } + H _ { 2 } O _ { 2 } { \longrightarrow } \cdot O H + O H ^ { - } + O _ { 2 }
2025-06-10 20:17:56,295 - INFO - All done. Returning 1 recognized text results.
2025-06-10 20:17:56,295 - DEBUG - Snippet 10.1116_1.2815690_576_item_0 recognized text:
 O _ { 2 } ^ { - } + H _ { 2 } O _ { 2 } { \longrightarrow } \cdot O H + O H ^ { - } + O _ { 2 }
2025-06-10 20:17:56,377 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:17:56,377 - INFO - Processing document 10.3390_ijerph13040378_634.pdf
2025-06-10 20:17:56,534 - DEBUG - [Page 48] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:56,546 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:56,764 - DEBUG - [Page 46] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:56,834 - DEBUG - [Page 18] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:56,908 - INFO - Finished converting document 10.1116_1.2815690_576.pdf in 65.09 sec.
2025-06-10 20:17:56,940 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:56,940 - DEBUG - [Page 19] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:56,941 - DEBUG - Finished converting page batch time=3818.847
2025-06-10 20:17:57,067 - DEBUG - [Page 20] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:57,191 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:57,403 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:57,631 - DEBUG - [Page 47] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:57,631 - DEBUG - Finished converting page batch time=3819.537
2025-06-10 20:17:57,826 - DEBUG - [Page 48] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:57,952 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:58,010 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:58,062 - DEBUG - [Page 49] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:58,082 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:58,224 - DEBUG - [Page 49] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:58,484 - DEBUG - [Page 21] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:58,514 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:58,861 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:58,861 - DEBUG - Finished converting page batch time=3820.767
2025-06-10 20:17:58,931 - DEBUG - [Page 50] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:59,092 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:59,092 - DEBUG - Finished converting page batch time=3820.998
2025-06-10 20:17:59,190 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:59,348 - DEBUG - [Page 50] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:59,425 - DEBUG - [Page 51] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:59,426 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:59,426 - DEBUG - Finished converting page batch time=3821.332
2025-06-10 20:17:59,503 - DEBUG - [Page 52] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:59,533 - DEBUG - Finished converting page batch time=3821.438
2025-06-10 20:17:59,690 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:59,774 - DEBUG - [Page 53] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:57,709 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:57,761 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:57,780 - DEBUG - [Page 54] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:58,013 - DEBUG - [Page 22] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:58,014 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:58,396 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:58,931 - DEBUG - [Page 55] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:58,945 - INFO - Extraction successful row 98, tokens=85564
2025-06-10 20:17:58,968 - INFO - Going to convert document batch...
2025-06-10 20:17:58,968 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:17:58,968 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:17:59,104 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:59,122 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:59,138 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:17:59,366 - DEBUG - [Page 23] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:59,370 - DEBUG - Finished converting page batch time=3823.497
2025-06-10 20:17:59,440 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:59,512 - DEBUG - Finished converting page batch time=3823.639
2025-06-10 20:17:59,661 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:17:59,858 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:17:59,901 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:17:59,907 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:17:59,962 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:00,066 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:00,235 - DEBUG - Finished converting page batch time=3824.362
2025-06-10 20:18:00,256 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:00,257 - DEBUG - Finished converting page batch time=3824.384
2025-06-10 20:18:00,309 - DEBUG - [Page 23] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:00,444 - DEBUG - [Page 51] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:00,447 - DEBUG - Finished converting page batch time=3824.575
2025-06-10 20:18:00,538 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:00,574 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:18:00,575 - DEBUG - Finished converting page batch time=3824.702
2025-06-10 20:18:00,575 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:18:00,575 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:18:00,625 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:18:00,627 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:00,665 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:18:00,701 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:18:00,708 - DEBUG - [Page 24] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:00,712 - DEBUG - [Page 56] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:00,738 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:18:00,747 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:00,775 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:18:00,814 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:18:00,953 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:18:00,990 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:18:01,028 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:18:01,029 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:01,188 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:18:01,199 - DEBUG - Finished converting page batch time=3825.327
2025-06-10 20:18:01,482 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:18:01,614 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:01,653 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:18:01,654 - INFO - Processing document 10.3390_ijerph13070728_635.pdf
2025-06-10 20:18:01,686 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:01,978 - DEBUG - [Page 25] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:02,209 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:02,301 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:02,302 - DEBUG - Finished converting page batch time=3826.430
2025-06-10 20:18:02,453 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:02,500 - DEBUG - [Page 57] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:02,811 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:02,838 - DEBUG - [Page 24] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:02,899 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:03,081 - DEBUG - [Page 14] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:03,486 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:03,941 - DEBUG - Dynamic vertical threshold: 63.844199999999994, Overlap threshold: 0.7
2025-06-10 20:18:03,942 - DEBUG - Checking merge:
  Current: 5, Next: 6
2025-06-10 20:18:03,942 - DEBUG -   Vertical gap: 12.949999999999989, Overlap ratio: 1.0
2025-06-10 20:18:03,942 - DEBUG -   Left boundary diff: 27.24600000000001, Right boundary diff: 0.0
2025-06-10 20:18:03,942 - DEBUG -   Alignment factor (ratio): 0.09199073542619068
2025-06-10 20:18:03,943 - DEBUG -   -> c1 5 formula number: 1, c2 6 formula number: 2
2025-06-10 20:18:03,943 - DEBUG -   -> Not merging clusters 5 and 6 due to different formula numbers: 1 vs 2
2025-06-10 20:18:03,943 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:03,944 - DEBUG - Finished converting page batch time=3828.072
2025-06-10 20:18:04,036 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:04,355 - DEBUG - [Page 26] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:04,377 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:04,457 - DEBUG - [Page 25] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:04,507 - DEBUG - [Page 58] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:04,520 - DEBUG - [Page 15] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:04,521 - DEBUG - Finished converting page batch time=3828.649
2025-06-10 20:18:04,612 - DEBUG - [Page 14] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:04,695 - DEBUG - [Page 52] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:05,089 - DEBUG - [Page 53] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:05,219 - DEBUG - [Page 15] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:05,220 - DEBUG - Finished converting page batch time=3829.347
2025-06-10 20:18:05,426 - DEBUG - [Page 16] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:05,429 - DEBUG - [Page 59] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:05,430 - DEBUG - Finished converting page batch time=3829.558
2025-06-10 20:18:05,594 - DEBUG - [Page 27] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:05,595 - DEBUG - Finished converting page batch time=3829.723
2025-06-10 20:18:05,630 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:05,644 - DEBUG - [Page 26] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:05,678 - DEBUG - [Page 60] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:05,917 - DEBUG - [Page 61] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:05,935 - DEBUG - [Page 16] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:06,107 - DEBUG - [Page 27] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:06,108 - DEBUG - Finished converting page batch time=3830.235
2025-06-10 20:18:06,162 - DEBUG - [Page 62] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:06,307 - DEBUG - [Page 63] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:06,485 - DEBUG - [Page 17] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:06,659 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:06,762 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:06,763 - DEBUG - Finished converting page batch time=3830.891
2025-06-10 20:18:06,887 - DEBUG - [Page 18] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:06,888 - DEBUG - Finished converting page batch time=3831.016
2025-06-10 20:18:06,897 - DEBUG - [Page 17] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:06,919 - DEBUG - Finished converting page batch time=3831.046
2025-06-10 20:18:07,004 - DEBUG - [Page 28] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:07,056 - INFO - Finished converting document 10.3390_nu7125539_632.pdf in 16.11 sec.
2025-06-10 20:18:07,142 - DEBUG - [Page 64] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:07,214 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:07,230 - DEBUG - [Page 28] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:07,245 - INFO - Extraction successful row 113, tokens=23752
2025-06-10 20:18:07,276 - INFO - Going to convert document batch...
2025-06-10 20:18:07,276 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:18:07,276 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:18:07,339 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:18:07,538 - DEBUG - [Page 54] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:07,797 - DEBUG - [Page 55] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:07,798 - DEBUG - Finished converting page batch time=3831.925
2025-06-10 20:18:08,062 - DEBUG - [Page 56] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:08,201 - DEBUG - [Page 29] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:08,417 - DEBUG - [Page 30] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:08,469 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:18:08,512 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:18:08,519 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:18:08,747 - DEBUG - [Page 65] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:08,771 - DEBUG - [Page 18] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:08,866 - DEBUG - [Page 31] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:08,867 - DEBUG - Finished converting page batch time=3832.995
2025-06-10 20:18:08,915 - DEBUG - [Page 29] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:09,196 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:18:09,197 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:18:09,197 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:18:09,233 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:18:09,236 - DEBUG - [Page 32] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:09,272 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:18:09,316 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:18:09,362 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:18:09,409 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:18:09,444 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:18:09,577 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:18:09,615 - DEBUG - [Page 66] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:09,616 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:18:09,734 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:18:09,765 - DEBUG - [Page 33] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:09,886 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:18:10,104 - DEBUG - [Page 34] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:10,189 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:18:10,270 - DEBUG - [Page 19] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:10,272 - DEBUG - Finished converting page batch time=3834.399
2025-06-10 20:18:10,374 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:18:10,375 - INFO - Processing document 10.1093_exposome_osae001_637.pdf
2025-06-10 20:18:10,425 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:10,576 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:10,626 - INFO - Finished converting document 10.1186_s12940-021-00708-z_631.pdf in 26.48 sec.
2025-06-10 20:18:10,801 - DEBUG - [Page 35] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:10,802 - DEBUG - Finished converting page batch time=3834.930
2025-06-10 20:18:10,878 - INFO - Extraction successful row 112, tokens=27563
2025-06-10 20:18:10,906 - INFO - Going to convert document batch...
2025-06-10 20:18:10,906 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:18:10,907 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:18:10,954 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:18:11,069 - DEBUG - [Page 30] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:11,390 - DEBUG - [Page 67] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:11,391 - DEBUG - Finished converting page batch time=3835.519
2025-06-10 20:18:11,451 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:11,461 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:11,463 - DEBUG - Finished converting page batch time=3835.590
2025-06-10 20:18:11,555 - DEBUG - [Page 68] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:11,630 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:18:11,675 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:18:11,681 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:18:11,702 - DEBUG - [Page 69] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:12,099 - DEBUG - [Page 57] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:12,170 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:12,362 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:18:12,363 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:18:12,363 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:18:12,373 - DEBUG - [Page 58] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:12,397 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:18:12,436 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:18:12,467 - DEBUG - [Page 36] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:12,471 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:18:12,508 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:18:12,548 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:18:12,649 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:18:12,693 - DEBUG - [Page 70] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:12,788 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:12,792 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:18:12,824 - DEBUG - [Page 37] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:12,831 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:18:12,869 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:18:13,016 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:18:13,255 - DEBUG - [Page 59] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:13,311 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:18:13,334 - DEBUG - Dynamic vertical threshold: 27.9909, Overlap threshold: 0.7
2025-06-10 20:18:13,340 - DEBUG - Checking merge:
  Current: 13, Next: 12
2025-06-10 20:18:13,342 - DEBUG -   Vertical gap: 19.735000000000014, Overlap ratio: 1.0
2025-06-10 20:18:13,342 - DEBUG -   Left boundary diff: 6.3500000000000085, Right boundary diff: 0.0
2025-06-10 20:18:13,342 - DEBUG -   Alignment factor (ratio): 0.036728343291438016
2025-06-10 20:18:13,342 - DEBUG -   -> c1 13 formula number: 3, c2 12 formula number: 4
2025-06-10 20:18:13,343 - DEBUG -   -> Not merging clusters 13 and 12 due to different formula numbers: 3 vs 4
2025-06-10 20:18:13,343 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:13,373 - DEBUG - [Page 38] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:13,535 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:18:13,536 - INFO - Processing document 10.3390_ijerph181910386_639.pdf
2025-06-10 20:18:13,632 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:13,644 - DEBUG - Finished converting page batch time=3837.771
2025-06-10 20:18:13,676 - DEBUG - [Page 31] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:13,677 - DEBUG - Finished converting page batch time=3837.804
2025-06-10 20:18:13,700 - DEBUG - [Page 14] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:13,931 - DEBUG - [Page 39] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:13,932 - DEBUG - Finished converting page batch time=3838.059
2025-06-10 20:18:13,952 - DEBUG - [Page 60] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:14,078 - DEBUG - [Page 61] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:14,206 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:14,207 - DEBUG - Finished converting page batch time=3838.335
2025-06-10 20:18:14,238 - DEBUG - [Page 62] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:14,349 - DEBUG - [Page 15] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:14,351 - DEBUG - Finished converting page batch time=3838.478
2025-06-10 20:18:14,369 - DEBUG - [Page 71] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:14,387 - DEBUG - [Page 63] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:14,388 - DEBUG - Finished converting page batch time=3838.516
2025-06-10 20:18:14,411 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:14,528 - DEBUG - [Page 40] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:14,576 - DEBUG - [Page 16] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:14,576 - DEBUG - Finished converting page batch time=3838.704
2025-06-10 20:18:14,646 - DEBUG - [Page 64] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:14,741 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:14,773 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:14,775 - DEBUG - Finished converting page batch time=3838.903
2025-06-10 20:18:15,016 - DEBUG - [Page 65] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:15,098 - DEBUG - Finished converting page batch time=3839.226
2025-06-10 20:18:15,120 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:15,249 - INFO - Finished converting document 10.3390_ijerph13040378_634.pdf in 24.07 sec.
2025-06-10 20:18:15,386 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:15,436 - INFO - Extraction successful row 114, tokens=31820
2025-06-10 20:18:15,496 - INFO - Going to convert document batch...
2025-06-10 20:18:15,496 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:18:15,497 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:18:15,547 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:18:15,661 - DEBUG - [Page 41] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:15,808 - DEBUG - [Page 5] Reclassifying cluster 0 from table to TEXT (area ratio: 0.72, cells: 244, density: 0.000729).
2025-06-10 20:18:15,809 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 1
2025-06-10 20:18:16,000 - DEBUG - [Page 42] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:16,013 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:16,019 - DEBUG - [Page 72] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:16,220 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:16,238 - DEBUG - [Page 32] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:16,239 - DEBUG - [Page 66] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:16,320 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:18:16,366 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:18:16,373 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:18:16,380 - DEBUG - [Page 14] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:16,381 - DEBUG - Finished converting page batch time=3840.508
2025-06-10 20:18:16,449 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:16,450 - DEBUG - Finished converting page batch time=3840.578
2025-06-10 20:18:16,522 - DEBUG - [Page 6] Reclassifying cluster 0 from table to TEXT (area ratio: 0.72, cells: 240, density: 0.000718).
2025-06-10 20:18:16,529 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 1
2025-06-10 20:18:16,537 - DEBUG - Creating masked image for page 3 with 14 clusters.
2025-06-10 20:18:16,538 - INFO - Masked image successfully created for page 3.
2025-06-10 20:18:16,543 - INFO - Starting prediction for 2 images with labels: ['formula', 'formula']
2025-06-10 20:18:16,549 - DEBUG - Generating chat message for label: formula
2025-06-10 20:18:16,553 - DEBUG - Snippet 10.3390_ijerph13070728_635_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:18:16,629 - DEBUG - Snippet 10.3390_ijerph13070728_635_item_0 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:18:16,693 - DEBUG - [Page 43] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:16,694 - DEBUG - Finished converting page batch time=3840.822
2025-06-10 20:18:16,826 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:18:16,827 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:18:16,827 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:18:16,861 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:18:16,897 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:18:16,933 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:18:16,976 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:18:17,008 - DEBUG - [Page 44] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:17,027 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:17,029 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:18:17,075 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:18:17,261 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:18:17,297 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:18:17,337 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:18:17,425 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:17,519 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:18:17,559 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:17,675 - DEBUG - Finished converting page batch time=3841.803
2025-06-10 20:18:17,795 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:18:17,996 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:18:17,996 - INFO - Processing document 10.1186_s12889-020-09766-3_642.pdf
2025-06-10 20:18:18,010 - DEBUG - [Page 45] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:18,054 - DEBUG - [Page 67] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:18,056 - DEBUG - Finished converting page batch time=3842.183
2025-06-10 20:18:18,178 - DEBUG - [Page 73] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:18,308 - DEBUG - [Page 68] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:18,390 - DEBUG - [Page 74] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:18,410 - DEBUG - [Page 46] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:18,433 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:18,564 - DEBUG - [Page 75] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:18,569 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:18,610 - DEBUG - [Page 33] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:18,617 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:18,951 - DEBUG - Snippet 10.3390_ijerph13070728_635_item_0: generation shape=torch.Size([1, 420])
2025-06-10 20:18:18,952 - DEBUG - Snippet 10.3390_ijerph13070728_635_item_0 raw docling: (tokens=74)
<formula><loc_0><loc_0><loc_500><loc_500>R M S E = \sqrt { \frac { 1 } { p } \sum _ { i = 1 } ^ { p } \left ( x _ { i j } - x _ { i k } \right ) ^ { 2 } }</formula><end_of_utterance>
2025-06-10 20:18:18,953 - DEBUG - Starting _parse_docling_output
2025-06-10 20:18:18,953 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>R M S E = \sqrt { \frac { 1 } { p } \sum _ { i = 1 } ^ { p } \left ( x _ { i j } - x _ { i k } \right ) ^ { 2 } }</formula><end_of_utterance>
2025-06-10 20:18:18,953 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:18:18,953 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>R M S E = \\sqrt { \\frac { 1 } { p } \\sum _ { i = 1 } ^ { p } \\left ( x _ { i j } - x _ { i k } \\right ) ^ { 2 } }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=832x157 at 0x7F9713F39520>)]
2025-06-10 20:18:18,954 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:18:18,958 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=832.0, b=157.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 113))], orig='R M S E = \\sqrt { \\frac { 1 } { p } \\sum _ { i = 1 } ^ { p } \\left ( x _ { i j } - x _ { i k } \\right ) ^ { 2 } }', text='R M S E = \\sqrt { \\frac { 1 } { p } \\sum _ { i = 1 } ^ { p } \\left ( x _ { i j } - x _ { i k } \\right ) ^ { 2 } }', formatting=None, hyperlink=None)]
2025-06-10 20:18:18,958 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:18:18,958 - DEBUG - Processing text item: label=formula, text=R M S E = \sqrt { \frac { 1 } { p } \sum _ { i = 1 } ^ { p } \left ( x _ { i j } - x _ { i k } \right ) ^ { 2 } }
2025-06-10 20:18:18,958 - DEBUG - Recognized string extracted: R M S E = \sqrt { \frac { 1 } { p } \sum _ { i = 1 } ^ { p } \left ( x _ { i j } - x _ { i k } \right ) ^ { 2 } }
2025-06-10 20:18:18,959 - DEBUG - Generating chat message for label: formula
2025-06-10 20:18:18,959 - DEBUG - Snippet 10.3390_ijerph13070728_635_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:18:18,975 - DEBUG - [Page 47] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:19,028 - DEBUG - Snippet 10.3390_ijerph13070728_635_item_1 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:18:19,183 - DEBUG - Finished converting page batch time=3843.311
2025-06-10 20:18:19,249 - DEBUG - Finished converting page batch time=3843.377
2025-06-10 20:18:19,509 - DEBUG - [Page 76] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:19,644 - DEBUG - [Page 48] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:19,669 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:19,871 - DEBUG - [Page 49] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:19,901 - DEBUG - [Page 69] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:19,938 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:20,172 - DEBUG - [Page 70] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:20,271 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:20,463 - DEBUG - [Page 71] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:20,464 - DEBUG - Finished converting page batch time=3844.592
2025-06-10 20:18:20,507 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:20,638 - DEBUG - [Page 72] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:20,738 - DEBUG - [Page 50] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:20,897 - DEBUG - [Page 73] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:20,989 - DEBUG - Finished converting page batch time=3845.117
2025-06-10 20:18:20,998 - DEBUG - [Page 34] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:21,141 - DEBUG - [Page 74] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:21,222 - DEBUG - [Page 77] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:21,224 - DEBUG - Dynamic vertical threshold: 24.69600000000005, Overlap threshold: 0.7
2025-06-10 20:18:21,224 - DEBUG - Checking merge:
  Current: 21, Next: 15
2025-06-10 20:18:21,225 - DEBUG -   Vertical gap: 7.8799999999999955, Overlap ratio: 1.0
2025-06-10 20:18:21,225 - DEBUG -   Left boundary diff: 0.0, Right boundary diff: 190.70399999999998
2025-06-10 20:18:21,225 - DEBUG -   Alignment factor (ratio): 0.9329302298277026
2025-06-10 20:18:21,225 - DEBUG -   -> c1 21 formula number: None, c2 15 formula number: 2
2025-06-10 20:18:21,226 - DEBUG -   -> Merging clusters 21 and 15 with vertical gap 7.8799999999999955 and overlap ratio 1.0
2025-06-10 20:18:21,226 - DEBUG - Checking merge:
  Current: 15, Next: 16
2025-06-10 20:18:21,226 - DEBUG -   Vertical gap: 8.0, Overlap ratio: 1.0
2025-06-10 20:18:21,226 - DEBUG -   Left boundary diff: 0.0, Right boundary diff: 225.891
2025-06-10 20:18:21,226 - DEBUG -   Alignment factor (ratio): 1.2091339012581597
2025-06-10 20:18:21,227 - DEBUG -   -> c1 15 formula number: 2, c2 16 formula number: None
2025-06-10 20:18:21,227 - DEBUG -   -> Merging clusters 15 and 16 with vertical gap 8.0 and overlap ratio 1.0
2025-06-10 20:18:21,227 - DEBUG - [Page 51] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:21,228 - DEBUG - Finished converting page batch time=3845.356
2025-06-10 20:18:21,352 - DEBUG - [Page 75] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:21,352 - DEBUG - Finished converting page batch time=3845.480
2025-06-10 20:18:21,388 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:21,406 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:21,589 - DEBUG - [Page 52] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:21,626 - DEBUG - [Page 76] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:21,677 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:21,958 - DEBUG - [Page 77] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:22,007 - DEBUG - Finished converting page batch time=3846.135
2025-06-10 20:18:22,018 - DEBUG - [Page 78] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:22,025 - DEBUG - Snippet 10.3390_ijerph13070728_635_item_1: generation shape=torch.Size([1, 445])
2025-06-10 20:18:22,026 - DEBUG - Snippet 10.3390_ijerph13070728_635_item_1 raw docling: (tokens=99)
<formula><loc_0><loc_0><loc_500><loc_500>C O D = \sqrt { \frac { 1 } { p } \sum _ { i = 1 } ^ { p } \left [ \left ( x _ { i j } - x _ { i k } \right ) / \left ( x _ { i j } + x _ { i k } \right ) \right ] ^ { 2 } }</formula><end_of_utterance>
2025-06-10 20:18:22,027 - DEBUG - Starting _parse_docling_output
2025-06-10 20:18:22,027 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>C O D = \sqrt { \frac { 1 } { p } \sum _ { i = 1 } ^ { p } \left [ \left ( x _ { i j } - x _ { i k } \right ) / \left ( x _ { i j } + x _ { i k } \right ) \right ] ^ { 2 } }</formula><end_of_utterance>
2025-06-10 20:18:22,027 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:18:22,027 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>C O D = \\sqrt { \\frac { 1 } { p } \\sum _ { i = 1 } ^ { p } \\left [ \\left ( x _ { i j } - x _ { i k } \\right ) / \\left ( x _ { i j } + x _ { i k } \\right ) \\right ] ^ { 2 } }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=912x157 at 0x7F9713F38140>)]
2025-06-10 20:18:22,027 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:18:22,032 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=912.0, b=157.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 173))], orig='C O D = \\sqrt { \\frac { 1 } { p } \\sum _ { i = 1 } ^ { p } \\left [ \\left ( x _ { i j } - x _ { i k } \\right ) / \\left ( x _ { i j } + x _ { i k } \\right ) \\right ] ^ { 2 } }', text='C O D = \\sqrt { \\frac { 1 } { p } \\sum _ { i = 1 } ^ { p } \\left [ \\left ( x _ { i j } - x _ { i k } \\right ) / \\left ( x _ { i j } + x _ { i k } \\right ) \\right ] ^ { 2 } }', formatting=None, hyperlink=None)]
2025-06-10 20:18:22,032 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:18:22,033 - DEBUG - Processing text item: label=formula, text=C O D = \sqrt { \frac { 1 } { p } \sum _ { i = 1 } ^ { p } \left [ \left ( x _ { i j } - x _ { i k } \right ) / \left ( x _ { i j } + x _ { i k } \right ) \right ] ^ { 2 } }
2025-06-10 20:18:22,033 - DEBUG - Recognized string extracted: C O D = \sqrt { \frac { 1 } { p } \sum _ { i = 1 } ^ { p } \left [ \left ( x _ { i j } - x _ { i k } \right ) / \left ( x _ { i j } + x _ { i k } \right ) \right ] ^ { 2 } }
2025-06-10 20:18:22,033 - INFO - All done. Returning 2 recognized text results.
2025-06-10 20:18:22,033 - DEBUG - Snippet 10.3390_ijerph13070728_635_item_0 recognized text:
R M S E = \sqrt { \frac { 1 } { p } \sum _ { i = 1 } ^ { p } \left ( x _ { i j } - x _ { i k } \right ) ^ { 2 } }
2025-06-10 20:18:22,034 - DEBUG - Snippet 10.3390_ijerph13070728_635_item_1 recognized text:
C O D = \sqrt { \frac { 1 } { p } \sum _ { i = 1 } ^ { p } \left [ \left ( x _ { i j } - x _ { i k } \right ) / \left ( x _ { i j } + x _ { i k } \right ) \right ] ^ { 2 } }
2025-06-10 20:18:22,128 - INFO - Finished converting document 10.3390_ijerph13070728_635.pdf in 23.18 sec.
2025-06-10 20:18:22,157 - DEBUG - [Page 53] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:22,268 - INFO - Extraction successful row 115, tokens=22116
2025-06-10 20:18:22,288 - INFO - Going to convert document batch...
2025-06-10 20:18:22,289 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:18:22,289 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:18:22,342 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:18:22,510 - DEBUG - [Page 54] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:22,566 - DEBUG - [Page 78] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:22,786 - DEBUG - [Page 55] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:22,786 - DEBUG - Finished converting page batch time=3846.914
2025-06-10 20:18:22,857 - DEBUG - Dynamic vertical threshold: 55.37340000000006, Overlap threshold: 0.7
2025-06-10 20:18:22,858 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:22,947 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:22,949 - DEBUG - Finished converting page batch time=3847.076
2025-06-10 20:18:23,187 - DEBUG - [Page 35] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:23,188 - DEBUG - Finished converting page batch time=3847.316
2025-06-10 20:18:23,208 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:18:23,241 - DEBUG - [Page 56] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:23,254 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:18:23,260 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:18:23,332 - DEBUG - [Page 79] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:23,338 - DEBUG - Finished converting page batch time=3847.465
2025-06-10 20:18:23,439 - DEBUG - [Page 80] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:23,445 - DEBUG - Finished converting page batch time=3847.573
2025-06-10 20:18:23,558 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:23,979 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:18:23,980 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:18:23,980 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:18:24,014 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:18:24,037 - DEBUG - Dynamic vertical threshold: 37.90980000000007, Overlap threshold: 0.7
2025-06-10 20:18:24,038 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:24,051 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:18:24,067 - INFO - Finished converting document 10.31390_gradschool_theses.3567_628.pdf in 53.46 sec.
2025-06-10 20:18:24,089 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:18:24,129 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:18:24,167 - DEBUG - [Page 79] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:24,168 - DEBUG - Finished converting page batch time=3848.295
2025-06-10 20:18:24,224 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:18:24,264 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:18:24,384 - DEBUG - [Page 80] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:24,406 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:18:24,441 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:18:24,475 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:24,510 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:18:24,526 - DEBUG - [Page 81] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:24,678 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:18:24,685 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:24,686 - DEBUG - Finished converting page batch time=3848.814
2025-06-10 20:18:24,897 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:24,912 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:24,921 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:24,954 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:18:25,146 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:18:25,146 - INFO - Processing document 10.3808_jei.200800130_645.pdf
2025-06-10 20:18:25,192 - DEBUG - [Page 36] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:25,462 - DEBUG - [Page 82] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:25,471 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:25,473 - DEBUG - Finished converting page batch time=3849.601
2025-06-10 20:18:25,928 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:26,117 - DEBUG - [Page 57] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:26,185 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:26,221 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:26,301 - INFO - Extraction successful row 109, tokens=55661
2025-06-10 20:18:26,332 - INFO - Going to convert document batch...
2025-06-10 20:18:26,333 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:18:26,333 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:18:26,382 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:18:26,484 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:26,992 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:18:27,041 - DEBUG - [Page 83] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:27,046 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:18:27,052 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:18:27,251 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:27,612 - DEBUG - [Page 14] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:27,668 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:18:27,668 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:18:27,668 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:18:27,688 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:27,689 - DEBUG - Finished converting page batch time=3851.816
2025-06-10 20:18:27,718 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:18:27,753 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:18:27,787 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:18:27,837 - INFO - Finished converting document 10.3390_ijerph181910386_639.pdf in 16.96 sec.
2025-06-10 20:18:27,886 - DEBUG - Finished converting page batch time=3852.014
2025-06-10 20:18:27,897 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:27,906 - DEBUG - [Page 58] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:27,977 - INFO - Extraction successful row 117, tokens=19594
2025-06-10 20:18:28,026 - INFO - Going to convert document batch...
2025-06-10 20:18:28,027 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:18:28,027 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:18:28,075 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:18:28,083 - DEBUG - [Page 59] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:28,085 - DEBUG - Finished converting page batch time=3852.213
2025-06-10 20:18:28,087 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:18:28,116 - DEBUG - [Page 84] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:28,121 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:18:28,234 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:18:28,267 - DEBUG - [Page 37] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:28,269 - DEBUG - Finished converting page batch time=3852.396
2025-06-10 20:18:28,352 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:18:28,406 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:18:28,458 - DEBUG - [Page 60] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:28,490 - DEBUG - Creating masked image for page 3 with 18 clusters.
2025-06-10 20:18:28,492 - INFO - Masked image successfully created for page 3.
2025-06-10 20:18:28,493 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:18:28,594 - DEBUG - Creating masked image for page 10 with 18 clusters.
2025-06-10 20:18:28,595 - INFO - Masked image successfully created for page 10.
2025-06-10 20:18:28,600 - INFO - Starting prediction for 3 images with labels: ['formula', 'formula', 'formula']
2025-06-10 20:18:28,601 - DEBUG - Generating chat message for label: formula
2025-06-10 20:18:28,601 - DEBUG - Snippet 10.1016_s0140-67361631679-8_532_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:18:28,647 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:18:28,747 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:28,753 - DEBUG - [Page 15] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:28,754 - DEBUG - Finished converting page batch time=3852.881
2025-06-10 20:18:28,795 - DEBUG - Snippet 10.1016_s0140-67361631679-8_532_item_0 => input_ids shape=torch.Size([1, 875]), prompt_len=875
2025-06-10 20:18:28,951 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:18:29,004 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:18:29,053 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:18:29,059 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:18:29,117 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:29,119 - DEBUG - Finished converting page batch time=3853.246
2025-06-10 20:18:29,155 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:18:29,156 - INFO - Processing document 10.1007_s40471-022-00290-z_649.pdf
2025-06-10 20:18:29,308 - DEBUG - Creating masked image for page 4 with 11 clusters.
2025-06-10 20:18:29,314 - INFO - Masked image successfully created for page 4.
2025-06-10 20:18:29,434 - DEBUG - Creating masked image for page 5 with 12 clusters.
2025-06-10 20:18:29,442 - INFO - Masked image successfully created for page 5.
2025-06-10 20:18:29,446 - INFO - Starting prediction for 3 images with labels: ['formula', 'formula', 'formula']
2025-06-10 20:18:29,446 - DEBUG - Generating chat message for label: formula
2025-06-10 20:18:29,447 - DEBUG - Snippet 10.1186_s12889-020-09766-3_642_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:18:29,579 - DEBUG - Snippet 10.1186_s12889-020-09766-3_642_item_0 => input_ids shape=torch.Size([1, 610]), prompt_len=610
2025-06-10 20:18:29,782 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:29,827 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:18:29,828 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:18:29,828 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:18:27,713 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:18:27,742 - DEBUG - [Page 85] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:27,749 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:18:27,826 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:18:27,861 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:18:27,879 - DEBUG - [Page 86] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:27,894 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:18:27,928 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:18:27,945 - DEBUG - [Page 87] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:27,946 - DEBUG - Finished converting page batch time=3854.225
2025-06-10 20:18:28,019 - DEBUG - [Page 88] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:28,055 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:18:28,094 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:18:28,130 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:18:28,231 - DEBUG - [Page 89] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:28,272 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:18:28,294 - DEBUG - Snippet 10.1016_s0140-67361631679-8_532_item_0: generation shape=torch.Size([1, 926])
2025-06-10 20:18:28,295 - DEBUG - Snippet 10.1016_s0140-67361631679-8_532_item_0 raw docling: (tokens=50)
<formula><loc_0><loc_0><loc_500><loc_500>c t = \sum D A L Y _ { o a s c t } \, P A F _ { j o a s c t }</formula><end_of_utterance>
2025-06-10 20:18:28,296 - DEBUG - Starting _parse_docling_output
2025-06-10 20:18:28,296 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>c t = \sum D A L Y _ { o a s c t } \, P A F _ { j o a s c t }</formula><end_of_utterance>
2025-06-10 20:18:28,296 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:18:28,296 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>c t = \\sum D A L Y _ { o a s c t } \\, P A F _ { j o a s c t }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=217x143 at 0x7F96CA178C20>)]
2025-06-10 20:18:28,297 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:18:28,298 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=217.0, b=143.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 61))], orig='c t = \\sum D A L Y _ { o a s c t } \\, P A F _ { j o a s c t }', text='c t = \\sum D A L Y _ { o a s c t } \\, P A F _ { j o a s c t }', formatting=None, hyperlink=None)]
2025-06-10 20:18:28,299 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:18:28,299 - DEBUG - Processing text item: label=formula, text=c t = \sum D A L Y _ { o a s c t } \, P A F _ { j o a s c t }
2025-06-10 20:18:28,299 - DEBUG - Recognized string extracted: c t = \sum D A L Y _ { o a s c t } \, P A F _ { j o a s c t }
2025-06-10 20:18:28,299 - DEBUG - Generating chat message for label: formula
2025-06-10 20:18:28,299 - DEBUG - Snippet 10.1016_s0140-67361631679-8_532_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:18:28,365 - DEBUG - Dynamic vertical threshold: 52.329600000000006, Overlap threshold: 0.7
2025-06-10 20:18:28,366 - DEBUG - Checking merge:
  Current: 20, Next: 16
2025-06-10 20:18:28,366 - DEBUG -   Vertical gap: 47.113999999999976, Overlap ratio: 0.9991012178498134
2025-06-10 20:18:28,366 - DEBUG -   Left boundary diff: 0.29999999999999716, Right boundary diff: 3.605000000000018
2025-06-10 20:18:28,366 - DEBUG -   Alignment factor (ratio): 0.015311919299177142
2025-06-10 20:18:28,367 - DEBUG -   -> c1 20 formula number: 1, c2 16 formula number: 2
2025-06-10 20:18:28,367 - DEBUG -   -> Not merging clusters 20 and 16 due to different formula numbers: 1 vs 2
2025-06-10 20:18:28,367 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:28,368 - DEBUG - Finished converting page batch time=3854.647
2025-06-10 20:18:28,408 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:28,424 - DEBUG - Snippet 10.1016_s0140-67361631679-8_532_item_1 => input_ids shape=torch.Size([1, 610]), prompt_len=610
2025-06-10 20:18:28,455 - DEBUG - [Page 16] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:28,466 - DEBUG - [Page 90] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:28,592 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:18:28,634 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:28,766 - DEBUG - [Page 91] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:28,767 - DEBUG - Finished converting page batch time=3855.046
2025-06-10 20:18:28,852 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:18:28,852 - INFO - Processing document 10.1186_s12911-024-02815-6_650.pdf
2025-06-10 20:18:29,012 - DEBUG - [Page 92] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:29,349 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:29,543 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:29,723 - DEBUG - [Page 61] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:29,814 - DEBUG - [Page 17] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:30,122 - DEBUG - [Page 93] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:30,530 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:30,614 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:30,926 - DEBUG - [Page 94] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:30,965 - DEBUG - [Page 18] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:30,966 - DEBUG - Finished converting page batch time=3857.245
2025-06-10 20:18:30,972 - DEBUG - Finished converting page batch time=3857.251
2025-06-10 20:18:31,088 - DEBUG - Dynamic vertical threshold: 127.87019999999998, Overlap threshold: 0.7
2025-06-10 20:18:31,088 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:31,211 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:31,250 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:31,253 - DEBUG - Creating masked image for page 2 with 19 clusters.
2025-06-10 20:18:31,255 - INFO - Masked image successfully created for page 2.
2025-06-10 20:18:31,262 - INFO - Starting prediction for 4 images with labels: ['formula', 'formula', 'formula', 'formula']
2025-06-10 20:18:31,266 - DEBUG - Generating chat message for label: formula
2025-06-10 20:18:31,266 - DEBUG - Snippet 10.1093_exposome_osae001_637_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:18:31,335 - DEBUG - Snippet 10.1093_exposome_osae001_637_item_0 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:18:31,505 - DEBUG - [Page 95] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:31,506 - DEBUG - Finished converting page batch time=3857.785
2025-06-10 20:18:31,584 - DEBUG - Snippet 10.1186_s12889-020-09766-3_642_item_0: generation shape=torch.Size([1, 745])
2025-06-10 20:18:31,586 - DEBUG - Snippet 10.1186_s12889-020-09766-3_642_item_0 raw docling: (tokens=134)
<formula><loc_0><loc_0><loc_500><loc_500>y _ { i j } = \beta _ { 0 j } + \beta _ { 1 j } x _ { 1 i j } + \dots + \beta _ { k j } x _ { k i j } + \epsilon _ { i j } \\ \beta _ { j } = \left [ \beta _ { 0 j } , \dots , \beta _ { k j } \right ] ^ { \prime } \sim M V N o r m a l ( \mu , \Sigma )</formula><end_of_utterance>
2025-06-10 20:18:31,586 - DEBUG - Starting _parse_docling_output
2025-06-10 20:18:31,587 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>y _ { i j } = \beta _ { 0 j } + \beta _ { 1 j } x _ { 1 i j } + \dots + \beta _ { k j } x _ { k i j } + \epsilon _ { i j } \\ \beta _ { j } = \left [ \beta _ { 0 j } , \dots , \beta _ { k j } \right ] ^ { \prime } \sim M V N o r m a l ( \mu , \Sigma )</formula><end_of_utterance>
2025-06-10 20:18:31,587 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:18:31,587 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>y _ { i j } = \\beta _ { 0 j } + \\beta _ { 1 j } x _ { 1 i j } + \\dots + \\beta _ { k j } x _ { k i j } + \\epsilon _ { i j } \\\\ \\beta _ { j } = \\left [ \\beta _ { 0 j } , \\dots , \\beta _ { k j } \\right ] ^ { \\prime } \\sim M V N o r m a l ( \\mu , \\Sigma )</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=426x168 at 0x7F971B1C0560>)]
2025-06-10 20:18:31,587 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:18:31,591 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=426.0, b=168.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 251))], orig='y _ { i j } = \\beta _ { 0 j } + \\beta _ { 1 j } x _ { 1 i j } + \\dots + \\beta _ { k j } x _ { k i j } + \\epsilon _ { i j } \\\\ \\beta _ { j } = \\left [ \\beta _ { 0 j } , \\dots , \\beta _ { k j } \\right ] ^ { \\prime } \\sim M V N o r m a l ( \\mu , \\Sigma )', text='y _ { i j } = \\beta _ { 0 j } + \\beta _ { 1 j } x _ { 1 i j } + \\dots + \\beta _ { k j } x _ { k i j } + \\epsilon _ { i j } \\\\ \\beta _ { j } = \\left [ \\beta _ { 0 j } , \\dots , \\beta _ { k j } \\right ] ^ { \\prime } \\sim M V N o r m a l ( \\mu , \\Sigma )', formatting=None, hyperlink=None)]
2025-06-10 20:18:31,592 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:18:31,592 - DEBUG - Processing text item: label=formula, text=y _ { i j } = \beta _ { 0 j } + \beta _ { 1 j } x _ { 1 i j } + \dots + \beta _ { k j } x _ { k i j } + \epsilon _ { i j } \\ \beta _ { j } = \left [ \beta _ { 0 j } , \dots , \beta _ { k j } \right ] ^ { \prime } \sim M V N o r m a l ( \mu , \Sigma )
2025-06-10 20:18:31,592 - DEBUG - Recognized string extracted: y _ { i j } = \beta _ { 0 j } + \beta _ { 1 j } x _ { 1 i j } + \dots + \beta _ { k j } x _ { k i j } + \epsilon _ { i j } \\ \beta _ { j } = \left [ \beta _ { 0 j } , \dots , \beta _ { k j } \right ] ^ { \prime } \sim M V N o r m a l ( \mu , \Sigma )
2025-06-10 20:18:31,592 - DEBUG - Generating chat message for label: formula
2025-06-10 20:18:31,593 - DEBUG - Snippet 10.1186_s12889-020-09766-3_642_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:18:31,623 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:31,672 - DEBUG - Snippet 10.1186_s12889-020-09766-3_642_item_1 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:18:31,709 - DEBUG - [Page 96] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:31,745 - DEBUG - [Page 62] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:31,965 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:32,004 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:32,049 - DEBUG - [Page 97] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:32,446 - DEBUG - [Page 63] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:32,448 - DEBUG - Finished converting page batch time=3858.726
2025-06-10 20:18:32,689 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:32,792 - DEBUG - [Page 64] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:32,812 - DEBUG - [Page 98] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:32,835 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:32,865 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:32,867 - DEBUG - Finished converting page batch time=3859.146
2025-06-10 20:18:33,011 - DEBUG - [Page 65] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:33,080 - DEBUG - Finished converting page batch time=3859.359
2025-06-10 20:18:33,190 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:33,295 - DEBUG - Finished converting page batch time=3859.574
2025-06-10 20:18:33,345 - DEBUG - [Page 99] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:33,346 - DEBUG - Finished converting page batch time=3859.625
2025-06-10 20:18:33,376 - DEBUG - [Page 66] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:33,503 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:33,574 - DEBUG - [Page 100] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:33,698 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:33,700 - DEBUG - Finished converting page batch time=3859.978
2025-06-10 20:18:33,751 - DEBUG - Snippet 10.1093_exposome_osae001_637_item_0: generation shape=torch.Size([1, 433])
2025-06-10 20:18:33,753 - DEBUG - Snippet 10.1093_exposome_osae001_637_item_0 raw docling: (tokens=87)
<formula><loc_0><loc_0><loc_500><loc_500>e \ ( P ) = G en o t y p e \ ( G ) + E n v i r o n m e n t a l \, E x p o s u r e s \ ( E ) \\ + \, I n t e r a c t i o n s \ ( G x E )</formula><end_of_utterance>
2025-06-10 20:18:33,753 - DEBUG - Starting _parse_docling_output
2025-06-10 20:18:33,753 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>e \ ( P ) = G en o t y p e \ ( G ) + E n v i r o n m e n t a l \, E x p o s u r e s \ ( E ) \\ + \, I n t e r a c t i o n s \ ( G x E )</formula><end_of_utterance>
2025-06-10 20:18:33,753 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:18:33,753 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>e \\ ( P ) = G en o t y p e \\ ( G ) + E n v i r o n m e n t a l \\, E x p o s u r e s \\ ( E ) \\\\ + \\, I n t e r a c t i o n s \\ ( G x E )</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=562x85 at 0x7F96BDE0E060>)]
2025-06-10 20:18:33,754 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:18:33,757 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=562.0, b=85.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 135))], orig='e \\ ( P ) = G en o t y p e \\ ( G ) + E n v i r o n m e n t a l \\, E x p o s u r e s \\ ( E ) \\\\ + \\, I n t e r a c t i o n s \\ ( G x E )', text='e \\ ( P ) = G en o t y p e \\ ( G ) + E n v i r o n m e n t a l \\, E x p o s u r e s \\ ( E ) \\\\ + \\, I n t e r a c t i o n s \\ ( G x E )', formatting=None, hyperlink=None)]
2025-06-10 20:18:33,757 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:18:33,758 - DEBUG - Processing text item: label=formula, text=e \ ( P ) = G en o t y p e \ ( G ) + E n v i r o n m e n t a l \, E x p o s u r e s \ ( E ) \\ + \, I n t e r a c t i o n s \ ( G x E )
2025-06-10 20:18:33,758 - DEBUG - Recognized string extracted: e \ ( P ) = G en o t y p e \ ( G ) + E n v i r o n m e n t a l \, E x p o s u r e s \ ( E ) \\ + \, I n t e r a c t i o n s \ ( G x E )
2025-06-10 20:18:33,758 - DEBUG - Generating chat message for label: formula
2025-06-10 20:18:33,758 - DEBUG - Snippet 10.1093_exposome_osae001_637_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:18:33,770 - DEBUG - Snippet 10.1016_s0140-67361631679-8_532_item_1: generation shape=torch.Size([1, 776])
2025-06-10 20:18:33,772 - DEBUG - Snippet 10.1016_s0140-67361631679-8_532_item_1 raw docling: (tokens=165)
<formula><loc_0><loc_0><loc_500><loc_500>\Lambda F _ { j o a s c t } ^ { \quad } = \frac { \int _ { x = l } ^ { u } R R _ { j o a s c } \left ( x \right ) P _ { j a s c t } \left ( x \right ) d x - R R _ { j o a s c } \left ( T M R E L _ { j a s } \right ) } { \int _ { x = l } ^ { u } R R _ { j o a s c } \left ( x \right ) P _ { j a s c t } \left ( x \right ) d x }</formula><end_of_utterance>
2025-06-10 20:18:33,772 - DEBUG - Starting _parse_docling_output
2025-06-10 20:18:33,773 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>\Lambda F _ { j o a s c t } ^ { \quad } = \frac { \int _ { x = l } ^ { u } R R _ { j o a s c } \left ( x \right ) P _ { j a s c t } \left ( x \right ) d x - R R _ { j o a s c } \left ( T M R E L _ { j a s } \right ) } { \int _ { x = l } ^ { u } R R _ { j o a s c } \left ( x \right ) P _ { j a s c t } \left ( x \right ) d x }</formula><end_of_utterance>
2025-06-10 20:18:33,773 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:18:33,773 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>\\Lambda F _ { j o a s c t } ^ { \\quad } = \\frac { \\int _ { x = l } ^ { u } R R _ { j o a s c } \\left ( x \\right ) P _ { j a s c t } \\left ( x \\right ) d x - R R _ { j o a s c } \\left ( T M R E L _ { j a s } \\right ) } { \\int _ { x = l } ^ { u } R R _ { j o a s c } \\left ( x \\right ) P _ { j a s c t } \\left ( x \\right ) d x }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=531x149 at 0x7F968C3F5DF0>)]
2025-06-10 20:18:33,773 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:18:33,777 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=531.0, b=149.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 326))], orig='\\Lambda F _ { j o a s c t } ^ { \\quad } = \\frac { \\int _ { x = l } ^ { u } R R _ { j o a s c } \\left ( x \\right ) P _ { j a s c t } \\left ( x \\right ) d x - R R _ { j o a s c } \\left ( T M R E L _ { j a s } \\right ) } { \\int _ { x = l } ^ { u } R R _ { j o a s c } \\left ( x \\right ) P _ { j a s c t } \\left ( x \\right ) d x }', text='\\Lambda F _ { j o a s c t } ^ { \\quad } = \\frac { \\int _ { x = l } ^ { u } R R _ { j o a s c } \\left ( x \\right ) P _ { j a s c t } \\left ( x \\right ) d x - R R _ { j o a s c } \\left ( T M R E L _ { j a s } \\right ) } { \\int _ { x = l } ^ { u } R R _ { j o a s c } \\left ( x \\right ) P _ { j a s c t } \\left ( x \\right ) d x }', formatting=None, hyperlink=None)]
2025-06-10 20:18:33,777 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:18:33,777 - DEBUG - Processing text item: label=formula, text=\Lambda F _ { j o a s c t } ^ { \quad } = \frac { \int _ { x = l } ^ { u } R R _ { j o a s c } \left ( x \right ) P _ { j a s c t } \left ( x \right ) d x - R R _ { j o a s c } \left ( T M R E L _ { j a s } \right ) } { \int _ { x = l } ^ { u } R R _ { j o a s c } \left ( x \right ) P _ { j a s c t } \left ( x \right ) d x }
2025-06-10 20:18:33,778 - DEBUG - Recognized string extracted: \Lambda F _ { j o a s c t } ^ { \quad } = \frac { \int _ { x = l } ^ { u } R R _ { j o a s c } \left ( x \right ) P _ { j a s c t } \left ( x \right ) d x - R R _ { j o a s c } \left ( T M R E L _ { j a s } \right ) } { \int _ { x = l } ^ { u } R R _ { j o a s c } \left ( x \right ) P _ { j a s c t } \left ( x \right ) d x }
2025-06-10 20:18:33,778 - DEBUG - Generating chat message for label: formula
2025-06-10 20:18:33,778 - DEBUG - Snippet 10.1016_s0140-67361631679-8_532_item_2 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:18:33,824 - DEBUG - [Page 101] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:33,828 - DEBUG - Snippet 10.1093_exposome_osae001_637_item_1 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:18:33,873 - DEBUG - Creating masked image for page 3 with 24 clusters.
2025-06-10 20:18:33,875 - INFO - Masked image successfully created for page 3.
2025-06-10 20:18:33,913 - DEBUG - Snippet 10.1016_s0140-67361631679-8_532_item_2 => input_ids shape=torch.Size([1, 610]), prompt_len=610
2025-06-10 20:18:33,932 - DEBUG - [Page 67] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:33,932 - DEBUG - Finished converting page batch time=3860.211
2025-06-10 20:18:34,003 - DEBUG - Creating masked image for page 5 with 16 clusters.
2025-06-10 20:18:34,005 - INFO - Masked image successfully created for page 5.
2025-06-10 20:18:34,013 - INFO - Starting prediction for 5 images with labels: ['formula', 'formula', 'formula', 'formula', 'formula']
2025-06-10 20:18:34,014 - DEBUG - Generating chat message for label: formula
2025-06-10 20:18:34,014 - DEBUG - Snippet 10.3808_jei.200800130_645_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:18:34,086 - DEBUG - Snippet 10.3808_jei.200800130_645_item_0 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:18:34,169 - DEBUG - [Page 102] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:34,292 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:34,353 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:34,433 - DEBUG - [Page 103] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:34,438 - DEBUG - Finished converting page batch time=3860.717
2025-06-10 20:18:34,516 - DEBUG - Snippet 10.1186_s12889-020-09766-3_642_item_1: generation shape=torch.Size([1, 420])
2025-06-10 20:18:34,517 - DEBUG - Snippet 10.1186_s12889-020-09766-3_642_item_1 raw docling: (tokens=74)
<formula><loc_0><loc_0><loc_500><loc_500>\beta _ { j } = \left [ \beta _ { 0 j } , \dots , \beta _ { k j } \right ] ^ { \prime } \sim M V N o r m a l ( \mu , \Sigma ) ,</formula><end_of_utterance>
2025-06-10 20:18:34,517 - DEBUG - Starting _parse_docling_output
2025-06-10 20:18:34,517 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>\beta _ { j } = \left [ \beta _ { 0 j } , \dots , \beta _ { k j } \right ] ^ { \prime } \sim M V N o r m a l ( \mu , \Sigma ) ,</formula><end_of_utterance>
2025-06-10 20:18:34,517 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:18:34,518 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>\\beta _ { j } = \\left [ \\beta _ { 0 j } , \\dots , \\beta _ { k j } \\right ] ^ { \\prime } \\sim M V N o r m a l ( \\mu , \\Sigma ) ,</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=446x104 at 0x7F971D084950>)]
2025-06-10 20:18:34,518 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:18:34,520 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=446.0, b=104.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 127))], orig='\\beta _ { j } = \\left [ \\beta _ { 0 j } , \\dots , \\beta _ { k j } \\right ] ^ { \\prime } \\sim M V N o r m a l ( \\mu , \\Sigma ) ,', text='\\beta _ { j } = \\left [ \\beta _ { 0 j } , \\dots , \\beta _ { k j } \\right ] ^ { \\prime } \\sim M V N o r m a l ( \\mu , \\Sigma ) ,', formatting=None, hyperlink=None)]
2025-06-10 20:18:34,521 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:18:34,521 - DEBUG - Processing text item: label=formula, text=\beta _ { j } = \left [ \beta _ { 0 j } , \dots , \beta _ { k j } \right ] ^ { \prime } \sim M V N o r m a l ( \mu , \Sigma ) ,
2025-06-10 20:18:34,521 - DEBUG - Recognized string extracted: \beta _ { j } = \left [ \beta _ { 0 j } , \dots , \beta _ { k j } \right ] ^ { \prime } \sim M V N o r m a l ( \mu , \Sigma ) ,
2025-06-10 20:18:34,521 - DEBUG - Generating chat message for label: formula
2025-06-10 20:18:34,522 - DEBUG - Snippet 10.1186_s12889-020-09766-3_642_item_2 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:18:34,648 - DEBUG - Snippet 10.1186_s12889-020-09766-3_642_item_2 => input_ids shape=torch.Size([1, 610]), prompt_len=610
2025-06-10 20:18:34,706 - DEBUG - [Page 68] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:34,845 - DEBUG - [Page 104] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:34,912 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:35,077 - DEBUG - [Page 105] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:35,092 - DEBUG - [Page 69] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:35,316 - DEBUG - [Page 106] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:35,429 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:35,431 - DEBUG - Finished converting page batch time=3861.710
2025-06-10 20:18:35,573 - DEBUG - [Page 107] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:35,574 - DEBUG - Finished converting page batch time=3861.852
2025-06-10 20:18:35,792 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:35,846 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:35,875 - DEBUG - [Page 108] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:36,128 - DEBUG - [Page 109] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:36,196 - DEBUG - Snippet 10.1186_s12889-020-09766-3_642_item_2: generation shape=torch.Size([1, 662])
2025-06-10 20:18:36,197 - DEBUG - Snippet 10.1186_s12889-020-09766-3_642_item_2 raw docling: (tokens=51)
<formula><loc_0><loc_0><loc_500><loc_500>\mu _ { l } \sim N ( 0 , 1 0 ) , l = 1 , \dots , k + 1 ,</formula><end_of_utterance>
2025-06-10 20:18:36,197 - DEBUG - Starting _parse_docling_output
2025-06-10 20:18:36,197 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>\mu _ { l } \sim N ( 0 , 1 0 ) , l = 1 , \dots , k + 1 ,</formula><end_of_utterance>
2025-06-10 20:18:36,197 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:18:36,198 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>\\mu _ { l } \\sim N ( 0 , 1 0 ) , l = 1 , \\dots , k + 1 ,</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=336x92 at 0x7F96CE1964B0>)]
2025-06-10 20:18:36,198 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:18:36,200 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=336.0, b=92.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 56))], orig='\\mu _ { l } \\sim N ( 0 , 1 0 ) , l = 1 , \\dots , k + 1 ,', text='\\mu _ { l } \\sim N ( 0 , 1 0 ) , l = 1 , \\dots , k + 1 ,', formatting=None, hyperlink=None)]
2025-06-10 20:18:36,200 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:18:36,200 - DEBUG - Processing text item: label=formula, text=\mu _ { l } \sim N ( 0 , 1 0 ) , l = 1 , \dots , k + 1 ,
2025-06-10 20:18:36,200 - DEBUG - Recognized string extracted: \mu _ { l } \sim N ( 0 , 1 0 ) , l = 1 , \dots , k + 1 ,
2025-06-10 20:18:36,201 - INFO - All done. Returning 3 recognized text results.
2025-06-10 20:18:36,201 - DEBUG - Snippet 10.1186_s12889-020-09766-3_642_item_0 recognized text:
y _ { i j } = \beta _ { 0 j } + \beta _ { 1 j } x _ { 1 i j } + \dots + \beta _ { k j } x _ { k i j } + \epsilon _ { i j } \\ \beta _ { j } = \left [ \beta _ { 0 j } , \dots , \beta _ { k j } \right ] ^ { \prime } \sim M V N o r m a l ( \mu , \Sigma )
2025-06-10 20:18:36,201 - DEBUG - Snippet 10.1186_s12889-020-09766-3_642_item_1 recognized text:
\beta _ { j } = \left [ \beta _ { 0 j } , \dots , \beta _ { k j } \right ] ^ { \prime } \sim M V N o r m a l ( \mu , \Sigma ) ,
2025-06-10 20:18:36,201 - DEBUG - Snippet 10.1186_s12889-020-09766-3_642_item_2 recognized text:
\mu _ { l } \sim N ( 0 , 1 0 ) , l = 1 , \dots , k + 1 ,
2025-06-10 20:18:36,300 - INFO - Finished converting document 10.1186_s12889-020-09766-3_642.pdf in 23.01 sec.
2025-06-10 20:18:36,302 - DEBUG - [Page 110] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:36,405 - INFO - Extraction successful row 118, tokens=21997
2025-06-10 20:18:36,465 - INFO - Going to convert document batch...
2025-06-10 20:18:36,466 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:18:36,466 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:18:36,511 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:18:36,660 - DEBUG - Snippet 10.1016_s0140-67361631679-8_532_item_2: generation shape=torch.Size([1, 706])
2025-06-10 20:18:36,661 - DEBUG - Snippet 10.1016_s0140-67361631679-8_532_item_2 raw docling: (tokens=95)
<formula><loc_0><loc_0><loc_500><loc_500>P A F _ { j o a s c t } = 1 - \prod _ { j = 1 } ^ { J } \left ( 1 - P A F _ { j o a s c t } \prod _ { i = 1 } ^ { J } ( 1 - M F _ { j i o } ) \right )</formula><end_of_utterance>
2025-06-10 20:18:36,662 - DEBUG - Starting _parse_docling_output
2025-06-10 20:18:36,662 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>P A F _ { j o a s c t } = 1 - \prod _ { j = 1 } ^ { J } \left ( 1 - P A F _ { j o a s c t } \prod _ { i = 1 } ^ { J } ( 1 - M F _ { j i o } ) \right )</formula><end_of_utterance>
2025-06-10 20:18:36,662 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:18:36,663 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>P A F _ { j o a s c t } = 1 - \\prod _ { j = 1 } ^ { J } \\left ( 1 - P A F _ { j o a s c t } \\prod _ { i = 1 } ^ { J } ( 1 - M F _ { j i o } ) \\right )</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=419x120 at 0x7F967F8A14F0>)]
2025-06-10 20:18:36,663 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:18:36,665 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=419.0, b=120.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 150))], orig='P A F _ { j o a s c t } = 1 - \\prod _ { j = 1 } ^ { J } \\left ( 1 - P A F _ { j o a s c t } \\prod _ { i = 1 } ^ { J } ( 1 - M F _ { j i o } ) \\right )', text='P A F _ { j o a s c t } = 1 - \\prod _ { j = 1 } ^ { J } \\left ( 1 - P A F _ { j o a s c t } \\prod _ { i = 1 } ^ { J } ( 1 - M F _ { j i o } ) \\right )', formatting=None, hyperlink=None)]
2025-06-10 20:18:36,666 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:18:36,666 - DEBUG - Processing text item: label=formula, text=P A F _ { j o a s c t } = 1 - \prod _ { j = 1 } ^ { J } \left ( 1 - P A F _ { j o a s c t } \prod _ { i = 1 } ^ { J } ( 1 - M F _ { j i o } ) \right )
2025-06-10 20:18:36,666 - DEBUG - Recognized string extracted: P A F _ { j o a s c t } = 1 - \prod _ { j = 1 } ^ { J } \left ( 1 - P A F _ { j o a s c t } \prod _ { i = 1 } ^ { J } ( 1 - M F _ { j i o } ) \right )
2025-06-10 20:18:36,666 - INFO - All done. Returning 3 recognized text results.
2025-06-10 20:18:36,667 - DEBUG - Snippet 10.1016_s0140-67361631679-8_532_item_0 recognized text:
c t = \sum D A L Y _ { o a s c t } \, P A F _ { j o a s c t }
2025-06-10 20:18:36,667 - DEBUG - Snippet 10.1016_s0140-67361631679-8_532_item_1 recognized text:
\Lambda F _ { j o a s c t } ^ { \quad } = \frac { \int _ { x = l } ^ { u } R R _ { j o a s c } \left ( x \right ) P _ { j a s c t } \left ( x \right ) d x - R R _ { j o a s c } \left ( T M R E L _ { j a s } \right ) } { \int _ { x = l } ^ { u } R R _ { j o a s c } \left ( x \right ) P _ { j a s c t } \left ( x \right ) d x }
2025-06-10 20:18:36,667 - DEBUG - Snippet 10.1016_s0140-67361631679-8_532_item_2 recognized text:
P A F _ { j o a s c t } = 1 - \prod _ { j = 1 } ^ { J } \left ( 1 - P A F _ { j o a s c t } \prod _ { i = 1 } ^ { J } ( 1 - M F _ { j i o } ) \right )
2025-06-10 20:18:36,690 - DEBUG - [Page 111] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:36,691 - DEBUG - Finished converting page batch time=3862.970
2025-06-10 20:18:36,741 - DEBUG - [Page 70] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:36,905 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:37,184 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:18:37,194 - DEBUG - [Page 112] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:37,230 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:18:37,236 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:18:37,248 - DEBUG - Snippet 10.3808_jei.200800130_645_item_0: generation shape=torch.Size([1, 454])
2025-06-10 20:18:37,249 - DEBUG - Snippet 10.3808_jei.200800130_645_item_0 raw docling: (tokens=108)
<formula><loc_0><loc_0><loc_500><loc_500>w ( x , y , t ) = N _ { 1 } ( x , y , t ) w _ { 1 } + N _ { 2 } ( x , y , t ) w _ { 2 } + N _ { 3 } ( x , y , t ) w _ { 3 } \\ + N _ { 4 } ( x , y , t ) w _ { 4 }</formula><end_of_utterance>
2025-06-10 20:18:37,250 - DEBUG - Starting _parse_docling_output
2025-06-10 20:18:37,250 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>w ( x , y , t ) = N _ { 1 } ( x , y , t ) w _ { 1 } + N _ { 2 } ( x , y , t ) w _ { 2 } + N _ { 3 } ( x , y , t ) w _ { 3 } \\ + N _ { 4 } ( x , y , t ) w _ { 4 }</formula><end_of_utterance>
2025-06-10 20:18:37,250 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:18:37,251 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>w ( x , y , t ) = N _ { 1 } ( x , y , t ) w _ { 1 } + N _ { 2 } ( x , y , t ) w _ { 2 } + N _ { 3 } ( x , y , t ) w _ { 3 } \\\\ + N _ { 4 } ( x , y , t ) w _ { 4 }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=689x138 at 0x7F96AC8AA630>)]
2025-06-10 20:18:37,251 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:18:37,254 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=689.0, b=138.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 162))], orig='w ( x , y , t ) = N _ { 1 } ( x , y , t ) w _ { 1 } + N _ { 2 } ( x , y , t ) w _ { 2 } + N _ { 3 } ( x , y , t ) w _ { 3 } \\\\ + N _ { 4 } ( x , y , t ) w _ { 4 }', text='w ( x , y , t ) = N _ { 1 } ( x , y , t ) w _ { 1 } + N _ { 2 } ( x , y , t ) w _ { 2 } + N _ { 3 } ( x , y , t ) w _ { 3 } \\\\ + N _ { 4 } ( x , y , t ) w _ { 4 }', formatting=None, hyperlink=None)]
2025-06-10 20:18:37,255 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:18:37,255 - DEBUG - Processing text item: label=formula, text=w ( x , y , t ) = N _ { 1 } ( x , y , t ) w _ { 1 } + N _ { 2 } ( x , y , t ) w _ { 2 } + N _ { 3 } ( x , y , t ) w _ { 3 } \\ + N _ { 4 } ( x , y , t ) w _ { 4 }
2025-06-10 20:18:37,255 - DEBUG - Recognized string extracted: w ( x , y , t ) = N _ { 1 } ( x , y , t ) w _ { 1 } + N _ { 2 } ( x , y , t ) w _ { 2 } + N _ { 3 } ( x , y , t ) w _ { 3 } \\ + N _ { 4 } ( x , y , t ) w _ { 4 }
2025-06-10 20:18:37,255 - DEBUG - Generating chat message for label: formula
2025-06-10 20:18:37,256 - DEBUG - Snippet 10.3808_jei.200800130_645_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:18:37,325 - DEBUG - Snippet 10.3808_jei.200800130_645_item_1 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:18:37,453 - DEBUG - [Page 71] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:37,458 - DEBUG - Finished converting page batch time=3863.737
2025-06-10 20:18:37,460 - INFO - Finished converting document 10.1016_s0140-67361631679-8_532.pdf in 134.17 sec.
2025-06-10 20:18:37,636 - DEBUG - Snippet 10.1093_exposome_osae001_637_item_1: generation shape=torch.Size([1, 474])
2025-06-10 20:18:37,636 - DEBUG - Snippet 10.1093_exposome_osae001_637_item_1 raw docling: (tokens=128)
<formula><loc_0><loc_0><loc_500><loc_500>^ { \prime } a r ( P ) = V a r ( G ) + V a r ( E _ { S h a r e d } ) + V a r ( E _ { N o n s h a r e d } ) \\ + V a r ( I n t e r a c t i o n s [ G x E ] ) + V a r ( I n t e r a c t i o n s [ G x G ] ) + \cdots + e r r o r</formula><end_of_utterance>
2025-06-10 20:18:37,637 - DEBUG - Starting _parse_docling_output
2025-06-10 20:18:37,637 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>^ { \prime } a r ( P ) = V a r ( G ) + V a r ( E _ { S h a r e d } ) + V a r ( E _ { N o n s h a r e d } ) \\ + V a r ( I n t e r a c t i o n s [ G x E ] ) + V a r ( I n t e r a c t i o n s [ G x G ] ) + \cdots + e r r o r</formula><end_of_utterance>
2025-06-10 20:18:37,637 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:18:37,637 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>^ { \\prime } a r ( P ) = V a r ( G ) + V a r ( E _ { S h a r e d } ) + V a r ( E _ { N o n s h a r e d } ) \\\\ + V a r ( I n t e r a c t i o n s [ G x E ] ) + V a r ( I n t e r a c t i o n s [ G x G ] ) + \\cdots + e r r o r</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=682x113 at 0x7F96BDE04B90>)]
2025-06-10 20:18:37,638 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:18:37,642 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=682.0, b=113.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 222))], orig='^ { \\prime } a r ( P ) = V a r ( G ) + V a r ( E _ { S h a r e d } ) + V a r ( E _ { N o n s h a r e d } ) \\\\ + V a r ( I n t e r a c t i o n s [ G x E ] ) + V a r ( I n t e r a c t i o n s [ G x G ] ) + \\cdots + e r r o r', text='^ { \\prime } a r ( P ) = V a r ( G ) + V a r ( E _ { S h a r e d } ) + V a r ( E _ { N o n s h a r e d } ) \\\\ + V a r ( I n t e r a c t i o n s [ G x E ] ) + V a r ( I n t e r a c t i o n s [ G x G ] ) + \\cdots + e r r o r', formatting=None, hyperlink=None)]
2025-06-10 20:18:37,642 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:18:37,642 - DEBUG - Processing text item: label=formula, text=^ { \prime } a r ( P ) = V a r ( G ) + V a r ( E _ { S h a r e d } ) + V a r ( E _ { N o n s h a r e d } ) \\ + V a r ( I n t e r a c t i o n s [ G x E ] ) + V a r ( I n t e r a c t i o n s [ G x G ] ) + \cdots + e r r o r
2025-06-10 20:18:37,642 - DEBUG - Recognized string extracted: ^ { \prime } a r ( P ) = V a r ( G ) + V a r ( E _ { S h a r e d } ) + V a r ( E _ { N o n s h a r e d } ) \\ + V a r ( I n t e r a c t i o n s [ G x E ] ) + V a r ( I n t e r a c t i o n s [ G x G ] ) + \cdots + e r r o r
2025-06-10 20:18:37,642 - DEBUG - Generating chat message for label: formula
2025-06-10 20:18:37,643 - DEBUG - Snippet 10.1093_exposome_osae001_637_item_2 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:18:37,707 - DEBUG - [Page 113] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:37,709 - DEBUG - Snippet 10.1093_exposome_osae001_637_item_2 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:18:37,714 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:18:37,714 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:18:37,714 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:18:37,751 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:18:37,786 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:37,787 - DEBUG - Finished converting page batch time=3864.066
2025-06-10 20:18:37,791 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:18:37,827 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:18:37,882 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:18:37,922 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:18:37,958 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:18:38,091 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:18:38,121 - DEBUG - [Page 72] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:38,129 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:18:38,186 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:18:38,224 - INFO - Extraction successful row 91, tokens=187202
2025-06-10 20:18:38,251 - INFO - Going to convert document batch...
2025-06-10 20:18:38,251 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:18:38,251 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:18:38,297 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:18:38,353 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:18:38,419 - DEBUG - [Page 14] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:38,647 - DEBUG - [Page 73] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:38,657 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:18:38,837 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:18:38,837 - INFO - Processing document 10.11606_t.6.2016.tde-26092016-142458_652.pdf
2025-06-10 20:18:38,955 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:39,006 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:39,025 - DEBUG - [Page 74] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:39,073 - DEBUG - [Page 114] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:39,115 - DEBUG - Snippet 10.1093_exposome_osae001_637_item_2: generation shape=torch.Size([1, 395])
2025-06-10 20:18:39,116 - DEBUG - Snippet 10.1093_exposome_osae001_637_item_2 raw docling: (tokens=49)
<formula><loc_0><loc_0><loc_500><loc_500>c ^ { 2 } = V a r ( E _ { - } s h a r e d ) / V a r ( P )</formula><end_of_utterance>
2025-06-10 20:18:39,116 - DEBUG - Starting _parse_docling_output
2025-06-10 20:18:39,117 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>c ^ { 2 } = V a r ( E _ { - } s h a r e d ) / V a r ( P )</formula><end_of_utterance>
2025-06-10 20:18:39,117 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:18:39,117 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>c ^ { 2 } = V a r ( E _ { - } s h a r e d ) / V a r ( P )</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=500x52 at 0x7F96BDE31760>)]
2025-06-10 20:18:39,117 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:18:39,119 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=500.0, b=52.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 57))], orig='c ^ { 2 } = V a r ( E _ { - } s h a r e d ) / V a r ( P )', text='c ^ { 2 } = V a r ( E _ { - } s h a r e d ) / V a r ( P )', formatting=None, hyperlink=None)]
2025-06-10 20:18:39,120 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:18:39,120 - DEBUG - Processing text item: label=formula, text=c ^ { 2 } = V a r ( E _ { - } s h a r e d ) / V a r ( P )
2025-06-10 20:18:39,120 - DEBUG - Recognized string extracted: c ^ { 2 } = V a r ( E _ { - } s h a r e d ) / V a r ( P )
2025-06-10 20:18:39,120 - DEBUG - Generating chat message for label: formula
2025-06-10 20:18:39,121 - DEBUG - Snippet 10.1093_exposome_osae001_637_item_3 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:18:39,146 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:18:39,147 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:39,186 - DEBUG - Snippet 10.1093_exposome_osae001_637_item_3 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:18:39,191 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:18:39,197 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:18:39,247 - DEBUG - Snippet 10.3808_jei.200800130_645_item_1: generation shape=torch.Size([1, 406])
2025-06-10 20:18:39,248 - DEBUG - Snippet 10.3808_jei.200800130_645_item_1 raw docling: (tokens=60)
<formula><loc_0><loc_0><loc_500><loc_500>N _ { i } ( x , y , t ) = \frac { V _ { i } } { V } , \quad i = 1 , 2 , 3 , 4</formula><end_of_utterance>
2025-06-10 20:18:39,249 - DEBUG - Starting _parse_docling_output
2025-06-10 20:18:39,249 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>N _ { i } ( x , y , t ) = \frac { V _ { i } } { V } , \quad i = 1 , 2 , 3 , 4</formula><end_of_utterance>
2025-06-10 20:18:39,249 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:18:39,249 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>N _ { i } ( x , y , t ) = \\frac { V _ { i } } { V } , \\quad i = 1 , 2 , 3 , 4</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=697x119 at 0x7F96AC8A8470>)]
2025-06-10 20:18:39,250 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:18:39,253 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=697.0, b=119.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 77))], orig='N _ { i } ( x , y , t ) = \\frac { V _ { i } } { V } , \\quad i = 1 , 2 , 3 , 4', text='N _ { i } ( x , y , t ) = \\frac { V _ { i } } { V } , \\quad i = 1 , 2 , 3 , 4', formatting=None, hyperlink=None)]
2025-06-10 20:18:39,253 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:18:39,253 - DEBUG - Processing text item: label=formula, text=N _ { i } ( x , y , t ) = \frac { V _ { i } } { V } , \quad i = 1 , 2 , 3 , 4
2025-06-10 20:18:39,253 - DEBUG - Recognized string extracted: N _ { i } ( x , y , t ) = \frac { V _ { i } } { V } , \quad i = 1 , 2 , 3 , 4
2025-06-10 20:18:39,254 - DEBUG - Generating chat message for label: formula
2025-06-10 20:18:39,254 - DEBUG - Snippet 10.3808_jei.200800130_645_item_2 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:18:39,307 - DEBUG - [Page 75] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:39,308 - DEBUG - Finished converting page batch time=3865.587
2025-06-10 20:18:39,312 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:39,327 - DEBUG - Snippet 10.3808_jei.200800130_645_item_2 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:18:39,486 - DEBUG - [Page 15] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:39,487 - DEBUG - Finished converting page batch time=3865.766
2025-06-10 20:18:39,532 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:39,532 - DEBUG - Finished converting page batch time=3865.811
2025-06-10 20:18:39,536 - DEBUG - [Page 115] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:39,537 - DEBUG - Finished converting page batch time=3865.816
2025-06-10 20:18:39,604 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:39,645 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:18:39,646 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:18:39,646 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:18:39,691 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:18:39,730 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:18:39,768 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:18:39,771 - DEBUG - [Page 76] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:39,805 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:18:39,846 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:18:39,889 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:18:40,023 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:18:40,059 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:18:40,075 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:40,091 - DEBUG - [Page 77] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:40,092 - DEBUG - [Page 116] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:40,098 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:18:40,168 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:40,250 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:40,251 - DEBUG - Finished converting page batch time=3866.529
2025-06-10 20:18:40,278 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:18:40,286 - DEBUG - [Page 117] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:40,564 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:18:40,564 - DEBUG - [Page 118] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:40,587 - DEBUG - [Page 78] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:40,697 - DEBUG - Snippet 10.1093_exposome_osae001_637_item_3: generation shape=torch.Size([1, 398])
2025-06-10 20:18:40,702 - DEBUG - Snippet 10.1093_exposome_osae001_637_item_3 raw docling: (tokens=52)
<formula><loc_0><loc_0><loc_500><loc_500>e ^ { 2 } = V a r ( E _ { - } n o n s h a r e d ) / V a r ( P )</formula><end_of_utterance>
2025-06-10 20:18:40,703 - DEBUG - Starting _parse_docling_output
2025-06-10 20:18:40,703 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>e ^ { 2 } = V a r ( E _ { - } n o n s h a r e d ) / V a r ( P )</formula><end_of_utterance>
2025-06-10 20:18:40,703 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:18:40,703 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>e ^ { 2 } = V a r ( E _ { - } n o n s h a r e d ) / V a r ( P )</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=517x51 at 0x7F96BDE33590>)]
2025-06-10 20:18:40,704 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:18:40,706 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=517.0, b=51.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 63))], orig='e ^ { 2 } = V a r ( E _ { - } n o n s h a r e d ) / V a r ( P )', text='e ^ { 2 } = V a r ( E _ { - } n o n s h a r e d ) / V a r ( P )', formatting=None, hyperlink=None)]
2025-06-10 20:18:40,706 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:18:40,706 - DEBUG - Processing text item: label=formula, text=e ^ { 2 } = V a r ( E _ { - } n o n s h a r e d ) / V a r ( P )
2025-06-10 20:18:40,706 - DEBUG - Recognized string extracted: e ^ { 2 } = V a r ( E _ { - } n o n s h a r e d ) / V a r ( P )
2025-06-10 20:18:40,707 - INFO - All done. Returning 4 recognized text results.
2025-06-10 20:18:40,707 - DEBUG - Snippet 10.1093_exposome_osae001_637_item_0 recognized text:
e \ ( P ) = G en o t y p e \ ( G ) + E n v i r o n m e n t a l \, E x p o s u r e s \ ( E ) \\ + \, I n t e r a c t i o n s \ ( G x E )
2025-06-10 20:18:40,707 - DEBUG - Snippet 10.1093_exposome_osae001_637_item_1 recognized text:
^ { \prime } a r ( P ) = V a r ( G ) + V a r ( E _ { S h a r e d } ) + V a r ( E _ { N o n s h a r e d } ) \\ + V a r ( I n t e r a c t i o n s [ G x E ] ) + V a r ( I n t e r a c t i o n s [ G x G ] ) + \cdots + e r r o r
2025-06-10 20:18:40,707 - DEBUG - Snippet 10.1093_exposome_osae001_637_item_2 recognized text:
c ^ { 2 } = V a r ( E _ { - } s h a r e d ) / V a r ( P )
2025-06-10 20:18:40,707 - DEBUG - Snippet 10.1093_exposome_osae001_637_item_3 recognized text:
e ^ { 2 } = V a r ( E _ { - } n o n s h a r e d ) / V a r ( P )
2025-06-10 20:18:40,710 - DEBUG - [Page 16] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:40,738 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:18:40,738 - INFO - Processing document 10.1371_journal.pone.0122245_653.pdf
2025-06-10 20:18:40,790 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:40,817 - DEBUG - [Page 119] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:40,818 - DEBUG - Finished converting page batch time=3867.097
2025-06-10 20:18:40,851 - DEBUG - [Page 79] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:40,852 - DEBUG - Finished converting page batch time=3867.130
2025-06-10 20:18:40,898 - INFO - Finished converting document 10.1093_exposome_osae001_637.pdf in 35.80 sec.
2025-06-10 20:18:40,988 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:41,031 - DEBUG - [Page 120] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:41,079 - DEBUG - [Page 80] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:41,177 - INFO - Extraction successful row 116, tokens=32246
2025-06-10 20:18:41,195 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:41,200 - INFO - Going to convert document batch...
2025-06-10 20:18:41,200 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:18:41,200 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:18:41,248 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:18:41,328 - DEBUG - [Page 121] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:41,456 - DEBUG - [Page 81] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:41,621 - DEBUG - [Page 122] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:41,637 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:41,683 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:41,734 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:41,735 - DEBUG - Finished converting page batch time=3868.014
2025-06-10 20:18:41,838 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:41,898 - DEBUG - [Page 123] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:41,898 - DEBUG - Finished converting page batch time=3868.177
2025-06-10 20:18:41,980 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:18:42,020 - DEBUG - [Page 82] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:42,037 - DEBUG - [Page 124] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:42,038 - DEBUG - Finished converting page batch time=3868.317
2025-06-10 20:18:42,047 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:18:42,055 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:18:42,348 - DEBUG - [Page 83] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:42,349 - DEBUG - Finished converting page batch time=3868.628
2025-06-10 20:18:42,469 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:42,581 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:42,612 - DEBUG - Snippet 10.3808_jei.200800130_645_item_2: generation shape=torch.Size([1, 452])
2025-06-10 20:18:42,613 - DEBUG - Snippet 10.3808_jei.200800130_645_item_2 raw docling: (tokens=106)
<formula><loc_0><loc_0><loc_500><loc_500>w ( x , y ) = \sum _ { i = 1 } ^ { N } \lambda _ { i } \omega _ { i } , \lambda _ { i } = \frac { ( 1 / d _ { i } ) ^ { p } } { \sum _ { k = 1 } ^ { N } ( 1 / d _ { k } ) ^ { p } }</formula><end_of_utterance>
2025-06-10 20:18:42,613 - DEBUG - Starting _parse_docling_output
2025-06-10 20:18:42,613 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>w ( x , y ) = \sum _ { i = 1 } ^ { N } \lambda _ { i } \omega _ { i } , \lambda _ { i } = \frac { ( 1 / d _ { i } ) ^ { p } } { \sum _ { k = 1 } ^ { N } ( 1 / d _ { k } ) ^ { p } }</formula><end_of_utterance>
2025-06-10 20:18:42,614 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:18:42,614 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>w ( x , y ) = \\sum _ { i = 1 } ^ { N } \\lambda _ { i } \\omega _ { i } , \\lambda _ { i } = \\frac { ( 1 / d _ { i } ) ^ { p } } { \\sum _ { k = 1 } ^ { N } ( 1 / d _ { k } ) ^ { p } }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=700x158 at 0x7F96B29DB320>)]
2025-06-10 20:18:42,614 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:18:42,618 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=700.0, b=158.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 180))], orig='w ( x , y ) = \\sum _ { i = 1 } ^ { N } \\lambda _ { i } \\omega _ { i } , \\lambda _ { i } = \\frac { ( 1 / d _ { i } ) ^ { p } } { \\sum _ { k = 1 } ^ { N } ( 1 / d _ { k } ) ^ { p } }', text='w ( x , y ) = \\sum _ { i = 1 } ^ { N } \\lambda _ { i } \\omega _ { i } , \\lambda _ { i } = \\frac { ( 1 / d _ { i } ) ^ { p } } { \\sum _ { k = 1 } ^ { N } ( 1 / d _ { k } ) ^ { p } }', formatting=None, hyperlink=None)]
2025-06-10 20:18:42,619 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:18:42,619 - DEBUG - Processing text item: label=formula, text=w ( x , y ) = \sum _ { i = 1 } ^ { N } \lambda _ { i } \omega _ { i } , \lambda _ { i } = \frac { ( 1 / d _ { i } ) ^ { p } } { \sum _ { k = 1 } ^ { N } ( 1 / d _ { k } ) ^ { p } }
2025-06-10 20:18:42,619 - DEBUG - Recognized string extracted: w ( x , y ) = \sum _ { i = 1 } ^ { N } \lambda _ { i } \omega _ { i } , \lambda _ { i } = \frac { ( 1 / d _ { i } ) ^ { p } } { \sum _ { k = 1 } ^ { N } ( 1 / d _ { k } ) ^ { p } }
2025-06-10 20:18:42,620 - DEBUG - Generating chat message for label: formula
2025-06-10 20:18:42,620 - DEBUG - Snippet 10.3808_jei.200800130_645_item_3 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:18:42,635 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:18:42,636 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:18:42,636 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:18:42,670 - DEBUG - [Page 84] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:42,674 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:42,675 - DEBUG - Finished converting page batch time=3868.954
2025-06-10 20:18:42,676 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:18:42,691 - DEBUG - Snippet 10.3808_jei.200800130_645_item_3 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:18:42,711 - INFO - Finished converting document 10.18297_etd_3639_629.pdf in 70.82 sec.
2025-06-10 20:18:42,714 - DEBUG - [Page 17] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:42,715 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:18:42,755 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:18:42,825 - INFO - Finished converting document 10.1186_s12911-024-02815-6_650.pdf in 17.00 sec.
2025-06-10 20:18:42,834 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:18:42,896 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:18:42,917 - INFO - Extraction successful row 121, tokens=18955
2025-06-10 20:18:42,932 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:18:42,957 - INFO - Going to convert document batch...
2025-06-10 20:18:42,957 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:18:42,958 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:18:43,024 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:18:43,057 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:18:43,098 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:18:43,135 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:18:43,230 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:43,231 - DEBUG - Finished converting page batch time=3869.510
2025-06-10 20:18:43,282 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:18:43,464 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:43,672 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:18:43,682 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:18:43,731 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:18:43,738 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:18:43,745 - DEBUG - [Page 85] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:43,849 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:43,864 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:18:43,865 - INFO - Processing document 10.4081_gh.2018.587_655.pdf
2025-06-10 20:18:44,020 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:44,257 - DEBUG - [Page 86] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:44,278 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:18:44,278 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:18:44,278 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:18:44,326 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:18:44,333 - DEBUG - [Page 14] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:44,333 - DEBUG - [Page 18] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:44,366 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:18:44,412 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:18:44,467 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:18:44,527 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:18:44,571 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:18:44,643 - DEBUG - Snippet 10.3808_jei.200800130_645_item_3: generation shape=torch.Size([1, 414])
2025-06-10 20:18:44,645 - DEBUG - Snippet 10.3808_jei.200800130_645_item_3 raw docling: (tokens=68)
<formula><loc_0><loc_0><loc_500><loc_500>\sqrt { ( x _ { i } - x ) ^ { 2 } + ( y _ { i } - y ) ^ { 2 } + ( t _ { i } - t ) ^ { 2 } } \ .</formula><end_of_utterance>
2025-06-10 20:18:44,646 - DEBUG - Starting _parse_docling_output
2025-06-10 20:18:44,646 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>\sqrt { ( x _ { i } - x ) ^ { 2 } + ( y _ { i } - y ) ^ { 2 } + ( t _ { i } - t ) ^ { 2 } } \ .</formula><end_of_utterance>
2025-06-10 20:18:44,646 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:18:44,646 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>\\sqrt { ( x _ { i } - x ) ^ { 2 } + ( y _ { i } - y ) ^ { 2 } + ( t _ { i } - t ) ^ { 2 } } \\ .</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=340x71 at 0x7F96B29DB440>)]
2025-06-10 20:18:44,646 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:18:44,648 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=340.0, b=71.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 95))], orig='\\sqrt { ( x _ { i } - x ) ^ { 2 } + ( y _ { i } - y ) ^ { 2 } + ( t _ { i } - t ) ^ { 2 } } \\ .', text='\\sqrt { ( x _ { i } - x ) ^ { 2 } + ( y _ { i } - y ) ^ { 2 } + ( t _ { i } - t ) ^ { 2 } } \\ .', formatting=None, hyperlink=None)]
2025-06-10 20:18:44,648 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:18:44,648 - DEBUG - Processing text item: label=formula, text=\sqrt { ( x _ { i } - x ) ^ { 2 } + ( y _ { i } - y ) ^ { 2 } + ( t _ { i } - t ) ^ { 2 } } \ .
2025-06-10 20:18:44,649 - DEBUG - Recognized string extracted: \sqrt { ( x _ { i } - x ) ^ { 2 } + ( y _ { i } - y ) ^ { 2 } + ( t _ { i } - t ) ^ { 2 } } \ .
2025-06-10 20:18:44,649 - DEBUG - Generating chat message for label: formula
2025-06-10 20:18:44,649 - DEBUG - Snippet 10.3808_jei.200800130_645_item_4 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:18:44,699 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:18:44,737 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:18:44,813 - DEBUG - Snippet 10.3808_jei.200800130_645_item_4 => input_ids shape=torch.Size([1, 610]), prompt_len=610
2025-06-10 20:18:44,821 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:18:44,954 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:18:45,128 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:45,263 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:18:45,346 - DEBUG - [Page 15] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:45,452 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:18:45,453 - INFO - Processing document 10.3389_fneur.2024.1260643_656.pdf
2025-06-10 20:18:45,681 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:45,791 - INFO - Extraction successful row 110, tokens=138915
2025-06-10 20:18:45,835 - INFO - Going to convert document batch...
2025-06-10 20:18:45,836 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:18:45,836 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:18:45,859 - DEBUG - Finished converting page batch time=3872.138
2025-06-10 20:18:45,913 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:18:45,924 - DEBUG - [Page 87] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:45,925 - DEBUG - Finished converting page batch time=3872.204
2025-06-10 20:18:45,930 - DEBUG - [Page 19] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:45,931 - DEBUG - Finished converting page batch time=3872.209
2025-06-10 20:18:46,057 - DEBUG - [Page 20] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:46,058 - DEBUG - Finished converting page batch time=3872.336
2025-06-10 20:18:46,118 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:46,248 - DEBUG - [Page 88] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:46,337 - DEBUG - [Page 16] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:46,618 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:18:46,666 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:18:46,673 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:18:46,706 - DEBUG - [Page 89] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:46,844 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:47,060 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:47,066 - DEBUG - Finished converting page batch time=3873.345
2025-06-10 20:18:47,163 - DEBUG - [Page 90] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:47,320 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:47,368 - DEBUG - [Page 91] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:47,369 - DEBUG - Finished converting page batch time=3873.647
2025-06-10 20:18:47,473 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:18:47,473 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:18:47,474 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:18:47,512 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:18:47,562 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:18:47,602 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:18:47,639 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:18:47,673 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:47,681 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:18:47,734 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:18:47,855 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:18:47,871 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:47,893 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:18:47,933 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:18:48,014 - DEBUG - [Page 92] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:48,074 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:18:48,090 - DEBUG - [Page 17] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:48,130 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:48,357 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:18:48,446 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:48,529 - DEBUG - [Page 93] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:48,534 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:18:48,535 - INFO - Processing document 10.5194_acp-22-6523-2022_663.pdf
2025-06-10 20:18:48,608 - INFO - Finished converting document 10.1007_s40471-022-00290-z_649.pdf in 24.46 sec.
2025-06-10 20:18:48,632 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:48,745 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:48,907 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:48,931 - DEBUG - [Page 94] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:49,068 - DEBUG - Finished converting page batch time=3875.347
2025-06-10 20:18:49,080 - INFO - Extraction successful row 120, tokens=36076
2025-06-10 20:18:49,085 - DEBUG - [Page 18] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:49,134 - INFO - Going to convert document batch...
2025-06-10 20:18:49,134 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:18:49,135 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:18:49,182 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:18:49,284 - DEBUG - [Page 95] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:49,285 - DEBUG - Finished converting page batch time=3875.564
2025-06-10 20:18:49,497 - DEBUG - [Page 19] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:49,498 - DEBUG - Finished converting page batch time=3875.777
2025-06-10 20:18:49,606 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:49,671 - DEBUG - [Page 96] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:49,868 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:18:49,920 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:18:49,928 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:18:50,018 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:50,052 - DEBUG - [Page 97] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:50,127 - DEBUG - Snippet 10.3808_jei.200800130_645_item_4: generation shape=torch.Size([1, 788])
2025-06-10 20:18:50,128 - DEBUG - Snippet 10.3808_jei.200800130_645_item_4 raw docling: (tokens=177)
<formula><loc_29><loc_75><loc_471><loc_311>M A E = \sum _ { i = 1 } ^ { N } | I _ { i } - O _ { i } | \sum _ { N } ^ { N } ( I _ { i } - O _ { i } ) , \quad M B E = \frac { N } { N } \quad N \sum _ { i = 1 } ^ { N } | I _ { i } - O _ { i } | \\ R M S E = \sqrt { \sum _ { i = 1 } ^ { N } ( I _ { i } - O _ { i } ) ^ { 2 } } \quad M A P E = \frac { N } { N } \quad N</formula><end_of_utterance>
2025-06-10 20:18:50,133 - DEBUG - Starting _parse_docling_output
2025-06-10 20:18:50,134 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_29><loc_75><loc_471><loc_311>M A E = \sum _ { i = 1 } ^ { N } | I _ { i } - O _ { i } | \sum _ { N } ^ { N } ( I _ { i } - O _ { i } ) , \quad M B E = \frac { N } { N } \quad N \sum _ { i = 1 } ^ { N } | I _ { i } - O _ { i } | \\ R M S E = \sqrt { \sum _ { i = 1 } ^ { N } ( I _ { i } - O _ { i } ) ^ { 2 } } \quad M A P E = \frac { N } { N } \quad N</formula><end_of_utterance>
2025-06-10 20:18:50,134 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:18:50,134 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_29><loc_75><loc_471><loc_311>M A E = \\sum _ { i = 1 } ^ { N } | I _ { i } - O _ { i } | \\sum _ { N } ^ { N } ( I _ { i } - O _ { i } ) , \\quad M B E = \\frac { N } { N } \\quad N \\sum _ { i = 1 } ^ { N } | I _ { i } - O _ { i } | \\\\ R M S E = \\sqrt { \\sum _ { i = 1 } ^ { N } ( I _ { i } - O _ { i } ) ^ { 2 } } \\quad M A P E = \\frac { N } { N } \\quad N</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=700x315 at 0x7F96B29DA000>)]
2025-06-10 20:18:50,134 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:18:50,141 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=40.6, t=47.25, r=659.4, b=195.93, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 322))], orig='M A E = \\sum _ { i = 1 } ^ { N } | I _ { i } - O _ { i } | \\sum _ { N } ^ { N } ( I _ { i } - O _ { i } ) , \\quad M B E = \\frac { N } { N } \\quad N \\sum _ { i = 1 } ^ { N } | I _ { i } - O _ { i } | \\\\ R M S E = \\sqrt { \\sum _ { i = 1 } ^ { N } ( I _ { i } - O _ { i } ) ^ { 2 } } \\quad M A P E = \\frac { N } { N } \\quad N', text='M A E = \\sum _ { i = 1 } ^ { N } | I _ { i } - O _ { i } | \\sum _ { N } ^ { N } ( I _ { i } - O _ { i } ) , \\quad M B E = \\frac { N } { N } \\quad N \\sum _ { i = 1 } ^ { N } | I _ { i } - O _ { i } | \\\\ R M S E = \\sqrt { \\sum _ { i = 1 } ^ { N } ( I _ { i } - O _ { i } ) ^ { 2 } } \\quad M A P E = \\frac { N } { N } \\quad N', formatting=None, hyperlink=None)]
2025-06-10 20:18:50,142 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:18:50,142 - DEBUG - Processing text item: label=formula, text=M A E = \sum _ { i = 1 } ^ { N } | I _ { i } - O _ { i } | \sum _ { N } ^ { N } ( I _ { i } - O _ { i } ) , \quad M B E = \frac { N } { N } \quad N \sum _ { i = 1 } ^ { N } | I _ { i } - O _ { i } | \\ R M S E = \sqrt { \sum _ { i = 1 } ^ { N } ( I _ { i } - O _ { i } ) ^ { 2 } } \quad M A P E = \frac { N } { N } \quad N
2025-06-10 20:18:50,142 - DEBUG - Recognized string extracted: M A E = \sum _ { i = 1 } ^ { N } | I _ { i } - O _ { i } | \sum _ { N } ^ { N } ( I _ { i } - O _ { i } ) , \quad M B E = \frac { N } { N } \quad N \sum _ { i = 1 } ^ { N } | I _ { i } - O _ { i } | \\ R M S E = \sqrt { \sum _ { i = 1 } ^ { N } ( I _ { i } - O _ { i } ) ^ { 2 } } \quad M A P E = \frac { N } { N } \quad N
2025-06-10 20:18:50,142 - INFO - All done. Returning 5 recognized text results.
2025-06-10 20:18:50,142 - DEBUG - Snippet 10.3808_jei.200800130_645_item_0 recognized text:
w ( x , y , t ) = N _ { 1 } ( x , y , t ) w _ { 1 } + N _ { 2 } ( x , y , t ) w _ { 2 } + N _ { 3 } ( x , y , t ) w _ { 3 } \\ + N _ { 4 } ( x , y , t ) w _ { 4 }
2025-06-10 20:18:50,143 - DEBUG - Snippet 10.3808_jei.200800130_645_item_1 recognized text:
N _ { i } ( x , y , t ) = \frac { V _ { i } } { V } , \quad i = 1 , 2 , 3 , 4
2025-06-10 20:18:50,143 - DEBUG - Snippet 10.3808_jei.200800130_645_item_2 recognized text:
w ( x , y ) = \sum _ { i = 1 } ^ { N } \lambda _ { i } \omega _ { i } , \lambda _ { i } = \frac { ( 1 / d _ { i } ) ^ { p } } { \sum _ { k = 1 } ^ { N } ( 1 / d _ { k } ) ^ { p } }
2025-06-10 20:18:50,143 - DEBUG - Snippet 10.3808_jei.200800130_645_item_3 recognized text:
\sqrt { ( x _ { i } - x ) ^ { 2 } + ( y _ { i } - y ) ^ { 2 } + ( t _ { i } - t ) ^ { 2 } } \ .
2025-06-10 20:18:50,143 - DEBUG - Snippet 10.3808_jei.200800130_645_item_4 recognized text:
M A E = \sum _ { i = 1 } ^ { N } | I _ { i } - O _ { i } | \sum _ { N } ^ { N } ( I _ { i } - O _ { i } ) , \quad M B E = \frac { N } { N } \quad N \sum _ { i = 1 } ^ { N } | I _ { i } - O _ { i } | \\ R M S E = \sqrt { \sum _ { i = 1 } ^ { N } ( I _ { i } - O _ { i } ) ^ { 2 } } \quad M A P E = \frac { N } { N } \quad N
2025-06-10 20:18:50,223 - INFO - Finished converting document 10.3808_jei.200800130_645.pdf in 30.10 sec.
2025-06-10 20:18:50,231 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:50,324 - INFO - Extraction successful row 119, tokens=11425
2025-06-10 20:18:50,344 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:18:50,345 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:18:50,345 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:18:50,380 - INFO - Going to convert document batch...
2025-06-10 20:18:50,380 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:18:50,381 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:18:50,413 - DEBUG - [Page 20] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:50,429 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:18:50,493 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:18:50,530 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:18:50,566 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:18:50,606 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:18:50,645 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:18:50,689 - DEBUG - [Page 98] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:50,718 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:18:50,777 - DEBUG - [Page 21] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:50,858 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:18:50,879 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:50,915 - DEBUG - Finished converting page batch time=3877.193
2025-06-10 20:18:50,978 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:18:51,018 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:18:51,025 - DEBUG - [Page 99] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:51,026 - DEBUG - Finished converting page batch time=3877.304
2025-06-10 20:18:51,083 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:18:51,128 - DEBUG - [Page 22] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:51,181 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:18:51,387 - DEBUG - [Page 23] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:51,388 - DEBUG - Finished converting page batch time=3877.667
2025-06-10 20:18:51,413 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:51,430 - DEBUG - [Page 100] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:51,454 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:18:51,459 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:51,527 - DEBUG - [Page 24] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:51,641 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:18:51,641 - INFO - Processing document 10.5194_acp-21-18589-2021_666.pdf
2025-06-10 20:18:51,745 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:51,777 - DEBUG - [Page 25] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:51,778 - DEBUG - [Page 101] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:52,047 - DEBUG - [Page 26] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:52,050 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:52,064 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:18:52,070 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:18:52,111 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:52,224 - DEBUG - [Page 102] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:52,328 - DEBUG - [Page 27] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:52,338 - DEBUG - Finished converting page batch time=3878.617
2025-06-10 20:18:52,451 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:52,655 - DEBUG - [Page 28] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:52,732 - DEBUG - [Page 14] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:52,739 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:18:52,740 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:18:52,740 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:18:52,753 - DEBUG - [Page 103] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:52,754 - DEBUG - Finished converting page batch time=3879.033
2025-06-10 20:18:52,777 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:18:52,880 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:18:52,917 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:18:52,956 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:18:52,968 - DEBUG - [Page 29] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:52,991 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:18:53,026 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:18:53,131 - DEBUG - Finished converting page batch time=3879.410
2025-06-10 20:18:53,161 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:18:53,203 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:18:53,243 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:18:53,264 - DEBUG - [Page 15] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:53,265 - DEBUG - Finished converting page batch time=3879.544
2025-06-10 20:18:53,276 - DEBUG - Dynamic vertical threshold: 25.119000000000025, Overlap threshold: 0.7
2025-06-10 20:18:53,276 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:53,278 - DEBUG - Finished converting page batch time=3879.556
2025-06-10 20:18:53,356 - DEBUG - [Page 104] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:53,410 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:18:53,520 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:53,611 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:53,681 - DEBUG - [Page 16] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:53,711 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:18:53,924 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:18:53,925 - INFO - Processing document 10.5194_acp-21-10347-2021_667.pdf
2025-06-10 20:18:53,946 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:54,158 - DEBUG - Dynamic vertical threshold: 35.5824, Overlap threshold: 0.7
2025-06-10 20:18:54,159 - DEBUG - Checking merge:
  Current: 15, Next: 7
2025-06-10 20:18:54,159 - DEBUG -   Vertical gap: 29.27299999999991, Overlap ratio: 1.0
2025-06-10 20:18:54,160 - DEBUG -   Left boundary diff: 8.009999999999998, Right boundary diff: 0.0
2025-06-10 20:18:54,160 - DEBUG -   Alignment factor (ratio): 0.03380602684223853
2025-06-10 20:18:54,160 - DEBUG -   -> c1 15 formula number: 4, c2 7 formula number: 5
2025-06-10 20:18:54,160 - DEBUG -   -> Not merging clusters 15 and 7 due to different formula numbers: 4 vs 5
2025-06-10 20:18:54,160 - DEBUG - Checking merge:
  Current: 18, Next: 6
2025-06-10 20:18:54,161 - DEBUG -   Vertical gap: 27.216000000000008, Overlap ratio: 1.0
2025-06-10 20:18:54,161 - DEBUG -   Left boundary diff: 5.280000000000001, Right boundary diff: 0.0
2025-06-10 20:18:54,161 - DEBUG -   Alignment factor (ratio): 0.022927115221780762
2025-06-10 20:18:54,161 - DEBUG -   -> c1 18 formula number: 6, c2 6 formula number: 7
2025-06-10 20:18:54,162 - DEBUG -   -> Not merging clusters 18 and 6 due to different formula numbers: 6 vs 7
2025-06-10 20:18:54,162 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:54,252 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:54,254 - DEBUG - Finished converting page batch time=3880.533
2025-06-10 20:18:54,287 - DEBUG - [Page 30] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:54,433 - DEBUG - [Page 17] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:54,498 - DEBUG - [Page 31] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:54,499 - DEBUG - Finished converting page batch time=3880.778
2025-06-10 20:18:54,553 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:54,737 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:54,747 - DEBUG - [Page 32] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:54,891 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:54,968 - DEBUG - Dynamic vertical threshold: 77.7294000000002, Overlap threshold: 0.7
2025-06-10 20:18:54,968 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:54,970 - DEBUG - Finished converting page batch time=3881.248
2025-06-10 20:18:55,112 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:55,122 - DEBUG - [Page 105] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:55,205 - DEBUG - [Page 18] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:55,226 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:55,303 - DEBUG - [Page 33] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:55,371 - DEBUG - [Page 19] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:55,372 - DEBUG - Finished converting page batch time=3881.651
2025-06-10 20:18:55,532 - INFO - Finished converting document 10.1371_journal.pone.0122245_653.pdf in 17.31 sec.
2025-06-10 20:18:55,643 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:55,644 - DEBUG - Finished converting page batch time=3881.923
2025-06-10 20:18:55,671 - DEBUG - Dynamic vertical threshold: 49.91940000000001, Overlap threshold: 0.7
2025-06-10 20:18:55,671 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:55,676 - DEBUG - [Page 106] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:55,727 - INFO - Extraction successful row 123, tokens=25042
2025-06-10 20:18:55,749 - INFO - Going to convert document batch...
2025-06-10 20:18:55,749 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:18:55,750 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:18:55,798 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:18:56,083 - DEBUG - [Page 34] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:56,153 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:56,202 - DEBUG - [Page 107] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:56,203 - DEBUG - Finished converting page batch time=3882.482
2025-06-10 20:18:56,205 - DEBUG - Dynamic vertical threshold: 34.6608, Overlap threshold: 0.7
2025-06-10 20:18:56,205 - DEBUG - Checking merge:
  Current: 11, Next: 10
2025-06-10 20:18:56,205 - DEBUG -   Vertical gap: 3.353999999999985, Overlap ratio: 1.0
2025-06-10 20:18:56,205 - DEBUG -   Left boundary diff: 0.3689999999999998, Right boundary diff: 0.0
2025-06-10 20:18:56,206 - DEBUG -   Alignment factor (ratio): 0.001603779530296872
2025-06-10 20:18:56,206 - DEBUG -   -> c1 11 formula number: 2, c2 10 formula number: 3
2025-06-10 20:18:56,206 - DEBUG -   -> Not merging clusters 11 and 10 due to different formula numbers: 2 vs 3
2025-06-10 20:18:56,206 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:56,257 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:56,361 - DEBUG - [Page 35] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:56,362 - DEBUG - Finished converting page batch time=3882.640
2025-06-10 20:18:56,389 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:18:56,442 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:18:56,447 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:18:56,567 - DEBUG - [Page 36] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:56,865 - DEBUG - [Page 37] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:57,020 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:57,049 - DEBUG - [Page 108] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:57,051 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:18:57,052 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:18:57,052 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:18:57,058 - DEBUG - Dynamic vertical threshold: 26.15760000000007, Overlap threshold: 0.7
2025-06-10 20:18:57,058 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:57,088 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:18:57,119 - DEBUG - [Page 38] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:57,133 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:18:57,168 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:18:57,207 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:18:57,241 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:18:57,280 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:18:57,290 - DEBUG - [Page 39] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:57,291 - DEBUG - Finished converting page batch time=3883.570
2025-06-10 20:18:57,418 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:18:57,456 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:18:57,572 - DEBUG - [Page 109] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:57,586 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:57,586 - DEBUG - Finished converting page batch time=3883.865
2025-06-10 20:18:57,642 - DEBUG - [Page 40] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:57,674 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:57,765 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:57,814 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:18:58,051 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:18:58,065 - DEBUG - [Page 110] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:58,144 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:58,145 - DEBUG - Finished converting page batch time=3884.424
2025-06-10 20:18:58,179 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:58,295 - DEBUG - [Page 111] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:58,296 - DEBUG - Finished converting page batch time=3884.575
2025-06-10 20:18:58,405 - DEBUG - [Page 112] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:58,431 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:18:58,500 - DEBUG - [Page 113] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:58,563 - DEBUG - [Page 41] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:58,625 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:58,636 - DEBUG - [Page 114] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:58,653 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:18:58,654 - INFO - Processing document 10.3390_ijerph13121219_669.pdf
2025-06-10 20:18:58,800 - DEBUG - Dynamic vertical threshold: 22.93020000000001, Overlap threshold: 0.7
2025-06-10 20:18:58,800 - DEBUG - Checking merge:
  Current: 19, Next: 17
2025-06-10 20:18:58,800 - DEBUG -   Vertical gap: 2.3940000000000055, Overlap ratio: 1.0
2025-06-10 20:18:58,801 - DEBUG -   Left boundary diff: 4.433000000000007, Right boundary diff: 0.0010000000000331966
2025-06-10 20:18:58,801 - DEBUG -   Alignment factor (ratio): 0.022043978557718162
2025-06-10 20:18:58,801 - DEBUG -   -> c1 19 formula number: 6, c2 17 formula number: 7
2025-06-10 20:18:58,801 - DEBUG -   -> Not merging clusters 19 and 17 due to different formula numbers: 6 vs 7
2025-06-10 20:18:58,802 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:58,807 - DEBUG - [Page 115] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:58,833 - DEBUG - [Page 42] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:59,089 - DEBUG - Finished converting page batch time=3885.368
2025-06-10 20:18:59,110 - DEBUG - [Page 43] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:59,111 - DEBUG - Finished converting page batch time=3885.389
2025-06-10 20:18:59,211 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:59,276 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:59,287 - DEBUG - [Page 116] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:59,394 - DEBUG - [Page 44] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:59,400 - DEBUG - [Page 117] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:59,619 - DEBUG - [Page 118] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:59,791 - DEBUG - [Page 119] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:59,792 - DEBUG - Finished converting page batch time=3886.070
2025-06-10 20:18:59,824 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:59,825 - DEBUG - Finished converting page batch time=3886.104
2025-06-10 20:18:59,833 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:59,879 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:57,852 - DEBUG - [Page 120] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:57,862 - DEBUG - [Page 45] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:57,947 - DEBUG - [Page 121] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:58,053 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:58,088 - DEBUG - [Page 46] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:58,090 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:58,090 - DEBUG - [Page 122] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:58,161 - DEBUG - [Page 123] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:58,162 - DEBUG - Finished converting page batch time=3886.598
2025-06-10 20:18:58,251 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:58,253 - DEBUG - Finished converting page batch time=3886.689
2025-06-10 20:18:58,277 - DEBUG - [Page 124] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:58,347 - DEBUG - [Page 125] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:58,400 - DEBUG - [Page 47] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:58,466 - DEBUG - [Page 126] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:58,513 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:58,524 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:58,560 - DEBUG - Finished converting page batch time=3886.997
2025-06-10 20:18:58,740 - DEBUG - [Page 48] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:58,817 - DEBUG - [Page 127] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:58,830 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:58,831 - DEBUG - Finished converting page batch time=3887.267
2025-06-10 20:18:58,843 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:58,845 - DEBUG - Finished converting page batch time=3887.282
2025-06-10 20:18:58,957 - DEBUG - [Page 49] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:59,030 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:59,031 - DEBUG - Finished converting page batch time=3887.467
2025-06-10 20:18:59,037 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:59,151 - DEBUG - [Page 50] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:59,220 - INFO - Finished converting document 10.3389_fneur.2024.1260643_656.pdf in 18.46 sec.
2025-06-10 20:18:59,229 - DEBUG - Finished converting page batch time=3887.666
2025-06-10 20:18:59,269 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:59,287 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:59,358 - INFO - Extraction successful row 125, tokens=16507
2025-06-10 20:18:59,383 - INFO - Going to convert document batch...
2025-06-10 20:18:59,383 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:18:59,383 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:18:59,433 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:18:59,451 - DEBUG - [Page 128] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:59,465 - DEBUG - [Page 51] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:59,465 - DEBUG - Finished converting page batch time=3887.902
2025-06-10 20:18:59,544 - DEBUG - [Page 129] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:59,564 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:59,565 - DEBUG - Finished converting page batch time=3888.001
2025-06-10 20:18:59,869 - DEBUG - [Page 130] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:59,879 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:59,889 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:59,890 - DEBUG - Finished converting page batch time=3888.326
2025-06-10 20:18:59,940 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:59,962 - DEBUG - [Page 131] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:18:59,963 - DEBUG - Finished converting page batch time=3888.399
2025-06-10 20:19:00,046 - DEBUG - [Page 52] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:00,101 - INFO - Finished converting document 10.4081_gh.2018.587_655.pdf in 21.08 sec.
2025-06-10 20:19:00,178 - DEBUG - [Page 132] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:00,198 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:00,199 - DEBUG - Finished converting page batch time=3888.635
2025-06-10 20:19:00,214 - INFO - Extraction successful row 124, tokens=56031
2025-06-10 20:19:00,235 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:19:00,238 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:00,253 - INFO - Going to convert document batch...
2025-06-10 20:19:00,253 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:19:00,254 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:19:00,272 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:00,273 - DEBUG - Finished converting page batch time=3888.709
2025-06-10 20:19:00,288 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:19:00,295 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:19:00,314 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:19:00,363 - DEBUG - [Page 133] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:00,434 - DEBUG - Creating masked image for page 1 with 13 clusters.
2025-06-10 20:19:00,436 - INFO - Masked image successfully created for page 1.
2025-06-10 20:19:00,498 - DEBUG - [Page 53] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:00,505 - DEBUG - [Page 134] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:00,556 - DEBUG - Creating masked image for page 2 with 16 clusters.
2025-06-10 20:19:00,558 - INFO - Masked image successfully created for page 2.
2025-06-10 20:19:00,562 - INFO - Starting prediction for 2 images with labels: ['formula', 'formula']
2025-06-10 20:19:00,562 - DEBUG - Generating chat message for label: formula
2025-06-10 20:19:00,563 - DEBUG - Snippet 10.5194_acp-21-10347-2021_667_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:19:00,621 - DEBUG - [Page 135] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:00,621 - DEBUG - Finished converting page batch time=3889.057
2025-06-10 20:19:00,641 - DEBUG - Snippet 10.5194_acp-21-10347-2021_667_item_0 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:19:00,819 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:19:00,820 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:19:00,820 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:19:00,854 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:19:00,871 - DEBUG - [Page 136] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:00,889 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:19:00,926 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:19:00,970 - DEBUG - [Page 137] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:00,983 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:19:01,004 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:01,021 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:19:01,063 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:19:01,153 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:19:01,194 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:19:01,203 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:19:01,209 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:19:01,232 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:19:01,257 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:01,304 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:19:01,336 - DEBUG - [Page 54] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:01,456 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:19:01,481 - DEBUG - [Page 138] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:01,664 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:01,749 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:19:01,857 - DEBUG - [Page 55] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:01,857 - DEBUG - Finished converting page batch time=3890.294
2025-06-10 20:19:01,870 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:19:01,871 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:19:01,871 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:19:01,906 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:19:01,923 - DEBUG - [Page 139] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:01,924 - DEBUG - Finished converting page batch time=3890.360
2025-06-10 20:19:01,965 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:19:01,965 - INFO - Processing document 10.1007_s00038-015-0690-y_676.pdf
2025-06-10 20:19:02,051 - DEBUG - [Page 140] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:02,109 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:19:02,146 - DEBUG - [Page 14] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:02,147 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:19:02,148 - DEBUG - [Page 141] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:02,185 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:19:02,237 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:19:02,282 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:19:02,283 - DEBUG - [Page 142] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:02,389 - DEBUG - [Page 143] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:02,390 - DEBUG - Finished converting page batch time=3890.826
2025-06-10 20:19:02,409 - DEBUG - [Page 56] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:02,413 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:19:02,455 - DEBUG - Snippet 10.5194_acp-21-10347-2021_667_item_0: generation shape=torch.Size([1, 408])
2025-06-10 20:19:02,455 - DEBUG - Snippet 10.5194_acp-21-10347-2021_667_item_0 raw docling: (tokens=62)
<formula><loc_0><loc_0><loc_500><loc_500>R = \frac { P _ { H 2 O _ { 2 } } + P _ { R O O H } } { P _ { H N O _ { 3 } } } ,</formula><end_of_utterance>
2025-06-10 20:19:02,456 - DEBUG - Starting _parse_docling_output
2025-06-10 20:19:02,456 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>R = \frac { P _ { H 2 O _ { 2 } } + P _ { R O O H } } { P _ { H N O _ { 3 } } } ,</formula><end_of_utterance>
2025-06-10 20:19:02,456 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:19:02,456 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>R = \\frac { P _ { H 2 O _ { 2 } } + P _ { R O O H } } { P _ { H N O _ { 3 } } } ,</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=681x122 at 0x7F96CEF3FFB0>)]
2025-06-10 20:19:02,457 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:19:02,460 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=681.0, b=122.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 81))], orig='R = \\frac { P _ { H 2 O _ { 2 } } + P _ { R O O H } } { P _ { H N O _ { 3 } } } ,', text='R = \\frac { P _ { H 2 O _ { 2 } } + P _ { R O O H } } { P _ { H N O _ { 3 } } } ,', formatting=None, hyperlink=None)]
2025-06-10 20:19:02,460 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:19:02,460 - DEBUG - Processing text item: label=formula, text=R = \frac { P _ { H 2 O _ { 2 } } + P _ { R O O H } } { P _ { H N O _ { 3 } } } ,
2025-06-10 20:19:02,460 - DEBUG - Recognized string extracted: R = \frac { P _ { H 2 O _ { 2 } } + P _ { R O O H } } { P _ { H N O _ { 3 } } } ,
2025-06-10 20:19:02,460 - DEBUG - Generating chat message for label: formula
2025-06-10 20:19:02,461 - DEBUG - Snippet 10.5194_acp-21-10347-2021_667_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:19:02,465 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:19:02,506 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:19:02,520 - DEBUG - [Page 144] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:02,527 - DEBUG - Snippet 10.5194_acp-21-10347-2021_667_item_1 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:19:02,597 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:02,617 - DEBUG - [Page 57] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:02,670 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:19:02,962 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:19:02,982 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:03,142 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:19:03,143 - INFO - Processing document 10.3390_atmos14101591_687.pdf
2025-06-10 20:19:03,391 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:03,408 - DEBUG - [Page 145] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:03,600 - DEBUG - [Page 58] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:03,742 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:03,845 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:03,904 - DEBUG - Snippet 10.5194_acp-21-10347-2021_667_item_1: generation shape=torch.Size([1, 396])
2025-06-10 20:19:03,905 - DEBUG - Snippet 10.5194_acp-21-10347-2021_667_item_1 raw docling: (tokens=50)
<formula><loc_0><loc_0><loc_500><loc_500>U = y _ { 0 } \left [ 1 - \exp ( - \beta \Delta X ) \right ] P o p ,</formula><end_of_utterance>
2025-06-10 20:19:03,905 - DEBUG - Starting _parse_docling_output
2025-06-10 20:19:03,905 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>U = y _ { 0 } \left [ 1 - \exp ( - \beta \Delta X ) \right ] P o p ,</formula><end_of_utterance>
2025-06-10 20:19:03,905 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:19:03,906 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>U = y _ { 0 } \\left [ 1 - \\exp ( - \\beta \\Delta X ) \\right ] P o p ,</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=651x63 at 0x7F96CEF3D010>)]
2025-06-10 20:19:03,906 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:19:03,908 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=651.0, b=63.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 68))], orig='U = y _ { 0 } \\left [ 1 - \\exp ( - \\beta \\Delta X ) \\right ] P o p ,', text='U = y _ { 0 } \\left [ 1 - \\exp ( - \\beta \\Delta X ) \\right ] P o p ,', formatting=None, hyperlink=None)]
2025-06-10 20:19:03,908 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:19:03,908 - DEBUG - Processing text item: label=formula, text=U = y _ { 0 } \left [ 1 - \exp ( - \beta \Delta X ) \right ] P o p ,
2025-06-10 20:19:03,908 - DEBUG - Recognized string extracted: U = y _ { 0 } \left [ 1 - \exp ( - \beta \Delta X ) \right ] P o p ,
2025-06-10 20:19:03,909 - INFO - All done. Returning 2 recognized text results.
2025-06-10 20:19:03,909 - DEBUG - Snippet 10.5194_acp-21-10347-2021_667_item_0 recognized text:
R = \frac { P _ { H 2 O _ { 2 } } + P _ { R O O H } } { P _ { H N O _ { 3 } } } ,
2025-06-10 20:19:03,909 - DEBUG - Snippet 10.5194_acp-21-10347-2021_667_item_1 recognized text:
U = y _ { 0 } \left [ 1 - \exp ( - \beta \Delta X ) \right ] P o p ,
2025-06-10 20:19:03,990 - INFO - Finished converting document 10.5194_acp-21-10347-2021_667.pdf in 15.82 sec.
2025-06-10 20:19:04,046 - DEBUG - [Page 15] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:04,047 - DEBUG - Finished converting page batch time=3892.483
2025-06-10 20:19:04,075 - INFO - Extraction successful row 128, tokens=12019
2025-06-10 20:19:04,110 - INFO - Going to convert document batch...
2025-06-10 20:19:04,110 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:19:04,111 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:19:04,160 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:19:04,317 - DEBUG - Finished converting page batch time=3892.753
2025-06-10 20:19:04,464 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:04,548 - DEBUG - [Page 14] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:04,679 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:04,746 - DEBUG - [Page 59] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:04,805 - DEBUG - [Page 15] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:04,805 - DEBUG - Finished converting page batch time=3893.242
2025-06-10 20:19:04,855 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:19:04,928 - DEBUG - [Page 146] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:04,989 - DEBUG - Creating masked image for page 3 with 13 clusters.
2025-06-10 20:19:04,990 - INFO - Masked image successfully created for page 3.
2025-06-10 20:19:05,087 - DEBUG - Creating masked image for page 4 with 21 clusters.
2025-06-10 20:19:05,089 - INFO - Masked image successfully created for page 4.
2025-06-10 20:19:05,097 - INFO - Starting prediction for 5 images with labels: ['formula', 'formula', 'formula', 'formula', 'formula']
2025-06-10 20:19:05,098 - DEBUG - Generating chat message for label: formula
2025-06-10 20:19:05,098 - DEBUG - Snippet 10.5194_acp-22-6523-2022_663_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:19:05,167 - DEBUG - Snippet 10.5194_acp-22-6523-2022_663_item_0 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:19:05,268 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:05,346 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:05,451 - DEBUG - [Page 16] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:05,460 - DEBUG - Finished converting page batch time=3893.896
2025-06-10 20:19:05,660 - DEBUG - [Page 60] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:05,718 - DEBUG - [Page 147] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:05,719 - DEBUG - Finished converting page batch time=3894.155
2025-06-10 20:19:05,762 - DEBUG - Dynamic vertical threshold: 83.61720000000001, Overlap threshold: 0.7
2025-06-10 20:19:05,762 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:06,211 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:06,211 - DEBUG - Finished converting page batch time=3894.648
2025-06-10 20:19:06,223 - DEBUG - Dynamic vertical threshold: 49.042799999999914, Overlap threshold: 0.7
2025-06-10 20:19:06,223 - DEBUG - Checking merge:
  Current: 7, Next: 6
2025-06-10 20:19:06,223 - DEBUG -   Vertical gap: 6.2450000000000045, Overlap ratio: 1.0
2025-06-10 20:19:06,223 - DEBUG -   Left boundary diff: 1.1619999999999777, Right boundary diff: 0.0
2025-06-10 20:19:06,224 - DEBUG -   Alignment factor (ratio): 0.00458205506352565
2025-06-10 20:19:06,224 - DEBUG -   -> c1 7 formula number: 1, c2 6 formula number: 2
2025-06-10 20:19:06,224 - DEBUG -   -> Not merging clusters 7 and 6 due to different formula numbers: 1 vs 2
2025-06-10 20:19:06,224 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:06,225 - DEBUG - Finished converting page batch time=3894.661
2025-06-10 20:19:06,365 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:06,495 - DEBUG - Snippet 10.5194_acp-22-6523-2022_663_item_0: generation shape=torch.Size([1, 394])
2025-06-10 20:19:06,496 - DEBUG - Snippet 10.5194_acp-22-6523-2022_663_item_0 raw docling: (tokens=48)
<formula><loc_0><loc_0><loc_500><loc_500>\dot { R } _ { i } = \exp ^ { \beta _ { i } * \Delta X _ { i } } ,</formula><end_of_utterance>
2025-06-10 20:19:06,496 - DEBUG - Starting _parse_docling_output
2025-06-10 20:19:06,496 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>\dot { R } _ { i } = \exp ^ { \beta _ { i } * \Delta X _ { i } } ,</formula><end_of_utterance>
2025-06-10 20:19:06,496 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:19:06,496 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>\\dot { R } _ { i } = \\exp ^ { \\beta _ { i } * \\Delta X _ { i } } ,</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=669x68 at 0x7F96B2753F20>)]
2025-06-10 20:19:06,497 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:19:06,499 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=669.0, b=68.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 66))], orig='\\dot { R } _ { i } = \\exp ^ { \\beta _ { i } * \\Delta X _ { i } } ,', text='\\dot { R } _ { i } = \\exp ^ { \\beta _ { i } * \\Delta X _ { i } } ,', formatting=None, hyperlink=None)]
2025-06-10 20:19:06,499 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:19:06,499 - DEBUG - Processing text item: label=formula, text=\dot { R } _ { i } = \exp ^ { \beta _ { i } * \Delta X _ { i } } ,
2025-06-10 20:19:06,500 - DEBUG - Recognized string extracted: \dot { R } _ { i } = \exp ^ { \beta _ { i } * \Delta X _ { i } } ,
2025-06-10 20:19:06,500 - DEBUG - Generating chat message for label: formula
2025-06-10 20:19:06,500 - DEBUG - Snippet 10.5194_acp-22-6523-2022_663_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:19:06,563 - DEBUG - Snippet 10.5194_acp-22-6523-2022_663_item_1 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:19:06,652 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:06,657 - DEBUG - [Page 148] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:06,686 - DEBUG - [Page 61] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:06,824 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:06,966 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:06,966 - DEBUG - Finished converting page batch time=3895.403
2025-06-10 20:19:07,024 - DEBUG - [Page 17] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:07,303 - DEBUG - [Page 149] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:07,352 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:07,491 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:07,894 - DEBUG - Snippet 10.5194_acp-22-6523-2022_663_item_1: generation shape=torch.Size([1, 394])
2025-06-10 20:19:07,895 - DEBUG - Snippet 10.5194_acp-22-6523-2022_663_item_1 raw docling: (tokens=48)
<formula><loc_0><loc_0><loc_500><loc_500>E R _ { i } = ( R R _ { i } - 1 ) \times 1 0 0 \% .</formula><end_of_utterance>
2025-06-10 20:19:07,895 - DEBUG - Starting _parse_docling_output
2025-06-10 20:19:07,895 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>E R _ { i } = ( R R _ { i } - 1 ) \times 1 0 0 \% .</formula><end_of_utterance>
2025-06-10 20:19:07,895 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:19:07,896 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>E R _ { i } = ( R R _ { i } - 1 ) \\times 1 0 0 \\% .</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=710x55 at 0x7F96B27522D0>)]
2025-06-10 20:19:07,896 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:19:07,898 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=710.0, b=55.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 51))], orig='E R _ { i } = ( R R _ { i } - 1 ) \\times 1 0 0 \\% .', text='E R _ { i } = ( R R _ { i } - 1 ) \\times 1 0 0 \\% .', formatting=None, hyperlink=None)]
2025-06-10 20:19:07,898 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:19:07,898 - DEBUG - Processing text item: label=formula, text=E R _ { i } = ( R R _ { i } - 1 ) \times 1 0 0 \% .
2025-06-10 20:19:07,898 - DEBUG - Recognized string extracted: E R _ { i } = ( R R _ { i } - 1 ) \times 1 0 0 \% .
2025-06-10 20:19:07,899 - DEBUG - Generating chat message for label: formula
2025-06-10 20:19:07,899 - DEBUG - Snippet 10.5194_acp-22-6523-2022_663_item_2 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:19:07,961 - DEBUG - Snippet 10.5194_acp-22-6523-2022_663_item_2 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:19:08,038 - DEBUG - [Page 150] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:08,096 - DEBUG - [Page 62] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:08,199 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:19:08,206 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:19:08,579 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:08,799 - DEBUG - [Page 151] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:08,800 - DEBUG - Finished converting page batch time=3897.236
2025-06-10 20:19:08,838 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:08,932 - DEBUG - [Page 18] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:09,027 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:19:09,028 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:19:09,028 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:19:09,062 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:19:09,081 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:09,107 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:19:09,144 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:19:09,230 - DEBUG - [Page 63] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:09,356 - DEBUG - [Page 19] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:09,357 - DEBUG - Finished converting page batch time=3897.794
2025-06-10 20:19:09,365 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:19:09,392 - DEBUG - Snippet 10.5194_acp-22-6523-2022_663_item_2: generation shape=torch.Size([1, 394])
2025-06-10 20:19:09,393 - DEBUG - Snippet 10.5194_acp-22-6523-2022_663_item_2 raw docling: (tokens=47)
<formula><loc_0><loc_0><loc_500><loc_500>\Delta E R _ { i , urbanization } = E R _ { i , urban } - E R _ { i , rural } ,</formula><end_of_utterance>
2025-06-10 20:19:09,393 - DEBUG - Starting _parse_docling_output
2025-06-10 20:19:09,393 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>\Delta E R _ { i , urbanization } = E R _ { i , urban } - E R _ { i , rural } ,</formula><end_of_utterance>
2025-06-10 20:19:09,393 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:19:09,394 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>\\Delta E R _ { i , urbanization } = E R _ { i , urban } - E R _ { i , rural } ,</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=686x55 at 0x7F96B2753950>)]
2025-06-10 20:19:09,394 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:19:09,396 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=686.0, b=55.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 79))], orig='\\Delta E R _ { i , urbanization } = E R _ { i , urban } - E R _ { i , rural } ,', text='\\Delta E R _ { i , urbanization } = E R _ { i , urban } - E R _ { i , rural } ,', formatting=None, hyperlink=None)]
2025-06-10 20:19:09,396 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:19:09,399 - DEBUG - Processing text item: label=formula, text=\Delta E R _ { i , urbanization } = E R _ { i , urban } - E R _ { i , rural } ,
2025-06-10 20:19:09,400 - DEBUG - Recognized string extracted: \Delta E R _ { i , urbanization } = E R _ { i , urban } - E R _ { i , rural } ,
2025-06-10 20:19:09,400 - DEBUG - Generating chat message for label: formula
2025-06-10 20:19:09,400 - DEBUG - Snippet 10.5194_acp-22-6523-2022_663_item_3 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:19:09,405 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:19:09,444 - DEBUG - [Page 14] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:09,469 - DEBUG - Snippet 10.5194_acp-22-6523-2022_663_item_3 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:19:09,489 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:19:09,508 - DEBUG - Creating masked image for page 3 with 13 clusters.
2025-06-10 20:19:09,511 - INFO - Masked image successfully created for page 3.
2025-06-10 20:19:09,530 - DEBUG - Finished converting page batch time=3897.966
2025-06-10 20:19:09,608 - DEBUG - Creating masked image for page 4 with 12 clusters.
2025-06-10 20:19:09,609 - INFO - Masked image successfully created for page 4.
2025-06-10 20:19:09,631 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:19:09,665 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:19:09,700 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:19:09,704 - DEBUG - Creating masked image for page 5 with 19 clusters.
2025-06-10 20:19:09,706 - INFO - Masked image successfully created for page 5.
2025-06-10 20:19:09,714 - INFO - Starting prediction for 5 images with labels: ['formula', 'formula', 'formula', 'formula', 'formula']
2025-06-10 20:19:09,714 - DEBUG - Generating chat message for label: formula
2025-06-10 20:19:09,715 - DEBUG - Snippet 10.5194_acp-21-18589-2021_666_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:19:09,807 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:09,808 - DEBUG - Finished converting page batch time=3898.244
2025-06-10 20:19:09,843 - DEBUG - Snippet 10.5194_acp-21-18589-2021_666_item_0 => input_ids shape=torch.Size([1, 610]), prompt_len=610
2025-06-10 20:19:09,909 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:19:09,962 - DEBUG - [Page 64] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:10,020 - DEBUG - [Page 15] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:10,021 - DEBUG - Finished converting page batch time=3898.457
2025-06-10 20:19:10,229 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:10,251 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:19:10,344 - DEBUG - [Page 65] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:10,367 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:10,473 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:19:10,479 - INFO - Processing document 10.1214_10-aoas351_689.pdf
2025-06-10 20:19:10,597 - DEBUG - [Page 16] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:10,904 - DEBUG - [Page 66] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:10,992 - DEBUG - [Page 152] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:11,138 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:11,161 - DEBUG - [Page 17] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:11,623 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:11,688 - DEBUG - [Page 153] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:11,712 - DEBUG - Snippet 10.5194_acp-22-6523-2022_663_item_3: generation shape=torch.Size([1, 422])
2025-06-10 20:19:11,713 - DEBUG - Snippet 10.5194_acp-22-6523-2022_663_item_3 raw docling: (tokens=76)
<formula><loc_0><loc_0><loc_500><loc_500>C R _ { i , u r b a n i z a t i o n } = \frac { \Delta E R _ { i } } { E R _ { i , u r b a n } } \times 1 0 0 \% ,</formula><end_of_utterance>
2025-06-10 20:19:11,713 - DEBUG - Starting _parse_docling_output
2025-06-10 20:19:11,713 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>C R _ { i , u r b a n i z a t i o n } = \frac { \Delta E R _ { i } } { E R _ { i , u r b a n } } \times 1 0 0 \% ,</formula><end_of_utterance>
2025-06-10 20:19:11,714 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:19:11,714 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>C R _ { i , u r b a n i z a t i o n } = \\frac { \\Delta E R _ { i } } { E R _ { i , u r b a n } } \\times 1 0 0 \\% ,</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=710x119 at 0x7F96B2752990>)]
2025-06-10 20:19:11,714 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:19:11,717 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=710.0, b=119.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 114))], orig='C R _ { i , u r b a n i z a t i o n } = \\frac { \\Delta E R _ { i } } { E R _ { i , u r b a n } } \\times 1 0 0 \\% ,', text='C R _ { i , u r b a n i z a t i o n } = \\frac { \\Delta E R _ { i } } { E R _ { i , u r b a n } } \\times 1 0 0 \\% ,', formatting=None, hyperlink=None)]
2025-06-10 20:19:11,717 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:19:11,718 - DEBUG - Processing text item: label=formula, text=C R _ { i , u r b a n i z a t i o n } = \frac { \Delta E R _ { i } } { E R _ { i , u r b a n } } \times 1 0 0 \% ,
2025-06-10 20:19:11,718 - DEBUG - Recognized string extracted: C R _ { i , u r b a n i z a t i o n } = \frac { \Delta E R _ { i } } { E R _ { i , u r b a n } } \times 1 0 0 \% ,
2025-06-10 20:19:11,718 - DEBUG - Generating chat message for label: formula
2025-06-10 20:19:11,718 - DEBUG - Snippet 10.5194_acp-22-6523-2022_663_item_4 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:19:11,719 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:11,782 - DEBUG - Snippet 10.5194_acp-22-6523-2022_663_item_4 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:19:11,802 - DEBUG - [Page 18] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:11,869 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:11,870 - DEBUG - Finished converting page batch time=3900.307
2025-06-10 20:19:12,130 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:12,386 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:12,386 - DEBUG - Finished converting page batch time=3900.823
2025-06-10 20:19:12,450 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:12,455 - DEBUG - [Page 67] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:12,455 - DEBUG - Finished converting page batch time=3900.891
2025-06-10 20:19:12,510 - INFO - Finished converting document 10.1007_s00038-015-0690-y_676.pdf in 13.15 sec.
2025-06-10 20:19:12,551 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:12,552 - DEBUG - Finished converting page batch time=3900.988
2025-06-10 20:19:12,557 - DEBUG - [Page 154] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:12,581 - INFO - Extraction successful row 130, tokens=15005
2025-06-10 20:19:12,603 - INFO - Going to convert document batch...
2025-06-10 20:19:12,603 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:19:12,603 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:19:12,663 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:19:12,904 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:12,909 - DEBUG - [Page 19] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:12,910 - DEBUG - Finished converting page batch time=3901.346
2025-06-10 20:19:12,945 - DEBUG - [Page 68] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:13,209 - DEBUG - [Page 155] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:13,210 - DEBUG - Finished converting page batch time=3901.646
2025-06-10 20:19:13,435 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:19:13,456 - DEBUG - [Page 69] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:13,478 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:19:13,482 - DEBUG - Snippet 10.5194_acp-22-6523-2022_663_item_4: generation shape=torch.Size([1, 408])
2025-06-10 20:19:13,483 - DEBUG - Snippet 10.5194_acp-22-6523-2022_663_item_4 raw docling: (tokens=62)
<formula><loc_0><loc_0><loc_500><loc_500>\Delta E R _ { i , \sinop t i c } = E R _ { i , \sinop t i c } - E R _ { i , a v e r a g e }</formula><end_of_utterance>
2025-06-10 20:19:13,483 - DEBUG - Starting _parse_docling_output
2025-06-10 20:19:13,484 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>\Delta E R _ { i , \sinop t i c } = E R _ { i , \sinop t i c } - E R _ { i , a v e r a g e }</formula><end_of_utterance>
2025-06-10 20:19:13,484 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:19:13,484 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:19:13,484 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>\\Delta E R _ { i , \\sinop t i c } = E R _ { i , \\sinop t i c } - E R _ { i , a v e r a g e }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=686x54 at 0x7F96B27506B0>)]
2025-06-10 20:19:13,485 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:19:13,487 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=686.0, b=54.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 92))], orig='\\Delta E R _ { i , \\sinop t i c } = E R _ { i , \\sinop t i c } - E R _ { i , a v e r a g e }', text='\\Delta E R _ { i , \\sinop t i c } = E R _ { i , \\sinop t i c } - E R _ { i , a v e r a g e }', formatting=None, hyperlink=None)]
2025-06-10 20:19:13,487 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:19:13,487 - DEBUG - Processing text item: label=formula, text=\Delta E R _ { i , \sinop t i c } = E R _ { i , \sinop t i c } - E R _ { i , a v e r a g e }
2025-06-10 20:19:13,487 - DEBUG - Recognized string extracted: \Delta E R _ { i , \sinop t i c } = E R _ { i , \sinop t i c } - E R _ { i , a v e r a g e }
2025-06-10 20:19:13,487 - INFO - All done. Returning 5 recognized text results.
2025-06-10 20:19:13,488 - DEBUG - Snippet 10.5194_acp-22-6523-2022_663_item_0 recognized text:
\dot { R } _ { i } = \exp ^ { \beta _ { i } * \Delta X _ { i } } ,
2025-06-10 20:19:13,488 - DEBUG - Snippet 10.5194_acp-22-6523-2022_663_item_1 recognized text:
E R _ { i } = ( R R _ { i } - 1 ) \times 1 0 0 \% .
2025-06-10 20:19:13,488 - DEBUG - Snippet 10.5194_acp-22-6523-2022_663_item_2 recognized text:
\Delta E R _ { i , urbanization } = E R _ { i , urban } - E R _ { i , rural } ,
2025-06-10 20:19:13,488 - DEBUG - Snippet 10.5194_acp-22-6523-2022_663_item_3 recognized text:
C R _ { i , u r b a n i z a t i o n } = \frac { \Delta E R _ { i } } { E R _ { i , u r b a n } } \times 1 0 0 \% ,
2025-06-10 20:19:13,488 - DEBUG - Snippet 10.5194_acp-22-6523-2022_663_item_4 recognized text:
\Delta E R _ { i , \sinop t i c } = E R _ { i , \sinop t i c } - E R _ { i , a v e r a g e }
2025-06-10 20:19:13,492 - INFO - Starting prediction for 1 images with labels: ['formula']
2025-06-10 20:19:13,492 - DEBUG - Generating chat message for label: formula
2025-06-10 20:19:13,492 - DEBUG - Snippet 10.5194_acp-22-6523-2022_663_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:19:13,510 - DEBUG - [Page 20] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:13,561 - DEBUG - Snippet 10.5194_acp-22-6523-2022_663_item_0 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:19:13,764 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:13,793 - DEBUG - [Page 21] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:13,801 - DEBUG - Finished converting page batch time=3902.237
2025-06-10 20:19:13,950 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:13,952 - DEBUG - Finished converting page batch time=3902.388
2025-06-10 20:19:13,995 - DEBUG - Snippet 10.5194_acp-21-18589-2021_666_item_0: generation shape=torch.Size([1, 750])
2025-06-10 20:19:13,997 - DEBUG - Snippet 10.5194_acp-21-18589-2021_666_item_0 raw docling: (tokens=139)
<formula><loc_0><loc_0><loc_500><loc_500>L ^ { ( t ) } \simeq \sum _ { i = 1 } ^ { n } \left [ l \left ( y _ { i } , \hat { y } ^ { ( t - 1 ) } \right ) + g _ { i } f _ { t } ( x _ { i } ) + \frac { 1 } { 2 } h _ { i } f _ { t } ^ { 2 } ( x _ { i } ) \right ] \\ + \Omega ( f _ { t } ) ;</formula><end_of_utterance>
2025-06-10 20:19:13,997 - DEBUG - Starting _parse_docling_output
2025-06-10 20:19:13,997 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>L ^ { ( t ) } \simeq \sum _ { i = 1 } ^ { n } \left [ l \left ( y _ { i } , \hat { y } ^ { ( t - 1 ) } \right ) + g _ { i } f _ { t } ( x _ { i } ) + \frac { 1 } { 2 } h _ { i } f _ { t } ^ { 2 } ( x _ { i } ) \right ] \\ + \Omega ( f _ { t } ) ;</formula><end_of_utterance>
2025-06-10 20:19:13,997 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:19:13,998 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>L ^ { ( t ) } \\simeq \\sum _ { i = 1 } ^ { n } \\left [ l \\left ( y _ { i } , \\hat { y } ^ { ( t - 1 ) } \\right ) + g _ { i } f _ { t } ( x _ { i } ) + \\frac { 1 } { 2 } h _ { i } f _ { t } ^ { 2 } ( x _ { i } ) \\right ] \\\\ + \\Omega ( f _ { t } ) ;</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=710x191 at 0x7F96D627B320>)]
2025-06-10 20:19:13,998 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:19:13,999 - DEBUG - Creating masked image for page 9 with 13 clusters.
2025-06-10 20:19:14,001 - INFO - Masked image successfully created for page 9.
2025-06-10 20:19:14,003 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=710.0, b=191.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 246))], orig='L ^ { ( t ) } \\simeq \\sum _ { i = 1 } ^ { n } \\left [ l \\left ( y _ { i } , \\hat { y } ^ { ( t - 1 ) } \\right ) + g _ { i } f _ { t } ( x _ { i } ) + \\frac { 1 } { 2 } h _ { i } f _ { t } ^ { 2 } ( x _ { i } ) \\right ] \\\\ + \\Omega ( f _ { t } ) ;', text='L ^ { ( t ) } \\simeq \\sum _ { i = 1 } ^ { n } \\left [ l \\left ( y _ { i } , \\hat { y } ^ { ( t - 1 ) } \\right ) + g _ { i } f _ { t } ( x _ { i } ) + \\frac { 1 } { 2 } h _ { i } f _ { t } ^ { 2 } ( x _ { i } ) \\right ] \\\\ + \\Omega ( f _ { t } ) ;', formatting=None, hyperlink=None)]
2025-06-10 20:19:14,004 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:19:14,004 - DEBUG - Processing text item: label=formula, text=L ^ { ( t ) } \simeq \sum _ { i = 1 } ^ { n } \left [ l \left ( y _ { i } , \hat { y } ^ { ( t - 1 ) } \right ) + g _ { i } f _ { t } ( x _ { i } ) + \frac { 1 } { 2 } h _ { i } f _ { t } ^ { 2 } ( x _ { i } ) \right ] \\ + \Omega ( f _ { t } ) ;
2025-06-10 20:19:14,004 - DEBUG - Recognized string extracted: L ^ { ( t ) } \simeq \sum _ { i = 1 } ^ { n } \left [ l \left ( y _ { i } , \hat { y } ^ { ( t - 1 ) } \right ) + g _ { i } f _ { t } ( x _ { i } ) + \frac { 1 } { 2 } h _ { i } f _ { t } ^ { 2 } ( x _ { i } ) \right ] \\ + \Omega ( f _ { t } ) ;
2025-06-10 20:19:14,004 - DEBUG - Generating chat message for label: formula
2025-06-10 20:19:14,004 - DEBUG - Snippet 10.5194_acp-21-18589-2021_666_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:19:14,005 - INFO - Starting prediction for 1 images with labels: ['formula']
2025-06-10 20:19:14,005 - DEBUG - Generating chat message for label: formula
2025-06-10 20:19:14,006 - DEBUG - Snippet 10.3390_ijerph13121219_669_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:19:14,008 - DEBUG - [Page 70] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:14,075 - DEBUG - Snippet 10.5194_acp-21-18589-2021_666_item_1 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:19:14,079 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:19:14,080 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:19:14,080 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:19:14,084 - DEBUG - Snippet 10.3390_ijerph13121219_669_item_0 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:19:14,121 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:19:14,146 - DEBUG - [Page 156] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:14,149 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:14,149 - DEBUG - Finished converting page batch time=3902.585
2025-06-10 20:19:14,158 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:19:14,194 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:19:14,234 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:19:14,274 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:19:14,357 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:19:14,358 - DEBUG - Creating masked image for page 3 with 14 clusters.
2025-06-10 20:19:14,360 - INFO - Masked image successfully created for page 3.
2025-06-10 20:19:14,366 - INFO - Starting prediction for 2 images with labels: ['formula', 'formula']
2025-06-10 20:19:14,366 - DEBUG - Generating chat message for label: formula
2025-06-10 20:19:14,367 - DEBUG - Snippet 10.3390_atmos14101591_687_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:19:14,440 - DEBUG - Snippet 10.3390_atmos14101591_687_item_0 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:19:14,504 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:19:14,540 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:19:14,577 - DEBUG - [Page 71] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:14,578 - DEBUG - Finished converting page batch time=3903.014
2025-06-10 20:19:14,591 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:19:14,754 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:19:14,955 - DEBUG - [Page 157] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:15,050 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:19:15,120 - DEBUG - [Page 72] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:15,281 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:19:15,281 - INFO - Processing document 10.1007_s10661-015-4850-6_693.pdf
2025-06-10 20:19:15,374 - DEBUG - [Page 73] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:15,687 - DEBUG - Snippet 10.5194_acp-22-6523-2022_663_item_0: generation shape=torch.Size([1, 415])
2025-06-10 20:19:15,690 - DEBUG - Snippet 10.5194_acp-22-6523-2022_663_item_0 raw docling: (tokens=69)
<formula><loc_0><loc_0><loc_500><loc_500>\AA R _ { i , \sinop tic } = \frac { \Delta E R _ { i } } { E R _ { i , \sinop tic } } \times 1 0 0 \% ,</formula><end_of_utterance>
2025-06-10 20:19:15,690 - DEBUG - Starting _parse_docling_output
2025-06-10 20:19:15,691 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>\AA R _ { i , \sinop tic } = \frac { \Delta E R _ { i } } { E R _ { i , \sinop tic } } \times 1 0 0 \% ,</formula><end_of_utterance>
2025-06-10 20:19:15,691 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:19:15,691 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>\\AA R _ { i , \\sinop tic } = \\frac { \\Delta E R _ { i } } { E R _ { i , \\sinop tic } } \\times 1 0 0 \\% ,</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=669x119 at 0x7F96B2752690>)]
2025-06-10 20:19:15,691 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:19:15,695 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=669.0, b=119.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 104))], orig='\\AA R _ { i , \\sinop tic } = \\frac { \\Delta E R _ { i } } { E R _ { i , \\sinop tic } } \\times 1 0 0 \\% ,', text='\\AA R _ { i , \\sinop tic } = \\frac { \\Delta E R _ { i } } { E R _ { i , \\sinop tic } } \\times 1 0 0 \\% ,', formatting=None, hyperlink=None)]
2025-06-10 20:19:15,695 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:19:15,695 - DEBUG - Processing text item: label=formula, text=\AA R _ { i , \sinop tic } = \frac { \Delta E R _ { i } } { E R _ { i , \sinop tic } } \times 1 0 0 \% ,
2025-06-10 20:19:15,695 - DEBUG - Recognized string extracted: \AA R _ { i , \sinop tic } = \frac { \Delta E R _ { i } } { E R _ { i , \sinop tic } } \times 1 0 0 \% ,
2025-06-10 20:19:15,696 - INFO - All done. Returning 1 recognized text results.
2025-06-10 20:19:15,696 - DEBUG - Snippet 10.5194_acp-22-6523-2022_663_item_0 recognized text:
\AA R _ { i , \sinop tic } = \frac { \Delta E R _ { i } } { E R _ { i , \sinop tic } } \times 1 0 0 \% ,
2025-06-10 20:19:15,717 - DEBUG - [Page 74] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:15,807 - DEBUG - [Page 158] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:15,823 - INFO - Finished converting document 10.5194_acp-22-6523-2022_663.pdf in 32.19 sec.
2025-06-10 20:19:15,896 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:15,993 - INFO - Extraction successful row 126, tokens=32783
2025-06-10 20:19:16,017 - INFO - Going to convert document batch...
2025-06-10 20:19:16,018 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:19:16,018 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:19:16,071 - DEBUG - [Page 75] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:16,072 - DEBUG - Finished converting page batch time=3904.508
2025-06-10 20:19:16,078 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:19:16,294 - DEBUG - Snippet 10.5194_acp-21-18589-2021_666_item_1: generation shape=torch.Size([1, 418])
2025-06-10 20:19:16,295 - DEBUG - Snippet 10.5194_acp-21-18589-2021_666_item_1 raw docling: (tokens=72)
<formula><loc_0><loc_0><loc_500><loc_500>g _ { i } = \partial _ { \hat { y } ^ { ( t - 1 ) } } l \left ( y _ { i } , \hat { y } ^ { ( t - 1 ) } \right ) ;</formula><end_of_utterance>
2025-06-10 20:19:16,296 - DEBUG - Starting _parse_docling_output
2025-06-10 20:19:16,296 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>g _ { i } = \partial _ { \hat { y } ^ { ( t - 1 ) } } l \left ( y _ { i } , \hat { y } ^ { ( t - 1 ) } \right ) ;</formula><end_of_utterance>
2025-06-10 20:19:16,296 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:19:16,297 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>g _ { i } = \\partial _ { \\hat { y } ^ { ( t - 1 ) } } l \\left ( y _ { i } , \\hat { y } ^ { ( t - 1 ) } \\right ) ;</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=678x82 at 0x7F96D6240050>)]
2025-06-10 20:19:16,297 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:19:16,300 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=678.0, b=82.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 113))], orig='g _ { i } = \\partial _ { \\hat { y } ^ { ( t - 1 ) } } l \\left ( y _ { i } , \\hat { y } ^ { ( t - 1 ) } \\right ) ;', text='g _ { i } = \\partial _ { \\hat { y } ^ { ( t - 1 ) } } l \\left ( y _ { i } , \\hat { y } ^ { ( t - 1 ) } \\right ) ;', formatting=None, hyperlink=None)]
2025-06-10 20:19:16,300 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:19:16,300 - DEBUG - Processing text item: label=formula, text=g _ { i } = \partial _ { \hat { y } ^ { ( t - 1 ) } } l \left ( y _ { i } , \hat { y } ^ { ( t - 1 ) } \right ) ;
2025-06-10 20:19:16,300 - DEBUG - Recognized string extracted: g _ { i } = \partial _ { \hat { y } ^ { ( t - 1 ) } } l \left ( y _ { i } , \hat { y } ^ { ( t - 1 ) } \right ) ;
2025-06-10 20:19:16,301 - DEBUG - Generating chat message for label: formula
2025-06-10 20:19:16,301 - DEBUG - Snippet 10.5194_acp-21-18589-2021_666_item_2 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:19:16,310 - WARNING - Repetitive generation detected with pattern: ' l } { { \begin{array} { l'
2025-06-10 20:19:16,311 - DEBUG - Snippet 10.3390_ijerph13121219_669_item_0: generation shape=torch.Size([1, 422])
2025-06-10 20:19:16,312 - DEBUG - Snippet 10.3390_ijerph13121219_669_item_0 raw docling: (tokens=76)
<formula><loc_0><loc_0><loc_500><loc_500>\begin{array} { l } { { \begin{array} { l } { { \begin{array} { l l } { { \begin{array} { l l } { { \begin{array} { l l } { { \begin{array} { l
2025-06-10 20:19:16,313 - DEBUG - Starting _parse_docling_output
2025-06-10 20:19:16,313 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>\begin{array} { l } { { \begin{array} { l } { { \begin{array} { l l } { { \begin{array} { l l } { { \begin{array} { l l } { { \begin{array} { l
2025-06-10 20:19:16,313 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:19:16,313 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>\\begin{array} { l } { { \\begin{array} { l } { { \\begin{array} { l l } { { \\begin{array} { l l } { { \\begin{array} { l l } { { \\begin{array} { l', image=<PIL.Image.Image image mode=RGB size=963x207 at 0x7F9698A40C20>)]
2025-06-10 20:19:16,314 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:19:16,377 - DEBUG - Snippet 10.5194_acp-21-18589-2021_666_item_2 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:19:16,438 - DEBUG - [Page 76] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:16,602 - DEBUG - Snippet 10.3390_atmos14101591_687_item_0: generation shape=torch.Size([1, 418])
2025-06-10 20:19:16,603 - DEBUG - Snippet 10.3390_atmos14101591_687_item_0 raw docling: (tokens=72)
<formula><loc_0><loc_0><loc_500><loc_500>R R = \begin{cases} e ^ { p ( x - x _ { 0 } ) } , & x > x _ { 0 } \\ 1 , & x \leq x _ { 0 } \end{cases}</formula><end_of_utterance>
2025-06-10 20:19:16,604 - DEBUG - Starting _parse_docling_output
2025-06-10 20:19:16,604 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>R R = \begin{cases} e ^ { p ( x - x _ { 0 } ) } , & x > x _ { 0 } \\ 1 , & x \leq x _ { 0 } \end{cases}</formula><end_of_utterance>
2025-06-10 20:19:16,604 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:19:16,604 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>R R = \\begin{cases} e ^ { p ( x - x _ { 0 } ) } , & x > x _ { 0 } \\\\ 1 , & x \\leq x _ { 0 } \\end{cases}</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=746x126 at 0x7F96DDFADD60>)]
2025-06-10 20:19:16,605 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:19:16,608 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=746.0, b=126.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 103))], orig='R R = \\begin{cases} e ^ { p ( x - x _ { 0 } ) } , & x > x _ { 0 } \\\\ 1 , & x \\leq x _ { 0 } \\end{cases}', text='R R = \\begin{cases} e ^ { p ( x - x _ { 0 } ) } , & x > x _ { 0 } \\\\ 1 , & x \\leq x _ { 0 } \\end{cases}', formatting=None, hyperlink=None)]
2025-06-10 20:19:16,608 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:19:16,608 - DEBUG - Processing text item: label=formula, text=R R = \begin{cases} e ^ { p ( x - x _ { 0 } ) } , & x > x _ { 0 } \\ 1 , & x \leq x _ { 0 } \end{cases}
2025-06-10 20:19:16,609 - DEBUG - Recognized string extracted: R R = \begin{cases} e ^ { p ( x - x _ { 0 } ) } , & x > x _ { 0 } \\ 1 , & x \leq x _ { 0 } \end{cases}
2025-06-10 20:19:16,609 - DEBUG - Generating chat message for label: formula
2025-06-10 20:19:16,609 - DEBUG - Snippet 10.3390_atmos14101591_687_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:19:16,676 - DEBUG - DoclingDocument loaded successfully. Extracted texts: []
2025-06-10 20:19:16,676 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:19:16,676 - WARNING - Extracted text is empty or malformed. Skipping formula.
2025-06-10 20:19:16,676 - INFO - All done. Returning 1 recognized text results.
2025-06-10 20:19:16,677 - DEBUG - Snippet 10.3390_ijerph13121219_669_item_0 recognized text:
MALFORMED_FORMULA
2025-06-10 20:19:16,680 - DEBUG - Snippet 10.3390_atmos14101591_687_item_1 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:19:16,680 - DEBUG - [Page 159] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:16,681 - DEBUG - Finished converting page batch time=3905.117
2025-06-10 20:19:16,764 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:16,831 - INFO - Finished converting document 10.3390_ijerph13121219_669.pdf in 23.26 sec.
2025-06-10 20:19:16,839 - DEBUG - [Page 77] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:16,898 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:19:16,931 - DEBUG - [Page 78] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:16,955 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:19:16,961 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:19:17,058 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:17,116 - INFO - Extraction successful row 129, tokens=52654
2025-06-10 20:19:17,160 - INFO - Going to convert document batch...
2025-06-10 20:19:17,160 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:19:17,161 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:19:17,177 - DEBUG - [Page 79] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:17,178 - DEBUG - Finished converting page batch time=3905.614
2025-06-10 20:19:17,212 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:19:17,416 - DEBUG - [Page 80] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:17,439 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:17,440 - DEBUG - Finished converting page batch time=3905.876
2025-06-10 20:19:17,491 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:19:17,491 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:19:17,492 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:19:17,529 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:19:17,568 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:19:17,613 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:19:17,621 - DEBUG - [Page 160] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:17,648 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:17,650 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:19:17,687 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:19:17,781 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:17,791 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:19:17,845 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:17,925 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:19:17,925 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:19:17,969 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:19:17,975 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:19:17,981 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:19:17,991 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:18,043 - DEBUG - Dynamic vertical threshold: 88.61400000000003, Overlap threshold: 0.7
2025-06-10 20:19:18,044 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:18,044 - DEBUG - Finished converting page batch time=3906.481
2025-06-10 20:19:18,078 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:19:18,123 - DEBUG - Snippet 10.3390_atmos14101591_687_item_1: generation shape=torch.Size([1, 394])
2025-06-10 20:19:18,129 - DEBUG - Snippet 10.3390_atmos14101591_687_item_1 raw docling: (tokens=48)
<formula><loc_0><loc_0><loc_500><loc_500>\Delta M = y _ { 0 } \times P o p \times \frac { R R - 1 } { R R }</formula><end_of_utterance>
2025-06-10 20:19:18,129 - DEBUG - Starting _parse_docling_output
2025-06-10 20:19:18,136 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>\Delta M = y _ { 0 } \times P o p \times \frac { R R - 1 } { R R }</formula><end_of_utterance>
2025-06-10 20:19:18,137 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:19:18,137 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>\\Delta M = y _ { 0 } \\times P o p \\times \\frac { R R - 1 } { R R }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=749x117 at 0x7F971CFD77D0>)]
2025-06-10 20:19:18,137 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:19:18,140 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=749.0, b=117.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 66))], orig='\\Delta M = y _ { 0 } \\times P o p \\times \\frac { R R - 1 } { R R }', text='\\Delta M = y _ { 0 } \\times P o p \\times \\frac { R R - 1 } { R R }', formatting=None, hyperlink=None)]
2025-06-10 20:19:18,140 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:19:18,141 - DEBUG - Processing text item: label=formula, text=\Delta M = y _ { 0 } \times P o p \times \frac { R R - 1 } { R R }
2025-06-10 20:19:18,141 - DEBUG - Recognized string extracted: \Delta M = y _ { 0 } \times P o p \times \frac { R R - 1 } { R R }
2025-06-10 20:19:18,141 - INFO - All done. Returning 2 recognized text results.
2025-06-10 20:19:18,141 - DEBUG - Snippet 10.3390_atmos14101591_687_item_0 recognized text:
R R = \begin{cases} e ^ { p ( x - x _ { 0 } ) } , & x > x _ { 0 } \\ 1 , & x \leq x _ { 0 } \end{cases}
2025-06-10 20:19:18,141 - DEBUG - Snippet 10.3390_atmos14101591_687_item_1 recognized text:
\Delta M = y _ { 0 } \times P o p \times \frac { R R - 1 } { R R }
2025-06-10 20:19:18,227 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:19:18,248 - INFO - Finished converting document 10.3390_atmos14101591_687.pdf in 18.03 sec.
2025-06-10 20:19:18,368 - DEBUG - Dynamic vertical threshold: 63.95040000000004, Overlap threshold: 0.7
2025-06-10 20:19:18,368 - DEBUG - Checking merge:
  Current: 9, Next: 11
2025-06-10 20:19:18,369 - DEBUG -   Vertical gap: 9.853999999999985, Overlap ratio: 1.0
2025-06-10 20:19:18,369 - DEBUG -   Left boundary diff: 0.0, Right boundary diff: 83.73699999999997
2025-06-10 20:19:18,369 - DEBUG -   Alignment factor (ratio): 0.3171681858382777
2025-06-10 20:19:18,369 - DEBUG -   -> c1 9 formula number: B, c2 11 formula number: 2
2025-06-10 20:19:18,369 - DEBUG -   -> Not merging clusters 9 and 11 due to different formula numbers: B vs 2
2025-06-10 20:19:18,370 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:18,371 - DEBUG - Finished converting page batch time=3906.807
2025-06-10 20:19:18,390 - INFO - Extraction successful row 131, tokens=15155
2025-06-10 20:19:18,415 - INFO - Going to convert document batch...
2025-06-10 20:19:18,415 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:19:18,415 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:19:18,449 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:19:18,449 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:19:18,450 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:19:18,464 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:19:18,479 - DEBUG - [Page 161] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:18,486 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:19:18,525 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:19:18,554 - DEBUG - Dynamic vertical threshold: 48.582000000000015, Overlap threshold: 0.7
2025-06-10 20:19:18,554 - DEBUG - Checking merge:
  Current: 6, Next: 10
2025-06-10 20:19:18,554 - DEBUG -   Vertical gap: 23.83699999999999, Overlap ratio: 0.9999524452644994
2025-06-10 20:19:18,555 - DEBUG -   Left boundary diff: 0.014999999999986358, Right boundary diff: 0.018000000000029104
2025-06-10 20:19:18,555 - DEBUG -   Alignment factor (ratio): 8.355479221561362e-05
2025-06-10 20:19:18,555 - DEBUG -   -> c1 6 formula number: None, c2 10 formula number: None
2025-06-10 20:19:18,556 - DEBUG -   -> Not merging clusters 6 and 10 because vertical_gap 23.83699999999999 > 3 with no numbers
2025-06-10 20:19:18,556 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:18,569 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:19:18,609 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:19:18,647 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:19:18,663 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:19:18,685 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:19:18,688 - DEBUG - [Page 81] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:18,782 - DEBUG - Dynamic vertical threshold: 45.93780000000013, Overlap threshold: 0.7
2025-06-10 20:19:18,782 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:18,828 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:19:18,865 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:19:18,867 - DEBUG - Snippet 10.5194_acp-21-18589-2021_666_item_2: generation shape=torch.Size([1, 426])
2025-06-10 20:19:18,868 - DEBUG - Snippet 10.5194_acp-21-18589-2021_666_item_2 raw docling: (tokens=80)
<formula><loc_0><loc_0><loc_500><loc_500>\acute { h } _ { i } = \partial _ { \hat { y } ^ { ( t - 1 ) } } ^ { 2 } l \left ( y _ { i } , \hat { y } ^ { ( t - 1 ) } \right ) .</formula><end_of_utterance>
2025-06-10 20:19:18,869 - DEBUG - Starting _parse_docling_output
2025-06-10 20:19:18,869 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>\acute { h } _ { i } = \partial _ { \hat { y } ^ { ( t - 1 ) } } ^ { 2 } l \left ( y _ { i } , \hat { y } ^ { ( t - 1 ) } \right ) .</formula><end_of_utterance>
2025-06-10 20:19:18,869 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:19:18,869 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:19:18,869 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>\\acute { h } _ { i } = \\partial _ { \\hat { y } ^ { ( t - 1 ) } } ^ { 2 } l \\left ( y _ { i } , \\hat { y } ^ { ( t - 1 ) } \\right ) .</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=677x88 at 0x7F96D6241640>)]
2025-06-10 20:19:18,870 - INFO - Processing document 10.3390_ijerph121012735_696.pdf
2025-06-10 20:19:18,870 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:19:18,872 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=677.0, b=88.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 132))], orig='\\acute { h } _ { i } = \\partial _ { \\hat { y } ^ { ( t - 1 ) } } ^ { 2 } l \\left ( y _ { i } , \\hat { y } ^ { ( t - 1 ) } \\right ) .', text='\\acute { h } _ { i } = \\partial _ { \\hat { y } ^ { ( t - 1 ) } } ^ { 2 } l \\left ( y _ { i } , \\hat { y } ^ { ( t - 1 ) } \\right ) .', formatting=None, hyperlink=None)]
2025-06-10 20:19:18,876 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:19:18,877 - DEBUG - Processing text item: label=formula, text=\acute { h } _ { i } = \partial _ { \hat { y } ^ { ( t - 1 ) } } ^ { 2 } l \left ( y _ { i } , \hat { y } ^ { ( t - 1 ) } \right ) .
2025-06-10 20:19:18,877 - DEBUG - Recognized string extracted: \acute { h } _ { i } = \partial _ { \hat { y } ^ { ( t - 1 ) } } ^ { 2 } l \left ( y _ { i } , \hat { y } ^ { ( t - 1 ) } \right ) .
2025-06-10 20:19:18,877 - DEBUG - Generating chat message for label: formula
2025-06-10 20:19:18,877 - DEBUG - Snippet 10.5194_acp-21-18589-2021_666_item_3 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:19:18,902 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:19:18,942 - DEBUG - Snippet 10.5194_acp-21-18589-2021_666_item_3 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:19:18,995 - DEBUG - [Page 82] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:19,063 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:19:19,165 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:19,165 - DEBUG - Dynamic vertical threshold: 177.83819999999997, Overlap threshold: 0.7
2025-06-10 20:19:19,166 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:19,222 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:19,236 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:19:19,290 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:19:19,297 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:19:19,446 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:19:19,463 - DEBUG - [Page 162] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:19,549 - DEBUG - Dynamic vertical threshold: 45.87659999999994, Overlap threshold: 0.7
2025-06-10 20:19:19,551 - DEBUG - [Page 14] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:19,657 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:19:19,658 - INFO - Processing document 10.3390_foods10061279_697.pdf
2025-06-10 20:19:19,814 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:19,911 - DEBUG - Dynamic vertical threshold: 56.750400000000035, Overlap threshold: 0.7
2025-06-10 20:19:19,911 - DEBUG - Checking merge:
  Current: 17, Next: 12
2025-06-10 20:19:19,911 - DEBUG -   Vertical gap: 40.601, Overlap ratio: 1.0
2025-06-10 20:19:19,912 - DEBUG -   Left boundary diff: 0.0, Right boundary diff: 95.56200000000001
2025-06-10 20:19:19,912 - DEBUG -   Alignment factor (ratio): 0.3337920724295475
2025-06-10 20:19:19,912 - DEBUG -   -> c1 17 formula number: 10, c2 12 formula number: 11
2025-06-10 20:19:19,913 - DEBUG -   -> Not merging clusters 17 and 12 due to different formula numbers: 10 vs 11
2025-06-10 20:19:19,913 - DEBUG - Checking merge:
  Current: 16, Next: 15
2025-06-10 20:19:19,913 - DEBUG -   Vertical gap: 47.05599999999998, Overlap ratio: 1.0
2025-06-10 20:19:19,913 - DEBUG -   Left boundary diff: 0.027000000000001023, Right boundary diff: 106.05699999999996
2025-06-10 20:19:19,914 - DEBUG -   Alignment factor (ratio): 0.3559819822238929
2025-06-10 20:19:19,914 - DEBUG -   -> c1 16 formula number: 12, c2 15 formula number: 13
2025-06-10 20:19:19,914 - DEBUG -   -> Not merging clusters 16 and 15 due to different formula numbers: 12 vs 13
2025-06-10 20:19:19,914 - DEBUG - Checking merge:
  Current: 20, Next: 15
2025-06-10 20:19:19,915 - DEBUG -   Vertical gap: 25.726, Overlap ratio: 0.8531340790870027
2025-06-10 20:19:19,915 - DEBUG -   Left boundary diff: 50.652, Right boundary diff: 73.43199999999996
2025-06-10 20:19:19,915 - DEBUG -   Alignment factor (ratio): 0.28653482963679766
2025-06-10 20:19:19,915 - DEBUG -   -> c1 20 formula number: None, c2 15 formula number: 13
2025-06-10 20:19:19,916 - DEBUG -   -> Not merging 20 and 15 (one missing, gap 25.726 > 12.8)
2025-06-10 20:19:19,916 - DEBUG - [Page 15] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:19,917 - DEBUG - Finished converting page batch time=3908.353
2025-06-10 20:19:19,937 - DEBUG - [Page 163] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:19,937 - DEBUG - Finished converting page batch time=3908.374
2025-06-10 20:19:19,945 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:19:19,946 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:19:19,946 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:19:20,010 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:19:20,048 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:19:20,067 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:20,085 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:19:20,093 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:20,123 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:19:20,160 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:19:20,204 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:19:20,270 - DEBUG - [Page 83] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:20,309 - DEBUG - Dynamic vertical threshold: 76.50720000000004, Overlap threshold: 0.7
2025-06-10 20:19:20,310 - DEBUG - [Page 16] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:20,337 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:19:20,372 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:19:20,411 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:19:20,462 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:20,559 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:19:20,581 - DEBUG - Snippet 10.5194_acp-21-18589-2021_666_item_3: generation shape=torch.Size([1, 400])
2025-06-10 20:19:20,582 - DEBUG - Snippet 10.5194_acp-21-18589-2021_666_item_3 raw docling: (tokens=54)
<formula><loc_0><loc_0><loc_500><loc_500>G _ { - } M e t = G _ { 2 0 2 0 } - G _ { 2 0 1 9 } .</formula><end_of_utterance>
2025-06-10 20:19:20,582 - DEBUG - Starting _parse_docling_output
2025-06-10 20:19:20,582 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>G _ { - } M e t = G _ { 2 0 2 0 } - G _ { 2 0 1 9 } .</formula><end_of_utterance>
2025-06-10 20:19:20,583 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:19:20,583 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>G _ { - } M e t = G _ { 2 0 2 0 } - G _ { 2 0 1 9 } .</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=685x55 at 0x7F96D62400B0>)]
2025-06-10 20:19:20,583 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:19:20,585 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=685.0, b=55.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 53))], orig='G _ { - } M e t = G _ { 2 0 2 0 } - G _ { 2 0 1 9 } .', text='G _ { - } M e t = G _ { 2 0 2 0 } - G _ { 2 0 1 9 } .', formatting=None, hyperlink=None)]
2025-06-10 20:19:20,586 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:19:20,586 - DEBUG - Processing text item: label=formula, text=G _ { - } M e t = G _ { 2 0 2 0 } - G _ { 2 0 1 9 } .
2025-06-10 20:19:20,586 - DEBUG - Recognized string extracted: G _ { - } M e t = G _ { 2 0 2 0 } - G _ { 2 0 1 9 } .
2025-06-10 20:19:20,586 - DEBUG - Generating chat message for label: formula
2025-06-10 20:19:20,586 - DEBUG - Snippet 10.5194_acp-21-18589-2021_666_item_4 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:19:20,591 - DEBUG - [Page 164] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:20,649 - DEBUG - Snippet 10.5194_acp-21-18589-2021_666_item_4 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:19:20,816 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:20,880 - DEBUG - Finished converting page batch time=3909.316
2025-06-10 20:19:20,896 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:19:21,055 - DEBUG - [Page 84] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:21,110 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:19:21,110 - INFO - Processing document 10.1186_1476-069x-14-3_700.pdf
2025-06-10 20:19:21,139 - DEBUG - [Page 165] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:21,151 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:21,278 - DEBUG - Finished converting page batch time=3909.714
2025-06-10 20:19:21,288 - DEBUG - Dynamic vertical threshold: 123.44399999999997, Overlap threshold: 0.7
2025-06-10 20:19:21,288 - DEBUG - [Page 17] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:21,392 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:21,445 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:21,604 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:21,669 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:21,711 - DEBUG - Dynamic vertical threshold: 75.14279999999997, Overlap threshold: 0.7
2025-06-10 20:19:21,711 - DEBUG - [Page 18] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:21,761 - DEBUG - [Page 166] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:22,015 - DEBUG - [Page 85] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:22,225 - DEBUG - [Page 19] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:22,262 - DEBUG - [Page 86] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:22,319 - DEBUG - [Page 167] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:22,320 - DEBUG - Finished converting page batch time=3910.756
2025-06-10 20:19:22,492 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:22,493 - DEBUG - Finished converting page batch time=3910.929
2025-06-10 20:19:22,689 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:22,781 - DEBUG - Snippet 10.5194_acp-21-18589-2021_666_item_4: generation shape=torch.Size([1, 418])
2025-06-10 20:19:22,782 - DEBUG - Snippet 10.5194_acp-21-18589-2021_666_item_4 raw docling: (tokens=72)
<formula><loc_0><loc_0><loc_500><loc_500>G _ { - } E m i s = ( M e a s _ { 2 0 2 0 } - M e a s _ { 2 0 1 9 } ) - G _ { - } M e t .</formula><end_of_utterance>
2025-06-10 20:19:22,782 - DEBUG - Starting _parse_docling_output
2025-06-10 20:19:22,782 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>G _ { - } E m i s = ( M e a s _ { 2 0 2 0 } - M e a s _ { 2 0 1 9 } ) - G _ { - } M e t .</formula><end_of_utterance>
2025-06-10 20:19:22,783 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:19:22,783 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>G _ { - } E m i s = ( M e a s _ { 2 0 2 0 } - M e a s _ { 2 0 1 9 } ) - G _ { - } M e t .</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=685x55 at 0x7F96D6240E90>)]
2025-06-10 20:19:22,783 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:19:22,785 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=685.0, b=55.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 89))], orig='G _ { - } E m i s = ( M e a s _ { 2 0 2 0 } - M e a s _ { 2 0 1 9 } ) - G _ { - } M e t .', text='G _ { - } E m i s = ( M e a s _ { 2 0 2 0 } - M e a s _ { 2 0 1 9 } ) - G _ { - } M e t .', formatting=None, hyperlink=None)]
2025-06-10 20:19:22,785 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:19:22,786 - DEBUG - Processing text item: label=formula, text=G _ { - } E m i s = ( M e a s _ { 2 0 2 0 } - M e a s _ { 2 0 1 9 } ) - G _ { - } M e t .
2025-06-10 20:19:22,786 - DEBUG - Recognized string extracted: G _ { - } E m i s = ( M e a s _ { 2 0 2 0 } - M e a s _ { 2 0 1 9 } ) - G _ { - } M e t .
2025-06-10 20:19:22,786 - INFO - All done. Returning 5 recognized text results.
2025-06-10 20:19:22,786 - DEBUG - Snippet 10.5194_acp-21-18589-2021_666_item_0 recognized text:
L ^ { ( t ) } \simeq \sum _ { i = 1 } ^ { n } \left [ l \left ( y _ { i } , \hat { y } ^ { ( t - 1 ) } \right ) + g _ { i } f _ { t } ( x _ { i } ) + \frac { 1 } { 2 } h _ { i } f _ { t } ^ { 2 } ( x _ { i } ) \right ] \\ + \Omega ( f _ { t } ) ;
2025-06-10 20:19:22,786 - DEBUG - Snippet 10.5194_acp-21-18589-2021_666_item_1 recognized text:
g _ { i } = \partial _ { \hat { y } ^ { ( t - 1 ) } } l \left ( y _ { i } , \hat { y } ^ { ( t - 1 ) } \right ) ;
2025-06-10 20:19:22,787 - DEBUG - Snippet 10.5194_acp-21-18589-2021_666_item_2 recognized text:
\acute { h } _ { i } = \partial _ { \hat { y } ^ { ( t - 1 ) } } ^ { 2 } l \left ( y _ { i } , \hat { y } ^ { ( t - 1 ) } \right ) .
2025-06-10 20:19:22,787 - DEBUG - Snippet 10.5194_acp-21-18589-2021_666_item_3 recognized text:
G _ { - } M e t = G _ { 2 0 2 0 } - G _ { 2 0 1 9 } .
2025-06-10 20:19:22,787 - DEBUG - Snippet 10.5194_acp-21-18589-2021_666_item_4 recognized text:
G _ { - } E m i s = ( M e a s _ { 2 0 2 0 } - M e a s _ { 2 0 1 9 } ) - G _ { - } M e t .
2025-06-10 20:19:22,794 - INFO - Starting prediction for 4 images with labels: ['formula', 'formula', 'formula', 'formula']
2025-06-10 20:19:22,794 - DEBUG - Generating chat message for label: formula
2025-06-10 20:19:22,794 - DEBUG - Snippet 10.5194_acp-21-18589-2021_666_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:19:22,859 - DEBUG - Snippet 10.5194_acp-21-18589-2021_666_item_0 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:19:22,931 - DEBUG - [Page 168] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:23,014 - DEBUG - [Page 87] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:23,015 - DEBUG - Finished converting page batch time=3911.451
2025-06-10 20:19:23,066 - DEBUG - Finished converting page batch time=3911.502
2025-06-10 20:19:23,137 - DEBUG - [Page 88] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:23,220 - DEBUG - [Page 169] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:23,357 - DEBUG - [Page 89] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:23,401 - DEBUG - Dynamic vertical threshold: 32.26229999999998, Overlap threshold: 0.7
2025-06-10 20:19:23,402 - DEBUG - [Page 20] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:23,492 - DEBUG - [Page 170] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:23,547 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:23,638 - DEBUG - Dynamic vertical threshold: 99.2142, Overlap threshold: 0.7
2025-06-10 20:19:23,638 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:23,963 - DEBUG - [Page 90] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:24,279 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:24,309 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:24,370 - DEBUG - Snippet 10.5194_acp-21-18589-2021_666_item_0: generation shape=torch.Size([1, 398])
2025-06-10 20:19:24,371 - DEBUG - Snippet 10.5194_acp-21-18589-2021_666_item_0 raw docling: (tokens=52)
<formula><loc_0><loc_0><loc_500><loc_500>i s = M e a s 2 0 2 0 - X \dot { G } _ { 2 0 2 0 }</formula><end_of_utterance>
2025-06-10 20:19:24,372 - DEBUG - Starting _parse_docling_output
2025-06-10 20:19:24,372 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>i s = M e a s 2 0 2 0 - X \dot { G } _ { 2 0 2 0 }</formula><end_of_utterance>
2025-06-10 20:19:24,372 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:19:24,372 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>i s = M e a s 2 0 2 0 - X \\dot { G } _ { 2 0 2 0 }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=585x54 at 0x7F96D57A1550>)]
2025-06-10 20:19:24,373 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:19:24,374 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=585.0, b=54.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 50))], orig='i s = M e a s 2 0 2 0 - X \\dot { G } _ { 2 0 2 0 }', text='i s = M e a s 2 0 2 0 - X \\dot { G } _ { 2 0 2 0 }', formatting=None, hyperlink=None)]
2025-06-10 20:19:24,375 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:19:24,375 - DEBUG - Processing text item: label=formula, text=i s = M e a s 2 0 2 0 - X \dot { G } _ { 2 0 2 0 }
2025-06-10 20:19:24,375 - DEBUG - Recognized string extracted: i s = M e a s 2 0 2 0 - X \dot { G } _ { 2 0 2 0 }
2025-06-10 20:19:24,375 - DEBUG - Generating chat message for label: formula
2025-06-10 20:19:24,376 - DEBUG - Snippet 10.5194_acp-21-18589-2021_666_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:19:24,442 - DEBUG - Snippet 10.5194_acp-21-18589-2021_666_item_1 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:19:24,494 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:24,655 - DEBUG - [Page 21] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:24,893 - DEBUG - [Page 91] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:24,893 - DEBUG - Finished converting page batch time=3913.330
2025-06-10 20:19:24,907 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:25,023 - DEBUG - Finished converting page batch time=3913.459
2025-06-10 20:19:25,055 - DEBUG - Dynamic vertical threshold: 66.87720000000004, Overlap threshold: 0.7
2025-06-10 20:19:25,055 - DEBUG - Checking merge:
  Current: 5, Next: 6
2025-06-10 20:19:25,056 - DEBUG -   Vertical gap: 45.02299999999997, Overlap ratio: 1.0
2025-06-10 20:19:25,056 - DEBUG -   Left boundary diff: 48.519999999999996, Right boundary diff: 48.52799999999996
2025-06-10 20:19:25,056 - DEBUG -   Alignment factor (ratio): 0.22484675225991171
2025-06-10 20:19:25,056 - DEBUG -   -> c1 5 formula number: z, c2 6 formula number: None
2025-06-10 20:19:25,056 - DEBUG - [Page 22] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:25,108 - DEBUG - [Page 92] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:25,184 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:25,439 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:25,515 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:25,516 - DEBUG - [Page 23] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:25,516 - DEBUG - Finished converting page batch time=3913.952
2025-06-10 20:19:25,517 - DEBUG - Finished converting page batch time=3913.953
2025-06-10 20:19:25,566 - WARNING - Repetitive generation detected with pattern: ', \, \'
2025-06-10 20:19:25,567 - DEBUG - Snippet 10.5194_acp-21-18589-2021_666_item_1: generation shape=torch.Size([1, 379])
2025-06-10 20:19:25,568 - DEBUG - Snippet 10.5194_acp-21-18589-2021_666_item_1 raw docling: (tokens=33)
<formula><loc_0><loc_0><loc_500><loc_500>\, \, \, \, \, \, \, \, \
2025-06-10 20:19:25,568 - DEBUG - Starting _parse_docling_output
2025-06-10 20:19:25,569 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>\, \, \, \, \, \, \, \, \
2025-06-10 20:19:25,569 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:19:25,569 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>\\, \\, \\, \\, \\, \\, \\, \\, \\', image=<PIL.Image.Image image mode=RGB size=597x55 at 0x7F96D57A0830>)]
2025-06-10 20:19:25,569 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:19:25,571 - DEBUG - DoclingDocument loaded successfully. Extracted texts: []
2025-06-10 20:19:25,571 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:19:25,572 - WARNING - Extracted text is empty or malformed. Skipping formula.
2025-06-10 20:19:25,572 - DEBUG - Generating chat message for label: formula
2025-06-10 20:19:25,572 - DEBUG - Snippet 10.5194_acp-21-18589-2021_666_item_2 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:19:25,641 - DEBUG - Snippet 10.5194_acp-21-18589-2021_666_item_2 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:19:25,737 - DEBUG - [Page 24] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:25,805 - DEBUG - [Page 93] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:26,074 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:26,170 - DEBUG - Finished converting page batch time=3914.606
2025-06-10 20:19:26,179 - DEBUG - [Page 94] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:26,367 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:26,377 - DEBUG - [Page 95] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:26,554 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:26,592 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:26,625 - DEBUG - Finished converting page batch time=3915.061
2025-06-10 20:19:26,898 - DEBUG - Finished converting page batch time=3915.335
2025-06-10 20:19:26,929 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:27,177 - DEBUG - [Page 171] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:27,201 - DEBUG - [Page 96] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:27,205 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:27,370 - DEBUG - [Page 97] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:27,378 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:27,712 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:27,847 - DEBUG - [Page 25] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:27,899 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:27,942 - DEBUG - [Page 98] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:28,262 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:28,263 - DEBUG - Finished converting page batch time=3916.699
2025-06-10 20:19:28,495 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:28,496 - DEBUG - Finished converting page batch time=3916.932
2025-06-10 20:19:28,516 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:28,580 - DEBUG - [Page 99] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:28,581 - DEBUG - Finished converting page batch time=3917.017
2025-06-10 20:19:28,791 - DEBUG - [Page 100] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:28,883 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:28,905 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:29,098 - DEBUG - [Page 26] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:29,240 - DEBUG - Snippet 10.5194_acp-21-18589-2021_666_item_2: generation shape=torch.Size([1, 461])
2025-06-10 20:19:29,241 - DEBUG - Snippet 10.5194_acp-21-18589-2021_666_item_2 raw docling: (tokens=115)
<formula><loc_0><loc_0><loc_500><loc_500>\Delta x = \left \{ \begin{array} { c } 0 , ( i f C _ { \max } - C _ { t h r e s } \leq 0 ) \\ C _ { \max } - C _ { t h r e s } , ( i f C _ { \max } - C _ { t h r e s } \geq 0 ) , \end{array} \right \}</formula><end_of_utterance>
2025-06-10 20:19:29,241 - DEBUG - Starting _parse_docling_output
2025-06-10 20:19:29,242 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>\Delta x = \left \{ \begin{array} { c } 0 , ( i f C _ { \max } - C _ { t h r e s } \leq 0 ) \\ C _ { \max } - C _ { t h r e s } , ( i f C _ { \max } - C _ { t h r e s } \geq 0 ) , \end{array} \right \}</formula><end_of_utterance>
2025-06-10 20:19:29,242 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:19:29,242 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>\\Delta x = \\left \\{ \\begin{array} { c } 0 , ( i f C _ { \\max } - C _ { t h r e s } \\leq 0 ) \\\\ C _ { \\max } - C _ { t h r e s } , ( i f C _ { \\max } - C _ { t h r e s } \\geq 0 ) , \\end{array} \\right \\}</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=710x117 at 0x7F96D62412E0>)]
2025-06-10 20:19:29,242 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:19:29,246 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=710.0, b=117.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 201))], orig='\\Delta x = \\left \\{ \\begin{array} { c } 0 , ( i f C _ { \\max } - C _ { t h r e s } \\leq 0 ) \\\\ C _ { \\max } - C _ { t h r e s } , ( i f C _ { \\max } - C _ { t h r e s } \\geq 0 ) , \\end{array} \\right \\}', text='\\Delta x = \\left \\{ \\begin{array} { c } 0 , ( i f C _ { \\max } - C _ { t h r e s } \\leq 0 ) \\\\ C _ { \\max } - C _ { t h r e s } , ( i f C _ { \\max } - C _ { t h r e s } \\geq 0 ) , \\end{array} \\right \\}', formatting=None, hyperlink=None)]
2025-06-10 20:19:29,246 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:19:29,246 - DEBUG - Processing text item: label=formula, text=\Delta x = \left \{ \begin{array} { c } 0 , ( i f C _ { \max } - C _ { t h r e s } \leq 0 ) \\ C _ { \max } - C _ { t h r e s } , ( i f C _ { \max } - C _ { t h r e s } \geq 0 ) , \end{array} \right \}
2025-06-10 20:19:29,246 - DEBUG - Recognized string extracted: \Delta x = \left \{ \begin{array} { c } 0 , ( i f C _ { \max } - C _ { t h r e s } \leq 0 ) \\ C _ { \max } - C _ { t h r e s } , ( i f C _ { \max } - C _ { t h r e s } \geq 0 ) , \end{array} \right \}
2025-06-10 20:19:29,247 - DEBUG - Generating chat message for label: formula
2025-06-10 20:19:29,247 - DEBUG - Snippet 10.5194_acp-21-18589-2021_666_item_3 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:19:29,311 - DEBUG - Snippet 10.5194_acp-21-18589-2021_666_item_3 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:19:29,395 - DEBUG - [Page 27] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:29,396 - DEBUG - Finished converting page batch time=3917.832
2025-06-10 20:19:29,496 - DEBUG - Finished converting page batch time=3917.932
2025-06-10 20:19:29,659 - DEBUG - [Page 101] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:29,688 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:29,730 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:29,760 - DEBUG - [Page 28] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:29,878 - DEBUG - [Page 172] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:29,935 - DEBUG - [Page 102] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:27,816 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:27,995 - DEBUG - [Page 103] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:27,997 - DEBUG - Finished converting page batch time=3918.680
2025-06-10 20:19:28,034 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:28,144 - DEBUG - [Page 104] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:28,253 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:28,254 - DEBUG - Finished converting page batch time=3918.938
2025-06-10 20:19:28,446 - DEBUG - [Page 105] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:28,470 - DEBUG - [Page 14] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:28,558 - DEBUG - Dynamic vertical threshold: 45.87659999999994, Overlap threshold: 0.7
2025-06-10 20:19:28,558 - DEBUG - Checking merge:
  Current: 15, Next: 12
2025-06-10 20:19:28,559 - DEBUG -   Vertical gap: 3.6270000000000095, Overlap ratio: 0.9999603810731242
2025-06-10 20:19:28,559 - DEBUG -   Left boundary diff: 0.012999999999998124, Right boundary diff: 109.52999999999997
2025-06-10 20:19:28,559 - DEBUG -   Alignment factor (ratio): 0.38718982482249814
2025-06-10 20:19:28,559 - DEBUG -   -> c1 15 formula number: None, c2 12 formula number: None
2025-06-10 20:19:28,559 - DEBUG -   -> Not merging clusters 15 and 12 because vertical_gap 3.6270000000000095 > 3 with no numbers
2025-06-10 20:19:28,560 - DEBUG - Checking merge:
  Current: 9, Next: 14
2025-06-10 20:19:28,560 - DEBUG -   Vertical gap: 13.238000000000056, Overlap ratio: 0.9587119360383517
2025-06-10 20:19:28,560 - DEBUG -   Left boundary diff: 13.090999999999994, Right boundary diff: 60.322
2025-06-10 20:19:28,560 - DEBUG -   Alignment factor (ratio): 0.2506310232860577
2025-06-10 20:19:28,560 - DEBUG -   -> c1 9 formula number: B, c2 14 formula number: None
2025-06-10 20:19:28,561 - DEBUG -   -> Not merging 9 and 14 (one missing, gap 13.238000000000056 > 12.8)
2025-06-10 20:19:28,561 - DEBUG - Checking merge:
  Current: 9, Next: 8
2025-06-10 20:19:28,561 - DEBUG -   Vertical gap: 36.40600000000006, Overlap ratio: 1.0
2025-06-10 20:19:28,561 - DEBUG -   Left boundary diff: 0.003999999999990678, Right boundary diff: 12.420000000000016
2025-06-10 20:19:28,561 - DEBUG -   Alignment factor (ratio): 0.045913614384787194
2025-06-10 20:19:28,562 - DEBUG -   -> c1 9 formula number: B, c2 8 formula number: B
2025-06-10 20:19:28,562 - DEBUG -   -> Merging clusters 9 and 8 with vertical gap 36.40600000000006 and overlap ratio 1.0
2025-06-10 20:19:28,562 - DEBUG - [Page 29] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:28,583 - DEBUG - Snippet 10.5194_acp-21-18589-2021_666_item_3: generation shape=torch.Size([1, 395])
2025-06-10 20:19:28,584 - DEBUG - Snippet 10.5194_acp-21-18589-2021_666_item_3 raw docling: (tokens=49)
<formula><loc_0><loc_0><loc_500><loc_500>\Delta M = y _ { 0 } [ 1 - \exp ( - \beta \Delta x ) ] \times P o p ,</formula><end_of_utterance>
2025-06-10 20:19:28,584 - DEBUG - Starting _parse_docling_output
2025-06-10 20:19:28,585 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>\Delta M = y _ { 0 } [ 1 - \exp ( - \beta \Delta x ) ] \times P o p ,</formula><end_of_utterance>
2025-06-10 20:19:28,585 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:19:28,585 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>\\Delta M = y _ { 0 } [ 1 - \\exp ( - \\beta \\Delta x ) ] \\times P o p ,</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=710x63 at 0x7F96D6240CE0>)]
2025-06-10 20:19:28,585 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:19:28,588 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=710.0, b=63.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 69))], orig='\\Delta M = y _ { 0 } [ 1 - \\exp ( - \\beta \\Delta x ) ] \\times P o p ,', text='\\Delta M = y _ { 0 } [ 1 - \\exp ( - \\beta \\Delta x ) ] \\times P o p ,', formatting=None, hyperlink=None)]
2025-06-10 20:19:28,589 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:19:28,589 - DEBUG - Processing text item: label=formula, text=\Delta M = y _ { 0 } [ 1 - \exp ( - \beta \Delta x ) ] \times P o p ,
2025-06-10 20:19:28,589 - DEBUG - Recognized string extracted: \Delta M = y _ { 0 } [ 1 - \exp ( - \beta \Delta x ) ] \times P o p ,
2025-06-10 20:19:28,589 - INFO - All done. Returning 4 recognized text results.
2025-06-10 20:19:28,590 - DEBUG - Snippet 10.5194_acp-21-18589-2021_666_item_0 recognized text:
i s = M e a s 2 0 2 0 - X \dot { G } _ { 2 0 2 0 }
2025-06-10 20:19:28,590 - DEBUG - Snippet 10.5194_acp-21-18589-2021_666_item_1 recognized text:
MALFORMED_FORMULA
2025-06-10 20:19:28,590 - DEBUG - Snippet 10.5194_acp-21-18589-2021_666_item_2 recognized text:
\Delta x = \left \{ \begin{array} { c } 0 , ( i f C _ { \max } - C _ { t h r e s } \leq 0 ) \\ C _ { \max } - C _ { t h r e s } , ( i f C _ { \max } - C _ { t h r e s } \geq 0 ) , \end{array} \right \}
2025-06-10 20:19:28,590 - DEBUG - Snippet 10.5194_acp-21-18589-2021_666_item_3 recognized text:
\Delta M = y _ { 0 } [ 1 - \exp ( - \beta \Delta x ) ] \times P o p ,
2025-06-10 20:19:28,737 - INFO - Finished converting document 10.5194_acp-21-18589-2021_666.pdf in 44.06 sec.
2025-06-10 20:19:28,774 - DEBUG - Dynamic vertical threshold: 166.89419999999996, Overlap threshold: 0.7
2025-06-10 20:19:28,775 - DEBUG - Checking merge:
  Current: 10, Next: 6
2025-06-10 20:19:28,775 - DEBUG -   Vertical gap: 10.088000000000022, Overlap ratio: 0.9994926639202872
2025-06-10 20:19:28,775 - DEBUG -   Left boundary diff: 34.116, Right boundary diff: 0.19999999999998863
2025-06-10 20:19:28,775 - DEBUG -   Alignment factor (ratio): 0.10963640921156653
2025-06-10 20:19:28,776 - DEBUG -   -> c1 10 formula number: 19, c2 6 formula number: B
2025-06-10 20:19:28,776 - DEBUG -   -> Not merging clusters 10 and 6 due to different formula numbers: 19 vs B
2025-06-10 20:19:28,776 - DEBUG - Checking merge:
  Current: 10, Next: 9
2025-06-10 20:19:28,776 - DEBUG -   Vertical gap: 122.642, Overlap ratio: 1.0
2025-06-10 20:19:28,776 - DEBUG -   Left boundary diff: 35.497, Right boundary diff: 4.2099999999999795
2025-06-10 20:19:28,777 - DEBUG -   Alignment factor (ratio): 0.11514588270022073
2025-06-10 20:19:28,777 - DEBUG -   -> c1 10 formula number: 19, c2 9 formula number: B
2025-06-10 20:19:28,777 - DEBUG -   -> Not merging clusters 10 and 9 due to different formula numbers: 19 vs B
2025-06-10 20:19:28,777 - DEBUG - Checking merge:
  Current: 6, Next: 9
2025-06-10 20:19:28,777 - DEBUG -   Vertical gap: 10.105999999999995, Overlap ratio: 1.0
2025-06-10 20:19:28,778 - DEBUG -   Left boundary diff: 1.3810000000000002, Right boundary diff: 4.409999999999968
2025-06-10 20:19:28,778 - DEBUG -   Alignment factor (ratio): 0.015137966603791932
2025-06-10 20:19:28,778 - DEBUG -   -> c1 6 formula number: B, c2 9 formula number: B
2025-06-10 20:19:28,778 - DEBUG -   -> Merging clusters 6 and 9 with vertical gap 10.105999999999995 and overlap ratio 1.0
2025-06-10 20:19:28,778 - DEBUG - Checking merge:
  Current: 6, Next: 14
2025-06-10 20:19:28,778 - DEBUG -   Vertical gap: 140.87900000000002, Overlap ratio: 1.0
2025-06-10 20:19:28,779 - DEBUG -   Left boundary diff: 290.803, Right boundary diff: 0.3990000000000009
2025-06-10 20:19:28,779 - DEBUG -   Alignment factor (ratio): 1.9567540288665342
2025-06-10 20:19:28,779 - DEBUG -   -> c1 6 formula number: B, c2 14 formula number: None
2025-06-10 20:19:28,779 - DEBUG - [Page 30] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:28,802 - DEBUG - Finished converting page batch time=3919.485
2025-06-10 20:19:28,907 - INFO - Extraction successful row 127, tokens=27117
2025-06-10 20:19:28,955 - DEBUG - [Page 15] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:28,956 - DEBUG - Finished converting page batch time=3919.639
2025-06-10 20:19:28,973 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:29,083 - INFO - Going to convert document batch...
2025-06-10 20:19:29,083 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:19:29,083 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:19:29,154 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:19:29,166 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:29,181 - DEBUG - [Page 31] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:29,182 - DEBUG - Finished converting page batch time=3919.866
2025-06-10 20:19:29,307 - DEBUG - [Page 16] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:29,417 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:29,430 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:29,431 - DEBUG - Finished converting page batch time=3920.115
2025-06-10 20:19:29,570 - DEBUG - [Page 17] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:29,616 - DEBUG - Creating masked image for page 2 with 28 clusters.
2025-06-10 20:19:29,618 - INFO - Masked image successfully created for page 2.
2025-06-10 20:19:29,624 - INFO - Starting prediction for 2 images with labels: ['formula', 'formula']
2025-06-10 20:19:29,624 - DEBUG - Generating chat message for label: formula
2025-06-10 20:19:29,625 - DEBUG - Snippet 10.1186_1476-069x-14-3_700_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:19:29,723 - DEBUG - [Page 32] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:29,767 - DEBUG - Snippet 10.1186_1476-069x-14-3_700_item_0 => input_ids shape=torch.Size([1, 610]), prompt_len=610
2025-06-10 20:19:29,773 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:29,777 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:19:29,823 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:19:29,829 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:19:29,884 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:29,989 - DEBUG - [Page 33] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:29,997 - DEBUG - Finished converting page batch time=3920.681
2025-06-10 20:19:30,111 - DEBUG - Creating masked image for page 11 with 12 clusters.
2025-06-10 20:19:30,112 - INFO - Masked image successfully created for page 11.
2025-06-10 20:19:30,154 - DEBUG - [Page 14] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:30,186 - DEBUG - Creating masked image for page 12 with 11 clusters.
2025-06-10 20:19:30,187 - INFO - Masked image successfully created for page 12.
2025-06-10 20:19:30,198 - INFO - Starting prediction for 5 images with labels: ['formula', 'formula', 'formula', 'formula', 'formula']
2025-06-10 20:19:30,198 - DEBUG - Generating chat message for label: formula
2025-06-10 20:19:30,198 - DEBUG - Snippet 10.1214_10-aoas351_689_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:19:30,268 - DEBUG - Snippet 10.1214_10-aoas351_689_item_0 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:19:30,358 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:19:30,358 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:19:30,359 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:19:30,393 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:19:30,442 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:19:30,458 - DEBUG - [Page 14] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:30,475 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:19:30,514 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:19:30,554 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:19:30,558 - DEBUG - [Page 15] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:30,559 - DEBUG - Finished converting page batch time=3921.242
2025-06-10 20:19:30,566 - DEBUG - [Page 18] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:30,594 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:19:30,694 - DEBUG - [Page 173] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:30,722 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:19:30,759 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:19:30,799 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:19:31,002 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:19:31,045 - DEBUG - [Page 15] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:31,046 - DEBUG - Finished converting page batch time=3921.730
2025-06-10 20:19:31,415 - DEBUG - [Page 16] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:31,416 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:19:31,534 - DEBUG - [Page 19] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:31,553 - DEBUG - [Page 16] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:31,637 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:19:31,638 - INFO - Processing document 10.3390_atmos8030061_703.pdf
2025-06-10 20:19:32,129 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:32,548 - DEBUG - [Page 17] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:32,678 - DEBUG - [Page 106] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:32,704 - DEBUG - [Page 174] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:32,737 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:32,884 - DEBUG - [Page 175] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:32,885 - DEBUG - Finished converting page batch time=3923.568
2025-06-10 20:19:32,913 - DEBUG - [Page 107] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:33,072 - DEBUG - [Page 17] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:33,075 - DEBUG - [Page 18] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:33,109 - DEBUG - [Page 176] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:33,131 - DEBUG - Snippet 10.1214_10-aoas351_689_item_0: generation shape=torch.Size([1, 441])
2025-06-10 20:19:33,132 - DEBUG - Snippet 10.1214_10-aoas351_689_item_0 raw docling: (tokens=95)
<formula><loc_0><loc_0><loc_500><loc_500>Y ( s ) = \tilde { \beta } _ { 0 } ( s ) + \tilde { \beta } _ { 1 } ( s ) x ( B ) + \varepsilon ( s ) , \quad \varepsilon ( s ) \sim N ( 0 , \tau ^ { 2 } ) ,</formula><end_of_utterance>
2025-06-10 20:19:33,132 - DEBUG - Starting _parse_docling_output
2025-06-10 20:19:33,133 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>Y ( s ) = \tilde { \beta } _ { 0 } ( s ) + \tilde { \beta } _ { 1 } ( s ) x ( B ) + \varepsilon ( s ) , \quad \varepsilon ( s ) \sim N ( 0 , \tau ^ { 2 } ) ,</formula><end_of_utterance>
2025-06-10 20:19:33,133 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:19:33,133 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>Y ( s ) = \\tilde { \\beta } _ { 0 } ( s ) + \\tilde { \\beta } _ { 1 } ( s ) x ( B ) + \\varepsilon ( s ) , \\quad \\varepsilon ( s ) \\sim N ( 0 , \\tau ^ { 2 } ) ,</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=901x113 at 0x7F96B2921A90>)]
2025-06-10 20:19:33,133 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:19:33,137 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=901.0, b=113.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 157))], orig='Y ( s ) = \\tilde { \\beta } _ { 0 } ( s ) + \\tilde { \\beta } _ { 1 } ( s ) x ( B ) + \\varepsilon ( s ) , \\quad \\varepsilon ( s ) \\sim N ( 0 , \\tau ^ { 2 } ) ,', text='Y ( s ) = \\tilde { \\beta } _ { 0 } ( s ) + \\tilde { \\beta } _ { 1 } ( s ) x ( B ) + \\varepsilon ( s ) , \\quad \\varepsilon ( s ) \\sim N ( 0 , \\tau ^ { 2 } ) ,', formatting=None, hyperlink=None)]
2025-06-10 20:19:33,137 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:19:33,137 - DEBUG - Processing text item: label=formula, text=Y ( s ) = \tilde { \beta } _ { 0 } ( s ) + \tilde { \beta } _ { 1 } ( s ) x ( B ) + \varepsilon ( s ) , \quad \varepsilon ( s ) \sim N ( 0 , \tau ^ { 2 } ) ,
2025-06-10 20:19:33,137 - DEBUG - Recognized string extracted: Y ( s ) = \tilde { \beta } _ { 0 } ( s ) + \tilde { \beta } _ { 1 } ( s ) x ( B ) + \varepsilon ( s ) , \quad \varepsilon ( s ) \sim N ( 0 , \tau ^ { 2 } ) ,
2025-06-10 20:19:33,138 - DEBUG - Generating chat message for label: formula
2025-06-10 20:19:33,138 - DEBUG - Snippet 10.1214_10-aoas351_689_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:19:33,198 - DEBUG - [Page 18] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:33,199 - DEBUG - Finished converting page batch time=3923.882
2025-06-10 20:19:33,224 - DEBUG - [Page 177] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:33,264 - DEBUG - Snippet 10.1214_10-aoas351_689_item_1 => input_ids shape=torch.Size([1, 610]), prompt_len=610
2025-06-10 20:19:33,349 - DEBUG - Creating masked image for page 3 with 22 clusters.
2025-06-10 20:19:33,350 - INFO - Masked image successfully created for page 3.
2025-06-10 20:19:33,431 - DEBUG - Creating masked image for page 4 with 17 clusters.
2025-06-10 20:19:33,432 - DEBUG - [Page 178] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:33,432 - INFO - Masked image successfully created for page 4.
2025-06-10 20:19:33,442 - INFO - Starting prediction for 3 images with labels: ['formula', 'formula', 'formula']
2025-06-10 20:19:33,442 - DEBUG - Generating chat message for label: formula
2025-06-10 20:19:33,443 - DEBUG - Snippet 10.1007_s10661-015-4850-6_693_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:19:33,480 - DEBUG - Finished converting page batch time=3924.164
2025-06-10 20:19:33,513 - DEBUG - Snippet 10.1186_1476-069x-14-3_700_item_0: generation shape=torch.Size([1, 728])
2025-06-10 20:19:33,514 - DEBUG - Snippet 10.1186_1476-069x-14-3_700_item_0 raw docling: (tokens=117)
<formula><loc_0><loc_0><loc_500><loc_500>\log ( \mu _ { t } ^ { c } ) \ = \ \beta _ { 0 } ^ { c } + \beta ^ { c } O Z O N E _ { t } ^ { c } + \, n s ( T _ { t } ^ { c } , 3 ) \\ + y ^ { c } D O W _ { t } + \, n s ( t i m e _ { t } , d f )</formula><end_of_utterance>
2025-06-10 20:19:33,515 - DEBUG - Starting _parse_docling_output
2025-06-10 20:19:33,515 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>\log ( \mu _ { t } ^ { c } ) \ = \ \beta _ { 0 } ^ { c } + \beta ^ { c } O Z O N E _ { t } ^ { c } + \, n s ( T _ { t } ^ { c } , 3 ) \\ + y ^ { c } D O W _ { t } + \, n s ( t i m e _ { t } , d f )</formula><end_of_utterance>
2025-06-10 20:19:33,515 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:19:33,515 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>\\log ( \\mu _ { t } ^ { c } ) \\ = \\ \\beta _ { 0 } ^ { c } + \\beta ^ { c } O Z O N E _ { t } ^ { c } + \\, n s ( T _ { t } ^ { c } , 3 ) \\\\ + y ^ { c } D O W _ { t } + \\, n s ( t i m e _ { t } , d f )</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=640x175 at 0x7F96D69F9580>)]
2025-06-10 20:19:33,515 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:19:33,519 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=640.0, b=175.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 197))], orig='\\log ( \\mu _ { t } ^ { c } ) \\ = \\ \\beta _ { 0 } ^ { c } + \\beta ^ { c } O Z O N E _ { t } ^ { c } + \\, n s ( T _ { t } ^ { c } , 3 ) \\\\ + y ^ { c } D O W _ { t } + \\, n s ( t i m e _ { t } , d f )', text='\\log ( \\mu _ { t } ^ { c } ) \\ = \\ \\beta _ { 0 } ^ { c } + \\beta ^ { c } O Z O N E _ { t } ^ { c } + \\, n s ( T _ { t } ^ { c } , 3 ) \\\\ + y ^ { c } D O W _ { t } + \\, n s ( t i m e _ { t } , d f )', formatting=None, hyperlink=None)]
2025-06-10 20:19:33,520 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:19:33,520 - DEBUG - Processing text item: label=formula, text=\log ( \mu _ { t } ^ { c } ) \ = \ \beta _ { 0 } ^ { c } + \beta ^ { c } O Z O N E _ { t } ^ { c } + \, n s ( T _ { t } ^ { c } , 3 ) \\ + y ^ { c } D O W _ { t } + \, n s ( t i m e _ { t } , d f )
2025-06-10 20:19:33,520 - DEBUG - Recognized string extracted: \log ( \mu _ { t } ^ { c } ) \ = \ \beta _ { 0 } ^ { c } + \beta ^ { c } O Z O N E _ { t } ^ { c } + \, n s ( T _ { t } ^ { c } , 3 ) \\ + y ^ { c } D O W _ { t } + \, n s ( t i m e _ { t } , d f )
2025-06-10 20:19:33,520 - DEBUG - Generating chat message for label: formula
2025-06-10 20:19:33,521 - DEBUG - Snippet 10.1186_1476-069x-14-3_700_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:19:33,534 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:33,577 - DEBUG - Snippet 10.1007_s10661-015-4850-6_693_item_0 => input_ids shape=torch.Size([1, 610]), prompt_len=610
2025-06-10 20:19:33,612 - DEBUG - [Page 179] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:33,612 - DEBUG - Finished converting page batch time=3924.296
2025-06-10 20:19:33,703 - DEBUG - [Page 19] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:33,704 - DEBUG - Finished converting page batch time=3924.387
2025-06-10 20:19:33,786 - DEBUG - Snippet 10.1186_1476-069x-14-3_700_item_1 => input_ids shape=torch.Size([1, 875]), prompt_len=875
2025-06-10 20:19:33,833 - DEBUG - [Page 180] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:34,003 - DEBUG - [Page 181] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:34,128 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:34,129 - DEBUG - Finished converting page batch time=3924.813
2025-06-10 20:19:34,194 - DEBUG - [Page 182] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:34,258 - DEBUG - [Page 20] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:34,308 - DEBUG - [Page 20] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:34,395 - DEBUG - [Page 183] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:34,396 - DEBUG - Finished converting page batch time=3925.080
2025-06-10 20:19:34,605 - DEBUG - [Page 184] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:34,620 - DEBUG - Dynamic vertical threshold: 22.96440000000007, Overlap threshold: 0.7
2025-06-10 20:19:34,620 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:34,832 - DEBUG - [Page 185] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:34,928 - DEBUG - [Page 21] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:35,057 - DEBUG - [Page 186] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:35,144 - DEBUG - [Page 187] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:35,145 - DEBUG - Finished converting page batch time=3925.828
2025-06-10 20:19:35,295 - DEBUG - [Page 188] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:35,376 - DEBUG - [Page 21] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:35,387 - DEBUG - [Page 22] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:35,408 - DEBUG - [Page 189] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:35,481 - DEBUG - Finished converting page batch time=3926.164
2025-06-10 20:19:35,532 - DEBUG - [Page 190] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:35,729 - DEBUG - [Page 108] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:35,789 - WARNING - Repetitive generation detected with pattern: ' \, \,'
2025-06-10 20:19:35,790 - DEBUG - Snippet 10.1007_s10661-015-4850-6_693_item_0: generation shape=torch.Size([1, 682])
2025-06-10 20:19:35,791 - DEBUG - Snippet 10.1007_s10661-015-4850-6_693_item_0 raw docling: (tokens=71)
<formula><loc_0><loc_0><loc_500><loc_500>P F = \frac { C } { C } \frac { \left ( \begin{array} { c } { c } \\ { r e s i d u e s \, \, \, \, \, \, \, \,
2025-06-10 20:19:35,791 - DEBUG - Starting _parse_docling_output
2025-06-10 20:19:35,791 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>P F = \frac { C } { C } \frac { \left ( \begin{array} { c } { c } \\ { r e s i d u e s \, \, \, \, \, \, \, \,
2025-06-10 20:19:35,791 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:19:35,791 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>P F = \\frac { C } { C } \\frac { \\left ( \\begin{array} { c } { c } \\\\ { r e s i d u e s \\, \\, \\, \\, \\, \\, \\, \\,', image=<PIL.Image.Image image mode=RGB size=636x218 at 0x7F96E02F9130>)]
2025-06-10 20:19:35,792 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:19:35,797 - DEBUG - DoclingDocument loaded successfully. Extracted texts: []
2025-06-10 20:19:35,797 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:19:35,797 - WARNING - Extracted text is empty or malformed. Skipping formula.
2025-06-10 20:19:35,797 - DEBUG - Generating chat message for label: formula
2025-06-10 20:19:35,798 - DEBUG - Snippet 10.1007_s10661-015-4850-6_693_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:19:35,868 - DEBUG - Snippet 10.1007_s10661-015-4850-6_693_item_1 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:19:35,926 - DEBUG - Snippet 10.1214_10-aoas351_689_item_1: generation shape=torch.Size([1, 700])
2025-06-10 20:19:35,927 - DEBUG - Snippet 10.1214_10-aoas351_689_item_1 raw docling: (tokens=89)
<formula><loc_0><loc_0><loc_500><loc_500>\tilde { \beta } _ { 0 } ( s ) = \beta _ { 0 } + \beta _ { 0 } ( s ) , \\ \tilde { \beta } _ { 1 } ( s ) = \beta _ { 1 } + \beta _ { 1 } ( s ) .</formula><end_of_utterance>
2025-06-10 20:19:35,927 - DEBUG - Starting _parse_docling_output
2025-06-10 20:19:35,928 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>\tilde { \beta } _ { 0 } ( s ) = \beta _ { 0 } + \beta _ { 0 } ( s ) , \\ \tilde { \beta } _ { 1 } ( s ) = \beta _ { 1 } + \beta _ { 1 } ( s ) .</formula><end_of_utterance>
2025-06-10 20:19:35,928 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:19:35,928 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>\\tilde { \\beta } _ { 0 } ( s ) = \\beta _ { 0 } + \\beta _ { 0 } ( s ) , \\\\ \\tilde { \\beta } _ { 1 } ( s ) = \\beta _ { 1 } + \\beta _ { 1 } ( s ) .</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=654x208 at 0x7F96B29FE2A0>)]
2025-06-10 20:19:35,929 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:19:35,930 - DEBUG - [Page 191] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:35,933 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=654.0, b=208.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 144))], orig='\\tilde { \\beta } _ { 0 } ( s ) = \\beta _ { 0 } + \\beta _ { 0 } ( s ) , \\\\ \\tilde { \\beta } _ { 1 } ( s ) = \\beta _ { 1 } + \\beta _ { 1 } ( s ) .', text='\\tilde { \\beta } _ { 0 } ( s ) = \\beta _ { 0 } + \\beta _ { 0 } ( s ) , \\\\ \\tilde { \\beta } _ { 1 } ( s ) = \\beta _ { 1 } + \\beta _ { 1 } ( s ) .', formatting=None, hyperlink=None)]
2025-06-10 20:19:35,933 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:19:35,933 - DEBUG - Processing text item: label=formula, text=\tilde { \beta } _ { 0 } ( s ) = \beta _ { 0 } + \beta _ { 0 } ( s ) , \\ \tilde { \beta } _ { 1 } ( s ) = \beta _ { 1 } + \beta _ { 1 } ( s ) .
2025-06-10 20:19:35,934 - DEBUG - Recognized string extracted: \tilde { \beta } _ { 0 } ( s ) = \beta _ { 0 } + \beta _ { 0 } ( s ) , \\ \tilde { \beta } _ { 1 } ( s ) = \beta _ { 1 } + \beta _ { 1 } ( s ) .
2025-06-10 20:19:35,934 - DEBUG - Generating chat message for label: formula
2025-06-10 20:19:35,934 - DEBUG - Snippet 10.1214_10-aoas351_689_item_2 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:19:35,957 - DEBUG - [Page 22] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:35,991 - DEBUG - [Page 109] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:36,006 - DEBUG - Snippet 10.1214_10-aoas351_689_item_2 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:19:36,415 - DEBUG - Finished converting page batch time=3927.098
2025-06-10 20:19:36,439 - DEBUG - [Page 23] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:36,440 - DEBUG - Finished converting page batch time=3927.123
2025-06-10 20:19:36,703 - DEBUG - [Page 23] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:36,806 - DEBUG - [Page 24] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:37,006 - DEBUG - [Page 192] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:37,089 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:37,108 - DEBUG - [Page 25] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:37,109 - DEBUG - Finished converting page batch time=3927.793
2025-06-10 20:19:37,263 - INFO - Finished converting document 10.3390_ijerph121012735_696.pdf in 23.52 sec.
2025-06-10 20:19:37,314 - DEBUG - Snippet 10.1007_s10661-015-4850-6_693_item_1: generation shape=torch.Size([1, 394])
2025-06-10 20:19:37,316 - DEBUG - Snippet 10.1007_s10661-015-4850-6_693_item_1 raw docling: (tokens=48)
<formula><loc_0><loc_0><loc_500><loc_500>I E S T I = \frac { L P ^ { * } ( H R ) ^ { * } v } { b w }</formula><end_of_utterance>
2025-06-10 20:19:37,316 - DEBUG - Starting _parse_docling_output
2025-06-10 20:19:37,316 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>I E S T I = \frac { L P ^ { * } ( H R ) ^ { * } v } { b w }</formula><end_of_utterance>
2025-06-10 20:19:37,317 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:19:37,317 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>I E S T I = \\frac { L P ^ { * } ( H R ) ^ { * } v } { b w }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=636x119 at 0x7F96E02FA5D0>)]
2025-06-10 20:19:37,317 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:19:37,320 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=636.0, b=119.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 59))], orig='I E S T I = \\frac { L P ^ { * } ( H R ) ^ { * } v } { b w }', text='I E S T I = \\frac { L P ^ { * } ( H R ) ^ { * } v } { b w }', formatting=None, hyperlink=None)]
2025-06-10 20:19:37,320 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:19:37,320 - DEBUG - Processing text item: label=formula, text=I E S T I = \frac { L P ^ { * } ( H R ) ^ { * } v } { b w }
2025-06-10 20:19:37,321 - DEBUG - Recognized string extracted: I E S T I = \frac { L P ^ { * } ( H R ) ^ { * } v } { b w }
2025-06-10 20:19:37,321 - DEBUG - Generating chat message for label: formula
2025-06-10 20:19:37,321 - DEBUG - Snippet 10.1007_s10661-015-4850-6_693_item_2 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:19:37,388 - DEBUG - Snippet 10.1007_s10661-015-4850-6_693_item_2 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:19:37,448 - INFO - Extraction successful row 134, tokens=37433
2025-06-10 20:19:37,478 - INFO - Going to convert document batch...
2025-06-10 20:19:37,478 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:19:37,478 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:19:37,531 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:19:37,593 - DEBUG - Finished converting page batch time=3928.277
2025-06-10 20:19:37,708 - DEBUG - [Page 193] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:37,908 - DEBUG - [Page 24] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:38,471 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:19:38,525 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:19:38,528 - DEBUG - [Page 194] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:38,532 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:19:38,600 - DEBUG - Snippet 10.1186_1476-069x-14-3_700_item_1: generation shape=torch.Size([1, 1040])
2025-06-10 20:19:38,601 - DEBUG - Snippet 10.1186_1476-069x-14-3_700_item_1 raw docling: (tokens=164)
<formula><loc_0><loc_0><loc_500><loc_500>\hat { \beta } ^ { c } | \, \beta ^ { c } , \hat { v } ^ { c } \sim N ( \beta ^ { c } , \hat { v } ^ { c } ) \\ \beta ^ { c } | \alpha _ { 0 } , \alpha _ { 1 j } , \tau ^ { 2 } \sim N \left ( \alpha _ { 0 } + \sum _ { j } \alpha _ { 1 j } \left ( x _ { j } ^ { c } - \bar { x } _ { j } \right ) , \tau ^ { 2 } \right )</formula><end_of_utterance>
2025-06-10 20:19:38,602 - DEBUG - Starting _parse_docling_output
2025-06-10 20:19:38,602 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>\hat { \beta } ^ { c } | \, \beta ^ { c } , \hat { v } ^ { c } \sim N ( \beta ^ { c } , \hat { v } ^ { c } ) \\ \beta ^ { c } | \alpha _ { 0 } , \alpha _ { 1 j } , \tau ^ { 2 } \sim N \left ( \alpha _ { 0 } + \sum _ { j } \alpha _ { 1 j } \left ( x _ { j } ^ { c } - \bar { x } _ { j } \right ) , \tau ^ { 2 } \right )</formula><end_of_utterance>
2025-06-10 20:19:38,602 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:19:38,602 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>\\hat { \\beta } ^ { c } | \\, \\beta ^ { c } , \\hat { v } ^ { c } \\sim N ( \\beta ^ { c } , \\hat { v } ^ { c } ) \\\\ \\beta ^ { c } | \\alpha _ { 0 } , \\alpha _ { 1 j } , \\tau ^ { 2 } \\sim N \\left ( \\alpha _ { 0 } + \\sum _ { j } \\alpha _ { 1 j } \\left ( x _ { j } ^ { c } - \\bar { x } _ { j } \\right ) , \\tau ^ { 2 } \\right )</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=500x315 at 0x7F96BB53C950>)]
2025-06-10 20:19:38,603 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:19:38,609 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=500.0, b=315.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 318))], orig='\\hat { \\beta } ^ { c } | \\, \\beta ^ { c } , \\hat { v } ^ { c } \\sim N ( \\beta ^ { c } , \\hat { v } ^ { c } ) \\\\ \\beta ^ { c } | \\alpha _ { 0 } , \\alpha _ { 1 j } , \\tau ^ { 2 } \\sim N \\left ( \\alpha _ { 0 } + \\sum _ { j } \\alpha _ { 1 j } \\left ( x _ { j } ^ { c } - \\bar { x } _ { j } \\right ) , \\tau ^ { 2 } \\right )', text='\\hat { \\beta } ^ { c } | \\, \\beta ^ { c } , \\hat { v } ^ { c } \\sim N ( \\beta ^ { c } , \\hat { v } ^ { c } ) \\\\ \\beta ^ { c } | \\alpha _ { 0 } , \\alpha _ { 1 j } , \\tau ^ { 2 } \\sim N \\left ( \\alpha _ { 0 } + \\sum _ { j } \\alpha _ { 1 j } \\left ( x _ { j } ^ { c } - \\bar { x } _ { j } \\right ) , \\tau ^ { 2 } \\right )', formatting=None, hyperlink=None)]
2025-06-10 20:19:38,610 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:19:38,610 - DEBUG - Processing text item: label=formula, text=\hat { \beta } ^ { c } | \, \beta ^ { c } , \hat { v } ^ { c } \sim N ( \beta ^ { c } , \hat { v } ^ { c } ) \\ \beta ^ { c } | \alpha _ { 0 } , \alpha _ { 1 j } , \tau ^ { 2 } \sim N \left ( \alpha _ { 0 } + \sum _ { j } \alpha _ { 1 j } \left ( x _ { j } ^ { c } - \bar { x } _ { j } \right ) , \tau ^ { 2 } \right )
2025-06-10 20:19:38,610 - DEBUG - Recognized string extracted: \hat { \beta } ^ { c } | \, \beta ^ { c } , \hat { v } ^ { c } \sim N ( \beta ^ { c } , \hat { v } ^ { c } ) \\ \beta ^ { c } | \alpha _ { 0 } , \alpha _ { 1 j } , \tau ^ { 2 } \sim N \left ( \alpha _ { 0 } + \sum _ { j } \alpha _ { 1 j } \left ( x _ { j } ^ { c } - \bar { x } _ { j } \right ) , \tau ^ { 2 } \right )
2025-06-10 20:19:38,610 - INFO - All done. Returning 2 recognized text results.
2025-06-10 20:19:38,611 - DEBUG - Snippet 10.1186_1476-069x-14-3_700_item_0 recognized text:
\log ( \mu _ { t } ^ { c } ) \ = \ \beta _ { 0 } ^ { c } + \beta ^ { c } O Z O N E _ { t } ^ { c } + \, n s ( T _ { t } ^ { c } , 3 ) \\ + y ^ { c } D O W _ { t } + \, n s ( t i m e _ { t } , d f )
2025-06-10 20:19:38,611 - DEBUG - Snippet 10.1186_1476-069x-14-3_700_item_1 recognized text:
\hat { \beta } ^ { c } | \, \beta ^ { c } , \hat { v } ^ { c } \sim N ( \beta ^ { c } , \hat { v } ^ { c } ) \\ \beta ^ { c } | \alpha _ { 0 } , \alpha _ { 1 j } , \tau ^ { 2 } \sim N \left ( \alpha _ { 0 } + \sum _ { j } \alpha _ { 1 j } \left ( x _ { j } ^ { c } - \bar { x } _ { j } \right ) , \tau ^ { 2 } \right )
2025-06-10 20:19:38,689 - INFO - Finished converting document 10.1186_1476-069x-14-3_700.pdf in 22.54 sec.
2025-06-10 20:19:38,877 - INFO - Extraction successful row 136, tokens=19417
2025-06-10 20:19:38,919 - INFO - Going to convert document batch...
2025-06-10 20:19:38,919 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:19:38,919 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:19:38,964 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:19:39,147 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:19:39,148 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:19:39,148 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:19:39,182 - DEBUG - [Page 195] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:39,183 - DEBUG - Finished converting page batch time=3929.867
2025-06-10 20:19:39,235 - DEBUG - Snippet 10.1007_s10661-015-4850-6_693_item_2: generation shape=torch.Size([1, 404])
2025-06-10 20:19:39,236 - DEBUG - Snippet 10.1007_s10661-015-4850-6_693_item_2 raw docling: (tokens=58)
<formula><loc_0><loc_0><loc_500><loc_500>I E S T I ^ { * } = \frac { L P ^ { * } ( H R ^ { * } P F ) ^ { * } v } { b w }</formula><end_of_utterance>
2025-06-10 20:19:39,237 - DEBUG - Starting _parse_docling_output
2025-06-10 20:19:39,237 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>I E S T I ^ { * } = \frac { L P ^ { * } ( H R ^ { * } P F ) ^ { * } v } { b w }</formula><end_of_utterance>
2025-06-10 20:19:39,237 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:19:39,237 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>I E S T I ^ { * } = \\frac { L P ^ { * } ( H R ^ { * } P F ) ^ { * } v } { b w }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=636x120 at 0x7F9714D0BE90>)]
2025-06-10 20:19:39,238 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:19:39,241 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=636.0, b=120.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 79))], orig='I E S T I ^ { * } = \\frac { L P ^ { * } ( H R ^ { * } P F ) ^ { * } v } { b w }', text='I E S T I ^ { * } = \\frac { L P ^ { * } ( H R ^ { * } P F ) ^ { * } v } { b w }', formatting=None, hyperlink=None)]
2025-06-10 20:19:39,241 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:19:39,241 - DEBUG - Processing text item: label=formula, text=I E S T I ^ { * } = \frac { L P ^ { * } ( H R ^ { * } P F ) ^ { * } v } { b w }
2025-06-10 20:19:39,241 - DEBUG - Recognized string extracted: I E S T I ^ { * } = \frac { L P ^ { * } ( H R ^ { * } P F ) ^ { * } v } { b w }
2025-06-10 20:19:39,241 - INFO - All done. Returning 3 recognized text results.
2025-06-10 20:19:39,242 - DEBUG - Snippet 10.1007_s10661-015-4850-6_693_item_0 recognized text:
MALFORMED_FORMULA
2025-06-10 20:19:39,242 - DEBUG - Snippet 10.1007_s10661-015-4850-6_693_item_1 recognized text:
I E S T I = \frac { L P ^ { * } ( H R ) ^ { * } v } { b w }
2025-06-10 20:19:39,242 - DEBUG - Snippet 10.1007_s10661-015-4850-6_693_item_2 recognized text:
I E S T I ^ { * } = \frac { L P ^ { * } ( H R ^ { * } P F ) ^ { * } v } { b w }
2025-06-10 20:19:39,353 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:19:39,361 - INFO - Finished converting document 10.1007_s10661-015-4850-6_693.pdf in 29.03 sec.
2025-06-10 20:19:39,390 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:19:39,426 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:19:39,464 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:19:39,502 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:19:39,531 - DEBUG - Snippet 10.1214_10-aoas351_689_item_2: generation shape=torch.Size([1, 465])
2025-06-10 20:19:39,533 - DEBUG - Snippet 10.1214_10-aoas351_689_item_2 raw docling: (tokens=119)
<formula><loc_0><loc_0><loc_500><loc_500>\left ( \begin{array} { c } { { \mu \cup \nu } } \\ { { \beta _ { 1 } ( s ) } } \end{array} \right ) = A \left ( \begin{array} { c } { { \ ^ { \wedge } \cup \wedge } } \\ { { \ ^ { \wedge } \omega \cup \wedge } } \end{array} \right ) .</formula><end_of_utterance>
2025-06-10 20:19:39,533 - DEBUG - Starting _parse_docling_output
2025-06-10 20:19:39,533 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>\left ( \begin{array} { c } { { \mu \cup \nu } } \\ { { \beta _ { 1 } ( s ) } } \end{array} \right ) = A \left ( \begin{array} { c } { { \ ^ { \wedge } \cup \wedge } } \\ { { \ ^ { \wedge } \omega \cup \wedge } } \end{array} \right ) .</formula><end_of_utterance>
2025-06-10 20:19:39,533 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:19:39,534 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>\\left ( \\begin{array} { c } { { \\mu \\cup \\nu } } \\\\ { { \\beta _ { 1 } ( s ) } } \\end{array} \\right ) = A \\left ( \\begin{array} { c } { { \\ ^ { \\wedge } \\cup \\wedge } } \\\\ { { \\ ^ { \\wedge } \\omega \\cup \\wedge } } \\end{array} \\right ) .</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=688x158 at 0x7F96B29FDBE0>)]
2025-06-10 20:19:39,534 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:19:39,537 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=688.0, b=158.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 235))], orig='\\left ( \\begin{array} { c } { { \\mu \\cup \\nu } } \\\\ { { \\beta _ { 1 } ( s ) } } \\end{array} \\right ) = A \\left ( \\begin{array} { c } { { \\ ^ { \\wedge } \\cup \\wedge } } \\\\ { { \\ ^ { \\wedge } \\omega \\cup \\wedge } } \\end{array} \\right ) .', text='\\left ( \\begin{array} { c } { { \\mu \\cup \\nu } } \\\\ { { \\beta _ { 1 } ( s ) } } \\end{array} \\right ) = A \\left ( \\begin{array} { c } { { \\ ^ { \\wedge } \\cup \\wedge } } \\\\ { { \\ ^ { \\wedge } \\omega \\cup \\wedge } } \\end{array} \\right ) .', formatting=None, hyperlink=None)]
2025-06-10 20:19:39,538 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:19:39,538 - DEBUG - Processing text item: label=formula, text=\left ( \begin{array} { c } { { \mu \cup \nu } } \\ { { \beta _ { 1 } ( s ) } } \end{array} \right ) = A \left ( \begin{array} { c } { { \ ^ { \wedge } \cup \wedge } } \\ { { \ ^ { \wedge } \omega \cup \wedge } } \end{array} \right ) .
2025-06-10 20:19:39,538 - DEBUG - Recognized string extracted: \left ( \begin{array} { c } { { \mu \cup \nu } } \\ { { \beta _ { 1 } ( s ) } } \end{array} \right ) = A \left ( \begin{array} { c } { { \ ^ { \wedge } \cup \wedge } } \\ { { \ ^ { \wedge } \omega \cup \wedge } } \end{array} \right ) .
2025-06-10 20:19:39,538 - DEBUG - Generating chat message for label: formula
2025-06-10 20:19:39,539 - DEBUG - Snippet 10.1214_10-aoas351_689_item_3 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:19:39,539 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:19:39,614 - DEBUG - Snippet 10.1214_10-aoas351_689_item_3 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:19:39,615 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:19:39,644 - INFO - Extraction successful row 133, tokens=30133
2025-06-10 20:19:39,662 - DEBUG - [Page 25] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:39,669 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:19:39,674 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:19:39,677 - DEBUG - [Page 110] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:39,683 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:19:39,683 - INFO - Going to convert document batch...
2025-06-10 20:19:39,683 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:19:39,684 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:19:39,717 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:19:39,742 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:19:39,769 - DEBUG - [Page 111] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:39,770 - DEBUG - Finished converting page batch time=3930.454
2025-06-10 20:19:39,772 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:19:39,839 - DEBUG - Dynamic vertical threshold: 25.088399999999876, Overlap threshold: 0.7
2025-06-10 20:19:39,845 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:39,937 - DEBUG - [Page 196] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:39,964 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:19:40,030 - DEBUG - [Page 112] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:40,203 - DEBUG - [Page 26] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:40,236 - DEBUG - [Page 113] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:40,294 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:19:40,395 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:19:40,413 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:19:40,413 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:19:40,413 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:19:40,442 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:19:40,449 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:19:40,450 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:19:40,479 - DEBUG - [Page 197] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:40,535 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:19:40,536 - INFO - Processing document 10.3390_atmos11121365_709.pdf
2025-06-10 20:19:40,546 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:19:40,562 - DEBUG - [Page 114] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:40,585 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:19:40,635 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:19:40,790 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:19:40,812 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:19:40,813 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:19:40,813 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:19:40,825 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:19:40,829 - DEBUG - [Page 115] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:40,830 - DEBUG - Finished converting page batch time=3931.513
2025-06-10 20:19:40,857 - DEBUG - [Page 27] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:40,859 - DEBUG - Finished converting page batch time=3931.542
2025-06-10 20:19:40,859 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:19:40,897 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:19:40,943 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:19:40,960 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:19:40,982 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:19:40,998 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:19:40,999 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:41,018 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:19:41,037 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:19:41,071 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:19:41,109 - DEBUG - [Page 116] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:41,196 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:19:41,240 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:19:41,246 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:19:41,370 - DEBUG - [Page 28] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:41,418 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:19:41,434 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:41,445 - DEBUG - [Page 117] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:41,496 - DEBUG - [Page 198] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:41,547 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:19:41,572 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:19:41,741 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:19:41,741 - INFO - Processing document 10.1007_s10113-013-0444-4_712.pdf
2025-06-10 20:19:41,768 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:41,787 - DEBUG - [Page 118] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:41,856 - DEBUG - Dynamic vertical threshold: 22.964399999999966, Overlap threshold: 0.7
2025-06-10 20:19:41,857 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:41,858 - DEBUG - Finished converting page batch time=3932.542
2025-06-10 20:19:41,904 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:19:42,077 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:19:42,078 - INFO - Processing document 10.3390_atmos9020074_714.pdf
2025-06-10 20:19:42,116 - DEBUG - [Page 119] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:42,117 - DEBUG - Finished converting page batch time=3932.801
2025-06-10 20:19:42,206 - DEBUG - Dynamic vertical threshold: 23.567400000000134, Overlap threshold: 0.7
2025-06-10 20:19:42,206 - DEBUG - Checking merge:
  Current: 9, Next: 14
2025-06-10 20:19:42,207 - DEBUG -   Vertical gap: 11.795999999999935, Overlap ratio: 1.0
2025-06-10 20:19:42,207 - DEBUG - [Page 120] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:42,207 - DEBUG -   Left boundary diff: 51.67499999999998, Right boundary diff: 0.0019999999999527063
2025-06-10 20:19:42,207 - DEBUG -   Alignment factor (ratio): 0.1707589894240126
2025-06-10 20:19:42,207 - DEBUG -   -> c1 9 formula number: 2, c2 14 formula number: 3
2025-06-10 20:19:42,208 - DEBUG -   -> Not merging clusters 9 and 14 due to different formula numbers: 2 vs 3
2025-06-10 20:19:42,208 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:42,209 - DEBUG - Finished converting page batch time=3932.893
2025-06-10 20:19:42,235 - DEBUG - [Page 199] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:42,236 - DEBUG - Finished converting page batch time=3932.919
2025-06-10 20:19:42,366 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:42,422 - DEBUG - [Page 121] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:42,524 - DEBUG - Dynamic vertical threshold: 25.46280000000013, Overlap threshold: 0.7
2025-06-10 20:19:42,525 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:42,579 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:42,605 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:42,625 - DEBUG - [Page 29] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:42,863 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:42,910 - DEBUG - [Page 122] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:42,947 - DEBUG - [Page 200] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:43,085 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:43,091 - DEBUG - [Page 30] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:43,233 - DEBUG - [Page 123] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:43,234 - DEBUG - Finished converting page batch time=3933.917
2025-06-10 20:19:43,258 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:43,464 - DEBUG - [Page 201] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:43,544 - DEBUG - [Page 124] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:43,662 - DEBUG - [Page 31] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:43,662 - DEBUG - Finished converting page batch time=3934.346
2025-06-10 20:19:43,721 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:43,983 - DEBUG - [Page 125] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:44,059 - DEBUG - [Page 202] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:44,150 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:44,265 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:44,270 - DEBUG - [Page 32] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:44,370 - DEBUG - [Page 126] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:44,411 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:44,492 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:44,493 - DEBUG - Finished converting page batch time=3935.176
2025-06-10 20:19:44,640 - DEBUG - [Page 33] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:44,650 - DEBUG - [Page 203] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:44,651 - DEBUG - Finished converting page batch time=3935.335
2025-06-10 20:19:44,749 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:44,832 - DEBUG - [Page 127] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:44,832 - DEBUG - Finished converting page batch time=3935.516
2025-06-10 20:19:45,268 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:45,329 - DEBUG - [Page 128] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:45,362 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:45,388 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:45,405 - DEBUG - [Page 34] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:45,568 - DEBUG - [Page 204] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:45,821 - DEBUG - [Page 129] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:45,842 - DEBUG - [Page 14] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:45,898 - DEBUG - [Page 35] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:45,899 - DEBUG - Finished converting page batch time=3936.582
2025-06-10 20:19:45,941 - DEBUG - [Page 205] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:46,015 - DEBUG - Snippet 10.1214_10-aoas351_689_item_3: generation shape=torch.Size([1, 558])
2025-06-10 20:19:46,016 - DEBUG - Snippet 10.1214_10-aoas351_689_item_3 raw docling: (tokens=212)
<formula><loc_0><loc_0><loc_500><loc_500>Y _ { 1 } ( s ) = \tilde { \beta } _ { 1 0 } ( s ) + \tilde { \beta } _ { 1 1 } ( s ) x _ { 1 } ( B ) + \tilde { \beta } _ { 1 2 } ( s ) x _ { 2 } ( B ) + \varepsilon _ { 1 } ( s ) , \\ Y _ { 2 } ( s ) = \tilde { \beta } _ { 2 0 } ( s ) + \tilde { \beta } _ { 2 1 } ( s ) x _ { 1 } ( B ) + \tilde { \beta } _ { 2 2 } ( s ) x _ { 2 } ( B ) + \varepsilon _ { 2 } ( s ) ,</formula><end_of_utterance>
2025-06-10 20:19:46,017 - DEBUG - Starting _parse_docling_output
2025-06-10 20:19:46,017 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>Y _ { 1 } ( s ) = \tilde { \beta } _ { 1 0 } ( s ) + \tilde { \beta } _ { 1 1 } ( s ) x _ { 1 } ( B ) + \tilde { \beta } _ { 1 2 } ( s ) x _ { 2 } ( B ) + \varepsilon _ { 1 } ( s ) , \\ Y _ { 2 } ( s ) = \tilde { \beta } _ { 2 0 } ( s ) + \tilde { \beta } _ { 2 1 } ( s ) x _ { 1 } ( B ) + \tilde { \beta } _ { 2 2 } ( s ) x _ { 2 } ( B ) + \varepsilon _ { 2 } ( s ) ,</formula><end_of_utterance>
2025-06-10 20:19:46,017 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:19:46,017 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>Y _ { 1 } ( s ) = \\tilde { \\beta } _ { 1 0 } ( s ) + \\tilde { \\beta } _ { 1 1 } ( s ) x _ { 1 } ( B ) + \\tilde { \\beta } _ { 1 2 } ( s ) x _ { 2 } ( B ) + \\varepsilon _ { 1 } ( s ) , \\\\ Y _ { 2 } ( s ) = \\tilde { \\beta } _ { 2 0 } ( s ) + \\tilde { \\beta } _ { 2 1 } ( s ) x _ { 1 } ( B ) + \\tilde { \\beta } _ { 2 2 } ( s ) x _ { 2 } ( B ) + \\varepsilon _ { 2 } ( s ) ,</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=873x214 at 0x7F96B29FE330>)]
2025-06-10 20:19:46,018 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:19:46,024 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=873.0, b=214.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 368))], orig='Y _ { 1 } ( s ) = \\tilde { \\beta } _ { 1 0 } ( s ) + \\tilde { \\beta } _ { 1 1 } ( s ) x _ { 1 } ( B ) + \\tilde { \\beta } _ { 1 2 } ( s ) x _ { 2 } ( B ) + \\varepsilon _ { 1 } ( s ) , \\\\ Y _ { 2 } ( s ) = \\tilde { \\beta } _ { 2 0 } ( s ) + \\tilde { \\beta } _ { 2 1 } ( s ) x _ { 1 } ( B ) + \\tilde { \\beta } _ { 2 2 } ( s ) x _ { 2 } ( B ) + \\varepsilon _ { 2 } ( s ) ,', text='Y _ { 1 } ( s ) = \\tilde { \\beta } _ { 1 0 } ( s ) + \\tilde { \\beta } _ { 1 1 } ( s ) x _ { 1 } ( B ) + \\tilde { \\beta } _ { 1 2 } ( s ) x _ { 2 } ( B ) + \\varepsilon _ { 1 } ( s ) , \\\\ Y _ { 2 } ( s ) = \\tilde { \\beta } _ { 2 0 } ( s ) + \\tilde { \\beta } _ { 2 1 } ( s ) x _ { 1 } ( B ) + \\tilde { \\beta } _ { 2 2 } ( s ) x _ { 2 } ( B ) + \\varepsilon _ { 2 } ( s ) ,', formatting=None, hyperlink=None)]
2025-06-10 20:19:46,025 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:19:46,025 - DEBUG - Processing text item: label=formula, text=Y _ { 1 } ( s ) = \tilde { \beta } _ { 1 0 } ( s ) + \tilde { \beta } _ { 1 1 } ( s ) x _ { 1 } ( B ) + \tilde { \beta } _ { 1 2 } ( s ) x _ { 2 } ( B ) + \varepsilon _ { 1 } ( s ) , \\ Y _ { 2 } ( s ) = \tilde { \beta } _ { 2 0 } ( s ) + \tilde { \beta } _ { 2 1 } ( s ) x _ { 1 } ( B ) + \tilde { \beta } _ { 2 2 } ( s ) x _ { 2 } ( B ) + \varepsilon _ { 2 } ( s ) ,
2025-06-10 20:19:46,025 - DEBUG - Recognized string extracted: Y _ { 1 } ( s ) = \tilde { \beta } _ { 1 0 } ( s ) + \tilde { \beta } _ { 1 1 } ( s ) x _ { 1 } ( B ) + \tilde { \beta } _ { 1 2 } ( s ) x _ { 2 } ( B ) + \varepsilon _ { 1 } ( s ) , \\ Y _ { 2 } ( s ) = \tilde { \beta } _ { 2 0 } ( s ) + \tilde { \beta } _ { 2 1 } ( s ) x _ { 1 } ( B ) + \tilde { \beta } _ { 2 2 } ( s ) x _ { 2 } ( B ) + \varepsilon _ { 2 } ( s ) ,
2025-06-10 20:19:46,025 - DEBUG - Generating chat message for label: formula
2025-06-10 20:19:46,026 - DEBUG - Snippet 10.1214_10-aoas351_689_item_4 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:19:46,082 - DEBUG - [Page 206] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:46,092 - DEBUG - Snippet 10.1214_10-aoas351_689_item_4 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:19:46,159 - DEBUG - [Page 207] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:46,159 - DEBUG - Finished converting page batch time=3936.843
2025-06-10 20:19:46,296 - DEBUG - [Page 130] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:46,324 - DEBUG - Finished converting page batch time=3937.008
2025-06-10 20:19:46,642 - DEBUG - [Page 208] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:46,676 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:46,718 - DEBUG - [Page 131] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:46,718 - DEBUG - Finished converting page batch time=3937.402
2025-06-10 20:19:46,966 - DEBUG - [Page 36] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:47,169 - DEBUG - [Page 209] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:47,351 - DEBUG - [Page 210] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:47,391 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:47,431 - DEBUG - [Page 211] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:47,431 - DEBUG - Finished converting page batch time=3938.115
2025-06-10 20:19:47,434 - DEBUG - [Page 15] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:48,061 - DEBUG - Snippet 10.1214_10-aoas351_689_item_4: generation shape=torch.Size([1, 399])
2025-06-10 20:19:48,062 - DEBUG - Snippet 10.1214_10-aoas351_689_item_4 raw docling: (tokens=53)
<formula><loc_0><loc_0><loc_500><loc_500>\tilde { \beta } _ { i j } ( s ) = \beta _ { i j } + \beta _ { i j } ( s ) .</formula><end_of_utterance>
2025-06-10 20:19:48,062 - DEBUG - Starting _parse_docling_output
2025-06-10 20:19:48,062 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>\tilde { \beta } _ { i j } ( s ) = \beta _ { i j } + \beta _ { i j } ( s ) .</formula><end_of_utterance>
2025-06-10 20:19:48,063 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:19:48,063 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>\\tilde { \\beta } _ { i j } ( s ) = \\beta _ { i j } + \\beta _ { i j } ( s ) .</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=666x55 at 0x7F96B29FF500>)]
2025-06-10 20:19:48,063 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:19:48,065 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=666.0, b=55.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 76))], orig='\\tilde { \\beta } _ { i j } ( s ) = \\beta _ { i j } + \\beta _ { i j } ( s ) .', text='\\tilde { \\beta } _ { i j } ( s ) = \\beta _ { i j } + \\beta _ { i j } ( s ) .', formatting=None, hyperlink=None)]
2025-06-10 20:19:48,065 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:19:48,065 - DEBUG - Processing text item: label=formula, text=\tilde { \beta } _ { i j } ( s ) = \beta _ { i j } + \beta _ { i j } ( s ) .
2025-06-10 20:19:48,066 - DEBUG - Recognized string extracted: \tilde { \beta } _ { i j } ( s ) = \beta _ { i j } + \beta _ { i j } ( s ) .
2025-06-10 20:19:48,066 - INFO - All done. Returning 5 recognized text results.
2025-06-10 20:19:48,066 - DEBUG - Snippet 10.1214_10-aoas351_689_item_0 recognized text:
Y ( s ) = \tilde { \beta } _ { 0 } ( s ) + \tilde { \beta } _ { 1 } ( s ) x ( B ) + \varepsilon ( s ) , \quad \varepsilon ( s ) \sim N ( 0 , \tau ^ { 2 } ) ,
2025-06-10 20:19:48,066 - DEBUG - Snippet 10.1214_10-aoas351_689_item_1 recognized text:
\tilde { \beta } _ { 0 } ( s ) = \beta _ { 0 } + \beta _ { 0 } ( s ) , \\ \tilde { \beta } _ { 1 } ( s ) = \beta _ { 1 } + \beta _ { 1 } ( s ) .
2025-06-10 20:19:48,066 - DEBUG - Snippet 10.1214_10-aoas351_689_item_2 recognized text:
\left ( \begin{array} { c } { { \mu \cup \nu } } \\ { { \beta _ { 1 } ( s ) } } \end{array} \right ) = A \left ( \begin{array} { c } { { \ ^ { \wedge } \cup \wedge } } \\ { { \ ^ { \wedge } \omega \cup \wedge } } \end{array} \right ) .
2025-06-10 20:19:48,067 - DEBUG - Snippet 10.1214_10-aoas351_689_item_3 recognized text:
Y _ { 1 } ( s ) = \tilde { \beta } _ { 1 0 } ( s ) + \tilde { \beta } _ { 1 1 } ( s ) x _ { 1 } ( B ) + \tilde { \beta } _ { 1 2 } ( s ) x _ { 2 } ( B ) + \varepsilon _ { 1 } ( s ) , \\ Y _ { 2 } ( s ) = \tilde { \beta } _ { 2 0 } ( s ) + \tilde { \beta } _ { 2 1 } ( s ) x _ { 1 } ( B ) + \tilde { \beta } _ { 2 2 } ( s ) x _ { 2 } ( B ) + \varepsilon _ { 2 } ( s ) ,
2025-06-10 20:19:48,067 - DEBUG - Snippet 10.1214_10-aoas351_689_item_4 recognized text:
\tilde { \beta } _ { i j } ( s ) = \beta _ { i j } + \beta _ { i j } ( s ) .
2025-06-10 20:19:48,138 - DEBUG - Creating masked image for page 13 with 12 clusters.
2025-06-10 20:19:48,139 - INFO - Masked image successfully created for page 13.
2025-06-10 20:19:48,201 - DEBUG - Finished converting page batch time=3938.885
2025-06-10 20:19:48,210 - DEBUG - Creating masked image for page 14 with 11 clusters.
2025-06-10 20:19:48,211 - INFO - Masked image successfully created for page 14.
2025-06-10 20:19:48,219 - INFO - Starting prediction for 5 images with labels: ['formula', 'formula', 'formula', 'formula', 'formula']
2025-06-10 20:19:48,219 - DEBUG - Generating chat message for label: formula
2025-06-10 20:19:48,219 - DEBUG - Snippet 10.1214_10-aoas351_689_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:19:48,364 - DEBUG - Snippet 10.1214_10-aoas351_689_item_0 => input_ids shape=torch.Size([1, 610]), prompt_len=610
2025-06-10 20:19:48,503 - DEBUG - [Page 132] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:48,591 - DEBUG - Finished converting page batch time=3939.275
2025-06-10 20:19:48,617 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:48,825 - DEBUG - [Page 133] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:48,966 - DEBUG - [Page 37] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:49,142 - DEBUG - [Page 134] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:49,350 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:49,443 - DEBUG - [Page 135] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:49,444 - DEBUG - Finished converting page batch time=3940.127
2025-06-10 20:19:49,535 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:49,770 - DEBUG - [Page 136] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:49,901 - DEBUG - [Page 38] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:50,002 - DEBUG - Snippet 10.1214_10-aoas351_689_item_0: generation shape=torch.Size([1, 663])
2025-06-10 20:19:50,003 - DEBUG - Snippet 10.1214_10-aoas351_689_item_0 raw docling: (tokens=52)
<formula><loc_0><loc_0><loc_500><loc_500>\tilde { \beta } _ { i j } ( s ) = \beta _ { i j } + \beta _ { i j } ( s )</formula><end_of_utterance>
2025-06-10 20:19:50,004 - DEBUG - Starting _parse_docling_output
2025-06-10 20:19:50,004 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>\tilde { \beta } _ { i j } ( s ) = \beta _ { i j } + \beta _ { i j } ( s )</formula><end_of_utterance>
2025-06-10 20:19:50,004 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:19:50,004 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>\\tilde { \\beta } _ { i j } ( s ) = \\beta _ { i j } + \\beta _ { i j } ( s )</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=256x112 at 0x7F96B29954F0>)]
2025-06-10 20:19:50,005 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:19:50,006 - DEBUG - [Page 16] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:50,006 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=256.0, b=112.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 74))], orig='\\tilde { \\beta } _ { i j } ( s ) = \\beta _ { i j } + \\beta _ { i j } ( s )', text='\\tilde { \\beta } _ { i j } ( s ) = \\beta _ { i j } + \\beta _ { i j } ( s )', formatting=None, hyperlink=None)]
2025-06-10 20:19:50,007 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:19:50,007 - DEBUG - Processing text item: label=formula, text=\tilde { \beta } _ { i j } ( s ) = \beta _ { i j } + \beta _ { i j } ( s )
2025-06-10 20:19:50,007 - DEBUG - Recognized string extracted: \tilde { \beta } _ { i j } ( s ) = \beta _ { i j } + \beta _ { i j } ( s )
2025-06-10 20:19:50,007 - DEBUG - Generating chat message for label: formula
2025-06-10 20:19:50,007 - DEBUG - Snippet 10.1214_10-aoas351_689_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:19:50,126 - DEBUG - [Page 137] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:50,340 - DEBUG - Snippet 10.1214_10-aoas351_689_item_1 => input_ids shape=torch.Size([1, 1140]), prompt_len=1140
2025-06-10 20:19:50,460 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:50,472 - DEBUG - [Page 138] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:50,494 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:50,502 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:50,652 - DEBUG - Creating masked image for page 51 with 16 clusters.
2025-06-10 20:19:50,654 - INFO - Masked image successfully created for page 51.
2025-06-10 20:19:50,667 - INFO - Starting prediction for 2 images with labels: ['formula', 'formula']
2025-06-10 20:19:50,668 - DEBUG - Generating chat message for label: formula
2025-06-10 20:19:50,668 - DEBUG - Snippet 10.20868_upm.thesis.32872_630_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:19:50,729 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:50,730 - DEBUG - Finished converting page batch time=3941.414
2025-06-10 20:19:50,744 - DEBUG - [Page 17] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:50,759 - DEBUG - [Page 39] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:50,760 - DEBUG - Finished converting page batch time=3941.444
2025-06-10 20:19:50,818 - DEBUG - [Page 139] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:50,819 - DEBUG - Finished converting page batch time=3941.503
2025-06-10 20:19:50,862 - DEBUG - Snippet 10.20868_upm.thesis.32872_630_item_0 => input_ids shape=torch.Size([1, 610]), prompt_len=610
2025-06-10 20:19:50,945 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:51,185 - DEBUG - [Page 140] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:51,224 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:51,285 - DEBUG - Finished converting page batch time=3941.968
2025-06-10 20:19:51,428 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:51,433 - DEBUG - Finished converting page batch time=3942.117
2025-06-10 20:19:51,492 - DEBUG - [Page 18] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:51,507 - DEBUG - [Page 141] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:51,681 - DEBUG - [Page 40] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:51,795 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:51,840 - DEBUG - [Page 142] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:52,123 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:52,166 - DEBUG - [Page 143] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:52,167 - DEBUG - Finished converting page batch time=3942.850
2025-06-10 20:19:52,180 - DEBUG - [Page 19] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:52,181 - DEBUG - Finished converting page batch time=3942.865
2025-06-10 20:19:52,454 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:52,472 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:52,574 - DEBUG - [Page 144] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:52,591 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:52,593 - DEBUG - [Page 41] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:52,745 - DEBUG - [Page 20] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:52,798 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:52,929 - DEBUG - [Page 145] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:53,017 - DEBUG - [Page 146] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:53,027 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:53,127 - DEBUG - [Page 147] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:53,127 - DEBUG - Finished converting page batch time=3943.811
2025-06-10 20:19:53,202 - DEBUG - [Page 148] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:53,384 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:53,492 - DEBUG - Snippet 10.20868_upm.thesis.32872_630_item_0: generation shape=torch.Size([1, 698])
2025-06-10 20:19:53,493 - DEBUG - Snippet 10.20868_upm.thesis.32872_630_item_0 raw docling: (tokens=87)
<formula><loc_0><loc_0><loc_500><loc_500>N O + O _ { 3 } \to N O _ { 2 } + O _ { 2 } \\ N O _ { 2 } + U V \left ( \sinh \right ) \to N O + O \\ O + O _ { 2 } \to O _ { 3 }</formula><end_of_utterance>
2025-06-10 20:19:53,494 - DEBUG - Starting _parse_docling_output
2025-06-10 20:19:53,494 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>N O + O _ { 3 } \to N O _ { 2 } + O _ { 2 } \\ N O _ { 2 } + U V \left ( \sinh \right ) \to N O + O \\ O + O _ { 2 } \to O _ { 3 }</formula><end_of_utterance>
2025-06-10 20:19:53,494 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:19:53,494 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>N O + O _ { 3 } \\to N O _ { 2 } + O _ { 2 } \\\\ N O _ { 2 } + U V \\left ( \\sinh \\right ) \\to N O + O \\\\ O + O _ { 2 } \\to O _ { 3 }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=884x254 at 0x7F96CC7EA900>)]
2025-06-10 20:19:53,495 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:19:53,501 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=884.0, b=254.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 130))], orig='N O + O _ { 3 } \\to N O _ { 2 } + O _ { 2 } \\\\ N O _ { 2 } + U V \\left ( \\sinh \\right ) \\to N O + O \\\\ O + O _ { 2 } \\to O _ { 3 }', text='N O + O _ { 3 } \\to N O _ { 2 } + O _ { 2 } \\\\ N O _ { 2 } + U V \\left ( \\sinh \\right ) \\to N O + O \\\\ O + O _ { 2 } \\to O _ { 3 }', formatting=None, hyperlink=None)]
2025-06-10 20:19:53,501 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:19:53,501 - DEBUG - Processing text item: label=formula, text=N O + O _ { 3 } \to N O _ { 2 } + O _ { 2 } \\ N O _ { 2 } + U V \left ( \sinh \right ) \to N O + O \\ O + O _ { 2 } \to O _ { 3 }
2025-06-10 20:19:53,501 - DEBUG - Recognized string extracted: N O + O _ { 3 } \to N O _ { 2 } + O _ { 2 } \\ N O _ { 2 } + U V \left ( \sinh \right ) \to N O + O \\ O + O _ { 2 } \to O _ { 3 }
2025-06-10 20:19:53,502 - DEBUG - Generating chat message for label: formula
2025-06-10 20:19:53,502 - DEBUG - Snippet 10.20868_upm.thesis.32872_630_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:19:53,540 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:53,575 - DEBUG - Snippet 10.20868_upm.thesis.32872_630_item_1 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:19:53,874 - DEBUG - [Page 42] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:53,996 - DEBUG - Finished converting page batch time=3944.680
2025-06-10 20:19:54,583 - DEBUG - Finished converting page batch time=3945.267
2025-06-10 20:19:54,681 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:54,684 - DEBUG - Finished converting page batch time=3945.368
2025-06-10 20:19:54,731 - DEBUG - [Page 43] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:54,733 - DEBUG - Finished converting page batch time=3945.416
2025-06-10 20:19:54,951 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:55,118 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:55,176 - DEBUG - [Page 149] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:55,251 - DEBUG - [Page 150] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:55,341 - DEBUG - [Page 151] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:55,342 - DEBUG - Finished converting page batch time=3946.026
2025-06-10 20:19:55,397 - DEBUG - Snippet 10.20868_upm.thesis.32872_630_item_1: generation shape=torch.Size([1, 408])
2025-06-10 20:19:55,398 - DEBUG - Snippet 10.20868_upm.thesis.32872_630_item_1 raw docling: (tokens=62)
<formula><loc_0><loc_0><loc_500><loc_500>N O + R O _ { 2 } \left ( a l k y l \, p e r o x i d e \right ) \to N O _ { 2 } + R O</formula><end_of_utterance>
2025-06-10 20:19:55,398 - DEBUG - Starting _parse_docling_output
2025-06-10 20:19:55,398 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>N O + R O _ { 2 } \left ( a l k y l \, p e r o x i d e \right ) \to N O _ { 2 } + R O</formula><end_of_utterance>
2025-06-10 20:19:55,399 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:19:55,399 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>N O + R O _ { 2 } \\left ( a l k y l \\, p e r o x i d e \\right ) \\to N O _ { 2 } + R O</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=884x61 at 0x7F9657C27350>)]
2025-06-10 20:19:55,399 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:19:55,402 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=884.0, b=61.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 85))], orig='N O + R O _ { 2 } \\left ( a l k y l \\, p e r o x i d e \\right ) \\to N O _ { 2 } + R O', text='N O + R O _ { 2 } \\left ( a l k y l \\, p e r o x i d e \\right ) \\to N O _ { 2 } + R O', formatting=None, hyperlink=None)]
2025-06-10 20:19:55,402 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:19:55,402 - DEBUG - Processing text item: label=formula, text=N O + R O _ { 2 } \left ( a l k y l \, p e r o x i d e \right ) \to N O _ { 2 } + R O
2025-06-10 20:19:55,403 - DEBUG - Recognized string extracted: N O + R O _ { 2 } \left ( a l k y l \, p e r o x i d e \right ) \to N O _ { 2 } + R O
2025-06-10 20:19:55,403 - INFO - All done. Returning 2 recognized text results.
2025-06-10 20:19:55,403 - DEBUG - Snippet 10.20868_upm.thesis.32872_630_item_0 recognized text:
N O + O _ { 3 } \to N O _ { 2 } + O _ { 2 } \\ N O _ { 2 } + U V \left ( \sinh \right ) \to N O + O \\ O + O _ { 2 } \to O _ { 3 }
2025-06-10 20:19:55,403 - DEBUG - Snippet 10.20868_upm.thesis.32872_630_item_1 recognized text:
N O + R O _ { 2 } \left ( a l k y l \, p e r o x i d e \right ) \to N O _ { 2 } + R O
2025-06-10 20:19:55,423 - DEBUG - [Page 152] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:55,509 - DEBUG - [Page 153] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:55,568 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:55,582 - DEBUG - [Page 154] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:55,594 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:55,595 - DEBUG - Finished converting page batch time=3946.278
2025-06-10 20:19:55,631 - DEBUG - Snippet 10.1214_10-aoas351_689_item_1: generation shape=torch.Size([1, 1322])
2025-06-10 20:19:55,632 - DEBUG - Snippet 10.1214_10-aoas351_689_item_1 raw docling: (tokens=181)
<formula><loc_0><loc_0><loc_500><loc_500>\begin{pmatrix} \beta _ { 1 0 } ( s ) \\ \beta _ { 1 1 } ( s ) \\ \beta _ { 1 2 } ( s ) \\ \beta _ { 2 0 } ( s ) \\ \beta _ { 2 1 } ( s ) \\ \beta _ { 2 2 } ( s ) \end{pmatrix} = A \begin{pmatrix} w _ { 1 } ( s ) \\ w _ { 2 } ( s ) \\ w _ { 3 } ( s ) \\ w _ { 4 } ( s ) \\ w _ { 5 } ( s ) \\ w _ { 6 } ( s ) \end{pmatrix} ,</formula><end_of_utterance>
2025-06-10 20:19:55,632 - DEBUG - Starting _parse_docling_output
2025-06-10 20:19:55,633 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>\begin{pmatrix} \beta _ { 1 0 } ( s ) \\ \beta _ { 1 1 } ( s ) \\ \beta _ { 1 2 } ( s ) \\ \beta _ { 2 0 } ( s ) \\ \beta _ { 2 1 } ( s ) \\ \beta _ { 2 2 } ( s ) \end{pmatrix} = A \begin{pmatrix} w _ { 1 } ( s ) \\ w _ { 2 } ( s ) \\ w _ { 3 } ( s ) \\ w _ { 4 } ( s ) \\ w _ { 5 } ( s ) \\ w _ { 6 } ( s ) \end{pmatrix} ,</formula><end_of_utterance>
2025-06-10 20:19:55,633 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:19:55,633 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>\\begin{pmatrix} \\beta _ { 1 0 } ( s ) \\\\ \\beta _ { 1 1 } ( s ) \\\\ \\beta _ { 1 2 } ( s ) \\\\ \\beta _ { 2 0 } ( s ) \\\\ \\beta _ { 2 1 } ( s ) \\\\ \\beta _ { 2 2 } ( s ) \\end{pmatrix} = A \\begin{pmatrix} w _ { 1 } ( s ) \\\\ w _ { 2 } ( s ) \\\\ w _ { 3 } ( s ) \\\\ w _ { 4 } ( s ) \\\\ w _ { 5 } ( s ) \\\\ w _ { 6 } ( s ) \\end{pmatrix} ,</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=346x439 at 0x7F96B2996B10>)]
2025-06-10 20:19:55,634 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:19:55,639 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=346.0, b=439.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 323))], orig='\\begin{pmatrix} \\beta _ { 1 0 } ( s ) \\\\ \\beta _ { 1 1 } ( s ) \\\\ \\beta _ { 1 2 } ( s ) \\\\ \\beta _ { 2 0 } ( s ) \\\\ \\beta _ { 2 1 } ( s ) \\\\ \\beta _ { 2 2 } ( s ) \\end{pmatrix} = A \\begin{pmatrix} w _ { 1 } ( s ) \\\\ w _ { 2 } ( s ) \\\\ w _ { 3 } ( s ) \\\\ w _ { 4 } ( s ) \\\\ w _ { 5 } ( s ) \\\\ w _ { 6 } ( s ) \\end{pmatrix} ,', text='\\begin{pmatrix} \\beta _ { 1 0 } ( s ) \\\\ \\beta _ { 1 1 } ( s ) \\\\ \\beta _ { 1 2 } ( s ) \\\\ \\beta _ { 2 0 } ( s ) \\\\ \\beta _ { 2 1 } ( s ) \\\\ \\beta _ { 2 2 } ( s ) \\end{pmatrix} = A \\begin{pmatrix} w _ { 1 } ( s ) \\\\ w _ { 2 } ( s ) \\\\ w _ { 3 } ( s ) \\\\ w _ { 4 } ( s ) \\\\ w _ { 5 } ( s ) \\\\ w _ { 6 } ( s ) \\end{pmatrix} ,', formatting=None, hyperlink=None)]
2025-06-10 20:19:55,640 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:19:55,640 - DEBUG - Processing text item: label=formula, text=\begin{pmatrix} \beta _ { 1 0 } ( s ) \\ \beta _ { 1 1 } ( s ) \\ \beta _ { 1 2 } ( s ) \\ \beta _ { 2 0 } ( s ) \\ \beta _ { 2 1 } ( s ) \\ \beta _ { 2 2 } ( s ) \end{pmatrix} = A \begin{pmatrix} w _ { 1 } ( s ) \\ w _ { 2 } ( s ) \\ w _ { 3 } ( s ) \\ w _ { 4 } ( s ) \\ w _ { 5 } ( s ) \\ w _ { 6 } ( s ) \end{pmatrix} ,
2025-06-10 20:19:55,640 - DEBUG - Recognized string extracted: \begin{pmatrix} \beta _ { 1 0 } ( s ) \\ \beta _ { 1 1 } ( s ) \\ \beta _ { 1 2 } ( s ) \\ \beta _ { 2 0 } ( s ) \\ \beta _ { 2 1 } ( s ) \\ \beta _ { 2 2 } ( s ) \end{pmatrix} = A \begin{pmatrix} w _ { 1 } ( s ) \\ w _ { 2 } ( s ) \\ w _ { 3 } ( s ) \\ w _ { 4 } ( s ) \\ w _ { 5 } ( s ) \\ w _ { 6 } ( s ) \end{pmatrix} ,
2025-06-10 20:19:55,640 - DEBUG - Generating chat message for label: formula
2025-06-10 20:19:55,641 - DEBUG - Snippet 10.1214_10-aoas351_689_item_2 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:19:55,643 - DEBUG - [Page 21] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:55,709 - DEBUG - Snippet 10.1214_10-aoas351_689_item_2 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:19:55,746 - INFO - Finished converting document 10.1007_s10113-013-0444-4_712.pdf in 16.87 sec.
2025-06-10 20:19:55,852 - INFO - Extraction successful row 139, tokens=15937
2025-06-10 20:19:55,879 - INFO - Going to convert document batch...
2025-06-10 20:19:55,879 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:19:55,880 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:19:55,932 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:19:55,940 - DEBUG - [Page 155] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:55,941 - DEBUG - Finished converting page batch time=3946.625
2025-06-10 20:19:56,188 - DEBUG - [Page 14] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:56,399 - DEBUG - [Page 44] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:56,418 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:56,457 - INFO - Finished converting document 10.20868_upm.thesis.32872_630.pdf in 148.08 sec.
2025-06-10 20:19:56,612 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:19:56,650 - DEBUG - [Page 15] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:56,653 - DEBUG - Finished converting page batch time=3947.337
2025-06-10 20:19:56,668 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:19:56,675 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:19:56,730 - INFO - Finished converting document 10.11606_t.6.2016.tde-26092016-142458_652.pdf in 84.73 sec.
2025-06-10 20:19:56,789 - INFO - Finished converting document 10.3390_atmos9020074_714.pdf in 17.14 sec.
2025-06-10 20:19:56,929 - INFO - Extraction successful row 140, tokens=21930
2025-06-10 20:19:56,948 - INFO - Going to convert document batch...
2025-06-10 20:19:56,949 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:19:56,949 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:19:57,000 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:19:57,027 - DEBUG - [Page 14] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:57,211 - DEBUG - [Page 45] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:57,229 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:19:57,229 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:19:57,229 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:19:57,275 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:19:57,314 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:19:57,351 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:19:57,460 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:19:57,518 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:19:57,551 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:19:57,634 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:19:57,684 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:19:57,691 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:19:57,754 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:19:57,797 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:19:57,832 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:19:57,956 - DEBUG - [Page 46] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:57,995 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:19:58,127 - DEBUG - [Page 15] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:58,128 - DEBUG - Finished converting page batch time=3948.811
2025-06-10 20:19:58,176 - DEBUG - Snippet 10.1214_10-aoas351_689_item_2: generation shape=torch.Size([1, 438])
2025-06-10 20:19:58,177 - DEBUG - Snippet 10.1214_10-aoas351_689_item_2 raw docling: (tokens=92)
<formula><loc_0><loc_0><loc_500><loc_500>C o v ( Y _ { 1 } ( s ) , Y _ { 2 } ( s ^ { \prime } ) ) = A _ { 1 1 } \cdot A _ { 4 1 } \exp ( - \phi _ { 1 } \| s - s ^ { \prime } \| ) .</formula><end_of_utterance>
2025-06-10 20:19:58,177 - DEBUG - Starting _parse_docling_output
2025-06-10 20:19:58,177 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>C o v ( Y _ { 1 } ( s ) , Y _ { 2 } ( s ^ { \prime } ) ) = A _ { 1 1 } \cdot A _ { 4 1 } \exp ( - \phi _ { 1 } \| s - s ^ { \prime } \| ) .</formula><end_of_utterance>
2025-06-10 20:19:58,177 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:19:58,178 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>C o v ( Y _ { 1 } ( s ) , Y _ { 2 } ( s ^ { \\prime } ) ) = A _ { 1 1 } \\cdot A _ { 4 1 } \\exp ( - \\phi _ { 1 } \\| s - s ^ { \\prime } \\| ) .</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=849x112 at 0x7F96B2997AD0>)]
2025-06-10 20:19:58,178 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:19:58,181 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=849.0, b=112.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 139))], orig='C o v ( Y _ { 1 } ( s ) , Y _ { 2 } ( s ^ { \\prime } ) ) = A _ { 1 1 } \\cdot A _ { 4 1 } \\exp ( - \\phi _ { 1 } \\| s - s ^ { \\prime } \\| ) .', text='C o v ( Y _ { 1 } ( s ) , Y _ { 2 } ( s ^ { \\prime } ) ) = A _ { 1 1 } \\cdot A _ { 4 1 } \\exp ( - \\phi _ { 1 } \\| s - s ^ { \\prime } \\| ) .', formatting=None, hyperlink=None)]
2025-06-10 20:19:58,181 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:19:58,181 - DEBUG - Processing text item: label=formula, text=C o v ( Y _ { 1 } ( s ) , Y _ { 2 } ( s ^ { \prime } ) ) = A _ { 1 1 } \cdot A _ { 4 1 } \exp ( - \phi _ { 1 } \| s - s ^ { \prime } \| ) .
2025-06-10 20:19:58,182 - DEBUG - Recognized string extracted: C o v ( Y _ { 1 } ( s ) , Y _ { 2 } ( s ^ { \prime } ) ) = A _ { 1 1 } \cdot A _ { 4 1 } \exp ( - \phi _ { 1 } \| s - s ^ { \prime } \| ) .
2025-06-10 20:19:58,182 - DEBUG - Generating chat message for label: formula
2025-06-10 20:19:58,182 - DEBUG - Snippet 10.1214_10-aoas351_689_item_3 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:19:58,195 - DEBUG - [Page 47] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:58,196 - DEBUG - Finished converting page batch time=3948.879
2025-06-10 20:19:58,202 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:19:58,202 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:19:58,202 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:19:58,240 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:19:58,253 - DEBUG - [Page 16] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:58,254 - DEBUG - Finished converting page batch time=3948.938
2025-06-10 20:19:58,282 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:19:58,291 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:19:58,318 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:19:58,359 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:19:58,394 - DEBUG - Creating masked image for page 3 with 20 clusters.
2025-06-10 20:19:58,395 - INFO - Masked image successfully created for page 3.
2025-06-10 20:19:58,395 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:19:58,404 - INFO - Starting prediction for 5 images with labels: ['formula', 'formula', 'formula', 'formula', 'formula']
2025-06-10 20:19:58,404 - DEBUG - Generating chat message for label: formula
2025-06-10 20:19:58,405 - DEBUG - Snippet 10.3390_atmos11121365_709_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:19:58,428 - DEBUG - Snippet 10.1214_10-aoas351_689_item_3 => input_ids shape=torch.Size([1, 876]), prompt_len=876
2025-06-10 20:19:58,431 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:19:58,462 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:19:58,463 - INFO - Processing document 10.5620_eaht.2023016_718.pdf
2025-06-10 20:19:58,494 - DEBUG - Snippet 10.3390_atmos11121365_709_item_0 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:19:58,569 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:19:58,608 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:19:58,645 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:19:58,670 - INFO - Finished converting document 10.3390_foods10061279_697.pdf in 43.80 sec.
2025-06-10 20:19:58,804 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:19:59,069 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:19:59,153 - DEBUG - Snippet 10.1214_10-aoas351_689_item_3: generation shape=torch.Size([1, 900])
2025-06-10 20:19:59,154 - DEBUG - Snippet 10.1214_10-aoas351_689_item_3 raw docling: (tokens=23)
<formula><loc_0><loc_0><loc_500><loc_500>( 9 )</formula><end_of_utterance>
2025-06-10 20:19:59,154 - DEBUG - Starting _parse_docling_output
2025-06-10 20:19:59,154 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>( 9 )</formula><end_of_utterance>
2025-06-10 20:19:59,155 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:19:59,155 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>( 9 )</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=38x54 at 0x7F968B1FBE60>)]
2025-06-10 20:19:59,155 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:19:59,156 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=38.0, b=54.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 5))], orig='( 9 )', text='( 9 )', formatting=None, hyperlink=None)]
2025-06-10 20:19:59,156 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:19:59,156 - DEBUG - Processing text item: label=formula, text=( 9 )
2025-06-10 20:19:59,157 - DEBUG - Recognized string extracted: ( 9 )
2025-06-10 20:19:59,157 - DEBUG - Generating chat message for label: formula
2025-06-10 20:19:59,157 - DEBUG - Snippet 10.1214_10-aoas351_689_item_4 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:19:59,268 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:19:59,268 - INFO - Processing document 10.3390_atmos11121271_719.pdf
2025-06-10 20:19:59,305 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:59,368 - DEBUG - Snippet 10.1214_10-aoas351_689_item_4 => input_ids shape=torch.Size([1, 875]), prompt_len=875
2025-06-10 20:19:59,653 - INFO - Extraction successful row 135, tokens=64607
2025-06-10 20:19:59,700 - INFO - Going to convert document batch...
2025-06-10 20:19:59,700 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:19:59,700 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:19:59,769 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:19:59,859 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:58,007 - DEBUG - Snippet 10.3390_atmos11121365_709_item_0: generation shape=torch.Size([1, 404])
2025-06-10 20:19:58,008 - DEBUG - Snippet 10.3390_atmos11121365_709_item_0 raw docling: (tokens=58)
<formula><loc_0><loc_0><loc_500><loc_500>x _ { i j } = \sum _ { k = 1 } ^ { p } g _ { i k } f _ { k i } + e _ { i j }</formula><end_of_utterance>
2025-06-10 20:19:58,008 - DEBUG - Starting _parse_docling_output
2025-06-10 20:19:58,008 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>x _ { i j } = \sum _ { k = 1 } ^ { p } g _ { i k } f _ { k i } + e _ { i j }</formula><end_of_utterance>
2025-06-10 20:19:58,008 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:19:58,009 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>x _ { i j } = \\sum _ { k = 1 } ^ { p } g _ { i k } f _ { k i } + e _ { i j }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=773x162 at 0x7F96D16EF020>)]
2025-06-10 20:19:58,009 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:19:58,013 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=773.0, b=162.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 76))], orig='x _ { i j } = \\sum _ { k = 1 } ^ { p } g _ { i k } f _ { k i } + e _ { i j }', text='x _ { i j } = \\sum _ { k = 1 } ^ { p } g _ { i k } f _ { k i } + e _ { i j }', formatting=None, hyperlink=None)]
2025-06-10 20:19:58,013 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:19:58,013 - DEBUG - Processing text item: label=formula, text=x _ { i j } = \sum _ { k = 1 } ^ { p } g _ { i k } f _ { k i } + e _ { i j }
2025-06-10 20:19:58,013 - DEBUG - Recognized string extracted: x _ { i j } = \sum _ { k = 1 } ^ { p } g _ { i k } f _ { k i } + e _ { i j }
2025-06-10 20:19:58,013 - DEBUG - Generating chat message for label: formula
2025-06-10 20:19:58,014 - DEBUG - Snippet 10.3390_atmos11121365_709_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:19:58,076 - DEBUG - Snippet 10.3390_atmos11121365_709_item_1 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:19:58,206 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:58,348 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:19:58,397 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:19:58,403 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:19:58,872 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:58,901 - WARNING - Repetitive generation detected with pattern: ' & 0'
2025-06-10 20:19:58,903 - DEBUG - Snippet 10.1214_10-aoas351_689_item_4: generation shape=torch.Size([1, 932])
2025-06-10 20:19:58,904 - DEBUG - Snippet 10.1214_10-aoas351_689_item_4 raw docling: (tokens=56)
<formula><loc_0><loc_0><loc_500><loc_500>A = \left ( \begin{array} { c c c c c c c } A _ { 1 1 } & 0 & 0 & 0 & 0
2025-06-10 20:19:58,904 - DEBUG - Starting _parse_docling_output
2025-06-10 20:19:58,905 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>A = \left ( \begin{array} { c c c c c c c } A _ { 1 1 } & 0 & 0 & 0 & 0
2025-06-10 20:19:58,905 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:19:58,905 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>A = \\left ( \\begin{array} { c c c c c c c } A _ { 1 1 } & 0 & 0 & 0 & 0', image=<PIL.Image.Image image mode=RGB size=589x439 at 0x7F96B2999A00>)]
2025-06-10 20:19:58,905 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:19:58,914 - DEBUG - DoclingDocument loaded successfully. Extracted texts: []
2025-06-10 20:19:58,914 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:19:58,914 - WARNING - Extracted text is empty or malformed. Skipping formula.
2025-06-10 20:19:58,914 - INFO - All done. Returning 5 recognized text results.
2025-06-10 20:19:58,915 - DEBUG - Snippet 10.1214_10-aoas351_689_item_0 recognized text:
\tilde { \beta } _ { i j } ( s ) = \beta _ { i j } + \beta _ { i j } ( s )
2025-06-10 20:19:58,915 - DEBUG - Snippet 10.1214_10-aoas351_689_item_1 recognized text:
\begin{pmatrix} \beta _ { 1 0 } ( s ) \\ \beta _ { 1 1 } ( s ) \\ \beta _ { 1 2 } ( s ) \\ \beta _ { 2 0 } ( s ) \\ \beta _ { 2 1 } ( s ) \\ \beta _ { 2 2 } ( s ) \end{pmatrix} = A \begin{pmatrix} w _ { 1 } ( s ) \\ w _ { 2 } ( s ) \\ w _ { 3 } ( s ) \\ w _ { 4 } ( s ) \\ w _ { 5 } ( s ) \\ w _ { 6 } ( s ) \end{pmatrix} ,
2025-06-10 20:19:58,915 - DEBUG - Snippet 10.1214_10-aoas351_689_item_2 recognized text:
C o v ( Y _ { 1 } ( s ) , Y _ { 2 } ( s ^ { \prime } ) ) = A _ { 1 1 } \cdot A _ { 4 1 } \exp ( - \phi _ { 1 } \| s - s ^ { \prime } \| ) .
2025-06-10 20:19:58,915 - DEBUG - Snippet 10.1214_10-aoas351_689_item_3 recognized text:
( 9 )
2025-06-10 20:19:58,916 - DEBUG - Snippet 10.1214_10-aoas351_689_item_4 recognized text:
MALFORMED_FORMULA
2025-06-10 20:19:58,987 - DEBUG - Creating masked image for page 15 with 18 clusters.
2025-06-10 20:19:58,988 - INFO - Masked image successfully created for page 15.
2025-06-10 20:19:59,000 - INFO - Starting prediction for 5 images with labels: ['formula', 'formula', 'formula', 'formula', 'formula']
2025-06-10 20:19:59,001 - DEBUG - Generating chat message for label: formula
2025-06-10 20:19:59,001 - DEBUG - Snippet 10.1214_10-aoas351_689_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:19:59,054 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:59,075 - DEBUG - Snippet 10.1214_10-aoas351_689_item_0 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:19:59,148 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:19:59,149 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:19:59,149 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:19:59,184 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:19:59,249 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:19:59,299 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:19:59,338 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:19:59,375 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:19:59,410 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:19:59,443 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:59,535 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:19:59,570 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:19:59,613 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:19:59,688 - DEBUG - Dynamic vertical threshold: 29.30130000000012, Overlap threshold: 0.7
2025-06-10 20:19:59,689 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:19:59,690 - DEBUG - Finished converting page batch time=3952.495
2025-06-10 20:19:59,756 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:20:00,038 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:20:00,041 - DEBUG - Snippet 10.3390_atmos11121365_709_item_1: generation shape=torch.Size([1, 414])
2025-06-10 20:20:00,042 - DEBUG - Snippet 10.3390_atmos11121365_709_item_1 raw docling: (tokens=68)
<formula><loc_0><loc_0><loc_500><loc_500>U n c e r t a i n t y = \sqrt { ( E F \times C o n c e r t r a t i o n ) ^ { 2 } + M D L ^ { 2 } }</formula><end_of_utterance>
2025-06-10 20:20:00,042 - DEBUG - Starting _parse_docling_output
2025-06-10 20:20:00,042 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>U n c e r t a i n t y = \sqrt { ( E F \times C o n c e r t r a t i o n ) ^ { 2 } + M D L ^ { 2 } }</formula><end_of_utterance>
2025-06-10 20:20:00,043 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:20:00,043 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>U n c e r t a i n t y = \\sqrt { ( E F \\times C o n c e r t r a t i o n ) ^ { 2 } + M D L ^ { 2 } }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=967x90 at 0x7F96DA2284D0>)]
2025-06-10 20:20:00,043 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:20:00,047 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=967.0, b=90.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 98))], orig='U n c e r t a i n t y = \\sqrt { ( E F \\times C o n c e r t r a t i o n ) ^ { 2 } + M D L ^ { 2 } }', text='U n c e r t a i n t y = \\sqrt { ( E F \\times C o n c e r t r a t i o n ) ^ { 2 } + M D L ^ { 2 } }', formatting=None, hyperlink=None)]
2025-06-10 20:20:00,047 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:20:00,047 - DEBUG - Processing text item: label=formula, text=U n c e r t a i n t y = \sqrt { ( E F \times C o n c e r t r a t i o n ) ^ { 2 } + M D L ^ { 2 } }
2025-06-10 20:20:00,047 - DEBUG - Recognized string extracted: U n c e r t a i n t y = \sqrt { ( E F \times C o n c e r t r a t i o n ) ^ { 2 } + M D L ^ { 2 } }
2025-06-10 20:20:00,048 - DEBUG - Generating chat message for label: formula
2025-06-10 20:20:00,048 - DEBUG - Snippet 10.3390_atmos11121365_709_item_2 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:20:00,067 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:00,096 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:00,097 - DEBUG - Finished converting page batch time=3952.902
2025-06-10 20:20:00,118 - DEBUG - Snippet 10.3390_atmos11121365_709_item_2 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:20:00,344 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:20:00,344 - INFO - Processing document 10.1038_s41467-024-55450-0_721.pdf
2025-06-10 20:20:00,432 - DEBUG - [Page 22] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:00,761 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:00,891 - DEBUG - [Page 23] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:00,893 - DEBUG - Finished converting page batch time=3953.698
2025-06-10 20:20:00,992 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:01,100 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:01,315 - DEBUG - Snippet 10.3390_atmos11121365_709_item_2: generation shape=torch.Size([1, 387])
2025-06-10 20:20:01,315 - DEBUG - Snippet 10.3390_atmos11121365_709_item_2 raw docling: (tokens=41)
<formula><loc_0><loc_0><loc_500><loc_500>U n c e r t a i n t y = 0 . 5 \times M D L</formula><end_of_utterance>
2025-06-10 20:20:01,316 - DEBUG - Starting _parse_docling_output
2025-06-10 20:20:01,316 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>U n c e r t a i n t y = 0 . 5 \times M D L</formula><end_of_utterance>
2025-06-10 20:20:01,316 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:20:01,316 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>U n c e r t a i n t y = 0 . 5 \\times M D L</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=816x56 at 0x7F96DA22AD80>)]
2025-06-10 20:20:01,317 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:20:01,319 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=816.0, b=56.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 42))], orig='U n c e r t a i n t y = 0 . 5 \\times M D L', text='U n c e r t a i n t y = 0 . 5 \\times M D L', formatting=None, hyperlink=None)]
2025-06-10 20:20:01,319 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:20:01,319 - DEBUG - Processing text item: label=formula, text=U n c e r t a i n t y = 0 . 5 \times M D L
2025-06-10 20:20:01,319 - DEBUG - Recognized string extracted: U n c e r t a i n t y = 0 . 5 \times M D L
2025-06-10 20:20:01,319 - DEBUG - Generating chat message for label: formula
2025-06-10 20:20:01,320 - DEBUG - Snippet 10.3390_atmos11121365_709_item_3 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:20:01,381 - DEBUG - Snippet 10.3390_atmos11121365_709_item_3 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:20:01,469 - DEBUG - [Page 24] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:01,506 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:01,747 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:02,022 - DEBUG - [Page 25] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:02,436 - DEBUG - Snippet 10.3390_atmos11121365_709_item_3: generation shape=torch.Size([1, 379])
2025-06-10 20:20:02,438 - DEBUG - Snippet 10.3390_atmos11121365_709_item_3 raw docling: (tokens=33)
<formula><loc_0><loc_0><loc_500><loc_500>O F P = [ V O C ] \times M I R</formula><end_of_utterance>
2025-06-10 20:20:02,438 - DEBUG - Starting _parse_docling_output
2025-06-10 20:20:02,438 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>O F P = [ V O C ] \times M I R</formula><end_of_utterance>
2025-06-10 20:20:02,438 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:20:02,439 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>O F P = [ V O C ] \\times M I R</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=786x59 at 0x7F96DA22B110>)]
2025-06-10 20:20:02,439 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:20:02,440 - INFO - Extraction successful row 122, tokens=159013
2025-06-10 20:20:02,441 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=786.0, b=59.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 30))], orig='O F P = [ V O C ] \\times M I R', text='O F P = [ V O C ] \\times M I R', formatting=None, hyperlink=None)]
2025-06-10 20:20:02,441 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:20:02,441 - DEBUG - Processing text item: label=formula, text=O F P = [ V O C ] \times M I R
2025-06-10 20:20:02,442 - DEBUG - Recognized string extracted: O F P = [ V O C ] \times M I R
2025-06-10 20:20:02,442 - DEBUG - Generating chat message for label: formula
2025-06-10 20:20:02,442 - DEBUG - Snippet 10.3390_atmos11121365_709_item_4 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:20:02,464 - INFO - Going to convert document batch...
2025-06-10 20:20:02,464 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:20:02,464 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:20:02,514 - DEBUG - Snippet 10.3390_atmos11121365_709_item_4 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:20:02,515 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:20:02,583 - DEBUG - [Page 26] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:02,624 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:02,678 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:02,940 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:03,161 - DEBUG - [Page 27] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:03,162 - DEBUG - Finished converting page batch time=3955.967
2025-06-10 20:20:03,289 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:03,310 - DEBUG - [Page 28] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:03,311 - DEBUG - Finished converting page batch time=3956.116
2025-06-10 20:20:03,386 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:20:03,437 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:20:03,443 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:20:03,482 - DEBUG - Finished converting page batch time=3956.287
2025-06-10 20:20:03,483 - DEBUG - Snippet 10.3390_atmos11121365_709_item_4: generation shape=torch.Size([1, 375])
2025-06-10 20:20:03,484 - DEBUG - Snippet 10.3390_atmos11121365_709_item_4 raw docling: (tokens=29)
<formula><loc_0><loc_0><loc_500><loc_500>C R = C D I \times S F</formula><end_of_utterance>
2025-06-10 20:20:03,484 - DEBUG - Starting _parse_docling_output
2025-06-10 20:20:03,484 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>C R = C D I \times S F</formula><end_of_utterance>
2025-06-10 20:20:03,484 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:20:03,485 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>C R = C D I \\times S F</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=749x56 at 0x7F96DA229880>)]
2025-06-10 20:20:03,485 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:20:03,487 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=749.0, b=56.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 22))], orig='C R = C D I \\times S F', text='C R = C D I \\times S F', formatting=None, hyperlink=None)]
2025-06-10 20:20:03,487 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:20:03,487 - DEBUG - Processing text item: label=formula, text=C R = C D I \times S F
2025-06-10 20:20:03,487 - DEBUG - Recognized string extracted: C R = C D I \times S F
2025-06-10 20:20:03,488 - INFO - All done. Returning 5 recognized text results.
2025-06-10 20:20:03,488 - DEBUG - Snippet 10.3390_atmos11121365_709_item_0 recognized text:
x _ { i j } = \sum _ { k = 1 } ^ { p } g _ { i k } f _ { k i } + e _ { i j }
2025-06-10 20:20:03,488 - DEBUG - Snippet 10.3390_atmos11121365_709_item_1 recognized text:
U n c e r t a i n t y = \sqrt { ( E F \times C o n c e r t r a t i o n ) ^ { 2 } + M D L ^ { 2 } }
2025-06-10 20:20:03,489 - DEBUG - Snippet 10.3390_atmos11121365_709_item_2 recognized text:
U n c e r t a i n t y = 0 . 5 \times M D L
2025-06-10 20:20:03,489 - DEBUG - Snippet 10.3390_atmos11121365_709_item_3 recognized text:
O F P = [ V O C ] \times M I R
2025-06-10 20:20:03,489 - DEBUG - Snippet 10.3390_atmos11121365_709_item_4 recognized text:
C R = C D I \times S F
2025-06-10 20:20:03,526 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:03,527 - DEBUG - Finished converting page batch time=3956.332
2025-06-10 20:20:03,587 - DEBUG - Creating masked image for page 4 with 8 clusters.
2025-06-10 20:20:03,588 - INFO - Masked image successfully created for page 4.
2025-06-10 20:20:03,594 - INFO - Starting prediction for 3 images with labels: ['formula', 'formula', 'formula']
2025-06-10 20:20:03,594 - DEBUG - Generating chat message for label: formula
2025-06-10 20:20:03,594 - DEBUG - Snippet 10.3390_atmos11121365_709_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:20:03,670 - DEBUG - Snippet 10.3390_atmos11121365_709_item_0 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:20:03,906 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:04,122 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:20:04,122 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:20:04,122 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:20:04,132 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:04,158 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:20:04,196 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:20:04,234 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:20:04,271 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:20:04,307 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:20:04,315 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:04,316 - DEBUG - Finished converting page batch time=3957.121
2025-06-10 20:20:04,343 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:20:04,482 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:20:04,516 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:20:04,554 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:20:04,710 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:20:04,983 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:20:05,139 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:05,152 - DEBUG - Snippet 10.3390_atmos11121365_709_item_0: generation shape=torch.Size([1, 399])
2025-06-10 20:20:05,153 - DEBUG - Snippet 10.3390_atmos11121365_709_item_0 raw docling: (tokens=53)
<formula><loc_0><loc_0><loc_500><loc_500>C D I = C _ { i } \times I R \times E F \times E D / ( B W \times A L \times N Y )</formula><end_of_utterance>
2025-06-10 20:20:05,153 - DEBUG - Starting _parse_docling_output
2025-06-10 20:20:05,153 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>C D I = C _ { i } \times I R \times E F \times E D / ( B W \times A L \times N Y )</formula><end_of_utterance>
2025-06-10 20:20:05,154 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:20:05,154 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>C D I = C _ { i } \\times I R \\times E F \\times E D / ( B W \\times A L \\times N Y )</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=934x62 at 0x7F96DA228EF0>)]
2025-06-10 20:20:05,154 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:20:05,157 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=934.0, b=62.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 82))], orig='C D I = C _ { i } \\times I R \\times E F \\times E D / ( B W \\times A L \\times N Y )', text='C D I = C _ { i } \\times I R \\times E F \\times E D / ( B W \\times A L \\times N Y )', formatting=None, hyperlink=None)]
2025-06-10 20:20:05,157 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:20:05,157 - DEBUG - Processing text item: label=formula, text=C D I = C _ { i } \times I R \times E F \times E D / ( B W \times A L \times N Y )
2025-06-10 20:20:05,158 - DEBUG - Recognized string extracted: C D I = C _ { i } \times I R \times E F \times E D / ( B W \times A L \times N Y )
2025-06-10 20:20:05,158 - DEBUG - Generating chat message for label: formula
2025-06-10 20:20:05,158 - DEBUG - Snippet 10.3390_atmos11121365_709_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:20:05,222 - DEBUG - Snippet 10.3390_atmos11121365_709_item_1 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:20:05,262 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:20:05,263 - INFO - Processing document 10.1136_bmjopen-2016-013941_722.pdf
2025-06-10 20:20:05,471 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:05,698 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:05,821 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:05,859 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:05,948 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:05,961 - DEBUG - Snippet 10.1214_10-aoas351_689_item_0: generation shape=torch.Size([1, 586])
2025-06-10 20:20:05,962 - DEBUG - Snippet 10.1214_10-aoas351_689_item_0 raw docling: (tokens=240)
<formula><loc_0><loc_0><loc_500><loc_500>Y _ { 1 } ( s , t ) = \tilde { \beta } _ { 1 0 } ( s , t ) + \tilde { \beta } _ { 1 1 } ( s , t ) x _ { 1 } ( B , t ) + \tilde { \beta } _ { 1 2 } ( s , t ) x _ { 2 } ( B , t ) + \varepsilon _ { 1 } ( s , t ) , \\ Y _ { 2 } ( s , t ) = \tilde { \beta } _ { 2 0 } ( s , t ) + \tilde { \beta } _ { 2 1 } ( s , t ) x _ { 1 } ( B , t ) + \tilde { \beta } _ { 2 2 } ( s , t ) x _ { 2 } ( B , t ) + \varepsilon _ { 2 } ( s , t ) ,</formula><end_of_utterance>
2025-06-10 20:20:05,962 - DEBUG - Starting _parse_docling_output
2025-06-10 20:20:05,963 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>Y _ { 1 } ( s , t ) = \tilde { \beta } _ { 1 0 } ( s , t ) + \tilde { \beta } _ { 1 1 } ( s , t ) x _ { 1 } ( B , t ) + \tilde { \beta } _ { 1 2 } ( s , t ) x _ { 2 } ( B , t ) + \varepsilon _ { 1 } ( s , t ) , \\ Y _ { 2 } ( s , t ) = \tilde { \beta } _ { 2 0 } ( s , t ) + \tilde { \beta } _ { 2 1 } ( s , t ) x _ { 1 } ( B , t ) + \tilde { \beta } _ { 2 2 } ( s , t ) x _ { 2 } ( B , t ) + \varepsilon _ { 2 } ( s , t ) ,</formula><end_of_utterance>
2025-06-10 20:20:05,963 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:20:05,963 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>Y _ { 1 } ( s , t ) = \\tilde { \\beta } _ { 1 0 } ( s , t ) + \\tilde { \\beta } _ { 1 1 } ( s , t ) x _ { 1 } ( B , t ) + \\tilde { \\beta } _ { 1 2 } ( s , t ) x _ { 2 } ( B , t ) + \\varepsilon _ { 1 } ( s , t ) , \\\\ Y _ { 2 } ( s , t ) = \\tilde { \\beta } _ { 2 0 } ( s , t ) + \\tilde { \\beta } _ { 2 1 } ( s , t ) x _ { 1 } ( B , t ) + \\tilde { \\beta } _ { 2 2 } ( s , t ) x _ { 2 } ( B , t ) + \\varepsilon _ { 2 } ( s , t ) ,</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=983x210 at 0x7F96B298BCB0>)]
2025-06-10 20:20:05,964 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:20:05,971 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=983.0, b=210.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 424))], orig='Y _ { 1 } ( s , t ) = \\tilde { \\beta } _ { 1 0 } ( s , t ) + \\tilde { \\beta } _ { 1 1 } ( s , t ) x _ { 1 } ( B , t ) + \\tilde { \\beta } _ { 1 2 } ( s , t ) x _ { 2 } ( B , t ) + \\varepsilon _ { 1 } ( s , t ) , \\\\ Y _ { 2 } ( s , t ) = \\tilde { \\beta } _ { 2 0 } ( s , t ) + \\tilde { \\beta } _ { 2 1 } ( s , t ) x _ { 1 } ( B , t ) + \\tilde { \\beta } _ { 2 2 } ( s , t ) x _ { 2 } ( B , t ) + \\varepsilon _ { 2 } ( s , t ) ,', text='Y _ { 1 } ( s , t ) = \\tilde { \\beta } _ { 1 0 } ( s , t ) + \\tilde { \\beta } _ { 1 1 } ( s , t ) x _ { 1 } ( B , t ) + \\tilde { \\beta } _ { 1 2 } ( s , t ) x _ { 2 } ( B , t ) + \\varepsilon _ { 1 } ( s , t ) , \\\\ Y _ { 2 } ( s , t ) = \\tilde { \\beta } _ { 2 0 } ( s , t ) + \\tilde { \\beta } _ { 2 1 } ( s , t ) x _ { 1 } ( B , t ) + \\tilde { \\beta } _ { 2 2 } ( s , t ) x _ { 2 } ( B , t ) + \\varepsilon _ { 2 } ( s , t ) ,', formatting=None, hyperlink=None)]
2025-06-10 20:20:05,971 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:20:05,971 - DEBUG - Processing text item: label=formula, text=Y _ { 1 } ( s , t ) = \tilde { \beta } _ { 1 0 } ( s , t ) + \tilde { \beta } _ { 1 1 } ( s , t ) x _ { 1 } ( B , t ) + \tilde { \beta } _ { 1 2 } ( s , t ) x _ { 2 } ( B , t ) + \varepsilon _ { 1 } ( s , t ) , \\ Y _ { 2 } ( s , t ) = \tilde { \beta } _ { 2 0 } ( s , t ) + \tilde { \beta } _ { 2 1 } ( s , t ) x _ { 1 } ( B , t ) + \tilde { \beta } _ { 2 2 } ( s , t ) x _ { 2 } ( B , t ) + \varepsilon _ { 2 } ( s , t ) ,
2025-06-10 20:20:05,972 - DEBUG - Recognized string extracted: Y _ { 1 } ( s , t ) = \tilde { \beta } _ { 1 0 } ( s , t ) + \tilde { \beta } _ { 1 1 } ( s , t ) x _ { 1 } ( B , t ) + \tilde { \beta } _ { 1 2 } ( s , t ) x _ { 2 } ( B , t ) + \varepsilon _ { 1 } ( s , t ) , \\ Y _ { 2 } ( s , t ) = \tilde { \beta } _ { 2 0 } ( s , t ) + \tilde { \beta } _ { 2 1 } ( s , t ) x _ { 1 } ( B , t ) + \tilde { \beta } _ { 2 2 } ( s , t ) x _ { 2 } ( B , t ) + \varepsilon _ { 2 } ( s , t ) ,
2025-06-10 20:20:05,972 - DEBUG - Generating chat message for label: formula
2025-06-10 20:20:05,972 - DEBUG - Snippet 10.1214_10-aoas351_689_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:20:06,040 - DEBUG - Snippet 10.1214_10-aoas351_689_item_1 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:20:06,044 - DEBUG - Snippet 10.3390_atmos11121365_709_item_1: generation shape=torch.Size([1, 375])
2025-06-10 20:20:06,045 - DEBUG - Snippet 10.3390_atmos11121365_709_item_1 raw docling: (tokens=29)
<formula><loc_0><loc_0><loc_500><loc_500>H Q = A D I / R f d</formula><end_of_utterance>
2025-06-10 20:20:06,045 - DEBUG - Starting _parse_docling_output
2025-06-10 20:20:06,045 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>H Q = A D I / R f d</formula><end_of_utterance>
2025-06-10 20:20:06,046 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:20:06,046 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>H Q = A D I / R f d</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=749x56 at 0x7F96DA229AC0>)]
2025-06-10 20:20:06,046 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:20:06,048 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=749.0, b=56.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 19))], orig='H Q = A D I / R f d', text='H Q = A D I / R f d', formatting=None, hyperlink=None)]
2025-06-10 20:20:06,048 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:20:06,049 - DEBUG - Processing text item: label=formula, text=H Q = A D I / R f d
2025-06-10 20:20:06,049 - DEBUG - Recognized string extracted: H Q = A D I / R f d
2025-06-10 20:20:06,049 - DEBUG - Generating chat message for label: formula
2025-06-10 20:20:06,049 - DEBUG - Snippet 10.3390_atmos11121365_709_item_2 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:20:06,080 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:06,114 - DEBUG - Snippet 10.3390_atmos11121365_709_item_2 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:20:06,474 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:06,479 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:06,480 - DEBUG - Finished converting page batch time=3959.285
2025-06-10 20:20:06,800 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:06,906 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:06,907 - DEBUG - Finished converting page batch time=3959.712
2025-06-10 20:20:07,060 - DEBUG - Creating masked image for page 3 with 20 clusters.
2025-06-10 20:20:07,061 - INFO - Masked image successfully created for page 3.
2025-06-10 20:20:07,069 - INFO - Starting prediction for 2 images with labels: ['formula', 'formula']
2025-06-10 20:20:07,069 - DEBUG - Generating chat message for label: formula
2025-06-10 20:20:07,070 - DEBUG - Snippet 10.5620_eaht.2023016_718_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:20:07,137 - DEBUG - Snippet 10.5620_eaht.2023016_718_item_0 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:20:07,265 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:07,282 - DEBUG - Creating masked image for page 4 with 11 clusters.
2025-06-10 20:20:07,284 - INFO - Masked image successfully created for page 4.
2025-06-10 20:20:07,402 - DEBUG - Creating masked image for page 6 with 15 clusters.
2025-06-10 20:20:07,403 - INFO - Masked image successfully created for page 6.
2025-06-10 20:20:07,521 - DEBUG - Creating masked image for page 7 with 19 clusters.
2025-06-10 20:20:07,522 - INFO - Masked image successfully created for page 7.
2025-06-10 20:20:07,530 - INFO - Starting prediction for 5 images with labels: ['formula', 'formula', 'formula', 'formula', 'formula']
2025-06-10 20:20:07,531 - DEBUG - Generating chat message for label: formula
2025-06-10 20:20:07,531 - DEBUG - Snippet 10.3390_atmos8030061_703_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:20:07,606 - DEBUG - Snippet 10.3390_atmos8030061_703_item_0 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:20:07,683 - DEBUG - Snippet 10.3390_atmos11121365_709_item_2: generation shape=torch.Size([1, 400])
2025-06-10 20:20:07,684 - DEBUG - Snippet 10.3390_atmos11121365_709_item_2 raw docling: (tokens=54)
<formula><loc_0><loc_0><loc_500><loc_500>A D I = ( C _ { i } \times \mathbb { R } \times \mathbb { E } ) / \mathbb { B } W</formula><end_of_utterance>
2025-06-10 20:20:07,684 - DEBUG - Starting _parse_docling_output
2025-06-10 20:20:07,685 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>A D I = ( C _ { i } \times \mathbb { R } \times \mathbb { E } ) / \mathbb { B } W</formula><end_of_utterance>
2025-06-10 20:20:07,685 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:20:07,685 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>A D I = ( C _ { i } \\times \\mathbb { R } \\times \\mathbb { E } ) / \\mathbb { B } W</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=815x62 at 0x7F96D7ACC650>)]
2025-06-10 20:20:07,685 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:20:07,687 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=815.0, b=62.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 81))], orig='A D I = ( C _ { i } \\times \\mathbb { R } \\times \\mathbb { E } ) / \\mathbb { B } W', text='A D I = ( C _ { i } \\times \\mathbb { R } \\times \\mathbb { E } ) / \\mathbb { B } W', formatting=None, hyperlink=None)]
2025-06-10 20:20:07,688 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:20:07,688 - DEBUG - Processing text item: label=formula, text=A D I = ( C _ { i } \times \mathbb { R } \times \mathbb { E } ) / \mathbb { B } W
2025-06-10 20:20:07,688 - DEBUG - Recognized string extracted: A D I = ( C _ { i } \times \mathbb { R } \times \mathbb { E } ) / \mathbb { B } W
2025-06-10 20:20:07,688 - INFO - All done. Returning 3 recognized text results.
2025-06-10 20:20:07,689 - DEBUG - Snippet 10.3390_atmos11121365_709_item_0 recognized text:
C D I = C _ { i } \times I R \times E F \times E D / ( B W \times A L \times N Y )
2025-06-10 20:20:07,689 - DEBUG - Snippet 10.3390_atmos11121365_709_item_1 recognized text:
H Q = A D I / R f d
2025-06-10 20:20:07,689 - DEBUG - Snippet 10.3390_atmos11121365_709_item_2 recognized text:
A D I = ( C _ { i } \times \mathbb { R } \times \mathbb { E } ) / \mathbb { B } W
2025-06-10 20:20:07,723 - DEBUG - Dynamic vertical threshold: 36.504900000000085, Overlap threshold: 0.7
2025-06-10 20:20:07,724 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:07,734 - DEBUG - Snippet 10.1214_10-aoas351_689_item_1: generation shape=torch.Size([1, 400])
2025-06-10 20:20:07,735 - DEBUG - Snippet 10.1214_10-aoas351_689_item_1 raw docling: (tokens=54)
<formula><loc_0><loc_0><loc_500><loc_500>\beta _ { i j } ( s , t ) = \beta _ { i j , t } + \beta _ { i j } ( s , t ) ,</formula><end_of_utterance>
2025-06-10 20:20:07,735 - DEBUG - Starting _parse_docling_output
2025-06-10 20:20:07,735 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>\beta _ { i j } ( s , t ) = \beta _ { i j , t } + \beta _ { i j } ( s , t ) ,</formula><end_of_utterance>
2025-06-10 20:20:07,736 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:20:07,736 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>\\beta _ { i j } ( s , t ) = \\beta _ { i j , t } + \\beta _ { i j } ( s , t ) ,</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=701x113 at 0x7F96B298A150>)]
2025-06-10 20:20:07,736 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:20:07,739 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=701.0, b=113.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 77))], orig='\\beta _ { i j } ( s , t ) = \\beta _ { i j , t } + \\beta _ { i j } ( s , t ) ,', text='\\beta _ { i j } ( s , t ) = \\beta _ { i j , t } + \\beta _ { i j } ( s , t ) ,', formatting=None, hyperlink=None)]
2025-06-10 20:20:07,739 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:20:07,740 - DEBUG - Processing text item: label=formula, text=\beta _ { i j } ( s , t ) = \beta _ { i j , t } + \beta _ { i j } ( s , t ) ,
2025-06-10 20:20:07,740 - DEBUG - Recognized string extracted: \beta _ { i j } ( s , t ) = \beta _ { i j , t } + \beta _ { i j } ( s , t ) ,
2025-06-10 20:20:07,740 - DEBUG - Generating chat message for label: formula
2025-06-10 20:20:07,740 - DEBUG - Snippet 10.1214_10-aoas351_689_item_2 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:20:07,788 - INFO - Finished converting document 10.3390_atmos11121365_709.pdf in 32.46 sec.
2025-06-10 20:20:07,804 - DEBUG - Snippet 10.1214_10-aoas351_689_item_2 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:20:07,887 - DEBUG - Finished converting page batch time=3960.693
2025-06-10 20:20:07,948 - INFO - Extraction successful row 138, tokens=22784
2025-06-10 20:20:07,976 - INFO - Going to convert document batch...
2025-06-10 20:20:07,976 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:20:07,977 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:20:08,041 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:20:08,134 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:08,135 - DEBUG - Finished converting page batch time=3960.940
2025-06-10 20:20:08,185 - DEBUG - Dynamic vertical threshold: 36.503999999999955, Overlap threshold: 0.7
2025-06-10 20:20:08,185 - DEBUG - Checking merge:
  Current: 18, Next: 12
2025-06-10 20:20:08,186 - DEBUG -   Vertical gap: 2.9640000000000555, Overlap ratio: 1.0
2025-06-10 20:20:08,186 - DEBUG -   Left boundary diff: 14.343000000000018, Right boundary diff: 0.0009999999999763531
2025-06-10 20:20:08,186 - DEBUG -   Alignment factor (ratio): 0.06915421926077363
2025-06-10 20:20:08,187 - DEBUG -   -> c1 18 formula number: None, c2 12 formula number: None
2025-06-10 20:20:08,187 - DEBUG -   -> Merging clusters 18 and 12 with vertical gap 2.9640000000000555 and overlap ratio 1.0
2025-06-10 20:20:08,187 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:08,270 - DEBUG - Snippet 10.5620_eaht.2023016_718_item_0: generation shape=torch.Size([1, 381])
2025-06-10 20:20:08,271 - DEBUG - Snippet 10.5620_eaht.2023016_718_item_0 raw docling: (tokens=35)
<formula><loc_0><loc_0><loc_500><loc_500>H Q = \frac { L A D D } { R f D }</formula><end_of_utterance>
2025-06-10 20:20:08,274 - DEBUG - Starting _parse_docling_output
2025-06-10 20:20:08,275 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>H Q = \frac { L A D D } { R f D }</formula><end_of_utterance>
2025-06-10 20:20:08,275 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:20:08,275 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>H Q = \\frac { L A D D } { R f D }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=1378x85 at 0x7F96BC48A3C0>)]
2025-06-10 20:20:08,276 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:20:08,279 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=1378.0, b=85.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 33))], orig='H Q = \\frac { L A D D } { R f D }', text='H Q = \\frac { L A D D } { R f D }', formatting=None, hyperlink=None)]
2025-06-10 20:20:08,279 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:20:08,279 - DEBUG - Processing text item: label=formula, text=H Q = \frac { L A D D } { R f D }
2025-06-10 20:20:08,280 - DEBUG - Recognized string extracted: H Q = \frac { L A D D } { R f D }
2025-06-10 20:20:08,280 - DEBUG - Generating chat message for label: formula
2025-06-10 20:20:08,280 - DEBUG - Snippet 10.5620_eaht.2023016_718_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:20:08,344 - DEBUG - Snippet 10.5620_eaht.2023016_718_item_1 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:20:08,523 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:08,893 - DEBUG - Finished converting page batch time=3961.698
2025-06-10 20:20:08,907 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:20:08,963 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:20:08,969 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:20:09,134 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:09,353 - DEBUG - Snippet 10.3390_atmos8030061_703_item_0: generation shape=torch.Size([1, 397])
2025-06-10 20:20:09,354 - DEBUG - Snippet 10.3390_atmos8030061_703_item_0 raw docling: (tokens=51)
<formula><loc_0><loc_0><loc_500><loc_500>O F P = M I R \times \rho \left ( C _ { 2 } - C _ { 1 2 } \right )</formula><end_of_utterance>
2025-06-10 20:20:09,354 - DEBUG - Starting _parse_docling_output
2025-06-10 20:20:09,354 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>O F P = M I R \times \rho \left ( C _ { 2 } - C _ { 1 2 } \right )</formula><end_of_utterance>
2025-06-10 20:20:09,354 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:20:09,355 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>O F P = M I R \\times \\rho \\left ( C _ { 2 } - C _ { 1 2 } \\right )</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=809x55 at 0x7F9698CEF410>)]
2025-06-10 20:20:09,355 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:20:09,357 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=809.0, b=55.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 66))], orig='O F P = M I R \\times \\rho \\left ( C _ { 2 } - C _ { 1 2 } \\right )', text='O F P = M I R \\times \\rho \\left ( C _ { 2 } - C _ { 1 2 } \\right )', formatting=None, hyperlink=None)]
2025-06-10 20:20:09,358 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:20:09,358 - DEBUG - Processing text item: label=formula, text=O F P = M I R \times \rho \left ( C _ { 2 } - C _ { 1 2 } \right )
2025-06-10 20:20:09,358 - DEBUG - Recognized string extracted: O F P = M I R \times \rho \left ( C _ { 2 } - C _ { 1 2 } \right )
2025-06-10 20:20:09,358 - DEBUG - Generating chat message for label: formula
2025-06-10 20:20:09,359 - DEBUG - Snippet 10.3390_atmos8030061_703_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:20:09,425 - DEBUG - Snippet 10.3390_atmos8030061_703_item_1 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:20:09,426 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:09,661 - DEBUG - Snippet 10.5620_eaht.2023016_718_item_1: generation shape=torch.Size([1, 387])
2025-06-10 20:20:09,662 - DEBUG - Snippet 10.5620_eaht.2023016_718_item_1 raw docling: (tokens=41)
<formula><loc_0><loc_0><loc_500><loc_500>O F P _ { i } = M I R _ { i } \times C _ { i }</formula><end_of_utterance>
2025-06-10 20:20:09,662 - DEBUG - Starting _parse_docling_output
2025-06-10 20:20:09,663 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>O F P _ { i } = M I R _ { i } \times C _ { i }</formula><end_of_utterance>
2025-06-10 20:20:09,663 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:20:09,663 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>O F P _ { i } = M I R _ { i } \\times C _ { i }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=1378x59 at 0x7F96DB84CD70>)]
2025-06-10 20:20:09,663 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:20:09,666 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=1378.0, b=59.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 46))], orig='O F P _ { i } = M I R _ { i } \\times C _ { i }', text='O F P _ { i } = M I R _ { i } \\times C _ { i }', formatting=None, hyperlink=None)]
2025-06-10 20:20:09,666 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:20:09,666 - DEBUG - Processing text item: label=formula, text=O F P _ { i } = M I R _ { i } \times C _ { i }
2025-06-10 20:20:09,666 - DEBUG - Recognized string extracted: O F P _ { i } = M I R _ { i } \times C _ { i }
2025-06-10 20:20:09,666 - INFO - All done. Returning 2 recognized text results.
2025-06-10 20:20:09,667 - DEBUG - Snippet 10.5620_eaht.2023016_718_item_0 recognized text:
H Q = \frac { L A D D } { R f D }
2025-06-10 20:20:09,667 - DEBUG - Snippet 10.5620_eaht.2023016_718_item_1 recognized text:
O F P _ { i } = M I R _ { i } \times C _ { i }
2025-06-10 20:20:09,677 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:20:09,678 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:20:09,678 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:20:09,713 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:20:09,755 - INFO - Finished converting document 10.5620_eaht.2023016_718.pdf in 16.02 sec.
2025-06-10 20:20:09,762 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:20:09,815 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:20:09,855 - INFO - Extraction successful row 141, tokens=13856
2025-06-10 20:20:09,860 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:20:09,901 - INFO - Going to convert document batch...
2025-06-10 20:20:09,901 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:20:09,902 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:20:09,966 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:09,967 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:20:10,035 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:20:10,088 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:20:10,211 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:20:10,256 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:20:10,297 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:20:10,462 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:20:10,614 - DEBUG - Snippet 10.3390_atmos8030061_703_item_1: generation shape=torch.Size([1, 385])
2025-06-10 20:20:10,615 - DEBUG - Snippet 10.3390_atmos8030061_703_item_1 raw docling: (tokens=39)
<formula><loc_0><loc_0><loc_500><loc_500>S O A F P = V O C s _ { 0 } \times F A C</formula><end_of_utterance>
2025-06-10 20:20:10,615 - DEBUG - Starting _parse_docling_output
2025-06-10 20:20:10,615 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>S O A F P = V O C s _ { 0 } \times F A C</formula><end_of_utterance>
2025-06-10 20:20:10,615 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:20:10,616 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>S O A F P = V O C s _ { 0 } \\times F A C</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=808x62 at 0x7F9698CEE8A0>)]
2025-06-10 20:20:10,616 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:20:10,618 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=808.0, b=62.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 40))], orig='S O A F P = V O C s _ { 0 } \\times F A C', text='S O A F P = V O C s _ { 0 } \\times F A C', formatting=None, hyperlink=None)]
2025-06-10 20:20:10,618 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:20:10,619 - DEBUG - Processing text item: label=formula, text=S O A F P = V O C s _ { 0 } \times F A C
2025-06-10 20:20:10,619 - DEBUG - Recognized string extracted: S O A F P = V O C s _ { 0 } \times F A C
2025-06-10 20:20:10,619 - DEBUG - Generating chat message for label: formula
2025-06-10 20:20:10,620 - DEBUG - Snippet 10.3390_atmos8030061_703_item_2 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:20:10,684 - DEBUG - Snippet 10.3390_atmos8030061_703_item_2 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:20:10,687 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:20:10,705 - DEBUG - [Page 14] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:10,736 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:20:10,742 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:20:10,750 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:20:10,966 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:10,991 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:20:10,999 - INFO - Processing document 10.1007_s10584-013-0847-8_723.pdf
2025-06-10 20:20:11,282 - DEBUG - [Page 15] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:11,283 - DEBUG - Finished converting page batch time=3964.088
2025-06-10 20:20:11,328 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:11,413 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:20:11,414 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:20:11,414 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:20:11,448 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:20:11,486 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:20:11,522 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:20:11,562 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:20:11,607 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:20:11,737 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:20:11,799 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:11,870 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:20:11,902 - DEBUG - [Page 16] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:11,908 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:20:11,949 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:20:12,103 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:20:12,117 - DEBUG - Snippet 10.1214_10-aoas351_689_item_2: generation shape=torch.Size([1, 471])
2025-06-10 20:20:12,118 - DEBUG - Snippet 10.1214_10-aoas351_689_item_2 raw docling: (tokens=125)
<formula><loc_0><loc_0><loc_500><loc_500>\beta _ { i j , t } = \rho _ { i j } \beta _ { i j , t - 1 } + \eta _ { i j , t } , \quad \eta _ { i j , t } \stackrel { i n d } { \sim } N ( 0 , \xi _ { i j } ^ { 2 } ) , \quad \quad i = 1 , 2 ; \, j = 0 , 1 , 2 ,</formula><end_of_utterance>
2025-06-10 20:20:12,119 - DEBUG - Starting _parse_docling_output
2025-06-10 20:20:12,119 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>\beta _ { i j , t } = \rho _ { i j } \beta _ { i j , t - 1 } + \eta _ { i j , t } , \quad \eta _ { i j , t } \stackrel { i n d } { \sim } N ( 0 , \xi _ { i j } ^ { 2 } ) , \quad \quad i = 1 , 2 ; \, j = 0 , 1 , 2 ,</formula><end_of_utterance>
2025-06-10 20:20:12,119 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:20:12,119 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>\\beta _ { i j , t } = \\rho _ { i j } \\beta _ { i j , t - 1 } + \\eta _ { i j , t } , \\quad \\eta _ { i j , t } \\stackrel { i n d } { \\sim } N ( 0 , \\xi _ { i j } ^ { 2 } ) , \\quad \\quad i = 1 , 2 ; \\, j = 0 , 1 , 2 ,</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=1034x81 at 0x7F96B296FEF0>)]
2025-06-10 20:20:12,120 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:20:12,123 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=1034.0, b=81.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 214))], orig='\\beta _ { i j , t } = \\rho _ { i j } \\beta _ { i j , t - 1 } + \\eta _ { i j , t } , \\quad \\eta _ { i j , t } \\stackrel { i n d } { \\sim } N ( 0 , \\xi _ { i j } ^ { 2 } ) , \\quad \\quad i = 1 , 2 ; \\, j = 0 , 1 , 2 ,', text='\\beta _ { i j , t } = \\rho _ { i j } \\beta _ { i j , t - 1 } + \\eta _ { i j , t } , \\quad \\eta _ { i j , t } \\stackrel { i n d } { \\sim } N ( 0 , \\xi _ { i j } ^ { 2 } ) , \\quad \\quad i = 1 , 2 ; \\, j = 0 , 1 , 2 ,', formatting=None, hyperlink=None)]
2025-06-10 20:20:12,124 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:20:12,124 - DEBUG - Processing text item: label=formula, text=\beta _ { i j , t } = \rho _ { i j } \beta _ { i j , t - 1 } + \eta _ { i j , t } , \quad \eta _ { i j , t } \stackrel { i n d } { \sim } N ( 0 , \xi _ { i j } ^ { 2 } ) , \quad \quad i = 1 , 2 ; \, j = 0 , 1 , 2 ,
2025-06-10 20:20:12,124 - DEBUG - Recognized string extracted: \beta _ { i j , t } = \rho _ { i j } \beta _ { i j , t - 1 } + \eta _ { i j , t } , \quad \eta _ { i j , t } \stackrel { i n d } { \sim } N ( 0 , \xi _ { i j } ^ { 2 } ) , \quad \quad i = 1 , 2 ; \, j = 0 , 1 , 2 ,
2025-06-10 20:20:12,124 - DEBUG - Generating chat message for label: formula
2025-06-10 20:20:12,125 - DEBUG - Snippet 10.1214_10-aoas351_689_item_3 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:20:12,157 - DEBUG - Snippet 10.3390_atmos8030061_703_item_2: generation shape=torch.Size([1, 395])
2025-06-10 20:20:12,158 - DEBUG - Snippet 10.3390_atmos8030061_703_item_2 raw docling: (tokens=49)
<formula><loc_0><loc_0><loc_500><loc_500>V O C s _ { t } = V O C s _ { 0 } \times ( 1 - F V O C r )</formula><end_of_utterance>
2025-06-10 20:20:12,158 - DEBUG - Starting _parse_docling_output
2025-06-10 20:20:12,158 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>V O C s _ { t } = V O C s _ { 0 } \times ( 1 - F V O C r )</formula><end_of_utterance>
2025-06-10 20:20:12,159 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:20:12,159 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>V O C s _ { t } = V O C s _ { 0 } \\times ( 1 - F V O C r )</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=858x61 at 0x7F9698CED610>)]
2025-06-10 20:20:12,159 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:20:12,162 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=858.0, b=61.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 58))], orig='V O C s _ { t } = V O C s _ { 0 } \\times ( 1 - F V O C r )', text='V O C s _ { t } = V O C s _ { 0 } \\times ( 1 - F V O C r )', formatting=None, hyperlink=None)]
2025-06-10 20:20:12,162 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:20:12,162 - DEBUG - Processing text item: label=formula, text=V O C s _ { t } = V O C s _ { 0 } \times ( 1 - F V O C r )
2025-06-10 20:20:12,163 - DEBUG - Recognized string extracted: V O C s _ { t } = V O C s _ { 0 } \times ( 1 - F V O C r )
2025-06-10 20:20:12,163 - DEBUG - Generating chat message for label: formula
2025-06-10 20:20:12,163 - DEBUG - Snippet 10.3390_atmos8030061_703_item_3 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:20:12,198 - DEBUG - Snippet 10.1214_10-aoas351_689_item_3 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:20:12,230 - DEBUG - Snippet 10.3390_atmos8030061_703_item_3 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:20:12,426 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:20:12,497 - DEBUG - [Page 17] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:12,620 - DEBUG - [Page 18] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:12,621 - DEBUG - Finished converting page batch time=3965.426
2025-06-10 20:20:12,642 - DEBUG - Dynamic vertical threshold: 30.135600000000036, Overlap threshold: 0.7
2025-06-10 20:20:12,642 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:12,650 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:20:12,650 - INFO - Processing document 10.3390_catal11080998_724.pdf
2025-06-10 20:20:12,747 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:12,847 - INFO - Finished converting document 10.3390_atmos11121271_719.pdf in 18.04 sec.
2025-06-10 20:20:13,006 - INFO - Extraction successful row 142, tokens=22300
2025-06-10 20:20:13,037 - INFO - Going to convert document batch...
2025-06-10 20:20:13,037 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:20:13,037 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:20:13,105 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:20:13,253 - DEBUG - Dynamic vertical threshold: 40.926599999999944, Overlap threshold: 0.7
2025-06-10 20:20:13,253 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:13,254 - DEBUG - Finished converting page batch time=3966.059
2025-06-10 20:20:13,342 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:13,361 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:13,984 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:20:13,994 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:14,038 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:20:14,045 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:20:14,060 - DEBUG - Dynamic vertical threshold: 49.40639999999996, Overlap threshold: 0.7
2025-06-10 20:20:14,060 - DEBUG - Checking merge:
  Current: 19, Next: 23
2025-06-10 20:20:14,060 - DEBUG -   Vertical gap: 7.8279999999999745, Overlap ratio: 1.0
2025-06-10 20:20:14,060 - DEBUG -   Left boundary diff: 44.275000000000034, Right boundary diff: 0.0009999999999763531
2025-06-10 20:20:14,060 - DEBUG -   Alignment factor (ratio): 0.24224832710500277
2025-06-10 20:20:14,061 - DEBUG -   -> c1 19 formula number: None, c2 23 formula number: None
2025-06-10 20:20:14,061 - DEBUG -   -> Not merging clusters 19 and 23 because vertical_gap 7.8279999999999745 > 3 with no numbers
2025-06-10 20:20:14,061 - DEBUG - Checking merge:
  Current: 19, Next: 10
2025-06-10 20:20:14,061 - DEBUG -   Vertical gap: 12.001999999999953, Overlap ratio: -0.022353613757486783
2025-06-10 20:20:14,061 - DEBUG -   Left boundary diff: 346.392, Right boundary diff: 266.455
2025-06-10 20:20:14,061 - DEBUG -   Alignment factor (ratio): 1.7268011814703577
2025-06-10 20:20:14,062 - DEBUG -   -> c1 19 formula number: None, c2 10 formula number: None
2025-06-10 20:20:14,062 - DEBUG -   -> Not merging clusters 19 and 10 because vertical_gap 12.001999999999953 > 3 with no numbers
2025-06-10 20:20:14,062 - DEBUG - Checking merge:
  Current: 23, Next: 21
2025-06-10 20:20:14,062 - DEBUG -   Vertical gap: 10.600999999999999, Overlap ratio: 1.0
2025-06-10 20:20:14,062 - DEBUG -   Left boundary diff: 35.31999999999999, Right boundary diff: 0.0
2025-06-10 20:20:14,062 - DEBUG -   Alignment factor (ratio): 0.18862986995647413
2025-06-10 20:20:14,063 - DEBUG -   -> c1 23 formula number: None, c2 21 formula number: None
2025-06-10 20:20:14,063 - DEBUG -   -> Not merging clusters 23 and 21 because vertical_gap 10.600999999999999 > 3 with no numbers
2025-06-10 20:20:14,063 - DEBUG - Checking merge:
  Current: 23, Next: 20
2025-06-10 20:20:14,063 - DEBUG -   Vertical gap: 47.37700000000001, Overlap ratio: 0.9999959986075151
2025-06-10 20:20:14,063 - DEBUG -   Left boundary diff: 54.992999999999995, Right boundary diff: 0.00100000000009004
2025-06-10 20:20:14,063 - DEBUG -   Alignment factor (ratio): 0.30997863693499195
2025-06-10 20:20:14,063 - DEBUG -   -> c1 23 formula number: None, c2 20 formula number: None
2025-06-10 20:20:14,064 - DEBUG - Checking merge:
  Current: 10, Next: 20
2025-06-10 20:20:14,064 - DEBUG -   Vertical gap: 36.49899999999997, Overlap ratio: -0.06619903726496812
2025-06-10 20:20:14,064 - DEBUG -   Left boundary diff: 357.10999999999996, Right boundary diff: 266.45700000000005
2025-06-10 20:20:14,064 - DEBUG -   Alignment factor (ratio): 1.82908683949713
2025-06-10 20:20:14,064 - DEBUG -   -> c1 10 formula number: None, c2 20 formula number: None
2025-06-10 20:20:14,064 - DEBUG - Checking merge:
  Current: 21, Next: 20
2025-06-10 20:20:14,065 - DEBUG -   Vertical gap: 12.397999999999968, Overlap ratio: 0.9999959986075151
2025-06-10 20:20:14,065 - DEBUG -   Left boundary diff: 19.673000000000002, Right boundary diff: 0.00100000000009004
2025-06-10 20:20:14,065 - DEBUG -   Alignment factor (ratio): 0.1231494406850747
2025-06-10 20:20:14,065 - DEBUG -   -> c1 21 formula number: None, c2 20 formula number: None
2025-06-10 20:20:14,065 - DEBUG -   -> Not merging clusters 21 and 20 because vertical_gap 12.397999999999968 > 3 with no numbers
2025-06-10 20:20:14,065 - DEBUG - Checking merge:
  Current: 21, Next: 18
2025-06-10 20:20:14,065 - DEBUG -   Vertical gap: 46.81099999999998, Overlap ratio: 1.0
2025-06-10 20:20:14,066 - DEBUG -   Left boundary diff: 2.266999999999996, Right boundary diff: 0.00100000000009004
2025-06-10 20:20:14,066 - DEBUG -   Alignment factor (ratio): 0.01327913120390815
2025-06-10 20:20:14,066 - DEBUG -   -> c1 21 formula number: None, c2 18 formula number: None
2025-06-10 20:20:14,066 - DEBUG -   -> Not merging clusters 21 and 18 because vertical_gap 46.81099999999998 > 3 with no numbers
2025-06-10 20:20:14,066 - DEBUG - Checking merge:
  Current: 20, Next: 18
2025-06-10 20:20:14,066 - DEBUG -   Vertical gap: 12.906999999999982, Overlap ratio: 1.0
2025-06-10 20:20:14,067 - DEBUG -   Left boundary diff: 21.939999999999998, Right boundary diff: 0.0
2025-06-10 20:20:14,067 - DEBUG -   Alignment factor (ratio): 0.13637239484594388
2025-06-10 20:20:14,067 - DEBUG -   -> c1 20 formula number: None, c2 18 formula number: None
2025-06-10 20:20:14,067 - DEBUG -   -> Not merging clusters 20 and 18 because vertical_gap 12.906999999999982 > 3 with no numbers
2025-06-10 20:20:14,067 - DEBUG - Checking merge:
  Current: 20, Next: 11
2025-06-10 20:20:14,067 - DEBUG -   Vertical gap: 19.966999999999985, Overlap ratio: -0.06620303865745261
2025-06-10 20:20:14,067 - DEBUG -   Left boundary diff: 349.22999999999996, Right boundary diff: 266.458
2025-06-10 20:20:14,068 - DEBUG -   Alignment factor (ratio): 1.8255714875665836
2025-06-10 20:20:14,068 - DEBUG -   -> c1 20 formula number: None, c2 11 formula number: None
2025-06-10 20:20:14,068 - DEBUG -   -> Not merging clusters 20 and 11 because vertical_gap 19.966999999999985 > 3 with no numbers
2025-06-10 20:20:14,068 - DEBUG - Checking merge:
  Current: 27, Next: 16
2025-06-10 20:20:14,068 - DEBUG -   Vertical gap: 9.197000000000116, Overlap ratio: 1.0
2025-06-10 20:20:14,068 - DEBUG -   Left boundary diff: 35.37700000000001, Right boundary diff: 0.0
2025-06-10 20:20:14,069 - DEBUG -   Alignment factor (ratio): 0.21522849433745314
2025-06-10 20:20:14,069 - DEBUG -   -> c1 27 formula number: None, c2 16 formula number: None
2025-06-10 20:20:14,069 - DEBUG -   -> Not merging clusters 27 and 16 because vertical_gap 9.197000000000116 > 3 with no numbers
2025-06-10 20:20:14,069 - DEBUG - Checking merge:
  Current: 16, Next: 17
2025-06-10 20:20:14,069 - DEBUG -   Vertical gap: 12.946000000000026, Overlap ratio: 1.0
2025-06-10 20:20:14,070 - DEBUG -   Left boundary diff: 0.3410000000000082, Right boundary diff: 0.0
2025-06-10 20:20:14,070 - DEBUG -   Alignment factor (ratio): 0.0023220736594451413
2025-06-10 20:20:14,070 - DEBUG -   -> c1 16 formula number: None, c2 17 formula number: None
2025-06-10 20:20:14,070 - DEBUG -   -> Not merging clusters 16 and 17 because vertical_gap 12.946000000000026 > 3 with no numbers
2025-06-10 20:20:14,070 - DEBUG - Checking merge:
  Current: 16, Next: 14
2025-06-10 20:20:14,070 - DEBUG -   Vertical gap: 41.450000000000045, Overlap ratio: 0.28272140943161417
2025-06-10 20:20:14,070 - DEBUG -   Left boundary diff: 176.939, Right boundary diff: 266.45699999999994
2025-06-10 20:20:14,071 - DEBUG -   Alignment factor (ratio): 1.391856456330965
2025-06-10 20:20:14,071 - DEBUG -   -> c1 16 formula number: None, c2 14 formula number: None
2025-06-10 20:20:14,071 - DEBUG - Checking merge:
  Current: 17, Next: 14
2025-06-10 20:20:14,071 - DEBUG -   Vertical gap: 0.6309999999999718, Overlap ratio: 0.28233112840151897
2025-06-10 20:20:14,071 - DEBUG -   Left boundary diff: 177.28, Right boundary diff: 266.45699999999994
2025-06-10 20:20:14,071 - DEBUG -   Alignment factor (ratio): 1.3906179463025248
2025-06-10 20:20:14,072 - DEBUG -   -> c1 17 formula number: None, c2 14 formula number: None
2025-06-10 20:20:14,072 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:14,165 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:14,625 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:14,751 - DEBUG - Snippet 10.3390_atmos8030061_703_item_3: generation shape=torch.Size([1, 427])
2025-06-10 20:20:14,752 - DEBUG - Snippet 10.3390_atmos8030061_703_item_3 raw docling: (tokens=81)
<formula><loc_0><loc_0><loc_500><loc_500>S O A = S O C \times C o e f _ { S O A / S O C } = [ T O C - E C \times ( O C / E C ) _ { \min } ] \times C o e f _ { S O A / S O C }</formula><end_of_utterance>
2025-06-10 20:20:14,752 - DEBUG - Starting _parse_docling_output
2025-06-10 20:20:14,752 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>S O A = S O C \times C o e f _ { S O A / S O C } = [ T O C - E C \times ( O C / E C ) _ { \min } ] \times C o e f _ { S O A / S O C }</formula><end_of_utterance>
2025-06-10 20:20:14,752 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:20:14,752 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>S O A = S O C \\times C o e f _ { S O A / S O C } = [ T O C - E C \\times ( O C / E C ) _ { \\min } ] \\times C o e f _ { S O A / S O C }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=1131x62 at 0x7F9698CEFD70>)]
2025-06-10 20:20:14,753 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:20:14,756 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=1131.0, b=62.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 133))], orig='S O A = S O C \\times C o e f _ { S O A / S O C } = [ T O C - E C \\times ( O C / E C ) _ { \\min } ] \\times C o e f _ { S O A / S O C }', text='S O A = S O C \\times C o e f _ { S O A / S O C } = [ T O C - E C \\times ( O C / E C ) _ { \\min } ] \\times C o e f _ { S O A / S O C }', formatting=None, hyperlink=None)]
2025-06-10 20:20:14,756 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:20:14,756 - DEBUG - Processing text item: label=formula, text=S O A = S O C \times C o e f _ { S O A / S O C } = [ T O C - E C \times ( O C / E C ) _ { \min } ] \times C o e f _ { S O A / S O C }
2025-06-10 20:20:14,757 - DEBUG - Recognized string extracted: S O A = S O C \times C o e f _ { S O A / S O C } = [ T O C - E C \times ( O C / E C ) _ { \min } ] \times C o e f _ { S O A / S O C }
2025-06-10 20:20:14,757 - DEBUG - Generating chat message for label: formula
2025-06-10 20:20:14,757 - DEBUG - Snippet 10.3390_atmos8030061_703_item_4 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:20:14,816 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:20:14,816 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:20:14,816 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:20:14,825 - DEBUG - Snippet 10.3390_atmos8030061_703_item_4 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:20:14,845 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:14,852 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:20:14,916 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:20:14,971 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:14,972 - DEBUG - Finished converting page batch time=3967.777
2025-06-10 20:20:15,081 - DEBUG - Dynamic vertical threshold: 37.314900000000016, Overlap threshold: 0.7
2025-06-10 20:20:15,082 - DEBUG - Checking merge:
  Current: 23, Next: 28
2025-06-10 20:20:15,082 - DEBUG -   Vertical gap: 12.487000000000023, Overlap ratio: 1.0
2025-06-10 20:20:15,082 - DEBUG -   Left boundary diff: 11.962999999999994, Right boundary diff: 0.0009999999999763531
2025-06-10 20:20:15,082 - DEBUG -   Alignment factor (ratio): 0.06983083694268999
2025-06-10 20:20:15,082 - DEBUG -   -> c1 23 formula number: None, c2 28 formula number: None
2025-06-10 20:20:15,083 - DEBUG -   -> Not merging clusters 23 and 28 because vertical_gap 12.487000000000023 > 3 with no numbers
2025-06-10 20:20:15,083 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:15,084 - DEBUG - Finished converting page batch time=3967.889
2025-06-10 20:20:15,113 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:20:15,140 - DEBUG - Snippet 10.1214_10-aoas351_689_item_3: generation shape=torch.Size([1, 447])
2025-06-10 20:20:15,141 - DEBUG - Snippet 10.1214_10-aoas351_689_item_3 raw docling: (tokens=101)
<formula><loc_0><loc_0><loc_500><loc_500>i , t = \rho _ { i j } \beta _ { i j , t - 1 } + \eta _ { i j , t } , \quad \eta _ { i j , t } \sim N ( 0 , \xi _ { i j } ^ { 2 } ) , \quad i = 1 , 2 ; \, j = 0</formula><end_of_utterance>
2025-06-10 20:20:15,141 - DEBUG - Starting _parse_docling_output
2025-06-10 20:20:15,141 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>i , t = \rho _ { i j } \beta _ { i j , t - 1 } + \eta _ { i j , t } , \quad \eta _ { i j , t } \sim N ( 0 , \xi _ { i j } ^ { 2 } ) , \quad i = 1 , 2 ; \, j = 0</formula><end_of_utterance>
2025-06-10 20:20:15,141 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:20:15,141 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>i , t = \\rho _ { i j } \\beta _ { i j , t - 1 } + \\eta _ { i j , t } , \\quad \\eta _ { i j , t } \\sim N ( 0 , \\xi _ { i j } ^ { 2 } ) , \\quad i = 1 , 2 ; \\, j = 0</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=789x167 at 0x7F96B296CA40>)]
2025-06-10 20:20:15,142 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:20:15,146 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=789.0, b=167.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 160))], orig='i , t = \\rho _ { i j } \\beta _ { i j , t - 1 } + \\eta _ { i j , t } , \\quad \\eta _ { i j , t } \\sim N ( 0 , \\xi _ { i j } ^ { 2 } ) , \\quad i = 1 , 2 ; \\, j = 0', text='i , t = \\rho _ { i j } \\beta _ { i j , t - 1 } + \\eta _ { i j , t } , \\quad \\eta _ { i j , t } \\sim N ( 0 , \\xi _ { i j } ^ { 2 } ) , \\quad i = 1 , 2 ; \\, j = 0', formatting=None, hyperlink=None)]
2025-06-10 20:20:15,146 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:20:15,146 - DEBUG - Processing text item: label=formula, text=i , t = \rho _ { i j } \beta _ { i j , t - 1 } + \eta _ { i j , t } , \quad \eta _ { i j , t } \sim N ( 0 , \xi _ { i j } ^ { 2 } ) , \quad i = 1 , 2 ; \, j = 0
2025-06-10 20:20:15,146 - DEBUG - Recognized string extracted: i , t = \rho _ { i j } \beta _ { i j , t - 1 } + \eta _ { i j , t } , \quad \eta _ { i j , t } \sim N ( 0 , \xi _ { i j } ^ { 2 } ) , \quad i = 1 , 2 ; \, j = 0
2025-06-10 20:20:15,147 - DEBUG - Generating chat message for label: formula
2025-06-10 20:20:15,147 - DEBUG - Snippet 10.1214_10-aoas351_689_item_4 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:20:15,152 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:20:15,189 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:20:15,195 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:15,196 - DEBUG - Finished converting page batch time=3968.001
2025-06-10 20:20:15,227 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:20:15,372 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:20:15,387 - DEBUG - Snippet 10.1214_10-aoas351_689_item_4 => input_ids shape=torch.Size([1, 875]), prompt_len=875
2025-06-10 20:20:15,413 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:20:15,448 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:15,456 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:20:15,473 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:15,620 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:20:15,781 - DEBUG - Snippet 10.3390_atmos8030061_703_item_4: generation shape=torch.Size([1, 377])
2025-06-10 20:20:15,782 - DEBUG - Snippet 10.3390_atmos8030061_703_item_4 raw docling: (tokens=31)
<formula><loc_0><loc_0><loc_500><loc_500>R i s k = I U R \times E C</formula><end_of_utterance>
2025-06-10 20:20:15,782 - DEBUG - Starting _parse_docling_output
2025-06-10 20:20:15,782 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>R i s k = I U R \times E C</formula><end_of_utterance>
2025-06-10 20:20:15,783 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:20:15,783 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>R i s k = I U R \\times E C</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=761x55 at 0x7F9698CEE330>)]
2025-06-10 20:20:15,783 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:20:15,785 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=761.0, b=55.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 26))], orig='R i s k = I U R \\times E C', text='R i s k = I U R \\times E C', formatting=None, hyperlink=None)]
2025-06-10 20:20:15,785 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:20:15,785 - DEBUG - Processing text item: label=formula, text=R i s k = I U R \times E C
2025-06-10 20:20:15,786 - DEBUG - Recognized string extracted: R i s k = I U R \times E C
2025-06-10 20:20:15,786 - INFO - All done. Returning 5 recognized text results.
2025-06-10 20:20:15,786 - DEBUG - Snippet 10.3390_atmos8030061_703_item_0 recognized text:
O F P = M I R \times \rho \left ( C _ { 2 } - C _ { 1 2 } \right )
2025-06-10 20:20:15,786 - DEBUG - Snippet 10.3390_atmos8030061_703_item_1 recognized text:
S O A F P = V O C s _ { 0 } \times F A C
2025-06-10 20:20:15,786 - DEBUG - Snippet 10.3390_atmos8030061_703_item_2 recognized text:
V O C s _ { t } = V O C s _ { 0 } \times ( 1 - F V O C r )
2025-06-10 20:20:15,787 - DEBUG - Snippet 10.3390_atmos8030061_703_item_3 recognized text:
S O A = S O C \times C o e f _ { S O A / S O C } = [ T O C - E C \times ( O C / E C ) _ { \min } ] \times C o e f _ { S O A / S O C }
2025-06-10 20:20:15,787 - DEBUG - Snippet 10.3390_atmos8030061_703_item_4 recognized text:
R i s k = I U R \times E C
2025-06-10 20:20:15,793 - INFO - Starting prediction for 3 images with labels: ['formula', 'formula', 'formula']
2025-06-10 20:20:15,793 - DEBUG - Generating chat message for label: formula
2025-06-10 20:20:15,794 - DEBUG - Snippet 10.3390_atmos8030061_703_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:20:15,859 - DEBUG - Snippet 10.3390_atmos8030061_703_item_0 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:20:15,932 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:20:16,163 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:20:16,163 - INFO - Processing document 10.3390_ijerph15040736_730.pdf
2025-06-10 20:20:16,465 - INFO - Extraction successful row 111, tokens=208239
2025-06-10 20:20:16,499 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:16,546 - INFO - Going to convert document batch...
2025-06-10 20:20:16,546 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:20:16,547 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:20:16,595 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:20:16,696 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:16,697 - DEBUG - Finished converting page batch time=3969.502
2025-06-10 20:20:16,849 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:16,904 - DEBUG - Creating masked image for page 2 with 26 clusters.
2025-06-10 20:20:16,906 - INFO - Masked image successfully created for page 2.
2025-06-10 20:20:17,007 - DEBUG - Creating masked image for page 3 with 20 clusters.
2025-06-10 20:20:17,009 - INFO - Masked image successfully created for page 3.
2025-06-10 20:20:17,018 - INFO - Starting prediction for 3 images with labels: ['formula', 'formula', 'formula']
2025-06-10 20:20:17,019 - DEBUG - Generating chat message for label: formula
2025-06-10 20:20:17,019 - DEBUG - Snippet 10.1136_bmjopen-2016-013941_722_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:20:17,082 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:17,091 - DEBUG - Snippet 10.1136_bmjopen-2016-013941_722_item_0 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:20:17,101 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:17,132 - DEBUG - Snippet 10.3390_atmos8030061_703_item_0: generation shape=torch.Size([1, 387])
2025-06-10 20:20:17,132 - DEBUG - Snippet 10.3390_atmos8030061_703_item_0 raw docling: (tokens=41)
<formula><loc_0><loc_0><loc_500><loc_500>E C = ( C A \times E T \times E F \times E D ) / A T</formula><end_of_utterance>
2025-06-10 20:20:17,133 - DEBUG - Starting _parse_docling_output
2025-06-10 20:20:17,133 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>E C = ( C A \times E T \times E F \times E D ) / A T</formula><end_of_utterance>
2025-06-10 20:20:17,133 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:20:17,133 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>E C = ( C A \\times E T \\times E F \\times E D ) / A T</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=862x55 at 0x7F9698CEEE70>)]
2025-06-10 20:20:17,133 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:20:17,135 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=862.0, b=55.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 52))], orig='E C = ( C A \\times E T \\times E F \\times E D ) / A T', text='E C = ( C A \\times E T \\times E F \\times E D ) / A T', formatting=None, hyperlink=None)]
2025-06-10 20:20:17,136 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:20:17,136 - DEBUG - Processing text item: label=formula, text=E C = ( C A \times E T \times E F \times E D ) / A T
2025-06-10 20:20:17,136 - DEBUG - Recognized string extracted: E C = ( C A \times E T \times E F \times E D ) / A T
2025-06-10 20:20:17,136 - DEBUG - Generating chat message for label: formula
2025-06-10 20:20:17,137 - DEBUG - Snippet 10.3390_atmos8030061_703_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:20:17,182 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:17,202 - DEBUG - Snippet 10.3390_atmos8030061_703_item_1 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:20:17,432 - DEBUG - Finished converting page batch time=3970.237
2025-06-10 20:20:17,471 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:20:17,532 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:20:17,539 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:20:17,656 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:17,860 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:17,861 - DEBUG - Finished converting page batch time=3970.666
2025-06-10 20:20:18,042 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:18,053 - DEBUG - Snippet 10.1136_bmjopen-2016-013941_722_item_0: generation shape=torch.Size([1, 377])
2025-06-10 20:20:18,054 - DEBUG - Snippet 10.1136_bmjopen-2016-013941_722_item_0 raw docling: (tokens=31)
<formula><loc_0><loc_0><loc_500><loc_500>A H D = C \times I R / B W</formula><end_of_utterance>
2025-06-10 20:20:18,059 - DEBUG - Starting _parse_docling_output
2025-06-10 20:20:18,059 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>A H D = C \times I R / B W</formula><end_of_utterance>
2025-06-10 20:20:18,061 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:20:18,061 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>A H D = C \\times I R / B W</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=488x90 at 0x7F969C686DE0>)]
2025-06-10 20:20:18,062 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:20:18,063 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=488.0, b=90.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 26))], orig='A H D = C \\times I R / B W', text='A H D = C \\times I R / B W', formatting=None, hyperlink=None)]
2025-06-10 20:20:18,064 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:20:18,064 - DEBUG - Processing text item: label=formula, text=A H D = C \times I R / B W
2025-06-10 20:20:18,064 - DEBUG - Recognized string extracted: A H D = C \times I R / B W
2025-06-10 20:20:18,064 - DEBUG - Generating chat message for label: formula
2025-06-10 20:20:18,065 - DEBUG - Snippet 10.1136_bmjopen-2016-013941_722_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:20:18,133 - DEBUG - Snippet 10.1136_bmjopen-2016-013941_722_item_1 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:20:18,328 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:18,334 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:20:18,334 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:20:18,334 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:20:18,398 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:20:18,433 - DEBUG - Snippet 10.3390_atmos8030061_703_item_1: generation shape=torch.Size([1, 386])
2025-06-10 20:20:18,434 - DEBUG - Snippet 10.3390_atmos8030061_703_item_1 raw docling: (tokens=40)
<formula><loc_0><loc_0><loc_500><loc_500>H Q = E C / ( R f C \times 1 0 0 0 )</formula><end_of_utterance>
2025-06-10 20:20:18,434 - DEBUG - Starting _parse_docling_output
2025-06-10 20:20:18,434 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>H Q = E C / ( R f C \times 1 0 0 0 )</formula><end_of_utterance>
2025-06-10 20:20:18,435 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:20:18,435 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>H Q = E C / ( R f C \\times 1 0 0 0 )</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=803x55 at 0x7F9698CEE7B0>)]
2025-06-10 20:20:18,435 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:20:18,437 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=803.0, b=55.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 36))], orig='H Q = E C / ( R f C \\times 1 0 0 0 )', text='H Q = E C / ( R f C \\times 1 0 0 0 )', formatting=None, hyperlink=None)]
2025-06-10 20:20:18,437 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:20:18,437 - DEBUG - Processing text item: label=formula, text=H Q = E C / ( R f C \times 1 0 0 0 )
2025-06-10 20:20:18,438 - DEBUG - Recognized string extracted: H Q = E C / ( R f C \times 1 0 0 0 )
2025-06-10 20:20:18,438 - DEBUG - Generating chat message for label: formula
2025-06-10 20:20:18,438 - DEBUG - Snippet 10.3390_atmos8030061_703_item_2 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:20:18,441 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:20:18,463 - DEBUG - [Page 14] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:18,464 - DEBUG - Finished converting page batch time=3971.269
2025-06-10 20:20:18,483 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:20:18,505 - DEBUG - Snippet 10.3390_atmos8030061_703_item_2 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:20:18,513 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:18,526 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:20:18,564 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:20:18,609 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:20:18,655 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:18,718 - DEBUG - Creating masked image for page 9 with 20 clusters.
2025-06-10 20:20:18,720 - INFO - Masked image successfully created for page 9.
2025-06-10 20:20:18,754 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:20:18,776 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:18,791 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:20:18,817 - DEBUG - Creating masked image for page 10 with 55 clusters.
2025-06-10 20:20:18,818 - INFO - Masked image successfully created for page 10.
2025-06-10 20:20:18,826 - INFO - Starting prediction for 5 images with labels: ['formula', 'formula', 'formula', 'formula', 'formula']
2025-06-10 20:20:18,826 - DEBUG - Generating chat message for label: formula
2025-06-10 20:20:18,827 - DEBUG - Snippet 10.1038_s41467-024-55450-0_721_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:20:18,827 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:20:18,894 - DEBUG - Snippet 10.1038_s41467-024-55450-0_721_item_0 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:20:18,993 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:20:18,994 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:19,112 - DEBUG - Dynamic vertical threshold: 33.19919999999993, Overlap threshold: 0.7
2025-06-10 20:20:19,112 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:19,113 - DEBUG - Finished converting page batch time=3971.918
2025-06-10 20:20:19,284 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:20:19,485 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:20:19,485 - INFO - Processing document 10.5194_acp-19-13367-2019_742.pdf
2025-06-10 20:20:19,592 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:19,672 - DEBUG - Snippet 10.3390_atmos8030061_703_item_2: generation shape=torch.Size([1, 376])
2025-06-10 20:20:19,673 - DEBUG - Snippet 10.3390_atmos8030061_703_item_2 raw docling: (tokens=30)
<formula><loc_0><loc_0><loc_500><loc_500>H I = \sum H Q _ { i }</formula><end_of_utterance>
2025-06-10 20:20:19,674 - DEBUG - Starting _parse_docling_output
2025-06-10 20:20:19,674 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>H I = \sum H Q _ { i }</formula><end_of_utterance>
2025-06-10 20:20:19,674 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:20:19,674 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>H I = \\sum H Q _ { i }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=737x89 at 0x7F9698CEED20>)]
2025-06-10 20:20:19,675 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:20:19,677 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=737.0, b=89.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 22))], orig='H I = \\sum H Q _ { i }', text='H I = \\sum H Q _ { i }', formatting=None, hyperlink=None)]
2025-06-10 20:20:19,677 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:20:19,678 - DEBUG - Processing text item: label=formula, text=H I = \sum H Q _ { i }
2025-06-10 20:20:19,678 - DEBUG - Recognized string extracted: H I = \sum H Q _ { i }
2025-06-10 20:20:19,678 - INFO - All done. Returning 3 recognized text results.
2025-06-10 20:20:19,678 - DEBUG - Snippet 10.3390_atmos8030061_703_item_0 recognized text:
E C = ( C A \times E T \times E F \times E D ) / A T
2025-06-10 20:20:19,678 - DEBUG - Snippet 10.3390_atmos8030061_703_item_1 recognized text:
H Q = E C / ( R f C \times 1 0 0 0 )
2025-06-10 20:20:19,679 - DEBUG - Snippet 10.3390_atmos8030061_703_item_2 recognized text:
H I = \sum H Q _ { i }
2025-06-10 20:20:19,834 - DEBUG - Dynamic vertical threshold: 40.10669999999989, Overlap threshold: 0.7
2025-06-10 20:20:19,834 - DEBUG - Checking merge:
  Current: 14, Next: 9
2025-06-10 20:20:19,835 - DEBUG -   Vertical gap: 20.90500000000003, Overlap ratio: 1.0
2025-06-10 20:20:19,835 - DEBUG -   Left boundary diff: 17.57099999999997, Right boundary diff: 0.0009999999999763531
2025-06-10 20:20:19,835 - DEBUG -   Alignment factor (ratio): 0.06540626256309454
2025-06-10 20:20:19,835 - DEBUG -   -> c1 14 formula number: 3, c2 9 formula number: 4
2025-06-10 20:20:19,836 - DEBUG -   -> Not merging clusters 14 and 9 due to different formula numbers: 3 vs 4
2025-06-10 20:20:19,836 - DEBUG - Checking merge:
  Current: 9, Next: 10
2025-06-10 20:20:19,836 - DEBUG -   Vertical gap: 39.87300000000005, Overlap ratio: 1.0
2025-06-10 20:20:19,836 - DEBUG -   Left boundary diff: 30.11099999999999, Right boundary diff: 0.0
2025-06-10 20:20:19,836 - DEBUG -   Alignment factor (ratio): 0.11476343928239974
2025-06-10 20:20:19,837 - DEBUG -   -> c1 9 formula number: 4, c2 10 formula number: 5
2025-06-10 20:20:19,837 - DEBUG -   -> Not merging clusters 9 and 10 due to different formula numbers: 4 vs 5
2025-06-10 20:20:19,837 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:19,882 - INFO - Finished converting document 10.3390_atmos8030061_703.pdf in 53.09 sec.
2025-06-10 20:20:20,138 - DEBUG - [Page 14] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:20,139 - DEBUG - Finished converting page batch time=3972.944
2025-06-10 20:20:20,152 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:20,227 - DEBUG - Creating masked image for page 3 with 12 clusters.
2025-06-10 20:20:20,228 - INFO - Masked image successfully created for page 3.
2025-06-10 20:20:20,235 - INFO - Starting prediction for 3 images with labels: ['formula', 'formula', 'formula']
2025-06-10 20:20:20,236 - DEBUG - Generating chat message for label: formula
2025-06-10 20:20:20,236 - DEBUG - Snippet 10.1007_s10584-013-0847-8_723_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:20:20,255 - DEBUG - Snippet 10.1136_bmjopen-2016-013941_722_item_1: generation shape=torch.Size([1, 389])
2025-06-10 20:20:20,257 - DEBUG - Snippet 10.1136_bmjopen-2016-013941_722_item_1 raw docling: (tokens=43)
<formula><loc_0><loc_0><loc_500><loc_500>A D D = ( C \times I R \times E D ) / ( B W \times A T )</formula><end_of_utterance>
2025-06-10 20:20:20,257 - DEBUG - Starting _parse_docling_output
2025-06-10 20:20:20,257 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>A D D = ( C \times I R \times E D ) / ( B W \times A T )</formula><end_of_utterance>
2025-06-10 20:20:20,257 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:20:20,258 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>A D D = ( C \\times I R \\times E D ) / ( B W \\times A T )</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=585x90 at 0x7F96B11E58E0>)]
2025-06-10 20:20:20,258 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:20:20,260 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=585.0, b=90.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 56))], orig='A D D = ( C \\times I R \\times E D ) / ( B W \\times A T )', text='A D D = ( C \\times I R \\times E D ) / ( B W \\times A T )', formatting=None, hyperlink=None)]
2025-06-10 20:20:20,261 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:20:20,261 - DEBUG - Processing text item: label=formula, text=A D D = ( C \times I R \times E D ) / ( B W \times A T )
2025-06-10 20:20:20,261 - DEBUG - Recognized string extracted: A D D = ( C \times I R \times E D ) / ( B W \times A T )
2025-06-10 20:20:20,261 - DEBUG - Generating chat message for label: formula
2025-06-10 20:20:20,262 - DEBUG - Snippet 10.1136_bmjopen-2016-013941_722_item_2 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:20:20,286 - DEBUG - Dynamic vertical threshold: 48.57299999999997, Overlap threshold: 0.7
2025-06-10 20:20:20,287 - DEBUG - Checking merge:
  Current: 7, Next: 8
2025-06-10 20:20:20,287 - DEBUG -   Vertical gap: 9.048999999999978, Overlap ratio: 1.0
2025-06-10 20:20:20,287 - DEBUG -   Left boundary diff: 1.191000000000031, Right boundary diff: 0.0
2025-06-10 20:20:20,287 - DEBUG -   Alignment factor (ratio): 0.00482628807388164
2025-06-10 20:20:20,287 - DEBUG -   -> c1 7 formula number: 6, c2 8 formula number: 7
2025-06-10 20:20:20,288 - DEBUG -   -> Not merging clusters 7 and 8 due to different formula numbers: 6 vs 7
2025-06-10 20:20:20,288 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:20,304 - DEBUG - Snippet 10.1007_s10584-013-0847-8_723_item_0 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:20:20,409 - DEBUG - Snippet 10.1136_bmjopen-2016-013941_722_item_2 => input_ids shape=torch.Size([1, 610]), prompt_len=610
2025-06-10 20:20:20,488 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:20,489 - DEBUG - Finished converting page batch time=3973.294
2025-06-10 20:20:20,847 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:20,891 - INFO - Extraction successful row 137, tokens=43814
2025-06-10 20:20:20,935 - INFO - Going to convert document batch...
2025-06-10 20:20:20,939 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:20:20,942 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:20:20,992 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:20:21,257 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:21,744 - DEBUG - Snippet 10.1038_s41467-024-55450-0_721_item_0: generation shape=torch.Size([1, 441])
2025-06-10 20:20:21,744 - DEBUG - Snippet 10.1038_s41467-024-55450-0_721_item_0 raw docling: (tokens=95)
<formula><loc_0><loc_0><loc_500><loc_500>V G _ { 0 3 } = F _ { G } ( V _ { T H C H O } , V _ { T N O 2 } , V _ { C A M S } , V _ { E S R I } , V _ { E M F } , V _ { G E } , V _ { T C } )</formula><end_of_utterance>
2025-06-10 20:20:21,745 - DEBUG - Starting _parse_docling_output
2025-06-10 20:20:21,745 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>V G _ { 0 3 } = F _ { G } ( V _ { T H C H O } , V _ { T N O 2 } , V _ { C A M S } , V _ { E S R I } , V _ { E M F } , V _ { G E } , V _ { T C } )</formula><end_of_utterance>
2025-06-10 20:20:21,745 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:20:21,745 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>V G _ { 0 3 } = F _ { G } ( V _ { T H C H O } , V _ { T N O 2 } , V _ { C A M S } , V _ { E S R I } , V _ { E M F } , V _ { G E } , V _ { T C } )</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=672x73 at 0x7F96DFFF85F0>)]
2025-06-10 20:20:21,746 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:20:21,748 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=672.0, b=73.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 145))], orig='V G _ { 0 3 } = F _ { G } ( V _ { T H C H O } , V _ { T N O 2 } , V _ { C A M S } , V _ { E S R I } , V _ { E M F } , V _ { G E } , V _ { T C } )', text='V G _ { 0 3 } = F _ { G } ( V _ { T H C H O } , V _ { T N O 2 } , V _ { C A M S } , V _ { E S R I } , V _ { E M F } , V _ { G E } , V _ { T C } )', formatting=None, hyperlink=None)]
2025-06-10 20:20:21,748 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:20:21,748 - DEBUG - Processing text item: label=formula, text=V G _ { 0 3 } = F _ { G } ( V _ { T H C H O } , V _ { T N O 2 } , V _ { C A M S } , V _ { E S R I } , V _ { E M F } , V _ { G E } , V _ { T C } )
2025-06-10 20:20:21,748 - DEBUG - Recognized string extracted: V G _ { 0 3 } = F _ { G } ( V _ { T H C H O } , V _ { T N O 2 } , V _ { C A M S } , V _ { E S R I } , V _ { E M F } , V _ { G E } , V _ { T C } )
2025-06-10 20:20:21,749 - DEBUG - Generating chat message for label: formula
2025-06-10 20:20:21,749 - DEBUG - Snippet 10.1038_s41467-024-55450-0_721_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:20:21,783 - DEBUG - Dynamic vertical threshold: 33.43680000000004, Overlap threshold: 0.7
2025-06-10 20:20:21,784 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:21,874 - DEBUG - Snippet 10.1038_s41467-024-55450-0_721_item_1 => input_ids shape=torch.Size([1, 610]), prompt_len=610
2025-06-10 20:20:21,897 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:20:21,951 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:20:21,957 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:20:21,963 - DEBUG - Snippet 10.1214_10-aoas351_689_item_4: generation shape=torch.Size([1, 1105])
2025-06-10 20:20:21,964 - DEBUG - Snippet 10.1214_10-aoas351_689_item_4 raw docling: (tokens=229)
<formula><loc_0><loc_0><loc_500><loc_500>\beta _ { 1 0 } ( s , t ) \left ( \begin{array} { c } { { \beta _ { 1 1 } ( s , t ) } } \\ { { \beta _ { 1 2 } ( s , t ) } } \\ { { \beta _ { 2 0 } ( s , t ) } } \\ { { \beta _ { 2 1 } ( s , t ) } } \\ { { \beta _ { 2 2 } ( s , t ) } } \end{array} \right ) = A \left ( \begin{array} { c } { { w _ { 1 } ( s , t ) } } \\ { { w _ { 3 } ( s , t ) } } \\ { { w _ { 4 } ( s , t ) } } \\ { { w _ { 5 } ( s , t ) } } \end{array} \right )</formula><end_of_utterance>
2025-06-10 20:20:21,964 - DEBUG - Starting _parse_docling_output
2025-06-10 20:20:21,964 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>\beta _ { 1 0 } ( s , t ) \left ( \begin{array} { c } { { \beta _ { 1 1 } ( s , t ) } } \\ { { \beta _ { 1 2 } ( s , t ) } } \\ { { \beta _ { 2 0 } ( s , t ) } } \\ { { \beta _ { 2 1 } ( s , t ) } } \\ { { \beta _ { 2 2 } ( s , t ) } } \end{array} \right ) = A \left ( \begin{array} { c } { { w _ { 1 } ( s , t ) } } \\ { { w _ { 3 } ( s , t ) } } \\ { { w _ { 4 } ( s , t ) } } \\ { { w _ { 5 } ( s , t ) } } \end{array} \right )</formula><end_of_utterance>
2025-06-10 20:20:21,965 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:20:21,965 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>\\beta _ { 1 0 } ( s , t ) \\left ( \\begin{array} { c } { { \\beta _ { 1 1 } ( s , t ) } } \\\\ { { \\beta _ { 1 2 } ( s , t ) } } \\\\ { { \\beta _ { 2 0 } ( s , t ) } } \\\\ { { \\beta _ { 2 1 } ( s , t ) } } \\\\ { { \\beta _ { 2 2 } ( s , t ) } } \\end{array} \\right ) = A \\left ( \\begin{array} { c } { { w _ { 1 } ( s , t ) } } \\\\ { { w _ { 3 } ( s , t ) } } \\\\ { { w _ { 4 } ( s , t ) } } \\\\ { { w _ { 5 } ( s , t ) } } \\end{array} \\right )</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=721x439 at 0x7F96B2950DA0>)]
2025-06-10 20:20:21,965 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:20:21,975 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=721.0, b=439.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 430))], orig='\\beta _ { 1 0 } ( s , t ) \\left ( \\begin{array} { c } { { \\beta _ { 1 1 } ( s , t ) } } \\\\ { { \\beta _ { 1 2 } ( s , t ) } } \\\\ { { \\beta _ { 2 0 } ( s , t ) } } \\\\ { { \\beta _ { 2 1 } ( s , t ) } } \\\\ { { \\beta _ { 2 2 } ( s , t ) } } \\end{array} \\right ) = A \\left ( \\begin{array} { c } { { w _ { 1 } ( s , t ) } } \\\\ { { w _ { 3 } ( s , t ) } } \\\\ { { w _ { 4 } ( s , t ) } } \\\\ { { w _ { 5 } ( s , t ) } } \\end{array} \\right )', text='\\beta _ { 1 0 } ( s , t ) \\left ( \\begin{array} { c } { { \\beta _ { 1 1 } ( s , t ) } } \\\\ { { \\beta _ { 1 2 } ( s , t ) } } \\\\ { { \\beta _ { 2 0 } ( s , t ) } } \\\\ { { \\beta _ { 2 1 } ( s , t ) } } \\\\ { { \\beta _ { 2 2 } ( s , t ) } } \\end{array} \\right ) = A \\left ( \\begin{array} { c } { { w _ { 1 } ( s , t ) } } \\\\ { { w _ { 3 } ( s , t ) } } \\\\ { { w _ { 4 } ( s , t ) } } \\\\ { { w _ { 5 } ( s , t ) } } \\end{array} \\right )', formatting=None, hyperlink=None)]
2025-06-10 20:20:21,976 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:20:21,977 - DEBUG - Processing text item: label=formula, text=\beta _ { 1 0 } ( s , t ) \left ( \begin{array} { c } { { \beta _ { 1 1 } ( s , t ) } } \\ { { \beta _ { 1 2 } ( s , t ) } } \\ { { \beta _ { 2 0 } ( s , t ) } } \\ { { \beta _ { 2 1 } ( s , t ) } } \\ { { \beta _ { 2 2 } ( s , t ) } } \end{array} \right ) = A \left ( \begin{array} { c } { { w _ { 1 } ( s , t ) } } \\ { { w _ { 3 } ( s , t ) } } \\ { { w _ { 4 } ( s , t ) } } \\ { { w _ { 5 } ( s , t ) } } \end{array} \right )
2025-06-10 20:20:21,980 - DEBUG - Recognized string extracted: \beta _ { 1 0 } ( s , t ) \left ( \begin{array} { c } { { \beta _ { 1 1 } ( s , t ) } } \\ { { \beta _ { 1 2 } ( s , t ) } } \\ { { \beta _ { 2 0 } ( s , t ) } } \\ { { \beta _ { 2 1 } ( s , t ) } } \\ { { \beta _ { 2 2 } ( s , t ) } } \end{array} \right ) = A \left ( \begin{array} { c } { { w _ { 1 } ( s , t ) } } \\ { { w _ { 3 } ( s , t ) } } \\ { { w _ { 4 } ( s , t ) } } \\ { { w _ { 5 } ( s , t ) } } \end{array} \right )
2025-06-10 20:20:21,980 - INFO - All done. Returning 5 recognized text results.
2025-06-10 20:20:21,984 - DEBUG - Snippet 10.1214_10-aoas351_689_item_0 recognized text:
Y _ { 1 } ( s , t ) = \tilde { \beta } _ { 1 0 } ( s , t ) + \tilde { \beta } _ { 1 1 } ( s , t ) x _ { 1 } ( B , t ) + \tilde { \beta } _ { 1 2 } ( s , t ) x _ { 2 } ( B , t ) + \varepsilon _ { 1 } ( s , t ) , \\ Y _ { 2 } ( s , t ) = \tilde { \beta } _ { 2 0 } ( s , t ) + \tilde { \beta } _ { 2 1 } ( s , t ) x _ { 1 } ( B , t ) + \tilde { \beta } _ { 2 2 } ( s , t ) x _ { 2 } ( B , t ) + \varepsilon _ { 2 } ( s , t ) ,
2025-06-10 20:20:21,987 - DEBUG - Snippet 10.1214_10-aoas351_689_item_1 recognized text:
\beta _ { i j } ( s , t ) = \beta _ { i j , t } + \beta _ { i j } ( s , t ) ,
2025-06-10 20:20:21,987 - DEBUG - Snippet 10.1214_10-aoas351_689_item_2 recognized text:
\beta _ { i j , t } = \rho _ { i j } \beta _ { i j , t - 1 } + \eta _ { i j , t } , \quad \eta _ { i j , t } \stackrel { i n d } { \sim } N ( 0 , \xi _ { i j } ^ { 2 } ) , \quad \quad i = 1 , 2 ; \, j = 0 , 1 , 2 ,
2025-06-10 20:20:21,987 - DEBUG - Snippet 10.1214_10-aoas351_689_item_3 recognized text:
i , t = \rho _ { i j } \beta _ { i j , t - 1 } + \eta _ { i j , t } , \quad \eta _ { i j , t } \sim N ( 0 , \xi _ { i j } ^ { 2 } ) , \quad i = 1 , 2 ; \, j = 0
2025-06-10 20:20:21,987 - DEBUG - Snippet 10.1214_10-aoas351_689_item_4 recognized text:
\beta _ { 1 0 } ( s , t ) \left ( \begin{array} { c } { { \beta _ { 1 1 } ( s , t ) } } \\ { { \beta _ { 1 2 } ( s , t ) } } \\ { { \beta _ { 2 0 } ( s , t ) } } \\ { { \beta _ { 2 1 } ( s , t ) } } \\ { { \beta _ { 2 2 } ( s , t ) } } \end{array} \right ) = A \left ( \begin{array} { c } { { w _ { 1 } ( s , t ) } } \\ { { w _ { 3 } ( s , t ) } } \\ { { w _ { 4 } ( s , t ) } } \\ { { w _ { 5 } ( s , t ) } } \end{array} \right )
2025-06-10 20:20:22,074 - DEBUG - Creating masked image for page 16 with 10 clusters.
2025-06-10 20:20:22,080 - INFO - Masked image successfully created for page 16.
2025-06-10 20:20:22,144 - DEBUG - Snippet 10.1007_s10584-013-0847-8_723_item_0: generation shape=torch.Size([1, 407])
2025-06-10 20:20:22,148 - DEBUG - Snippet 10.1007_s10584-013-0847-8_723_item_0 raw docling: (tokens=61)
<formula><loc_0><loc_0><loc_500><loc_500>\Delta M o r t = P O P \times M o r t _ { b a s e } \times ( 1 - e ^ { - \beta \times \Delta X } ) ,</formula><end_of_utterance>
2025-06-10 20:20:22,148 - DEBUG - Starting _parse_docling_output
2025-06-10 20:20:22,151 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>\Delta M o r t = P O P \times M o r t _ { b a s e } \times ( 1 - e ^ { - \beta \times \Delta X } ) ,</formula><end_of_utterance>
2025-06-10 20:20:22,151 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:20:22,152 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>\\Delta M o r t = P O P \\times M o r t _ { b a s e } \\times ( 1 - e ^ { - \\beta \\times \\Delta X } ) ,</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=748x100 at 0x7F96A77289E0>)]
2025-06-10 20:20:22,152 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:20:22,155 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=748.0, b=100.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 100))], orig='\\Delta M o r t = P O P \\times M o r t _ { b a s e } \\times ( 1 - e ^ { - \\beta \\times \\Delta X } ) ,', text='\\Delta M o r t = P O P \\times M o r t _ { b a s e } \\times ( 1 - e ^ { - \\beta \\times \\Delta X } ) ,', formatting=None, hyperlink=None)]
2025-06-10 20:20:22,155 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:20:22,155 - DEBUG - Processing text item: label=formula, text=\Delta M o r t = P O P \times M o r t _ { b a s e } \times ( 1 - e ^ { - \beta \times \Delta X } ) ,
2025-06-10 20:20:22,155 - DEBUG - Recognized string extracted: \Delta M o r t = P O P \times M o r t _ { b a s e } \times ( 1 - e ^ { - \beta \times \Delta X } ) ,
2025-06-10 20:20:22,156 - DEBUG - Generating chat message for label: formula
2025-06-10 20:20:22,156 - DEBUG - Snippet 10.1007_s10584-013-0847-8_723_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:20:22,175 - DEBUG - Creating masked image for page 17 with 10 clusters.
2025-06-10 20:20:22,180 - INFO - Masked image successfully created for page 17.
2025-06-10 20:20:22,225 - DEBUG - Snippet 10.1007_s10584-013-0847-8_723_item_1 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:20:22,267 - DEBUG - Snippet 10.1136_bmjopen-2016-013941_722_item_2: generation shape=torch.Size([1, 672])
2025-06-10 20:20:22,268 - DEBUG - Snippet 10.1136_bmjopen-2016-013941_722_item_2 raw docling: (tokens=61)
<formula><loc_0><loc_0><loc_500><loc_500>H Q = A D D / R E L \ ( c h r i c o n t e x p o s u r e ) \ \ o r \quad \quad ( 4 )</formula>
<end_of_utterance>
2025-06-10 20:20:22,268 - DEBUG - Starting _parse_docling_output
2025-06-10 20:20:22,268 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>H Q = A D D / R E L \ ( c h r i c o n t e x p o s u r e ) \ \ o r \quad \quad ( 4 )</formula>
<end_of_utterance>
2025-06-10 20:20:22,269 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:20:22,269 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>H Q = A D D / R E L \\ ( c h r i c o n t e x p o s u r e ) \\ \\ o r \\quad \\quad ( 4 )</formula>\n<end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=631x191 at 0x7F968E658110>)]
2025-06-10 20:20:22,269 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:20:22,271 - DEBUG - Creating masked image for page 18 with 5 clusters.
2025-06-10 20:20:22,272 - INFO - Masked image successfully created for page 18.
2025-06-10 20:20:22,274 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=631.0, b=191.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 83))], orig='H Q = A D D / R E L \\ ( c h r i c o n t e x p o s u r e ) \\ \\ o r \\quad \\quad ( 4 )', text='H Q = A D D / R E L \\ ( c h r i c o n t e x p o s u r e ) \\ \\ o r \\quad \\quad ( 4 )', formatting=None, hyperlink=None)]
2025-06-10 20:20:22,274 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:20:22,274 - DEBUG - Processing text item: label=formula, text=H Q = A D D / R E L \ ( c h r i c o n t e x p o s u r e ) \ \ o r \quad \quad ( 4 )
2025-06-10 20:20:22,274 - DEBUG - Recognized string extracted: H Q = A D D / R E L \ ( c h r i c o n t e x p o s u r e ) \ \ o r \quad \quad ( 4 )
2025-06-10 20:20:22,274 - INFO - All done. Returning 3 recognized text results.
2025-06-10 20:20:22,275 - DEBUG - Snippet 10.1136_bmjopen-2016-013941_722_item_0 recognized text:
A H D = C \times I R / B W
2025-06-10 20:20:22,275 - DEBUG - Snippet 10.1136_bmjopen-2016-013941_722_item_1 recognized text:
A D D = ( C \times I R \times E D ) / ( B W \times A T )
2025-06-10 20:20:22,275 - DEBUG - Snippet 10.1136_bmjopen-2016-013941_722_item_2 recognized text:
H Q = A D D / R E L \ ( c h r i c o n t e x p o s u r e ) \ \ o r \quad \quad ( 4 )
2025-06-10 20:20:22,359 - DEBUG - Creating masked image for page 20 with 10 clusters.
2025-06-10 20:20:22,361 - INFO - Masked image successfully created for page 20.
2025-06-10 20:20:22,371 - INFO - Starting prediction for 5 images with labels: ['formula', 'formula', 'formula', 'formula', 'formula']
2025-06-10 20:20:22,371 - DEBUG - Generating chat message for label: formula
2025-06-10 20:20:22,372 - DEBUG - Snippet 10.1214_10-aoas351_689_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:20:22,371 - INFO - Finished converting document 10.1136_bmjopen-2016-013941_722.pdf in 19.93 sec.
2025-06-10 20:20:22,444 - DEBUG - Snippet 10.1214_10-aoas351_689_item_0 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:20:22,472 - INFO - Extraction successful row 144, tokens=13757
2025-06-10 20:20:22,507 - INFO - Going to convert document batch...
2025-06-10 20:20:22,507 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:20:22,508 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:20:22,526 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:20:22,527 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:20:22,527 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:20:22,566 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:20:22,601 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:22,603 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:20:22,634 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:22,640 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:20:22,657 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:20:22,683 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:20:22,732 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:20:22,769 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:20:22,847 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:22,906 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:20:22,956 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:20:23,002 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:20:23,149 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:20:23,167 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:23,168 - DEBUG - Finished converting page batch time=3975.973
2025-06-10 20:20:23,249 - DEBUG - Finished converting page batch time=3976.054
2025-06-10 20:20:23,348 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:23,428 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:20:23,437 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:20:23,484 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:20:23,492 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:20:23,494 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:23,695 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:20:23,699 - INFO - Processing document 10.3390_atmos14121806_744.pdf
2025-06-10 20:20:24,000 - DEBUG - Snippet 10.1007_s10584-013-0847-8_723_item_1: generation shape=torch.Size([1, 408])
2025-06-10 20:20:24,001 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:24,001 - DEBUG - Snippet 10.1007_s10584-013-0847-8_723_item_1 raw docling: (tokens=62)
<formula><loc_0><loc_0><loc_500><loc_500>Y L L _ { p e r d e a t h } = \frac { Y L L _ { b a s e } } { M o r t _ { b a s e } } .</formula><end_of_utterance>
2025-06-10 20:20:24,001 - DEBUG - Starting _parse_docling_output
2025-06-10 20:20:24,002 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>Y L L _ { p e r d e a t h } = \frac { Y L L _ { b a s e } } { M o r t _ { b a s e } } .</formula><end_of_utterance>
2025-06-10 20:20:24,002 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:20:24,002 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>Y L L _ { p e r d e a t h } = \\frac { Y L L _ { b a s e } } { M o r t _ { b a s e } } .</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=643x112 at 0x7F96A3A9BD10>)]
2025-06-10 20:20:24,002 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:20:24,005 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=643.0, b=112.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 87))], orig='Y L L _ { p e r d e a t h } = \\frac { Y L L _ { b a s e } } { M o r t _ { b a s e } } .', text='Y L L _ { p e r d e a t h } = \\frac { Y L L _ { b a s e } } { M o r t _ { b a s e } } .', formatting=None, hyperlink=None)]
2025-06-10 20:20:24,005 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:20:24,005 - DEBUG - Processing text item: label=formula, text=Y L L _ { p e r d e a t h } = \frac { Y L L _ { b a s e } } { M o r t _ { b a s e } } .
2025-06-10 20:20:24,006 - DEBUG - Recognized string extracted: Y L L _ { p e r d e a t h } = \frac { Y L L _ { b a s e } } { M o r t _ { b a s e } } .
2025-06-10 20:20:24,006 - DEBUG - Generating chat message for label: formula
2025-06-10 20:20:24,006 - DEBUG - Snippet 10.1007_s10584-013-0847-8_723_item_2 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:20:24,020 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:20:24,020 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:20:24,020 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:20:24,050 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:24,056 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:20:24,072 - DEBUG - Snippet 10.1007_s10584-013-0847-8_723_item_2 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:20:24,093 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:20:24,116 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:24,145 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:20:24,181 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:20:24,221 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:20:24,258 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:20:24,384 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:20:24,425 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:20:24,440 - DEBUG - Snippet 10.1214_10-aoas351_689_item_0: generation shape=torch.Size([1, 413])
2025-06-10 20:20:24,440 - DEBUG - Snippet 10.1214_10-aoas351_689_item_0 raw docling: (tokens=67)
<formula><loc_0><loc_0><loc_500><loc_500>\beta _ { i j } ( s , t ) = \gamma _ { i j } \beta _ { i j } ( s , t - 1 ) + \nu _ { i j } ( s , t ) ,</formula><end_of_utterance>
2025-06-10 20:20:24,441 - DEBUG - Starting _parse_docling_output
2025-06-10 20:20:24,441 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>\beta _ { i j } ( s , t ) = \gamma _ { i j } \beta _ { i j } ( s , t - 1 ) + \nu _ { i j } ( s , t ) ,</formula><end_of_utterance>
2025-06-10 20:20:24,441 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:20:24,441 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>\\beta _ { i j } ( s , t ) = \\gamma _ { i j } \\beta _ { i j } ( s , t - 1 ) + \\nu _ { i j } ( s , t ) ,</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=770x102 at 0x7F96B294F5C0>)]
2025-06-10 20:20:24,441 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:20:24,444 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=770.0, b=102.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 102))], orig='\\beta _ { i j } ( s , t ) = \\gamma _ { i j } \\beta _ { i j } ( s , t - 1 ) + \\nu _ { i j } ( s , t ) ,', text='\\beta _ { i j } ( s , t ) = \\gamma _ { i j } \\beta _ { i j } ( s , t - 1 ) + \\nu _ { i j } ( s , t ) ,', formatting=None, hyperlink=None)]
2025-06-10 20:20:24,444 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:20:24,445 - DEBUG - Processing text item: label=formula, text=\beta _ { i j } ( s , t ) = \gamma _ { i j } \beta _ { i j } ( s , t - 1 ) + \nu _ { i j } ( s , t ) ,
2025-06-10 20:20:24,445 - DEBUG - Recognized string extracted: \beta _ { i j } ( s , t ) = \gamma _ { i j } \beta _ { i j } ( s , t - 1 ) + \nu _ { i j } ( s , t ) ,
2025-06-10 20:20:24,445 - DEBUG - Generating chat message for label: formula
2025-06-10 20:20:24,445 - DEBUG - Snippet 10.1214_10-aoas351_689_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:20:24,464 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:20:24,470 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:24,518 - DEBUG - Snippet 10.1214_10-aoas351_689_item_1 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:20:24,571 - DEBUG - Finished converting page batch time=3977.376
2025-06-10 20:20:24,624 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:20:24,932 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:24,938 - DEBUG - Dynamic vertical threshold: 31.0283999999999, Overlap threshold: 0.7
2025-06-10 20:20:24,938 - DEBUG - Checking merge:
  Current: 7, Next: 8
2025-06-10 20:20:24,938 - DEBUG -   Vertical gap: 29.15700000000004, Overlap ratio: 1.0
2025-06-10 20:20:24,938 - DEBUG -   Left boundary diff: 29.737000000000023, Right boundary diff: 3.0890000000000555
2025-06-10 20:20:24,939 - DEBUG -   Alignment factor (ratio): 0.07248347994803288
2025-06-10 20:20:24,939 - DEBUG -   -> c1 7 formula number: OH, c2 8 formula number: OH
2025-06-10 20:20:24,939 - DEBUG -   -> Merging clusters 7 and 8 with vertical gap 29.15700000000004 and overlap ratio 1.0
2025-06-10 20:20:24,939 - DEBUG - Checking merge:
  Current: 8, Next: 11
2025-06-10 20:20:24,939 - DEBUG -   Vertical gap: 18.629999999999995, Overlap ratio: 1.0
2025-06-10 20:20:24,940 - DEBUG -   Left boundary diff: 0.0, Right boundary diff: 2.8110000000000355
2025-06-10 20:20:24,940 - DEBUG -   Alignment factor (ratio): 0.0066099728052880615
2025-06-10 20:20:24,940 - DEBUG -   -> c1 8 formula number: OH, c2 11 formula number: 3
2025-06-10 20:20:24,940 - DEBUG -   -> Not merging clusters 8 and 11 due to different formula numbers: OH vs 3
2025-06-10 20:20:24,940 - DEBUG - Checking merge:
  Current: 10, Next: 9
2025-06-10 20:20:24,940 - DEBUG -   Vertical gap: 29.676000000000045, Overlap ratio: 1.0
2025-06-10 20:20:24,941 - DEBUG -   Left boundary diff: 61.86700000000002, Right boundary diff: 0.0
2025-06-10 20:20:24,941 - DEBUG -   Alignment factor (ratio): 0.23184576843154564
2025-06-10 20:20:24,941 - DEBUG -   -> c1 10 formula number: 4, c2 9 formula number: OH
2025-06-10 20:20:24,941 - DEBUG -   -> Not merging clusters 10 and 9 due to different formula numbers: 4 vs OH
2025-06-10 20:20:24,941 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:24,962 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:20:25,034 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:25,141 - DEBUG - Snippet 10.1038_s41467-024-55450-0_721_item_1: generation shape=torch.Size([1, 724])
2025-06-10 20:20:25,142 - DEBUG - Snippet 10.1038_s41467-024-55450-0_721_item_1 raw docling: (tokens=113)
<formula><loc_0><loc_0><loc_500><loc_500>p = \int _ { \mathcal { O } } \left ( \frac { \mathcal { O } } { q _ { \max } - q _ { \min } } \times ( p _ { \max } - p _ { \min } ) + p _ { \min } \right ) , q _ { \min } < \mathcal { O } \left < q _ { \max } \right ></formula><end_of_utterance>
2025-06-10 20:20:25,143 - DEBUG - Starting _parse_docling_output
2025-06-10 20:20:25,143 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>p = \int _ { \mathcal { O } } \left ( \frac { \mathcal { O } } { q _ { \max } - q _ { \min } } \times ( p _ { \max } - p _ { \min } ) + p _ { \min } \right ) , q _ { \min } < \mathcal { O } \left < q _ { \max } \right ></formula><end_of_utterance>
2025-06-10 20:20:25,143 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:20:25,143 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>p = \\int _ { \\mathcal { O } } \\left ( \\frac { \\mathcal { O } } { q _ { \\max } - q _ { \\min } } \\times ( p _ { \\max } - p _ { \\min } ) + p _ { \\min } \\right ) , q _ { \\min } < \\mathcal { O } \\left < q _ { \\max } \\right ></formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=709x179 at 0x7F96DFFFBF80>)]
2025-06-10 20:20:25,144 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:20:25,148 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=709.0, b=179.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 172))], orig='p = \\int _ { \\mathcal { O } } \\left ( \\frac { \\mathcal { O } } { q _ { \\max } - q _ { \\min } } \\times ( p _ { \\max } - p _ { \\min } ) + p _ { \\min } \\right ) , q _ { \\min }', text='p = \\int _ { \\mathcal { O } } \\left ( \\frac { \\mathcal { O } } { q _ { \\max } - q _ { \\min } } \\times ( p _ { \\max } - p _ { \\min } ) + p _ { \\min } \\right ) , q _ { \\min }', formatting=None, hyperlink=None)]
2025-06-10 20:20:25,149 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:20:25,149 - DEBUG - Processing text item: label=formula, text=p = \int _ { \mathcal { O } } \left ( \frac { \mathcal { O } } { q _ { \max } - q _ { \min } } \times ( p _ { \max } - p _ { \min } ) + p _ { \min } \right ) , q _ { \min }
2025-06-10 20:20:25,149 - DEBUG - Recognized string extracted: p = \int _ { \mathcal { O } } \left ( \frac { \mathcal { O } } { q _ { \max } - q _ { \min } } \times ( p _ { \max } - p _ { \min } ) + p _ { \min } \right ) , q _ { \min }
2025-06-10 20:20:25,149 - DEBUG - Generating chat message for label: formula
2025-06-10 20:20:25,149 - DEBUG - Snippet 10.1038_s41467-024-55450-0_721_item_2 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:20:25,155 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:20:25,156 - INFO - Processing document 10.3390_ijerph120708075_762.pdf
2025-06-10 20:20:25,217 - DEBUG - Snippet 10.1038_s41467-024-55450-0_721_item_2 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:20:25,457 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:25,459 - DEBUG - Snippet 10.1007_s10584-013-0847-8_723_item_2: generation shape=torch.Size([1, 393])
2025-06-10 20:20:25,460 - DEBUG - Snippet 10.1007_s10584-013-0847-8_723_item_2 raw docling: (tokens=47)
<formula><loc_0><loc_0><loc_500><loc_500>\Delta Y L L = \Delta M o r t \times Y L L _ { p e r d e a t h } .</formula><end_of_utterance>
2025-06-10 20:20:25,461 - DEBUG - Starting _parse_docling_output
2025-06-10 20:20:25,461 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>\Delta Y L L = \Delta M o r t \times Y L L _ { p e r d e a t h } .</formula><end_of_utterance>
2025-06-10 20:20:25,461 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:20:25,461 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>\\Delta Y L L = \\Delta M o r t \\times Y L L _ { p e r d e a t h } .</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=683x90 at 0x7F96A3A8DB20>)]
2025-06-10 20:20:25,462 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:20:25,464 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=683.0, b=90.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 66))], orig='\\Delta Y L L = \\Delta M o r t \\times Y L L _ { p e r d e a t h } .', text='\\Delta Y L L = \\Delta M o r t \\times Y L L _ { p e r d e a t h } .', formatting=None, hyperlink=None)]
2025-06-10 20:20:25,465 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:20:25,465 - DEBUG - Processing text item: label=formula, text=\Delta Y L L = \Delta M o r t \times Y L L _ { p e r d e a t h } .
2025-06-10 20:20:25,465 - DEBUG - Recognized string extracted: \Delta Y L L = \Delta M o r t \times Y L L _ { p e r d e a t h } .
2025-06-10 20:20:25,465 - INFO - All done. Returning 3 recognized text results.
2025-06-10 20:20:25,465 - DEBUG - Snippet 10.1007_s10584-013-0847-8_723_item_0 recognized text:
\Delta M o r t = P O P \times M o r t _ { b a s e } \times ( 1 - e ^ { - \beta \times \Delta X } ) ,
2025-06-10 20:20:25,466 - DEBUG - Snippet 10.1007_s10584-013-0847-8_723_item_1 recognized text:
Y L L _ { p e r d e a t h } = \frac { Y L L _ { b a s e } } { M o r t _ { b a s e } } .
2025-06-10 20:20:25,466 - DEBUG - Snippet 10.1007_s10584-013-0847-8_723_item_2 recognized text:
\Delta Y L L = \Delta M o r t \times Y L L _ { p e r d e a t h } .
2025-06-10 20:20:25,479 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:25,551 - INFO - Finished converting document 10.1007_s10584-013-0847-8_723.pdf in 17.60 sec.
2025-06-10 20:20:25,664 - INFO - Extraction successful row 145, tokens=12595
2025-06-10 20:20:25,687 - INFO - Going to convert document batch...
2025-06-10 20:20:25,688 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:20:25,688 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:20:25,741 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:20:25,828 - DEBUG - Dynamic vertical threshold: 31.381199999999946, Overlap threshold: 0.7
2025-06-10 20:20:25,828 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:26,062 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:26,142 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:26,147 - DEBUG - Dynamic vertical threshold: 39.582000000000015, Overlap threshold: 0.7
2025-06-10 20:20:26,147 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:26,213 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:26,495 - DEBUG - [Page 14] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:26,497 - DEBUG - Finished converting page batch time=3979.302
2025-06-10 20:20:26,560 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:20:26,606 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:20:26,613 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:20:26,625 - DEBUG - Dynamic vertical threshold: 56.165400000000005, Overlap threshold: 0.7
2025-06-10 20:20:26,626 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:26,627 - DEBUG - Finished converting page batch time=3979.432
2025-06-10 20:20:26,703 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:26,719 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:26,720 - DEBUG - Finished converting page batch time=3979.525
2025-06-10 20:20:26,874 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:26,975 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:26,976 - DEBUG - Finished converting page batch time=3979.781
2025-06-10 20:20:27,150 - DEBUG - Dynamic vertical threshold: 44.4573, Overlap threshold: 0.7
2025-06-10 20:20:27,151 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:27,250 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:20:27,251 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:20:27,251 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:20:27,295 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:20:27,297 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:27,329 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:20:27,363 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:20:27,488 - DEBUG - [Page 15] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:27,524 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:27,560 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:27,841 - DEBUG - Finished converting page batch time=3980.646
2025-06-10 20:20:27,848 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:27,934 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:28,083 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:28,256 - DEBUG - Snippet 10.1214_10-aoas351_689_item_1: generation shape=torch.Size([1, 480])
2025-06-10 20:20:28,257 - DEBUG - Snippet 10.1214_10-aoas351_689_item_1 raw docling: (tokens=134)
<formula><loc_0><loc_0><loc_500><loc_500>Y _ { i } ( s ) = \tilde { \beta } _ { i 0 } ( s ) + \sum _ { j = 1 } ^ { p } \tilde { \beta } _ { i j } ( s ) x _ { j } ( B ) + \varepsilon _ { i } ( s ) , \quad \varepsilon _ { i } ( s ) \sim \mathcal { N } ( 0 , \tau _ { i } ^ { 2 } ) ,</formula><end_of_utterance>
2025-06-10 20:20:28,257 - DEBUG - Starting _parse_docling_output
2025-06-10 20:20:28,258 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>Y _ { i } ( s ) = \tilde { \beta } _ { i 0 } ( s ) + \sum _ { j = 1 } ^ { p } \tilde { \beta } _ { i j } ( s ) x _ { j } ( B ) + \varepsilon _ { i } ( s ) , \quad \varepsilon _ { i } ( s ) \sim \mathcal { N } ( 0 , \tau _ { i } ^ { 2 } ) ,</formula><end_of_utterance>
2025-06-10 20:20:28,258 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:20:28,258 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>Y _ { i } ( s ) = \\tilde { \\beta } _ { i 0 } ( s ) + \\sum _ { j = 1 } ^ { p } \\tilde { \\beta } _ { i j } ( s ) x _ { j } ( B ) + \\varepsilon _ { i } ( s ) , \\quad \\varepsilon _ { i } ( s ) \\sim \\mathcal { N } ( 0 , \\tau _ { i } ^ { 2 } ) ,</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=954x188 at 0x7F96B2921A90>)]
2025-06-10 20:20:28,258 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:20:28,264 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=954.0, b=188.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 239))], orig='Y _ { i } ( s ) = \\tilde { \\beta } _ { i 0 } ( s ) + \\sum _ { j = 1 } ^ { p } \\tilde { \\beta } _ { i j } ( s ) x _ { j } ( B ) + \\varepsilon _ { i } ( s ) , \\quad \\varepsilon _ { i } ( s ) \\sim \\mathcal { N } ( 0 , \\tau _ { i } ^ { 2 } ) ,', text='Y _ { i } ( s ) = \\tilde { \\beta } _ { i 0 } ( s ) + \\sum _ { j = 1 } ^ { p } \\tilde { \\beta } _ { i j } ( s ) x _ { j } ( B ) + \\varepsilon _ { i } ( s ) , \\quad \\varepsilon _ { i } ( s ) \\sim \\mathcal { N } ( 0 , \\tau _ { i } ^ { 2 } ) ,', formatting=None, hyperlink=None)]
2025-06-10 20:20:28,264 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:20:28,264 - DEBUG - Processing text item: label=formula, text=Y _ { i } ( s ) = \tilde { \beta } _ { i 0 } ( s ) + \sum _ { j = 1 } ^ { p } \tilde { \beta } _ { i j } ( s ) x _ { j } ( B ) + \varepsilon _ { i } ( s ) , \quad \varepsilon _ { i } ( s ) \sim \mathcal { N } ( 0 , \tau _ { i } ^ { 2 } ) ,
2025-06-10 20:20:28,265 - DEBUG - Recognized string extracted: Y _ { i } ( s ) = \tilde { \beta } _ { i 0 } ( s ) + \sum _ { j = 1 } ^ { p } \tilde { \beta } _ { i j } ( s ) x _ { j } ( B ) + \varepsilon _ { i } ( s ) , \quad \varepsilon _ { i } ( s ) \sim \mathcal { N } ( 0 , \tau _ { i } ^ { 2 } ) ,
2025-06-10 20:20:28,265 - DEBUG - Generating chat message for label: formula
2025-06-10 20:20:28,265 - DEBUG - Snippet 10.1214_10-aoas351_689_item_2 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:20:28,308 - DEBUG - [Page 16] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:28,349 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:28,418 - DEBUG - Snippet 10.1214_10-aoas351_689_item_2 => input_ids shape=torch.Size([1, 610]), prompt_len=610
2025-06-10 20:20:28,560 - DEBUG - Snippet 10.1038_s41467-024-55450-0_721_item_2: generation shape=torch.Size([1, 458])
2025-06-10 20:20:28,561 - DEBUG - Snippet 10.1038_s41467-024-55450-0_721_item_2 raw docling: (tokens=112)
<formula><loc_0><loc_0><loc_500><loc_500>V L _ { 0 3 } = \frac { 1 } { N } \sum _ { n = 1 } ^ { N } F _ { V L n } ( V _ { T H C H O } , V _ { T N O 2 } , V _ { C A M S } , V _ { E S R I } , V _ { E M F } , V _ { T C } )</formula><end_of_utterance>
2025-06-10 20:20:28,561 - DEBUG - Starting _parse_docling_output
2025-06-10 20:20:28,562 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>V L _ { 0 3 } = \frac { 1 } { N } \sum _ { n = 1 } ^ { N } F _ { V L n } ( V _ { T H C H O } , V _ { T N O 2 } , V _ { C A M S } , V _ { E S R I } , V _ { E M F } , V _ { T C } )</formula><end_of_utterance>
2025-06-10 20:20:28,562 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:20:28,562 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>V L _ { 0 3 } = \\frac { 1 } { N } \\sum _ { n = 1 } ^ { N } F _ { V L n } ( V _ { T H C H O } , V _ { T N O 2 } , V _ { C A M S } , V _ { E S R I } , V _ { E M F } , V _ { T C } )</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=686x120 at 0x7F96DFF39C70>)]
2025-06-10 20:20:28,562 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:20:28,566 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=686.0, b=120.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 178))], orig='V L _ { 0 3 } = \\frac { 1 } { N } \\sum _ { n = 1 } ^ { N } F _ { V L n } ( V _ { T H C H O } , V _ { T N O 2 } , V _ { C A M S } , V _ { E S R I } , V _ { E M F } , V _ { T C } )', text='V L _ { 0 3 } = \\frac { 1 } { N } \\sum _ { n = 1 } ^ { N } F _ { V L n } ( V _ { T H C H O } , V _ { T N O 2 } , V _ { C A M S } , V _ { E S R I } , V _ { E M F } , V _ { T C } )', formatting=None, hyperlink=None)]
2025-06-10 20:20:28,566 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:20:28,566 - DEBUG - Processing text item: label=formula, text=V L _ { 0 3 } = \frac { 1 } { N } \sum _ { n = 1 } ^ { N } F _ { V L n } ( V _ { T H C H O } , V _ { T N O 2 } , V _ { C A M S } , V _ { E S R I } , V _ { E M F } , V _ { T C } )
2025-06-10 20:20:28,566 - DEBUG - Recognized string extracted: V L _ { 0 3 } = \frac { 1 } { N } \sum _ { n = 1 } ^ { N } F _ { V L n } ( V _ { T H C H O } , V _ { T N O 2 } , V _ { C A M S } , V _ { E S R I } , V _ { E M F } , V _ { T C } )
2025-06-10 20:20:28,567 - DEBUG - Generating chat message for label: formula
2025-06-10 20:20:28,567 - DEBUG - Snippet 10.1038_s41467-024-55450-0_721_item_3 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:20:28,635 - DEBUG - Snippet 10.1038_s41467-024-55450-0_721_item_3 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:20:28,825 - DEBUG - [Page 14] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:29,038 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:29,135 - DEBUG - [Page 15] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:29,136 - DEBUG - Finished converting page batch time=3981.941
2025-06-10 20:20:29,268 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:29,269 - DEBUG - Finished converting page batch time=3982.074
2025-06-10 20:20:29,291 - DEBUG - Creating masked image for page 3 with 13 clusters.
2025-06-10 20:20:29,292 - INFO - Masked image successfully created for page 3.
2025-06-10 20:20:29,401 - DEBUG - Creating masked image for page 4 with 16 clusters.
2025-06-10 20:20:29,402 - INFO - Masked image successfully created for page 4.
2025-06-10 20:20:29,406 - DEBUG - [Page 17] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:29,412 - INFO - Starting prediction for 5 images with labels: ['formula', 'formula', 'formula', 'formula', 'formula']
2025-06-10 20:20:29,412 - DEBUG - Generating chat message for label: formula
2025-06-10 20:20:29,412 - DEBUG - Snippet 10.3390_ijerph15040736_730_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:20:29,479 - DEBUG - Snippet 10.3390_ijerph15040736_730_item_0 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:20:29,852 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:29,880 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:28,101 - DEBUG - Finished converting page batch time=3983.082
2025-06-10 20:20:28,157 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:20:28,204 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:20:28,239 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:20:28,388 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:20:28,399 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:28,426 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:20:28,466 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:20:28,514 - DEBUG - [Page 18] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:28,515 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:28,516 - DEBUG - Finished converting page batch time=3983.497
2025-06-10 20:20:28,535 - DEBUG - Snippet 10.1038_s41467-024-55450-0_721_item_3: generation shape=torch.Size([1, 410])
2025-06-10 20:20:28,537 - DEBUG - Snippet 10.1038_s41467-024-55450-0_721_item_3 raw docling: (tokens=64)
<formula><loc_0><loc_0><loc_500><loc_500>V W _ { 0 3 } = V G _ { 0 3 } \times w _ { 1 } + V L _ { 0 3 } \times w _ { 2 }</formula><end_of_utterance>
2025-06-10 20:20:28,537 - DEBUG - Starting _parse_docling_output
2025-06-10 20:20:28,537 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>V W _ { 0 3 } = V G _ { 0 3 } \times w _ { 1 } + V L _ { 0 3 } \times w _ { 2 }</formula><end_of_utterance>
2025-06-10 20:20:28,537 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:20:28,538 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>V W _ { 0 3 } = V G _ { 0 3 } \\times w _ { 1 } + V L _ { 0 3 } \\times w _ { 2 }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=537x73 at 0x7F96C3E36F30>)]
2025-06-10 20:20:28,538 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:20:28,540 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=537.0, b=73.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 79))], orig='V W _ { 0 3 } = V G _ { 0 3 } \\times w _ { 1 } + V L _ { 0 3 } \\times w _ { 2 }', text='V W _ { 0 3 } = V G _ { 0 3 } \\times w _ { 1 } + V L _ { 0 3 } \\times w _ { 2 }', formatting=None, hyperlink=None)]
2025-06-10 20:20:28,540 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:20:28,541 - DEBUG - Processing text item: label=formula, text=V W _ { 0 3 } = V G _ { 0 3 } \times w _ { 1 } + V L _ { 0 3 } \times w _ { 2 }
2025-06-10 20:20:28,541 - DEBUG - Recognized string extracted: V W _ { 0 3 } = V G _ { 0 3 } \times w _ { 1 } + V L _ { 0 3 } \times w _ { 2 }
2025-06-10 20:20:28,541 - DEBUG - Generating chat message for label: formula
2025-06-10 20:20:28,541 - DEBUG - Snippet 10.1038_s41467-024-55450-0_721_item_4 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:20:28,583 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:28,614 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:20:28,668 - DEBUG - Snippet 10.1038_s41467-024-55450-0_721_item_4 => input_ids shape=torch.Size([1, 610]), prompt_len=610
2025-06-10 20:20:29,077 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:29,095 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:20:29,171 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:29,281 - DEBUG - Snippet 10.3390_ijerph15040736_730_item_0: generation shape=torch.Size([1, 408])
2025-06-10 20:20:29,282 - DEBUG - Snippet 10.3390_ijerph15040736_730_item_0 raw docling: (tokens=62)
<formula><loc_0><loc_0><loc_500><loc_500>P W C _ { a d j } = P W C _ { p r e d } + \left ( C _ { o b s } - C _ { p r e d } \right )</formula><end_of_utterance>
2025-06-10 20:20:29,282 - DEBUG - Starting _parse_docling_output
2025-06-10 20:20:29,283 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>P W C _ { a d j } = P W C _ { p r e d } + \left ( C _ { o b s } - C _ { p r e d } \right )</formula><end_of_utterance>
2025-06-10 20:20:29,283 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:20:29,283 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>P W C _ { a d j } = P W C _ { p r e d } + \\left ( C _ { o b s } - C _ { p r e d } \\right )</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=892x81 at 0x7F971C65F9E0>)]
2025-06-10 20:20:29,283 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:20:29,286 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=892.0, b=81.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 90))], orig='P W C _ { a d j } = P W C _ { p r e d } + \\left ( C _ { o b s } - C _ { p r e d } \\right )', text='P W C _ { a d j } = P W C _ { p r e d } + \\left ( C _ { o b s } - C _ { p r e d } \\right )', formatting=None, hyperlink=None)]
2025-06-10 20:20:29,287 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:20:29,287 - DEBUG - Processing text item: label=formula, text=P W C _ { a d j } = P W C _ { p r e d } + \left ( C _ { o b s } - C _ { p r e d } \right )
2025-06-10 20:20:29,287 - DEBUG - Recognized string extracted: P W C _ { a d j } = P W C _ { p r e d } + \left ( C _ { o b s } - C _ { p r e d } \right )
2025-06-10 20:20:29,287 - DEBUG - Generating chat message for label: formula
2025-06-10 20:20:29,288 - DEBUG - Snippet 10.3390_ijerph15040736_730_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:20:29,288 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:20:29,289 - INFO - Processing document 10.1136_bmj-2023-077784_764.pdf
2025-06-10 20:20:29,355 - DEBUG - Snippet 10.3390_ijerph15040736_730_item_1 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:20:29,438 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:29,777 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:29,921 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:29,993 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:30,140 - DEBUG - [Page 14] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:30,140 - DEBUG - Finished converting page batch time=3985.120
2025-06-10 20:20:30,233 - DEBUG - Snippet 10.1214_10-aoas351_689_item_2: generation shape=torch.Size([1, 755])
2025-06-10 20:20:30,234 - DEBUG - Snippet 10.1214_10-aoas351_689_item_2 raw docling: (tokens=144)
<formula><loc_0><loc_0><loc_500><loc_500>Y _ { i } ( s , t ) = \tilde { \beta } _ { i 0 } ( s , t ) + \sum _ { j = 1 } ^ { p } \tilde { \beta } _ { i j } ( s , t ) x _ { j } ( B , t ) \\ + \varepsilon _ { i } ( s , t ) , \quad \quad \varepsilon _ { i } ( s , t ) \sim N ( 0 , \tau _ { i } ^ { 2 } ) ,</formula><end_of_utterance>
2025-06-10 20:20:30,234 - DEBUG - Starting _parse_docling_output
2025-06-10 20:20:30,234 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>Y _ { i } ( s , t ) = \tilde { \beta } _ { i 0 } ( s , t ) + \sum _ { j = 1 } ^ { p } \tilde { \beta } _ { i j } ( s , t ) x _ { j } ( B , t ) \\ + \varepsilon _ { i } ( s , t ) , \quad \quad \varepsilon _ { i } ( s , t ) \sim N ( 0 , \tau _ { i } ^ { 2 } ) ,</formula><end_of_utterance>
2025-06-10 20:20:30,235 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:20:30,235 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>Y _ { i } ( s , t ) = \\tilde { \\beta } _ { i 0 } ( s , t ) + \\sum _ { j = 1 } ^ { p } \\tilde { \\beta } _ { i j } ( s , t ) x _ { j } ( B , t ) \\\\ + \\varepsilon _ { i } ( s , t ) , \\quad \\quad \\varepsilon _ { i } ( s , t ) \\sim N ( 0 , \\tau _ { i } ^ { 2 } ) ,</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=833x304 at 0x7F96B2921100>)]
2025-06-10 20:20:30,235 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:20:30,242 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=833.0, b=304.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 259))], orig='Y _ { i } ( s , t ) = \\tilde { \\beta } _ { i 0 } ( s , t ) + \\sum _ { j = 1 } ^ { p } \\tilde { \\beta } _ { i j } ( s , t ) x _ { j } ( B , t ) \\\\ + \\varepsilon _ { i } ( s , t ) , \\quad \\quad \\varepsilon _ { i } ( s , t ) \\sim N ( 0 , \\tau _ { i } ^ { 2 } ) ,', text='Y _ { i } ( s , t ) = \\tilde { \\beta } _ { i 0 } ( s , t ) + \\sum _ { j = 1 } ^ { p } \\tilde { \\beta } _ { i j } ( s , t ) x _ { j } ( B , t ) \\\\ + \\varepsilon _ { i } ( s , t ) , \\quad \\quad \\varepsilon _ { i } ( s , t ) \\sim N ( 0 , \\tau _ { i } ^ { 2 } ) ,', formatting=None, hyperlink=None)]
2025-06-10 20:20:30,242 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:20:30,243 - DEBUG - Processing text item: label=formula, text=Y _ { i } ( s , t ) = \tilde { \beta } _ { i 0 } ( s , t ) + \sum _ { j = 1 } ^ { p } \tilde { \beta } _ { i j } ( s , t ) x _ { j } ( B , t ) \\ + \varepsilon _ { i } ( s , t ) , \quad \quad \varepsilon _ { i } ( s , t ) \sim N ( 0 , \tau _ { i } ^ { 2 } ) ,
2025-06-10 20:20:30,243 - DEBUG - Recognized string extracted: Y _ { i } ( s , t ) = \tilde { \beta } _ { i 0 } ( s , t ) + \sum _ { j = 1 } ^ { p } \tilde { \beta } _ { i j } ( s , t ) x _ { j } ( B , t ) \\ + \varepsilon _ { i } ( s , t ) , \quad \quad \varepsilon _ { i } ( s , t ) \sim N ( 0 , \tau _ { i } ^ { 2 } ) ,
2025-06-10 20:20:30,243 - DEBUG - Generating chat message for label: formula
2025-06-10 20:20:30,243 - DEBUG - Snippet 10.1214_10-aoas351_689_item_3 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:20:30,251 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:30,253 - DEBUG - Dynamic vertical threshold: 29.433599999999956, Overlap threshold: 0.7
2025-06-10 20:20:30,253 - DEBUG - Checking merge:
  Current: 8, Next: 7
2025-06-10 20:20:30,253 - DEBUG -   Vertical gap: 6.662000000000035, Overlap ratio: 1.0
2025-06-10 20:20:30,253 - DEBUG -   Left boundary diff: 7.043000000000006, Right boundary diff: 0.0
2025-06-10 20:20:30,254 - DEBUG -   Alignment factor (ratio): 0.02823971884579224
2025-06-10 20:20:30,254 - DEBUG -   -> c1 8 formula number: 8, c2 7 formula number: 9
2025-06-10 20:20:30,254 - DEBUG -   -> Not merging clusters 8 and 7 due to different formula numbers: 8 vs 9
2025-06-10 20:20:30,254 - DEBUG - Checking merge:
  Current: 10, Next: 12
2025-06-10 20:20:30,254 - DEBUG -   Vertical gap: 7.8419999999999845, Overlap ratio: 1.0
2025-06-10 20:20:30,255 - DEBUG -   Left boundary diff: 12.375999999999976, Right boundary diff: 0.0
2025-06-10 20:20:30,255 - DEBUG -   Alignment factor (ratio): 0.0413462245177498
2025-06-10 20:20:30,255 - DEBUG -   -> c1 10 formula number: 10, c2 12 formula number: 11
2025-06-10 20:20:30,255 - DEBUG -   -> Not merging clusters 10 and 12 due to different formula numbers: 10 vs 11
2025-06-10 20:20:30,255 - DEBUG - Checking merge:
  Current: 10, Next: 13
2025-06-10 20:20:30,256 - DEBUG -   Vertical gap: 26.67199999999997, Overlap ratio: 1.0
2025-06-10 20:20:30,256 - DEBUG -   Left boundary diff: 24.048000000000002, Right boundary diff: 0.0
2025-06-10 20:20:30,256 - DEBUG -   Alignment factor (ratio): 0.0819380558111009
2025-06-10 20:20:30,256 - DEBUG -   -> c1 10 formula number: 10, c2 13 formula number: 12
2025-06-10 20:20:30,256 - DEBUG -   -> Not merging clusters 10 and 13 due to different formula numbers: 10 vs 12
2025-06-10 20:20:30,256 - DEBUG - Checking merge:
  Current: 12, Next: 13
2025-06-10 20:20:30,257 - DEBUG -   Vertical gap: 2.4780000000000086, Overlap ratio: 1.0
2025-06-10 20:20:30,257 - DEBUG -   Left boundary diff: 11.672000000000025, Right boundary diff: 0.0
2025-06-10 20:20:30,257 - DEBUG -   Alignment factor (ratio): 0.040626239984406745
2025-06-10 20:20:30,257 - DEBUG -   -> c1 12 formula number: 11, c2 13 formula number: 12
2025-06-10 20:20:30,257 - DEBUG -   -> Not merging clusters 12 and 13 due to different formula numbers: 11 vs 12
2025-06-10 20:20:30,258 - DEBUG - Checking merge:
  Current: 12, Next: 14
2025-06-10 20:20:30,258 - DEBUG -   Vertical gap: 21.307000000000016, Overlap ratio: 1.0
2025-06-10 20:20:30,258 - DEBUG -   Left boundary diff: 10.56499999999997, Right boundary diff: 0.0
2025-06-10 20:20:30,258 - DEBUG -   Alignment factor (ratio): 0.03540306379756073
2025-06-10 20:20:30,258 - DEBUG -   -> c1 12 formula number: 11, c2 14 formula number: 13
2025-06-10 20:20:30,258 - DEBUG -   -> Not merging clusters 12 and 14 due to different formula numbers: 11 vs 13
2025-06-10 20:20:30,259 - DEBUG - Checking merge:
  Current: 13, Next: 14
2025-06-10 20:20:30,259 - DEBUG -   Vertical gap: 2.4780000000000086, Overlap ratio: 1.0
2025-06-10 20:20:30,259 - DEBUG -   Left boundary diff: 22.236999999999995, Right boundary diff: 0.0
2025-06-10 20:20:30,259 - DEBUG -   Alignment factor (ratio): 0.07600197549767673
2025-06-10 20:20:30,259 - DEBUG -   -> c1 13 formula number: 12, c2 14 formula number: 13
2025-06-10 20:20:30,259 - DEBUG -   -> Not merging clusters 13 and 14 due to different formula numbers: 12 vs 13
2025-06-10 20:20:30,260 - DEBUG - Checking merge:
  Current: 13, Next: 11
2025-06-10 20:20:30,260 - DEBUG -   Vertical gap: 23.721000000000004, Overlap ratio: 1.0
2025-06-10 20:20:30,260 - DEBUG -   Left boundary diff: 39.113999999999976, Right boundary diff: 0.0
2025-06-10 20:20:30,260 - DEBUG -   Alignment factor (ratio): 0.14934194701213008
2025-06-10 20:20:30,260 - DEBUG -   -> c1 13 formula number: 12, c2 11 formula number: 14
2025-06-10 20:20:30,261 - DEBUG -   -> Not merging clusters 13 and 11 due to different formula numbers: 12 vs 14
2025-06-10 20:20:30,261 - DEBUG - Checking merge:
  Current: 14, Next: 11
2025-06-10 20:20:30,261 - DEBUG -   Vertical gap: 4.8910000000000196, Overlap ratio: 1.0
2025-06-10 20:20:30,261 - DEBUG -   Left boundary diff: 61.35099999999997, Right boundary diff: 0.0
2025-06-10 20:20:30,261 - DEBUG -   Alignment factor (ratio): 0.22470630247868795
2025-06-10 20:20:30,262 - DEBUG -   -> c1 14 formula number: 13, c2 11 formula number: 14
2025-06-10 20:20:30,262 - DEBUG -   -> Not merging clusters 14 and 11 due to different formula numbers: 13 vs 14
2025-06-10 20:20:30,262 - DEBUG - [Page 19] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:30,264 - DEBUG - Finished converting page batch time=3985.244
2025-06-10 20:20:30,273 - INFO - Finished converting document 10.5194_acp-19-13367-2019_742.pdf in 15.98 sec.
2025-06-10 20:20:30,316 - DEBUG - Snippet 10.1214_10-aoas351_689_item_3 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:20:30,375 - INFO - Extraction successful row 148, tokens=15087
2025-06-10 20:20:30,396 - INFO - Going to convert document batch...
2025-06-10 20:20:30,396 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:20:30,396 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:20:30,434 - DEBUG - [Page 20] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:30,449 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:20:30,964 - DEBUG - Snippet 10.1038_s41467-024-55450-0_721_item_4: generation shape=torch.Size([1, 677])
2025-06-10 20:20:30,965 - DEBUG - Snippet 10.1038_s41467-024-55450-0_721_item_4 raw docling: (tokens=66)
<formula><loc_0><loc_0><loc_500><loc_500>w _ { 1 } = \frac { l _ { 1 } ^ { 2 } } { l _ { 1 } ^ { 2 } + l _ { 2 } ^ { 2 } }</formula><end_of_utterance>
2025-06-10 20:20:30,966 - DEBUG - Starting _parse_docling_output
2025-06-10 20:20:30,966 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>w _ { 1 } = \frac { l _ { 1 } ^ { 2 } } { l _ { 1 } ^ { 2 } + l _ { 2 } ^ { 2 } }</formula><end_of_utterance>
2025-06-10 20:20:30,966 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:20:30,966 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>w _ { 1 } = \\frac { l _ { 1 } ^ { 2 } } { l _ { 1 } ^ { 2 } + l _ { 2 } ^ { 2 } }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=432x123 at 0x7F96C3E37A10>)]
2025-06-10 20:20:30,967 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:20:30,969 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=432.0, b=123.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 81))], orig='w _ { 1 } = \\frac { l _ { 1 } ^ { 2 } } { l _ { 1 } ^ { 2 } + l _ { 2 } ^ { 2 } }', text='w _ { 1 } = \\frac { l _ { 1 } ^ { 2 } } { l _ { 1 } ^ { 2 } + l _ { 2 } ^ { 2 } }', formatting=None, hyperlink=None)]
2025-06-10 20:20:30,969 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:20:30,970 - DEBUG - Processing text item: label=formula, text=w _ { 1 } = \frac { l _ { 1 } ^ { 2 } } { l _ { 1 } ^ { 2 } + l _ { 2 } ^ { 2 } }
2025-06-10 20:20:30,970 - DEBUG - Recognized string extracted: w _ { 1 } = \frac { l _ { 1 } ^ { 2 } } { l _ { 1 } ^ { 2 } + l _ { 2 } ^ { 2 } }
2025-06-10 20:20:30,970 - INFO - All done. Returning 5 recognized text results.
2025-06-10 20:20:30,970 - DEBUG - Snippet 10.1038_s41467-024-55450-0_721_item_0 recognized text:
V G _ { 0 3 } = F _ { G } ( V _ { T H C H O } , V _ { T N O 2 } , V _ { C A M S } , V _ { E S R I } , V _ { E M F } , V _ { G E } , V _ { T C } )
2025-06-10 20:20:30,971 - DEBUG - Snippet 10.1038_s41467-024-55450-0_721_item_1 recognized text:
p = \int _ { \mathcal { O } } \left ( \frac { \mathcal { O } } { q _ { \max } - q _ { \min } } \times ( p _ { \max } - p _ { \min } ) + p _ { \min } \right ) , q _ { \min }
2025-06-10 20:20:30,971 - DEBUG - Snippet 10.1038_s41467-024-55450-0_721_item_2 recognized text:
V L _ { 0 3 } = \frac { 1 } { N } \sum _ { n = 1 } ^ { N } F _ { V L n } ( V _ { T H C H O } , V _ { T N O 2 } , V _ { C A M S } , V _ { E S R I } , V _ { E M F } , V _ { T C } )
2025-06-10 20:20:30,971 - DEBUG - Snippet 10.1038_s41467-024-55450-0_721_item_3 recognized text:
V W _ { 0 3 } = V G _ { 0 3 } \times w _ { 1 } + V L _ { 0 3 } \times w _ { 2 }
2025-06-10 20:20:30,971 - DEBUG - Snippet 10.1038_s41467-024-55450-0_721_item_4 recognized text:
w _ { 1 } = \frac { l _ { 1 } ^ { 2 } } { l _ { 1 } ^ { 2 } + l _ { 2 } ^ { 2 } }
2025-06-10 20:20:30,980 - INFO - Starting prediction for 5 images with labels: ['formula', 'formula', 'formula', 'formula', 'formula']
2025-06-10 20:20:30,980 - DEBUG - Generating chat message for label: formula
2025-06-10 20:20:30,980 - DEBUG - Snippet 10.1038_s41467-024-55450-0_721_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:20:31,106 - DEBUG - Snippet 10.1038_s41467-024-55450-0_721_item_0 => input_ids shape=torch.Size([1, 610]), prompt_len=610
2025-06-10 20:20:31,122 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:31,299 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:31,336 - DEBUG - [Page 21] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:31,385 - DEBUG - Snippet 10.3390_ijerph15040736_730_item_1: generation shape=torch.Size([1, 412])
2025-06-10 20:20:31,386 - DEBUG - Snippet 10.3390_ijerph15040736_730_item_1 raw docling: (tokens=66)
<formula><loc_0><loc_0><loc_500><loc_500>P W S D _ { a d j } = P W S D _ { p r e d } \times \frac { S D _ { o b s } } { S D _ { p r e d } }</formula><end_of_utterance>
2025-06-10 20:20:31,387 - DEBUG - Starting _parse_docling_output
2025-06-10 20:20:31,387 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>P W S D _ { a d j } = P W S D _ { p r e d } \times \frac { S D _ { o b s } } { S D _ { p r e d } }</formula><end_of_utterance>
2025-06-10 20:20:31,387 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:20:31,387 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>P W S D _ { a d j } = P W S D _ { p r e d } \\times \\frac { S D _ { o b s } } { S D _ { p r e d } }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=866x121 at 0x7F971C65C350>)]
2025-06-10 20:20:31,387 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:20:31,391 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=866.0, b=121.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 98))], orig='P W S D _ { a d j } = P W S D _ { p r e d } \\times \\frac { S D _ { o b s } } { S D _ { p r e d } }', text='P W S D _ { a d j } = P W S D _ { p r e d } \\times \\frac { S D _ { o b s } } { S D _ { p r e d } }', formatting=None, hyperlink=None)]
2025-06-10 20:20:31,392 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:20:31,392 - DEBUG - Processing text item: label=formula, text=P W S D _ { a d j } = P W S D _ { p r e d } \times \frac { S D _ { o b s } } { S D _ { p r e d } }
2025-06-10 20:20:31,392 - DEBUG - Recognized string extracted: P W S D _ { a d j } = P W S D _ { p r e d } \times \frac { S D _ { o b s } } { S D _ { p r e d } }
2025-06-10 20:20:31,392 - DEBUG - Generating chat message for label: formula
2025-06-10 20:20:31,393 - DEBUG - Snippet 10.3390_ijerph15040736_730_item_2 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:20:31,405 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:20:31,455 - DEBUG - Snippet 10.3390_ijerph15040736_730_item_2 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:20:31,460 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:20:31,466 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:20:31,483 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:31,659 - DEBUG - Finished converting page batch time=3986.639
2025-06-10 20:20:31,974 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:31,976 - DEBUG - Finished converting page batch time=3986.956
2025-06-10 20:20:32,223 - DEBUG - [Page 12] Keeping cluster 0 as table (area ratio: 0.72, cells: 426, density: 0.001188).
2025-06-10 20:20:32,224 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:32,255 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:20:32,256 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:20:32,256 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:20:32,291 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:20:32,327 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:20:32,363 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:20:32,399 - DEBUG - [Page 22] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:32,405 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:20:32,451 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:20:32,496 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:20:32,498 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:32,560 - DEBUG - Snippet 10.3390_ijerph15040736_730_item_2: generation shape=torch.Size([1, 380])
2025-06-10 20:20:32,561 - DEBUG - Snippet 10.3390_ijerph15040736_730_item_2 raw docling: (tokens=34)
<formula><loc_0><loc_0><loc_500><loc_500>A B = P A F \times B _ { 0 } D</formula><end_of_utterance>
2025-06-10 20:20:32,561 - DEBUG - Starting _parse_docling_output
2025-06-10 20:20:32,561 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>A B = P A F \times B _ { 0 } D</formula><end_of_utterance>
2025-06-10 20:20:32,561 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:20:32,562 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>A B = P A F \\times B _ { 0 } D</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=765x56 at 0x7F971C65E6F0>)]
2025-06-10 20:20:32,562 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:20:32,564 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=765.0, b=56.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 30))], orig='A B = P A F \\times B _ { 0 } D', text='A B = P A F \\times B _ { 0 } D', formatting=None, hyperlink=None)]
2025-06-10 20:20:32,564 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:20:32,564 - DEBUG - Processing text item: label=formula, text=A B = P A F \times B _ { 0 } D
2025-06-10 20:20:32,565 - DEBUG - Recognized string extracted: A B = P A F \times B _ { 0 } D
2025-06-10 20:20:32,565 - DEBUG - Generating chat message for label: formula
2025-06-10 20:20:32,565 - DEBUG - Snippet 10.3390_ijerph15040736_730_item_3 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:20:32,633 - DEBUG - Snippet 10.3390_ijerph15040736_730_item_3 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:20:32,692 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:20:32,737 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:20:32,774 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:20:32,816 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:32,887 - DEBUG - Dynamic vertical threshold: 29.433599999999956, Overlap threshold: 0.7
2025-06-10 20:20:32,887 - DEBUG - [Page 23] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:32,888 - DEBUG - Finished converting page batch time=3987.868
2025-06-10 20:20:32,922 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:20:33,100 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:33,177 - DEBUG - Dynamic vertical threshold: 29.4318, Overlap threshold: 0.7
2025-06-10 20:20:33,178 - DEBUG - Checking merge:
  Current: 8, Next: 14
2025-06-10 20:20:33,178 - DEBUG -   Vertical gap: 2.4780000000000655, Overlap ratio: 1.0
2025-06-10 20:20:33,178 - DEBUG -   Left boundary diff: 15.064000000000021, Right boundary diff: 0.0
2025-06-10 20:20:33,178 - DEBUG -   Alignment factor (ratio): 0.05975975499452556
2025-06-10 20:20:33,178 - DEBUG -   -> c1 8 formula number: 16, c2 14 formula number: 17
2025-06-10 20:20:33,179 - DEBUG -   -> Not merging clusters 8 and 14 due to different formula numbers: 16 vs 17
2025-06-10 20:20:33,179 - DEBUG - Checking merge:
  Current: 8, Next: 11
2025-06-10 20:20:33,179 - DEBUG -   Vertical gap: 21.307000000000016, Overlap ratio: 1.0
2025-06-10 20:20:33,179 - DEBUG -   Left boundary diff: 18.61500000000001, Right boundary diff: 0.0
2025-06-10 20:20:33,180 - DEBUG -   Alignment factor (ratio): 0.07437060653094985
2025-06-10 20:20:33,180 - DEBUG -   -> c1 8 formula number: 16, c2 11 formula number: 18
2025-06-10 20:20:33,180 - DEBUG -   -> Not merging clusters 8 and 11 due to different formula numbers: 16 vs 18
2025-06-10 20:20:33,180 - DEBUG - Checking merge:
  Current: 14, Next: 11
2025-06-10 20:20:33,180 - DEBUG -   Vertical gap: 2.477999999999952, Overlap ratio: 1.0
2025-06-10 20:20:33,181 - DEBUG -   Left boundary diff: 3.5509999999999877, Right boundary diff: 0.0
2025-06-10 20:20:33,181 - DEBUG -   Alignment factor (ratio): 0.01462710359869583
2025-06-10 20:20:33,181 - DEBUG -   -> c1 14 formula number: 17, c2 11 formula number: 18
2025-06-10 20:20:33,181 - DEBUG -   -> Not merging clusters 14 and 11 due to different formula numbers: 17 vs 18
2025-06-10 20:20:33,181 - DEBUG - Checking merge:
  Current: 14, Next: 9
2025-06-10 20:20:33,181 - DEBUG -   Vertical gap: 21.307999999999993, Overlap ratio: 1.0
2025-06-10 20:20:33,182 - DEBUG -   Left boundary diff: 6.775000000000034, Right boundary diff: 0.0
2025-06-10 20:20:33,182 - DEBUG -   Alignment factor (ratio): 0.027326096119291158
2025-06-10 20:20:33,182 - DEBUG -   -> c1 14 formula number: 17, c2 9 formula number: 19
2025-06-10 20:20:33,182 - DEBUG -   -> Not merging clusters 14 and 9 due to different formula numbers: 17 vs 19
2025-06-10 20:20:33,182 - DEBUG - Checking merge:
  Current: 11, Next: 9
2025-06-10 20:20:33,183 - DEBUG -   Vertical gap: 2.477999999999952, Overlap ratio: 1.0
2025-06-10 20:20:33,183 - DEBUG -   Left boundary diff: 10.326000000000022, Right boundary diff: 0.0
2025-06-10 20:20:33,183 - DEBUG -   Alignment factor (ratio): 0.04194900794618057
2025-06-10 20:20:33,183 - DEBUG -   -> c1 11 formula number: 18, c2 9 formula number: 19
2025-06-10 20:20:33,183 - DEBUG -   -> Not merging clusters 11 and 9 due to different formula numbers: 18 vs 19
2025-06-10 20:20:33,183 - DEBUG - Checking merge:
  Current: 11, Next: 15
2025-06-10 20:20:33,184 - DEBUG -   Vertical gap: 21.306999999999903, Overlap ratio: 1.0
2025-06-10 20:20:33,184 - DEBUG -   Left boundary diff: 0.0, Right boundary diff: 0.0
2025-06-10 20:20:33,184 - DEBUG -   Alignment factor (ratio): 0.0
2025-06-10 20:20:33,184 - DEBUG -   -> c1 11 formula number: 18, c2 15 formula number: 20
2025-06-10 20:20:33,184 - DEBUG -   -> Not merging clusters 11 and 15 due to different formula numbers: 18 vs 20
2025-06-10 20:20:33,185 - DEBUG - Checking merge:
  Current: 9, Next: 15
2025-06-10 20:20:33,185 - DEBUG -   Vertical gap: 2.477999999999952, Overlap ratio: 1.0
2025-06-10 20:20:33,185 - DEBUG -   Left boundary diff: 10.326000000000022, Right boundary diff: 0.0
2025-06-10 20:20:33,185 - DEBUG -   Alignment factor (ratio): 0.04194900794618057
2025-06-10 20:20:33,185 - DEBUG -   -> c1 9 formula number: 19, c2 15 formula number: 20
2025-06-10 20:20:33,185 - DEBUG -   -> Not merging clusters 9 and 15 due to different formula numbers: 19 vs 20
2025-06-10 20:20:33,186 - DEBUG - Checking merge:
  Current: 9, Next: 10
2025-06-10 20:20:33,186 - DEBUG -   Vertical gap: 23.721000000000004, Overlap ratio: 1.0
2025-06-10 20:20:33,186 - DEBUG -   Left boundary diff: 12.240000000000009, Right boundary diff: 0.0
2025-06-10 20:20:33,186 - DEBUG -   Alignment factor (ratio): 0.04991863751483493
2025-06-10 20:20:33,186 - DEBUG -   -> c1 9 formula number: 19, c2 10 formula number: 21
2025-06-10 20:20:33,187 - DEBUG -   -> Not merging clusters 9 and 10 due to different formula numbers: 19 vs 21
2025-06-10 20:20:33,187 - DEBUG - Checking merge:
  Current: 15, Next: 10
2025-06-10 20:20:33,187 - DEBUG -   Vertical gap: 4.892000000000053, Overlap ratio: 1.0
2025-06-10 20:20:33,187 - DEBUG -   Left boundary diff: 1.9139999999999873, Right boundary diff: 0.0
2025-06-10 20:20:33,187 - DEBUG -   Alignment factor (ratio): 0.007973803929410538
2025-06-10 20:20:33,188 - DEBUG -   -> c1 15 formula number: 20, c2 10 formula number: 21
2025-06-10 20:20:33,188 - DEBUG -   -> Not merging clusters 15 and 10 due to different formula numbers: 20 vs 21
2025-06-10 20:20:33,188 - DEBUG - Checking merge:
  Current: 15, Next: 12
2025-06-10 20:20:33,188 - DEBUG -   Vertical gap: 23.721000000000004, Overlap ratio: 1.0
2025-06-10 20:20:33,188 - DEBUG -   Left boundary diff: 13.418000000000006, Right boundary diff: 0.0030000000000427463
2025-06-10 20:20:33,189 - DEBUG -   Alignment factor (ratio): 0.054169601963638014
2025-06-10 20:20:33,189 - DEBUG -   -> c1 15 formula number: 20, c2 12 formula number: 22
2025-06-10 20:20:33,189 - DEBUG -   -> Not merging clusters 15 and 12 due to different formula numbers: 20 vs 22
2025-06-10 20:20:33,189 - DEBUG - Checking merge:
  Current: 10, Next: 12
2025-06-10 20:20:33,189 - DEBUG -   Vertical gap: 4.890999999999963, Overlap ratio: 1.0
2025-06-10 20:20:33,189 - DEBUG -   Left boundary diff: 15.331999999999994, Right boundary diff: 0.0030000000000427463
2025-06-10 20:20:33,190 - DEBUG -   Alignment factor (ratio): 0.06213664631514528
2025-06-10 20:20:33,190 - DEBUG -   -> c1 10 formula number: 21, c2 12 formula number: 22
2025-06-10 20:20:33,190 - DEBUG -   -> Not merging clusters 10 and 12 due to different formula numbers: 21 vs 22
2025-06-10 20:20:33,190 - DEBUG - Checking merge:
  Current: 5, Next: 4
2025-06-10 20:20:33,190 - DEBUG -   Vertical gap: 6.662000000000035, Overlap ratio: 1.0
2025-06-10 20:20:33,191 - DEBUG -   Left boundary diff: 25.845000000000027, Right boundary diff: 0.0
2025-06-10 20:20:33,191 - DEBUG -   Alignment factor (ratio): 0.09828248084832111
2025-06-10 20:20:33,191 - DEBUG -   -> c1 5 formula number: 23, c2 4 formula number: 24
2025-06-10 20:20:33,191 - DEBUG -   -> Not merging clusters 5 and 4 due to different formula numbers: 23 vs 24
2025-06-10 20:20:33,191 - DEBUG - [Page 24] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:33,208 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:20:33,434 - DEBUG - Snippet 10.1038_s41467-024-55450-0_721_item_0: generation shape=torch.Size([1, 677])
2025-06-10 20:20:33,435 - DEBUG - Snippet 10.1038_s41467-024-55450-0_721_item_0 raw docling: (tokens=66)
<formula><loc_0><loc_0><loc_500><loc_500>w _ { 2 } = \frac { l _ { 2 } ^ { 2 } } { l _ { 1 } ^ { 2 } + l _ { 2 } ^ { 2 } }</formula><end_of_utterance>
2025-06-10 20:20:33,435 - DEBUG - Starting _parse_docling_output
2025-06-10 20:20:33,435 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>w _ { 2 } = \frac { l _ { 2 } ^ { 2 } } { l _ { 1 } ^ { 2 } + l _ { 2 } ^ { 2 } }</formula><end_of_utterance>
2025-06-10 20:20:33,435 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:20:33,436 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>w _ { 2 } = \\frac { l _ { 2 } ^ { 2 } } { l _ { 1 } ^ { 2 } + l _ { 2 } ^ { 2 } }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=433x123 at 0x7F96DFF3C590>)]
2025-06-10 20:20:33,436 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:20:33,438 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=433.0, b=123.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 81))], orig='w _ { 2 } = \\frac { l _ { 2 } ^ { 2 } } { l _ { 1 } ^ { 2 } + l _ { 2 } ^ { 2 } }', text='w _ { 2 } = \\frac { l _ { 2 } ^ { 2 } } { l _ { 1 } ^ { 2 } + l _ { 2 } ^ { 2 } }', formatting=None, hyperlink=None)]
2025-06-10 20:20:33,438 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:20:33,438 - DEBUG - Processing text item: label=formula, text=w _ { 2 } = \frac { l _ { 2 } ^ { 2 } } { l _ { 1 } ^ { 2 } + l _ { 2 } ^ { 2 } }
2025-06-10 20:20:33,439 - DEBUG - Recognized string extracted: w _ { 2 } = \frac { l _ { 2 } ^ { 2 } } { l _ { 1 } ^ { 2 } + l _ { 2 } ^ { 2 } }
2025-06-10 20:20:33,439 - DEBUG - Generating chat message for label: formula
2025-06-10 20:20:33,439 - DEBUG - Snippet 10.1038_s41467-024-55450-0_721_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:20:33,467 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:20:33,468 - INFO - Processing document 10.3390_ijerph15112487_768.pdf
2025-06-10 20:20:33,571 - DEBUG - Snippet 10.1038_s41467-024-55450-0_721_item_1 => input_ids shape=torch.Size([1, 610]), prompt_len=610
2025-06-10 20:20:33,897 - DEBUG - [Page 14] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:33,995 - DEBUG - Snippet 10.1214_10-aoas351_689_item_3: generation shape=torch.Size([1, 466])
2025-06-10 20:20:33,996 - DEBUG - Snippet 10.1214_10-aoas351_689_item_3 raw docling: (tokens=120)
<formula><loc_0><loc_0><loc_500><loc_500>P M S E = \frac { 1 } { n _ { v } } \sum _ { t = 1 } ^ { n } \sum _ { r = 1 } ( \widehat { Y ^ { * } } ( s _ { r } , t ) - Y ^ { * } ( s _ { r } , t ) ) ^ { 2 } \cdot I ( Y ^ { * } ( s _ { r } , t ) ) ,</formula><end_of_utterance>
2025-06-10 20:20:33,996 - DEBUG - Starting _parse_docling_output
2025-06-10 20:20:33,997 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>P M S E = \frac { 1 } { n _ { v } } \sum _ { t = 1 } ^ { n } \sum _ { r = 1 } ( \widehat { Y ^ { * } } ( s _ { r } , t ) - Y ^ { * } ( s _ { r } , t ) ) ^ { 2 } \cdot I ( Y ^ { * } ( s _ { r } , t ) ) ,</formula><end_of_utterance>
2025-06-10 20:20:33,997 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:20:33,997 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>P M S E = \\frac { 1 } { n _ { v } } \\sum _ { t = 1 } ^ { n } \\sum _ { r = 1 } ( \\widehat { Y ^ { * } } ( s _ { r } , t ) - Y ^ { * } ( s _ { r } , t ) ) ^ { 2 } \\cdot I ( Y ^ { * } ( s _ { r } , t ) ) ,</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=896x186 at 0x7F969CFAFFE0>)]
2025-06-10 20:20:33,997 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:20:34,002 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=896.0, b=186.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 202))], orig='P M S E = \\frac { 1 } { n _ { v } } \\sum _ { t = 1 } ^ { n } \\sum _ { r = 1 } ( \\widehat { Y ^ { * } } ( s _ { r } , t ) - Y ^ { * } ( s _ { r } , t ) ) ^ { 2 } \\cdot I ( Y ^ { * } ( s _ { r } , t ) ) ,', text='P M S E = \\frac { 1 } { n _ { v } } \\sum _ { t = 1 } ^ { n } \\sum _ { r = 1 } ( \\widehat { Y ^ { * } } ( s _ { r } , t ) - Y ^ { * } ( s _ { r } , t ) ) ^ { 2 } \\cdot I ( Y ^ { * } ( s _ { r } , t ) ) ,', formatting=None, hyperlink=None)]
2025-06-10 20:20:34,003 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:20:34,003 - DEBUG - Processing text item: label=formula, text=P M S E = \frac { 1 } { n _ { v } } \sum _ { t = 1 } ^ { n } \sum _ { r = 1 } ( \widehat { Y ^ { * } } ( s _ { r } , t ) - Y ^ { * } ( s _ { r } , t ) ) ^ { 2 } \cdot I ( Y ^ { * } ( s _ { r } , t ) ) ,
2025-06-10 20:20:34,003 - DEBUG - Recognized string extracted: P M S E = \frac { 1 } { n _ { v } } \sum _ { t = 1 } ^ { n } \sum _ { r = 1 } ( \widehat { Y ^ { * } } ( s _ { r } , t ) - Y ^ { * } ( s _ { r } , t ) ) ^ { 2 } \cdot I ( Y ^ { * } ( s _ { r } , t ) ) ,
2025-06-10 20:20:34,003 - DEBUG - Generating chat message for label: formula
2025-06-10 20:20:34,004 - DEBUG - Snippet 10.1214_10-aoas351_689_item_4 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:20:34,069 - DEBUG - Snippet 10.1214_10-aoas351_689_item_4 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:20:34,073 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:34,216 - DEBUG - Dynamic vertical threshold: 24.521399999999883, Overlap threshold: 0.7
2025-06-10 20:20:34,216 - DEBUG - Checking merge:
  Current: 13, Next: 12
2025-06-10 20:20:34,217 - DEBUG -   Vertical gap: 6.385999999999967, Overlap ratio: 0.9999908593157283
2025-06-10 20:20:34,217 - DEBUG -   Left boundary diff: 5.574000000000012, Right boundary diff: 0.0030000000000427463
2025-06-10 20:20:34,217 - DEBUG -   Alignment factor (ratio): 0.02413107146026756
2025-06-10 20:20:34,217 - DEBUG -   -> c1 13 formula number: 25, c2 12 formula number: 26
2025-06-10 20:20:34,217 - DEBUG -   -> Not merging clusters 13 and 12 due to different formula numbers: 25 vs 26
2025-06-10 20:20:34,218 - DEBUG - Checking merge:
  Current: 13, Next: 10
2025-06-10 20:20:34,218 - DEBUG -   Vertical gap: 14.70799999999997, Overlap ratio: 1.0
2025-06-10 20:20:34,218 - DEBUG -   Left boundary diff: 11.91500000000002, Right boundary diff: 0.0
2025-06-10 20:20:34,218 - DEBUG -   Alignment factor (ratio): 0.05088390228070072
2025-06-10 20:20:34,218 - DEBUG -   -> c1 13 formula number: 25, c2 10 formula number: 25
2025-06-10 20:20:34,218 - DEBUG -   -> Merging clusters 13 and 10 with vertical gap 14.70799999999997 and overlap ratio 1.0
2025-06-10 20:20:34,219 - DEBUG - [Page 25] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:34,487 - DEBUG - Dynamic vertical threshold: 25.088400000000185, Overlap threshold: 0.7
2025-06-10 20:20:34,487 - DEBUG - Checking merge:
  Current: 13, Next: 10
2025-06-10 20:20:34,488 - DEBUG -   Vertical gap: 6.071000000000026, Overlap ratio: 1.0
2025-06-10 20:20:34,488 - DEBUG -   Left boundary diff: 21.312000000000012, Right boundary diff: 0.0039999999999054126
2025-06-10 20:20:34,488 - DEBUG -   Alignment factor (ratio): 0.0865395157327963
2025-06-10 20:20:34,489 - DEBUG -   -> c1 13 formula number: 28, c2 10 formula number: 29
2025-06-10 20:20:34,489 - DEBUG -   -> Not merging clusters 13 and 10 due to different formula numbers: 28 vs 29
2025-06-10 20:20:34,489 - DEBUG - Checking merge:
  Current: 13, Next: 12
2025-06-10 20:20:34,489 - DEBUG -   Vertical gap: 24.900999999999954, Overlap ratio: 1.0
2025-06-10 20:20:34,489 - DEBUG -   Left boundary diff: 3.4739999999999895, Right boundary diff: 0.0039999999999054126
2025-06-10 20:20:34,489 - DEBUG -   Alignment factor (ratio): 0.014636612597429911
2025-06-10 20:20:34,490 - DEBUG -   -> c1 13 formula number: 28, c2 12 formula number: 30
2025-06-10 20:20:34,490 - DEBUG -   -> Not merging clusters 13 and 12 due to different formula numbers: 28 vs 30
2025-06-10 20:20:34,490 - DEBUG - Checking merge:
  Current: 10, Next: 12
2025-06-10 20:20:34,490 - DEBUG -   Vertical gap: 6.071999999999889, Overlap ratio: 1.0
2025-06-10 20:20:34,491 - DEBUG -   Left boundary diff: 17.838000000000022, Right boundary diff: 0.0
2025-06-10 20:20:34,491 - DEBUG -   Alignment factor (ratio): 0.0719250991903488
2025-06-10 20:20:34,491 - DEBUG -   -> c1 10 formula number: 29, c2 12 formula number: 30
2025-06-10 20:20:34,491 - DEBUG -   -> Not merging clusters 10 and 12 due to different formula numbers: 29 vs 30
2025-06-10 20:20:34,491 - DEBUG - Checking merge:
  Current: 10, Next: 9
2025-06-10 20:20:34,492 - DEBUG -   Vertical gap: 22.487999999999943, Overlap ratio: 1.0
2025-06-10 20:20:34,492 - DEBUG -   Left boundary diff: 5.608000000000004, Right boundary diff: 0.0
2025-06-10 20:20:34,492 - DEBUG -   Alignment factor (ratio): 0.022068053659054888
2025-06-10 20:20:34,492 - DEBUG -   -> c1 10 formula number: 29, c2 9 formula number: 31
2025-06-10 20:20:34,492 - DEBUG -   -> Not merging clusters 10 and 9 due to different formula numbers: 29 vs 31
2025-06-10 20:20:34,493 - DEBUG - Checking merge:
  Current: 12, Next: 9
2025-06-10 20:20:34,493 - DEBUG -   Vertical gap: 2.477999999999952, Overlap ratio: 1.0
2025-06-10 20:20:34,493 - DEBUG -   Left boundary diff: 12.230000000000018, Right boundary diff: 0.0
2025-06-10 20:20:34,493 - DEBUG -   Alignment factor (ratio): 0.04987683724572201
2025-06-10 20:20:34,493 - DEBUG -   -> c1 12 formula number: 30, c2 9 formula number: 31
2025-06-10 20:20:34,493 - DEBUG -   -> Not merging clusters 12 and 9 due to different formula numbers: 30 vs 31
2025-06-10 20:20:34,494 - DEBUG - Checking merge:
  Current: 12, Next: 11
2025-06-10 20:20:34,494 - DEBUG -   Vertical gap: 21.306999999999903, Overlap ratio: 1.0
2025-06-10 20:20:34,494 - DEBUG -   Left boundary diff: 1.9039999999999964, Right boundary diff: 0.0
2025-06-10 20:20:34,494 - DEBUG -   Alignment factor (ratio): 0.007931978287042616
2025-06-10 20:20:34,494 - DEBUG -   -> c1 12 formula number: 30, c2 11 formula number: 32
2025-06-10 20:20:34,494 - DEBUG -   -> Not merging clusters 12 and 11 due to different formula numbers: 30 vs 32
2025-06-10 20:20:34,495 - DEBUG - Checking merge:
  Current: 9, Next: 11
2025-06-10 20:20:34,495 - DEBUG -   Vertical gap: 2.477999999999952, Overlap ratio: 1.0
2025-06-10 20:20:34,495 - DEBUG -   Left boundary diff: 10.326000000000022, Right boundary diff: 0.0
2025-06-10 20:20:34,495 - DEBUG -   Alignment factor (ratio): 0.04194900794618057
2025-06-10 20:20:34,495 - DEBUG -   -> c1 9 formula number: 31, c2 11 formula number: 32
2025-06-10 20:20:34,495 - DEBUG -   -> Not merging clusters 9 and 11 due to different formula numbers: 31 vs 32
2025-06-10 20:20:34,496 - DEBUG - Checking merge:
  Current: 9, Next: 6
2025-06-10 20:20:34,496 - DEBUG -   Vertical gap: 23.721000000000004, Overlap ratio: 1.0
2025-06-10 20:20:34,496 - DEBUG -   Left boundary diff: 12.240000000000009, Right boundary diff: 0.0
2025-06-10 20:20:34,496 - DEBUG -   Alignment factor (ratio): 0.04991863751483493
2025-06-10 20:20:34,496 - DEBUG -   -> c1 9 formula number: 31, c2 6 formula number: 33
2025-06-10 20:20:34,497 - DEBUG -   -> Not merging clusters 9 and 6 due to different formula numbers: 31 vs 33
2025-06-10 20:20:34,497 - DEBUG - Checking merge:
  Current: 11, Next: 6
2025-06-10 20:20:34,497 - DEBUG -   Vertical gap: 4.892000000000053, Overlap ratio: 1.0
2025-06-10 20:20:34,497 - DEBUG -   Left boundary diff: 1.9139999999999873, Right boundary diff: 0.0
2025-06-10 20:20:34,497 - DEBUG -   Alignment factor (ratio): 0.007973803929410538
2025-06-10 20:20:34,497 - DEBUG -   -> c1 11 formula number: 32, c2 6 formula number: 33
2025-06-10 20:20:34,498 - DEBUG -   -> Not merging clusters 11 and 6 due to different formula numbers: 32 vs 33
2025-06-10 20:20:34,498 - DEBUG - Checking merge:
  Current: 11, Next: 8
2025-06-10 20:20:34,498 - DEBUG -   Vertical gap: 23.721000000000004, Overlap ratio: 0.9999910149242107
2025-06-10 20:20:34,498 - DEBUG -   Left boundary diff: 7.1089999999999804, Right boundary diff: 0.0030000000000427463
2025-06-10 20:20:34,498 - DEBUG -   Alignment factor (ratio): 0.02994019541778968
2025-06-10 20:20:34,499 - DEBUG -   -> c1 11 formula number: 32, c2 8 formula number: 34
2025-06-10 20:20:34,499 - DEBUG -   -> Not merging clusters 11 and 8 due to different formula numbers: 32 vs 34
2025-06-10 20:20:34,499 - DEBUG - Checking merge:
  Current: 6, Next: 8
2025-06-10 20:20:34,499 - DEBUG -   Vertical gap: 4.890999999999963, Overlap ratio: 0.9999910149242107
2025-06-10 20:20:34,499 - DEBUG -   Left boundary diff: 5.194999999999993, Right boundary diff: 0.0030000000000427463
2025-06-10 20:20:34,500 - DEBUG -   Alignment factor (ratio): 0.0219677524388645
2025-06-10 20:20:34,500 - DEBUG -   -> c1 6 formula number: 33, c2 8 formula number: 34
2025-06-10 20:20:34,500 - DEBUG -   -> Not merging clusters 6 and 8 due to different formula numbers: 33 vs 34
2025-06-10 20:20:34,501 - DEBUG - [Page 26] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:34,580 - DEBUG - Snippet 10.3390_ijerph15040736_730_item_3: generation shape=torch.Size([1, 406])
2025-06-10 20:20:34,581 - DEBUG - Snippet 10.3390_ijerph15040736_730_item_3 raw docling: (tokens=60)
<formula><loc_0><loc_0><loc_500><loc_500>P A F = \frac { f \times ( R R _ { E } - 1 ) } { f \times ( R R _ { E } - 1 ) + 1 }</formula><end_of_utterance>
2025-06-10 20:20:34,586 - DEBUG - Starting _parse_docling_output
2025-06-10 20:20:34,586 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>P A F = \frac { f \times ( R R _ { E } - 1 ) } { f \times ( R R _ { E } - 1 ) + 1 }</formula><end_of_utterance>
2025-06-10 20:20:34,586 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:20:34,587 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>P A F = \\frac { f \\times ( R R _ { E } - 1 ) } { f \\times ( R R _ { E } - 1 ) + 1 }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=817x121 at 0x7F971C65EA80>)]
2025-06-10 20:20:34,587 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:20:34,591 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=817.0, b=121.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 83))], orig='P A F = \\frac { f \\times ( R R _ { E } - 1 ) } { f \\times ( R R _ { E } - 1 ) + 1 }', text='P A F = \\frac { f \\times ( R R _ { E } - 1 ) } { f \\times ( R R _ { E } - 1 ) + 1 }', formatting=None, hyperlink=None)]
2025-06-10 20:20:34,591 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:20:34,591 - DEBUG - Processing text item: label=formula, text=P A F = \frac { f \times ( R R _ { E } - 1 ) } { f \times ( R R _ { E } - 1 ) + 1 }
2025-06-10 20:20:34,591 - DEBUG - Recognized string extracted: P A F = \frac { f \times ( R R _ { E } - 1 ) } { f \times ( R R _ { E } - 1 ) + 1 }
2025-06-10 20:20:34,592 - DEBUG - Generating chat message for label: formula
2025-06-10 20:20:34,592 - DEBUG - Snippet 10.3390_ijerph15040736_730_item_4 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:20:34,661 - DEBUG - Snippet 10.3390_ijerph15040736_730_item_4 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:20:34,674 - DEBUG - Finished converting page batch time=3989.655
2025-06-10 20:20:34,731 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:35,025 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:35,351 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:35,372 - DEBUG - [Page 27] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:35,411 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:35,588 - DEBUG - Snippet 10.1038_s41467-024-55450-0_721_item_1: generation shape=torch.Size([1, 678])
2025-06-10 20:20:35,589 - DEBUG - Snippet 10.1038_s41467-024-55450-0_721_item_1 raw docling: (tokens=67)
<formula><loc_0><loc_0><loc_500><loc_500>R ^ { 2 } = 1 - \frac { \sum ( \hat { v } - v ) ^ { 2 } } { \sum ( \hat { v } - v ) ^ { 2 } }</formula><end_of_utterance>
2025-06-10 20:20:35,589 - DEBUG - Starting _parse_docling_output
2025-06-10 20:20:35,589 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>R ^ { 2 } = 1 - \frac { \sum ( \hat { v } - v ) ^ { 2 } } { \sum ( \hat { v } - v ) ^ { 2 } }</formula><end_of_utterance>
2025-06-10 20:20:35,589 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:20:35,590 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>R ^ { 2 } = 1 - \\frac { \\sum ( \\hat { v } - v ) ^ { 2 } } { \\sum ( \\hat { v } - v ) ^ { 2 } }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=473x137 at 0x7F96DFF3C770>)]
2025-06-10 20:20:35,590 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:20:35,592 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=473.0, b=137.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 93))], orig='R ^ { 2 } = 1 - \\frac { \\sum ( \\hat { v } - v ) ^ { 2 } } { \\sum ( \\hat { v } - v ) ^ { 2 } }', text='R ^ { 2 } = 1 - \\frac { \\sum ( \\hat { v } - v ) ^ { 2 } } { \\sum ( \\hat { v } - v ) ^ { 2 } }', formatting=None, hyperlink=None)]
2025-06-10 20:20:35,592 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:20:35,593 - DEBUG - Processing text item: label=formula, text=R ^ { 2 } = 1 - \frac { \sum ( \hat { v } - v ) ^ { 2 } } { \sum ( \hat { v } - v ) ^ { 2 } }
2025-06-10 20:20:35,593 - DEBUG - Recognized string extracted: R ^ { 2 } = 1 - \frac { \sum ( \hat { v } - v ) ^ { 2 } } { \sum ( \hat { v } - v ) ^ { 2 } }
2025-06-10 20:20:35,593 - DEBUG - Generating chat message for label: formula
2025-06-10 20:20:35,594 - DEBUG - Snippet 10.1038_s41467-024-55450-0_721_item_2 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:20:35,664 - DEBUG - Snippet 10.1038_s41467-024-55450-0_721_item_2 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:20:35,731 - DEBUG - Finished converting page batch time=3990.712
2025-06-10 20:20:35,855 - DEBUG - Snippet 10.3390_ijerph15040736_730_item_4: generation shape=torch.Size([1, 383])
2025-06-10 20:20:35,856 - DEBUG - Snippet 10.3390_ijerph15040736_730_item_4 raw docling: (tokens=37)
<formula><loc_0><loc_0><loc_500><loc_500>R R _ { E } = R R _ { 1 } ^ { E }</formula><end_of_utterance>
2025-06-10 20:20:35,856 - DEBUG - Starting _parse_docling_output
2025-06-10 20:20:35,856 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>R R _ { E } = R R _ { 1 } ^ { E }</formula><end_of_utterance>
2025-06-10 20:20:35,857 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:20:35,857 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>R R _ { E } = R R _ { 1 } ^ { E }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=728x74 at 0x7F971C65F8C0>)]
2025-06-10 20:20:35,857 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:20:35,859 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=728.0, b=74.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 33))], orig='R R _ { E } = R R _ { 1 } ^ { E }', text='R R _ { E } = R R _ { 1 } ^ { E }', formatting=None, hyperlink=None)]
2025-06-10 20:20:35,860 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:20:35,860 - DEBUG - Processing text item: label=formula, text=R R _ { E } = R R _ { 1 } ^ { E }
2025-06-10 20:20:35,860 - DEBUG - Recognized string extracted: R R _ { E } = R R _ { 1 } ^ { E }
2025-06-10 20:20:35,860 - INFO - All done. Returning 5 recognized text results.
2025-06-10 20:20:35,860 - DEBUG - Snippet 10.3390_ijerph15040736_730_item_0 recognized text:
P W C _ { a d j } = P W C _ { p r e d } + \left ( C _ { o b s } - C _ { p r e d } \right )
2025-06-10 20:20:35,861 - DEBUG - Snippet 10.3390_ijerph15040736_730_item_1 recognized text:
P W S D _ { a d j } = P W S D _ { p r e d } \times \frac { S D _ { o b s } } { S D _ { p r e d } }
2025-06-10 20:20:35,861 - DEBUG - Snippet 10.3390_ijerph15040736_730_item_2 recognized text:
A B = P A F \times B _ { 0 } D
2025-06-10 20:20:35,861 - DEBUG - Snippet 10.3390_ijerph15040736_730_item_3 recognized text:
P A F = \frac { f \times ( R R _ { E } - 1 ) } { f \times ( R R _ { E } - 1 ) + 1 }
2025-06-10 20:20:35,861 - DEBUG - Snippet 10.3390_ijerph15040736_730_item_4 recognized text:
R R _ { E } = R R _ { 1 } ^ { E }
2025-06-10 20:20:35,940 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:35,961 - DEBUG - Creating masked image for page 5 with 16 clusters.
2025-06-10 20:20:35,962 - INFO - Masked image successfully created for page 5.
2025-06-10 20:20:36,063 - DEBUG - Creating masked image for page 6 with 19 clusters.
2025-06-10 20:20:36,065 - INFO - Masked image successfully created for page 6.
2025-06-10 20:20:36,073 - INFO - Starting prediction for 5 images with labels: ['formula', 'formula', 'formula', 'formula', 'formula']
2025-06-10 20:20:36,073 - DEBUG - Generating chat message for label: formula
2025-06-10 20:20:36,074 - DEBUG - Snippet 10.3390_ijerph15040736_730_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:20:36,103 - DEBUG - [Page 15] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:36,105 - DEBUG - Finished converting page batch time=3991.085
2025-06-10 20:20:36,131 - DEBUG - [Page 14] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:36,143 - DEBUG - Snippet 10.3390_ijerph15040736_730_item_0 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:20:36,168 - DEBUG - Dynamic vertical threshold: 29.001600000000042, Overlap threshold: 0.7
2025-06-10 20:20:36,168 - DEBUG - Checking merge:
  Current: 10, Next: 12
2025-06-10 20:20:36,169 - DEBUG -   Vertical gap: 6.662000000000035, Overlap ratio: 1.0
2025-06-10 20:20:36,169 - DEBUG -   Left boundary diff: 8.23599999999999, Right boundary diff: 0.0
2025-06-10 20:20:36,169 - DEBUG -   Alignment factor (ratio): 0.029256613465288822
2025-06-10 20:20:36,169 - DEBUG -   -> c1 10 formula number: 35, c2 12 formula number: 36
2025-06-10 20:20:36,169 - DEBUG -   -> Not merging clusters 10 and 12 due to different formula numbers: 35 vs 36
2025-06-10 20:20:36,169 - DEBUG - Checking merge:
  Current: 10, Next: 13
2025-06-10 20:20:36,170 - DEBUG -   Vertical gap: 25.732000000000028, Overlap ratio: 1.0
2025-06-10 20:20:36,170 - DEBUG -   Left boundary diff: 0.5409999999999968, Right boundary diff: 0.0039999999999054126
2025-06-10 20:20:36,170 - DEBUG -   Alignment factor (ratio): 0.0019522334308247076
2025-06-10 20:20:36,170 - DEBUG -   -> c1 10 formula number: 35, c2 13 formula number: 37
2025-06-10 20:20:36,170 - DEBUG -   -> Not merging clusters 10 and 13 due to different formula numbers: 35 vs 37
2025-06-10 20:20:36,171 - DEBUG - Checking merge:
  Current: 12, Next: 13
2025-06-10 20:20:36,171 - DEBUG -   Vertical gap: 2.7180000000000177, Overlap ratio: 1.0
2025-06-10 20:20:36,171 - DEBUG -   Left boundary diff: 8.776999999999987, Right boundary diff: 0.0039999999999054126
2025-06-10 20:20:36,171 - DEBUG -   Alignment factor (ratio): 0.031208609124349036
2025-06-10 20:20:36,171 - DEBUG -   -> c1 12 formula number: 36, c2 13 formula number: 37
2025-06-10 20:20:36,172 - DEBUG -   -> Not merging clusters 12 and 13 due to different formula numbers: 36 vs 37
2025-06-10 20:20:36,172 - DEBUG - Checking merge:
  Current: 12, Next: 14
2025-06-10 20:20:36,172 - DEBUG -   Vertical gap: 21.307000000000016, Overlap ratio: 1.0
2025-06-10 20:20:36,172 - DEBUG -   Left boundary diff: 13.221000000000004, Right boundary diff: 0.0
2025-06-10 20:20:36,172 - DEBUG -   Alignment factor (ratio): 0.04524060053894523
2025-06-10 20:20:36,172 - DEBUG -   -> c1 12 formula number: 36, c2 14 formula number: 38
2025-06-10 20:20:36,173 - DEBUG -   -> Not merging clusters 12 and 14 due to different formula numbers: 36 vs 38
2025-06-10 20:20:36,173 - DEBUG - Checking merge:
  Current: 13, Next: 14
2025-06-10 20:20:36,173 - DEBUG -   Vertical gap: 3.6580000000000155, Overlap ratio: 1.0
2025-06-10 20:20:36,173 - DEBUG -   Left boundary diff: 21.99799999999999, Right boundary diff: 0.0039999999999054126
2025-06-10 20:20:36,173 - DEBUG -   Alignment factor (ratio): 0.07642254392090239
2025-06-10 20:20:36,173 - DEBUG -   -> c1 13 formula number: 37, c2 14 formula number: 38
2025-06-10 20:20:36,174 - DEBUG -   -> Not merging clusters 13 and 14 due to different formula numbers: 37 vs 38
2025-06-10 20:20:36,174 - DEBUG - Checking merge:
  Current: 13, Next: 11
2025-06-10 20:20:36,174 - DEBUG -   Vertical gap: 24.90100000000001, Overlap ratio: 0.9999882033390451
2025-06-10 20:20:36,174 - DEBUG -   Left boundary diff: 37.771000000000015, Right boundary diff: 0.0039999999999054126
2025-06-10 20:20:36,174 - DEBUG -   Alignment factor (ratio): 0.14642050685661684
2025-06-10 20:20:36,175 - DEBUG -   -> c1 13 formula number: 37, c2 11 formula number: 39
2025-06-10 20:20:36,175 - DEBUG -   -> Not merging clusters 13 and 11 due to different formula numbers: 37 vs 39
2025-06-10 20:20:36,175 - DEBUG - Checking merge:
  Current: 14, Next: 11
2025-06-10 20:20:36,175 - DEBUG -   Vertical gap: 4.8910000000000196, Overlap ratio: 1.0
2025-06-10 20:20:36,175 - DEBUG -   Left boundary diff: 59.769000000000005, Right boundary diff: 0.0
2025-06-10 20:20:36,176 - DEBUG -   Alignment factor (ratio): 0.22221974357115376
2025-06-10 20:20:36,176 - DEBUG -   -> c1 14 formula number: 38, c2 11 formula number: 39
2025-06-10 20:20:36,176 - DEBUG -   -> Not merging clusters 14 and 11 due to different formula numbers: 38 vs 39
2025-06-10 20:20:36,176 - DEBUG - [Page 28] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:36,554 - DEBUG - Snippet 10.1214_10-aoas351_689_item_4: generation shape=torch.Size([1, 425])
2025-06-10 20:20:36,556 - DEBUG - Snippet 10.1214_10-aoas351_689_item_4 raw docling: (tokens=79)
<formula><loc_0><loc_0><loc_500><loc_500>\mathfrak { d } _ { t } = \mathfrak { B } _ { B o t h , t } \cup \mathfrak { D } _ { 0 , t } \cup \mathfrak { D } _ { P M , t } ,</formula><end_of_utterance>
2025-06-10 20:20:36,556 - DEBUG - Starting _parse_docling_output
2025-06-10 20:20:36,556 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>\mathfrak { d } _ { t } = \mathfrak { B } _ { B o t h , t } \cup \mathfrak { D } _ { 0 , t } \cup \mathfrak { D } _ { P M , t } ,</formula><end_of_utterance>
2025-06-10 20:20:36,556 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:20:36,557 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>\\mathfrak { d } _ { t } = \\mathfrak { B } _ { B o t h , t } \\cup \\mathfrak { D } _ { 0 , t } \\cup \\mathfrak { D } _ { P M , t } ,</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=710x54 at 0x7F96B2999A00>)]
2025-06-10 20:20:36,557 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:20:36,559 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=710.0, b=54.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 129))], orig='\\mathfrak { d } _ { t } = \\mathfrak { B } _ { B o t h , t } \\cup \\mathfrak { D } _ { 0 , t } \\cup \\mathfrak { D } _ { P M , t } ,', text='\\mathfrak { d } _ { t } = \\mathfrak { B } _ { B o t h , t } \\cup \\mathfrak { D } _ { 0 , t } \\cup \\mathfrak { D } _ { P M , t } ,', formatting=None, hyperlink=None)]
2025-06-10 20:20:36,559 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:20:36,559 - DEBUG - Processing text item: label=formula, text=\mathfrak { d } _ { t } = \mathfrak { B } _ { B o t h , t } \cup \mathfrak { D } _ { 0 , t } \cup \mathfrak { D } _ { P M , t } ,
2025-06-10 20:20:36,559 - DEBUG - Recognized string extracted: \mathfrak { d } _ { t } = \mathfrak { B } _ { B o t h , t } \cup \mathfrak { D } _ { 0 , t } \cup \mathfrak { D } _ { P M , t } ,
2025-06-10 20:20:36,560 - INFO - All done. Returning 5 recognized text results.
2025-06-10 20:20:36,560 - DEBUG - Snippet 10.1214_10-aoas351_689_item_0 recognized text:
\beta _ { i j } ( s , t ) = \gamma _ { i j } \beta _ { i j } ( s , t - 1 ) + \nu _ { i j } ( s , t ) ,
2025-06-10 20:20:36,560 - DEBUG - Snippet 10.1214_10-aoas351_689_item_1 recognized text:
Y _ { i } ( s ) = \tilde { \beta } _ { i 0 } ( s ) + \sum _ { j = 1 } ^ { p } \tilde { \beta } _ { i j } ( s ) x _ { j } ( B ) + \varepsilon _ { i } ( s ) , \quad \varepsilon _ { i } ( s ) \sim \mathcal { N } ( 0 , \tau _ { i } ^ { 2 } ) ,
2025-06-10 20:20:36,560 - DEBUG - Snippet 10.1214_10-aoas351_689_item_2 recognized text:
Y _ { i } ( s , t ) = \tilde { \beta } _ { i 0 } ( s , t ) + \sum _ { j = 1 } ^ { p } \tilde { \beta } _ { i j } ( s , t ) x _ { j } ( B , t ) \\ + \varepsilon _ { i } ( s , t ) , \quad \quad \varepsilon _ { i } ( s , t ) \sim N ( 0 , \tau _ { i } ^ { 2 } ) ,
2025-06-10 20:20:36,560 - DEBUG - Snippet 10.1214_10-aoas351_689_item_3 recognized text:
P M S E = \frac { 1 } { n _ { v } } \sum _ { t = 1 } ^ { n } \sum _ { r = 1 } ( \widehat { Y ^ { * } } ( s _ { r } , t ) - Y ^ { * } ( s _ { r } , t ) ) ^ { 2 } \cdot I ( Y ^ { * } ( s _ { r } , t ) ) ,
2025-06-10 20:20:36,561 - DEBUG - Snippet 10.1214_10-aoas351_689_item_4 recognized text:
\mathfrak { d } _ { t } = \mathfrak { B } _ { B o t h , t } \cup \mathfrak { D } _ { 0 , t } \cup \mathfrak { D } _ { P M , t } ,
2025-06-10 20:20:36,575 - DEBUG - Finished converting page batch time=3991.555
2025-06-10 20:20:36,601 - DEBUG - [Page 15] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:36,602 - DEBUG - Finished converting page batch time=3991.582
2025-06-10 20:20:36,636 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:36,647 - DEBUG - Creating masked image for page 22 with 10 clusters.
2025-06-10 20:20:36,649 - INFO - Masked image successfully created for page 22.
2025-06-10 20:20:36,723 - DEBUG - Creating masked image for page 29 with 17 clusters.
2025-06-10 20:20:36,725 - INFO - Masked image successfully created for page 29.
2025-06-10 20:20:36,732 - INFO - Starting prediction for 5 images with labels: ['formula', 'formula', 'formula', 'formula', 'formula']
2025-06-10 20:20:36,733 - DEBUG - Generating chat message for label: formula
2025-06-10 20:20:36,733 - DEBUG - Snippet 10.1214_10-aoas351_689_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:20:36,740 - DEBUG - [Page 16] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:36,740 - DEBUG - Finished converting page batch time=3991.721
2025-06-10 20:20:36,841 - INFO - Finished converting document 10.3390_ijerph120708075_762.pdf in 16.54 sec.
2025-06-10 20:20:36,874 - DEBUG - Snippet 10.1214_10-aoas351_689_item_0 => input_ids shape=torch.Size([1, 610]), prompt_len=610
2025-06-10 20:20:36,882 - DEBUG - [Page 16] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:36,961 - INFO - Extraction successful row 150, tokens=20656
2025-06-10 20:20:36,987 - INFO - Going to convert document batch...
2025-06-10 20:20:36,987 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:20:36,988 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:20:37,041 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:20:37,321 - DEBUG - [Page 29] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:37,412 - DEBUG - Snippet 10.3390_ijerph15040736_730_item_0: generation shape=torch.Size([1, 387])
2025-06-10 20:20:37,413 - DEBUG - Snippet 10.3390_ijerph15040736_730_item_0 raw docling: (tokens=41)
<formula><loc_0><loc_0><loc_500><loc_500>S E = \frac { S D _ { o b s } } { \sqrt { n } }</formula><end_of_utterance>
2025-06-10 20:20:37,413 - DEBUG - Starting _parse_docling_output
2025-06-10 20:20:37,413 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>S E = \frac { S D _ { o b s } } { \sqrt { n } }</formula><end_of_utterance>
2025-06-10 20:20:37,413 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:20:37,414 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>S E = \\frac { S D _ { o b s } } { \\sqrt { n } }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=728x118 at 0x7F96E029EF30>)]
2025-06-10 20:20:37,414 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:20:37,417 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=728.0, b=118.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 47))], orig='S E = \\frac { S D _ { o b s } } { \\sqrt { n } }', text='S E = \\frac { S D _ { o b s } } { \\sqrt { n } }', formatting=None, hyperlink=None)]
2025-06-10 20:20:37,417 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:20:37,417 - DEBUG - Processing text item: label=formula, text=S E = \frac { S D _ { o b s } } { \sqrt { n } }
2025-06-10 20:20:37,417 - DEBUG - Recognized string extracted: S E = \frac { S D _ { o b s } } { \sqrt { n } }
2025-06-10 20:20:37,417 - DEBUG - Generating chat message for label: formula
2025-06-10 20:20:37,418 - DEBUG - Snippet 10.3390_ijerph15040736_730_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:20:37,485 - DEBUG - Snippet 10.3390_ijerph15040736_730_item_1 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:20:37,490 - DEBUG - [Page 17] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:37,491 - DEBUG - Finished converting page batch time=3992.471
2025-06-10 20:20:37,656 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:37,728 - DEBUG - Creating masked image for page 2 with 15 clusters.
2025-06-10 20:20:37,729 - INFO - Masked image successfully created for page 2.
2025-06-10 20:20:37,832 - DEBUG - Creating masked image for page 3 with 14 clusters.
2025-06-10 20:20:37,833 - INFO - Masked image successfully created for page 3.
2025-06-10 20:20:37,841 - INFO - Starting prediction for 5 images with labels: ['formula', 'formula', 'formula', 'formula', 'formula']
2025-06-10 20:20:37,842 - DEBUG - Generating chat message for label: formula
2025-06-10 20:20:37,842 - DEBUG - Snippet 10.3390_atmos14121806_744_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:20:37,916 - DEBUG - Snippet 10.3390_atmos14121806_744_item_0 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:20:37,944 - DEBUG - [Page 30] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:37,970 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:20:38,021 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:20:38,028 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:20:38,304 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:38,633 - DEBUG - Snippet 10.3390_ijerph15040736_730_item_1: generation shape=torch.Size([1, 383])
2025-06-10 20:20:38,634 - DEBUG - Snippet 10.3390_ijerph15040736_730_item_1 raw docling: (tokens=37)
<formula><loc_0><loc_0><loc_500><loc_500>C U = \frac { S E } { C _ { o b s } }</formula><end_of_utterance>
2025-06-10 20:20:38,634 - DEBUG - Starting _parse_docling_output
2025-06-10 20:20:38,634 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>C U = \frac { S E } { C _ { o b s } }</formula><end_of_utterance>
2025-06-10 20:20:38,634 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:20:38,635 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>C U = \\frac { S E } { C _ { o b s } }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=725x121 at 0x7F971C65F560>)]
2025-06-10 20:20:38,635 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:20:38,638 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=725.0, b=121.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 37))], orig='C U = \\frac { S E } { C _ { o b s } }', text='C U = \\frac { S E } { C _ { o b s } }', formatting=None, hyperlink=None)]
2025-06-10 20:20:38,638 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:20:38,638 - DEBUG - Processing text item: label=formula, text=C U = \frac { S E } { C _ { o b s } }
2025-06-10 20:20:38,638 - DEBUG - Recognized string extracted: C U = \frac { S E } { C _ { o b s } }
2025-06-10 20:20:38,639 - DEBUG - Generating chat message for label: formula
2025-06-10 20:20:38,639 - DEBUG - Snippet 10.3390_ijerph15040736_730_item_2 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:20:38,656 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:20:38,656 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:20:38,657 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:20:38,693 - DEBUG - [Page 31] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:38,694 - DEBUG - Finished converting page batch time=3993.675
2025-06-10 20:20:38,695 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:20:38,702 - DEBUG - Snippet 10.3390_ijerph15040736_730_item_2 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:20:38,733 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:20:38,772 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:20:38,812 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:20:38,850 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:20:38,888 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:20:39,010 - DEBUG - Snippet 10.1038_s41467-024-55450-0_721_item_2: generation shape=torch.Size([1, 450])
2025-06-10 20:20:39,011 - DEBUG - Snippet 10.1038_s41467-024-55450-0_721_item_2 raw docling: (tokens=104)
<formula><loc_0><loc_0><loc_500><loc_500>C C = \frac { k \sum v \hat { v } - \sum v \sum \hat { v } } { \sqrt { k \sum v ^ { 2 } - ( \sum v ) ^ { 2 } \sqrt { k \sum \hat { v } ^ { 2 } - ( \sum \hat { v } ) ^ { 2 } } } }</formula><end_of_utterance>
2025-06-10 20:20:39,011 - DEBUG - Starting _parse_docling_output
2025-06-10 20:20:39,012 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>C C = \frac { k \sum v \hat { v } - \sum v \sum \hat { v } } { \sqrt { k \sum v ^ { 2 } - ( \sum v ) ^ { 2 } \sqrt { k \sum \hat { v } ^ { 2 } - ( \sum \hat { v } ) ^ { 2 } } } }</formula><end_of_utterance>
2025-06-10 20:20:39,012 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:20:39,012 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>C C = \\frac { k \\sum v \\hat { v } - \\sum v \\sum \\hat { v } } { \\sqrt { k \\sum v ^ { 2 } - ( \\sum v ) ^ { 2 } \\sqrt { k \\sum \\hat { v } ^ { 2 } - ( \\sum \\hat { v } ) ^ { 2 } } } }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=604x149 at 0x7F96DFF3A4B0>)]
2025-06-10 20:20:39,012 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:20:39,016 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=604.0, b=149.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 178))], orig='C C = \\frac { k \\sum v \\hat { v } - \\sum v \\sum \\hat { v } } { \\sqrt { k \\sum v ^ { 2 } - ( \\sum v ) ^ { 2 } \\sqrt { k \\sum \\hat { v } ^ { 2 } - ( \\sum \\hat { v } ) ^ { 2 } } } }', text='C C = \\frac { k \\sum v \\hat { v } - \\sum v \\sum \\hat { v } } { \\sqrt { k \\sum v ^ { 2 } - ( \\sum v ) ^ { 2 } \\sqrt { k \\sum \\hat { v } ^ { 2 } - ( \\sum \\hat { v } ) ^ { 2 } } } }', formatting=None, hyperlink=None)]
2025-06-10 20:20:39,016 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:20:39,016 - DEBUG - Processing text item: label=formula, text=C C = \frac { k \sum v \hat { v } - \sum v \sum \hat { v } } { \sqrt { k \sum v ^ { 2 } - ( \sum v ) ^ { 2 } \sqrt { k \sum \hat { v } ^ { 2 } - ( \sum \hat { v } ) ^ { 2 } } } }
2025-06-10 20:20:39,016 - DEBUG - Recognized string extracted: C C = \frac { k \sum v \hat { v } - \sum v \sum \hat { v } } { \sqrt { k \sum v ^ { 2 } - ( \sum v ) ^ { 2 } \sqrt { k \sum \hat { v } ^ { 2 } - ( \sum \hat { v } ) ^ { 2 } } } }
2025-06-10 20:20:39,017 - DEBUG - Generating chat message for label: formula
2025-06-10 20:20:39,017 - DEBUG - Snippet 10.1038_s41467-024-55450-0_721_item_3 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:20:39,021 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:20:39,058 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:20:39,072 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:39,091 - DEBUG - Snippet 10.1038_s41467-024-55450-0_721_item_3 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:20:39,093 - DEBUG - [Page 32] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:39,097 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:20:39,188 - DEBUG - Snippet 10.1214_10-aoas351_689_item_0: generation shape=torch.Size([1, 689])
2025-06-10 20:20:39,189 - DEBUG - Snippet 10.1214_10-aoas351_689_item_0 raw docling: (tokens=78)
<formula><loc_0><loc_0><loc_500><loc_500>\mathfrak { d } _ { t } = \mathfrak { D } _ { B o t h , t } \cup \mathfrak { D } _ { O , t } \cup \mathfrak { D } _ { P M , t } ,</formula><end_of_utterance>
2025-06-10 20:20:39,192 - DEBUG - Starting _parse_docling_output
2025-06-10 20:20:39,192 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>\mathfrak { d } _ { t } = \mathfrak { D } _ { B o t h , t } \cup \mathfrak { D } _ { O , t } \cup \mathfrak { D } _ { P M , t } ,</formula><end_of_utterance>
2025-06-10 20:20:39,193 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:20:39,193 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>\\mathfrak { d } _ { t } = \\mathfrak { D } _ { B o t h , t } \\cup \\mathfrak { D } _ { O , t } \\cup \\mathfrak { D } _ { P M , t } ,</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=347x102 at 0x7F96B3C73A70>)]
2025-06-10 20:20:39,193 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:20:39,195 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=347.0, b=102.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 129))], orig='\\mathfrak { d } _ { t } = \\mathfrak { D } _ { B o t h , t } \\cup \\mathfrak { D } _ { O , t } \\cup \\mathfrak { D } _ { P M , t } ,', text='\\mathfrak { d } _ { t } = \\mathfrak { D } _ { B o t h , t } \\cup \\mathfrak { D } _ { O , t } \\cup \\mathfrak { D } _ { P M , t } ,', formatting=None, hyperlink=None)]
2025-06-10 20:20:39,195 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:20:39,195 - DEBUG - Processing text item: label=formula, text=\mathfrak { d } _ { t } = \mathfrak { D } _ { B o t h , t } \cup \mathfrak { D } _ { O , t } \cup \mathfrak { D } _ { P M , t } ,
2025-06-10 20:20:39,195 - DEBUG - Recognized string extracted: \mathfrak { d } _ { t } = \mathfrak { D } _ { B o t h , t } \cup \mathfrak { D } _ { O , t } \cup \mathfrak { D } _ { P M , t } ,
2025-06-10 20:20:39,195 - DEBUG - Generating chat message for label: formula
2025-06-10 20:20:39,196 - DEBUG - Snippet 10.1214_10-aoas351_689_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:20:39,238 - WARNING - Repetitive generation detected with pattern: 'forall \, \, \'
2025-06-10 20:20:39,239 - DEBUG - Snippet 10.3390_atmos14121806_744_item_0: generation shape=torch.Size([1, 391])
2025-06-10 20:20:39,240 - DEBUG - Snippet 10.3390_atmos14121806_744_item_0 raw docling: (tokens=45)
<formula><loc_0><loc_0><loc_500><loc_500>\forall \, \, \forall \, \, \forall \, \, \forall \, \, \
2025-06-10 20:20:39,240 - DEBUG - Starting _parse_docling_output
2025-06-10 20:20:39,240 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>\forall \, \, \forall \, \, \forall \, \, \forall \, \, \
2025-06-10 20:20:39,241 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:20:39,241 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>\\forall \\, \\, \\forall \\, \\, \\forall \\, \\, \\forall \\, \\, \\', image=<PIL.Image.Image image mode=RGB size=1180x98 at 0x7F96AA7C3F80>)]
2025-06-10 20:20:39,241 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:20:39,244 - DEBUG - DoclingDocument loaded successfully. Extracted texts: []
2025-06-10 20:20:39,244 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:20:39,244 - WARNING - Extracted text is empty or malformed. Skipping formula.
2025-06-10 20:20:39,244 - DEBUG - Generating chat message for label: formula
2025-06-10 20:20:39,245 - DEBUG - Snippet 10.3390_atmos14121806_744_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:20:39,291 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:20:39,315 - DEBUG - Snippet 10.3390_atmos14121806_744_item_1 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:20:39,329 - DEBUG - Snippet 10.1214_10-aoas351_689_item_1 => input_ids shape=torch.Size([1, 610]), prompt_len=610
2025-06-10 20:20:39,559 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:39,560 - DEBUG - Finished converting page batch time=3994.541
2025-06-10 20:20:39,575 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:20:39,800 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:20:39,801 - INFO - Processing document 10.1186_1476-069x-11-5_771.pdf
2025-06-10 20:20:39,833 - DEBUG - [Page 33] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:39,890 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:39,937 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:40,040 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:40,041 - DEBUG - Finished converting page batch time=3995.021
2025-06-10 20:20:40,120 - INFO - Finished converting document 10.3390_ijerph15112487_768.pdf in 9.74 sec.
2025-06-10 20:20:40,183 - INFO - Extraction successful row 152, tokens=8611
2025-06-10 20:20:40,206 - INFO - Going to convert document batch...
2025-06-10 20:20:40,206 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:20:40,207 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:20:40,502 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:40,514 - DEBUG - Snippet 10.3390_ijerph15040736_730_item_2: generation shape=torch.Size([1, 408])
2025-06-10 20:20:40,515 - DEBUG - Snippet 10.3390_ijerph15040736_730_item_2 raw docling: (tokens=62)
<formula><loc_0><loc_0><loc_500><loc_500>C I ( \pm 9 5 \% _ { o } ) = ( 1 \pm 1 . 9 6 C U ) \times P W C _ { a d j }</formula><end_of_utterance>
2025-06-10 20:20:40,515 - DEBUG - Starting _parse_docling_output
2025-06-10 20:20:40,515 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>C I ( \pm 9 5 \% _ { o } ) = ( 1 \pm 1 . 9 6 C U ) \times P W C _ { a d j }</formula><end_of_utterance>
2025-06-10 20:20:40,515 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:20:40,516 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>C I ( \\pm 9 5 \\% _ { o } ) = ( 1 \\pm 1 . 9 6 C U ) \\times P W C _ { a d j }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=892x62 at 0x7F971C65E0F0>)]
2025-06-10 20:20:40,516 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:20:40,518 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=892.0, b=62.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 75))], orig='C I ( \\pm 9 5 \\% _ { o } ) = ( 1 \\pm 1 . 9 6 C U ) \\times P W C _ { a d j }', text='C I ( \\pm 9 5 \\% _ { o } ) = ( 1 \\pm 1 . 9 6 C U ) \\times P W C _ { a d j }', formatting=None, hyperlink=None)]
2025-06-10 20:20:40,519 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:20:40,519 - DEBUG - Processing text item: label=formula, text=C I ( \pm 9 5 \% _ { o } ) = ( 1 \pm 1 . 9 6 C U ) \times P W C _ { a d j }
2025-06-10 20:20:40,519 - DEBUG - Recognized string extracted: C I ( \pm 9 5 \% _ { o } ) = ( 1 \pm 1 . 9 6 C U ) \times P W C _ { a d j }
2025-06-10 20:20:40,519 - DEBUG - Generating chat message for label: formula
2025-06-10 20:20:40,519 - DEBUG - Snippet 10.3390_ijerph15040736_730_item_3 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:20:40,587 - DEBUG - Snippet 10.3390_ijerph15040736_730_item_3 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:20:40,591 - DEBUG - Snippet 10.1038_s41467-024-55450-0_721_item_3: generation shape=torch.Size([1, 399])
2025-06-10 20:20:40,592 - DEBUG - Snippet 10.1038_s41467-024-55450-0_721_item_3 raw docling: (tokens=53)
<formula><loc_0><loc_0><loc_500><loc_500>R M S E = \sqrt { \frac { 1 } { k } \sum ( \hat { v } - v ) ^ { 2 } }</formula><end_of_utterance>
2025-06-10 20:20:40,592 - DEBUG - Starting _parse_docling_output
2025-06-10 20:20:40,592 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>R M S E = \sqrt { \frac { 1 } { k } \sum ( \hat { v } - v ) ^ { 2 } }</formula><end_of_utterance>
2025-06-10 20:20:40,596 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:20:40,597 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>R M S E = \\sqrt { \\frac { 1 } { k } \\sum ( \\hat { v } - v ) ^ { 2 } }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=500x108 at 0x7F96DFF381D0>)]
2025-06-10 20:20:40,597 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:20:40,599 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=500.0, b=108.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 69))], orig='R M S E = \\sqrt { \\frac { 1 } { k } \\sum ( \\hat { v } - v ) ^ { 2 } }', text='R M S E = \\sqrt { \\frac { 1 } { k } \\sum ( \\hat { v } - v ) ^ { 2 } }', formatting=None, hyperlink=None)]
2025-06-10 20:20:40,599 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:20:40,599 - DEBUG - Processing text item: label=formula, text=R M S E = \sqrt { \frac { 1 } { k } \sum ( \hat { v } - v ) ^ { 2 } }
2025-06-10 20:20:40,600 - DEBUG - Recognized string extracted: R M S E = \sqrt { \frac { 1 } { k } \sum ( \hat { v } - v ) ^ { 2 } }
2025-06-10 20:20:40,600 - DEBUG - Generating chat message for label: formula
2025-06-10 20:20:40,600 - DEBUG - Snippet 10.1038_s41467-024-55450-0_721_item_4 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:20:40,670 - DEBUG - Snippet 10.1038_s41467-024-55450-0_721_item_4 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:20:40,876 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:20:40,931 - DEBUG - Snippet 10.3390_atmos14121806_744_item_1: generation shape=torch.Size([1, 397])
2025-06-10 20:20:40,932 - DEBUG - Snippet 10.3390_atmos14121806_744_item_1 raw docling: (tokens=51)
<formula><loc_0><loc_0><loc_500><loc_500>S O A F P _ { S } = \sum _ { i } V O C _ { i } \times F A C _ { i }</formula><end_of_utterance>
2025-06-10 20:20:40,932 - DEBUG - Starting _parse_docling_output
2025-06-10 20:20:40,932 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>S O A F P _ { S } = \sum _ { i } V O C _ { i } \times F A C _ { i }</formula><end_of_utterance>
2025-06-10 20:20:40,932 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:20:40,933 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>S O A F P _ { S } = \\sum _ { i } V O C _ { i } \\times F A C _ { i }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=755x119 at 0x7F96AA7C06E0>)]
2025-06-10 20:20:40,933 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:20:40,936 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=755.0, b=119.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 67))], orig='S O A F P _ { S } = \\sum _ { i } V O C _ { i } \\times F A C _ { i }', text='S O A F P _ { S } = \\sum _ { i } V O C _ { i } \\times F A C _ { i }', formatting=None, hyperlink=None)]
2025-06-10 20:20:40,936 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:20:40,937 - DEBUG - Processing text item: label=formula, text=S O A F P _ { S } = \sum _ { i } V O C _ { i } \times F A C _ { i }
2025-06-10 20:20:40,937 - DEBUG - Recognized string extracted: S O A F P _ { S } = \sum _ { i } V O C _ { i } \times F A C _ { i }
2025-06-10 20:20:40,937 - DEBUG - Generating chat message for label: formula
2025-06-10 20:20:40,937 - DEBUG - Snippet 10.3390_atmos14121806_744_item_2 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:20:41,007 - DEBUG - Snippet 10.3390_atmos14121806_744_item_2 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:20:41,148 - DEBUG - Snippet 10.1214_10-aoas351_689_item_1: generation shape=torch.Size([1, 671])
2025-06-10 20:20:41,149 - DEBUG - Snippet 10.1214_10-aoas351_689_item_1 raw docling: (tokens=60)
<formula><loc_0><loc_0><loc_500><loc_500>C R P S ( F , y ) = \int ( F ( z ) - 1 _ { \{ z \geq y \} } ) ^ { 2 } d z ,</formula><end_of_utterance>
2025-06-10 20:20:41,149 - DEBUG - Starting _parse_docling_output
2025-06-10 20:20:41,149 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>C R P S ( F , y ) = \int ( F ( z ) - 1 _ { \{ z \geq y \} } ) ^ { 2 } d z ,</formula><end_of_utterance>
2025-06-10 20:20:41,149 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:20:41,150 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>C R P S ( F , y ) = \\int ( F ( z ) - 1 _ { \\{ z \\geq y \\} } ) ^ { 2 } d z ,</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=491x175 at 0x7F96B3C2DBE0>)]
2025-06-10 20:20:41,150 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:20:41,153 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=491.0, b=175.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 75))], orig='C R P S ( F , y ) = \\int ( F ( z ) - 1 _ { \\{ z \\geq y \\} } ) ^ { 2 } d z ,', text='C R P S ( F , y ) = \\int ( F ( z ) - 1 _ { \\{ z \\geq y \\} } ) ^ { 2 } d z ,', formatting=None, hyperlink=None)]
2025-06-10 20:20:41,153 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:20:41,153 - DEBUG - Processing text item: label=formula, text=C R P S ( F , y ) = \int ( F ( z ) - 1 _ { \{ z \geq y \} } ) ^ { 2 } d z ,
2025-06-10 20:20:41,153 - DEBUG - Recognized string extracted: C R P S ( F , y ) = \int ( F ( z ) - 1 _ { \{ z \geq y \} } ) ^ { 2 } d z ,
2025-06-10 20:20:41,154 - DEBUG - Generating chat message for label: formula
2025-06-10 20:20:41,154 - DEBUG - Snippet 10.1214_10-aoas351_689_item_2 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:20:41,225 - DEBUG - Snippet 10.1214_10-aoas351_689_item_2 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:20:41,417 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:41,478 - DEBUG - [Page 34] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:41,767 - DEBUG - Snippet 10.1038_s41467-024-55450-0_721_item_4: generation shape=torch.Size([1, 384])
2025-06-10 20:20:41,767 - DEBUG - Snippet 10.1038_s41467-024-55450-0_721_item_4 raw docling: (tokens=38)
<formula><loc_0><loc_0><loc_500><loc_500>R P E = \frac { R M S E } { \bar { v } }</formula><end_of_utterance>
2025-06-10 20:20:41,768 - DEBUG - Starting _parse_docling_output
2025-06-10 20:20:41,768 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>R P E = \frac { R M S E } { \bar { v } }</formula><end_of_utterance>
2025-06-10 20:20:41,768 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:20:41,769 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>R P E = \\frac { R M S E } { \\bar { v } }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=441x94 at 0x7F96DFF39250>)]
2025-06-10 20:20:41,769 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:20:41,771 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=441.0, b=94.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 40))], orig='R P E = \\frac { R M S E } { \\bar { v } }', text='R P E = \\frac { R M S E } { \\bar { v } }', formatting=None, hyperlink=None)]
2025-06-10 20:20:41,771 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:20:41,771 - DEBUG - Processing text item: label=formula, text=R P E = \frac { R M S E } { \bar { v } }
2025-06-10 20:20:41,771 - DEBUG - Recognized string extracted: R P E = \frac { R M S E } { \bar { v } }
2025-06-10 20:20:41,771 - INFO - All done. Returning 5 recognized text results.
2025-06-10 20:20:41,772 - DEBUG - Snippet 10.1038_s41467-024-55450-0_721_item_0 recognized text:
w _ { 2 } = \frac { l _ { 2 } ^ { 2 } } { l _ { 1 } ^ { 2 } + l _ { 2 } ^ { 2 } }
2025-06-10 20:20:41,772 - DEBUG - Snippet 10.1038_s41467-024-55450-0_721_item_1 recognized text:
R ^ { 2 } = 1 - \frac { \sum ( \hat { v } - v ) ^ { 2 } } { \sum ( \hat { v } - v ) ^ { 2 } }
2025-06-10 20:20:41,772 - DEBUG - Snippet 10.1038_s41467-024-55450-0_721_item_2 recognized text:
C C = \frac { k \sum v \hat { v } - \sum v \sum \hat { v } } { \sqrt { k \sum v ^ { 2 } - ( \sum v ) ^ { 2 } \sqrt { k \sum \hat { v } ^ { 2 } - ( \sum \hat { v } ) ^ { 2 } } } }
2025-06-10 20:20:41,772 - DEBUG - Snippet 10.1038_s41467-024-55450-0_721_item_3 recognized text:
R M S E = \sqrt { \frac { 1 } { k } \sum ( \hat { v } - v ) ^ { 2 } }
2025-06-10 20:20:41,772 - DEBUG - Snippet 10.1038_s41467-024-55450-0_721_item_4 recognized text:
R P E = \frac { R M S E } { \bar { v } }
2025-06-10 20:20:41,779 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:20:41,821 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:20:41,827 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:20:41,863 - DEBUG - Snippet 10.3390_ijerph15040736_730_item_3: generation shape=torch.Size([1, 390])
2025-06-10 20:20:41,864 - DEBUG - Snippet 10.3390_ijerph15040736_730_item_3 raw docling: (tokens=44)
<formula><loc_0><loc_0><loc_500><loc_500>k = \frac { S D _ { o b s } } { S D _ { p r e d } }</formula><end_of_utterance>
2025-06-10 20:20:41,864 - DEBUG - Starting _parse_docling_output
2025-06-10 20:20:41,864 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>k = \frac { S D _ { o b s } } { S D _ { p r e d } }</formula><end_of_utterance>
2025-06-10 20:20:41,864 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:20:41,865 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>k = \\frac { S D _ { o b s } } { S D _ { p r e d } }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=724x122 at 0x7F971C65F2C0>)]
2025-06-10 20:20:41,865 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:20:41,868 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=724.0, b=122.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 51))], orig='k = \\frac { S D _ { o b s } } { S D _ { p r e d } }', text='k = \\frac { S D _ { o b s } } { S D _ { p r e d } }', formatting=None, hyperlink=None)]
2025-06-10 20:20:41,868 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:20:41,868 - DEBUG - Processing text item: label=formula, text=k = \frac { S D _ { o b s } } { S D _ { p r e d } }
2025-06-10 20:20:41,869 - DEBUG - Recognized string extracted: k = \frac { S D _ { o b s } } { S D _ { p r e d } }
2025-06-10 20:20:41,869 - DEBUG - Generating chat message for label: formula
2025-06-10 20:20:41,869 - DEBUG - Snippet 10.3390_ijerph15040736_730_item_4 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:20:41,871 - DEBUG - Creating masked image for page 11 with 34 clusters.
2025-06-10 20:20:41,873 - INFO - Masked image successfully created for page 11.
2025-06-10 20:20:41,879 - INFO - Starting prediction for 5 images with labels: ['formula', 'formula', 'formula', 'formula', 'formula']
2025-06-10 20:20:41,879 - DEBUG - Generating chat message for label: formula
2025-06-10 20:20:41,880 - DEBUG - Snippet 10.1038_s41467-024-55450-0_721_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:20:41,934 - DEBUG - Snippet 10.3390_ijerph15040736_730_item_4 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:20:41,950 - DEBUG - Snippet 10.1038_s41467-024-55450-0_721_item_0 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:20:42,154 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:42,413 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:20:42,413 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:20:42,413 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:20:42,447 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:20:42,450 - DEBUG - Snippet 10.3390_atmos14121806_744_item_2: generation shape=torch.Size([1, 393])
2025-06-10 20:20:42,451 - DEBUG - Snippet 10.3390_atmos14121806_744_item_2 raw docling: (tokens=47)
<formula><loc_0><loc_0><loc_500><loc_500>P S C F _ { i j } = \frac { n _ { i j } } { n _ { i j } }</formula><end_of_utterance>
2025-06-10 20:20:42,451 - DEBUG - Starting _parse_docling_output
2025-06-10 20:20:42,451 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>P S C F _ { i j } = \frac { n _ { i j } } { n _ { i j } }</formula><end_of_utterance>
2025-06-10 20:20:42,451 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:20:42,451 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>P S C F _ { i j } = \\frac { n _ { i j } } { n _ { i j } }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=663x128 at 0x7F96AA7C2540>)]
2025-06-10 20:20:42,452 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:20:42,455 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=663.0, b=128.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 57))], orig='P S C F _ { i j } = \\frac { n _ { i j } } { n _ { i j } }', text='P S C F _ { i j } = \\frac { n _ { i j } } { n _ { i j } }', formatting=None, hyperlink=None)]
2025-06-10 20:20:42,455 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:20:42,455 - DEBUG - Processing text item: label=formula, text=P S C F _ { i j } = \frac { n _ { i j } } { n _ { i j } }
2025-06-10 20:20:42,455 - DEBUG - Recognized string extracted: P S C F _ { i j } = \frac { n _ { i j } } { n _ { i j } }
2025-06-10 20:20:42,455 - DEBUG - Generating chat message for label: formula
2025-06-10 20:20:42,456 - DEBUG - Snippet 10.3390_atmos14121806_744_item_3 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:20:42,485 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:20:42,523 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:20:42,543 - DEBUG - Snippet 10.3390_atmos14121806_744_item_3 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:20:42,851 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:42,852 - DEBUG - Finished converting page batch time=3997.832
2025-06-10 20:20:43,052 - DEBUG - [Page 35] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:43,158 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:20:43,197 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:20:43,239 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:20:43,325 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:43,327 - DEBUG - Finished converting page batch time=3998.307
2025-06-10 20:20:43,341 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:43,362 - DEBUG - Snippet 10.1038_s41467-024-55450-0_721_item_0: generation shape=torch.Size([1, 392])
2025-06-10 20:20:43,363 - DEBUG - Snippet 10.1038_s41467-024-55450-0_721_item_0 raw docling: (tokens=46)
<formula><loc_0><loc_0><loc_500><loc_500>\emph { mean bias = } \frac { 1 } { k } \sum ( \hat { v } - v )</formula><end_of_utterance>
2025-06-10 20:20:43,363 - DEBUG - Starting _parse_docling_output
2025-06-10 20:20:43,363 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>\emph { mean bias = } \frac { 1 } { k } \sum ( \hat { v } - v )</formula><end_of_utterance>
2025-06-10 20:20:43,363 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:20:43,363 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>\\emph { mean bias = } \\frac { 1 } { k } \\sum ( \\hat { v } - v )</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=506x99 at 0x7F96DFF3B2C0>)]
2025-06-10 20:20:43,364 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:20:43,366 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=506.0, b=99.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 63))], orig='\\emph { mean bias = } \\frac { 1 } { k } \\sum ( \\hat { v } - v )', text='\\emph { mean bias = } \\frac { 1 } { k } \\sum ( \\hat { v } - v )', formatting=None, hyperlink=None)]
2025-06-10 20:20:43,366 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:20:43,366 - DEBUG - Processing text item: label=formula, text=\emph { mean bias = } \frac { 1 } { k } \sum ( \hat { v } - v )
2025-06-10 20:20:43,366 - DEBUG - Recognized string extracted: \emph { mean bias = } \frac { 1 } { k } \sum ( \hat { v } - v )
2025-06-10 20:20:43,367 - DEBUG - Generating chat message for label: formula
2025-06-10 20:20:43,367 - DEBUG - Snippet 10.1038_s41467-024-55450-0_721_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:20:43,370 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:20:43,442 - DEBUG - Snippet 10.1038_s41467-024-55450-0_721_item_1 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:20:43,477 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:20:43,516 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:20:43,530 - INFO - Finished converting document 10.1136_bmj-2023-077784_764.pdf in 20.04 sec.
2025-06-10 20:20:43,624 - INFO - Extraction successful row 151, tokens=16463
2025-06-10 20:20:43,648 - INFO - Going to convert document batch...
2025-06-10 20:20:43,648 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:20:43,648 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:20:43,674 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:20:43,740 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:20:43,779 - DEBUG - Snippet 10.3390_ijerph15040736_730_item_4: generation shape=torch.Size([1, 405])
2025-06-10 20:20:43,780 - DEBUG - Snippet 10.3390_ijerph15040736_730_item_4 raw docling: (tokens=59)
<formula><loc_0><loc_0><loc_500><loc_500>C _ { i , a d j } = C _ { a d j } + \left ( C _ { i } - C _ { a d j } \right ) \times k</formula><end_of_utterance>
2025-06-10 20:20:43,781 - DEBUG - Starting _parse_docling_output
2025-06-10 20:20:43,781 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>C _ { i , a d j } = C _ { a d j } + \left ( C _ { i } - C _ { a d j } \right ) \times k</formula><end_of_utterance>
2025-06-10 20:20:43,781 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:20:43,781 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>C _ { i , a d j } = C _ { a d j } + \\left ( C _ { i } - C _ { a d j } \\right ) \\times k</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=850x81 at 0x7F971C65EFC0>)]
2025-06-10 20:20:43,782 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:20:43,785 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=850.0, b=81.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 87))], orig='C _ { i , a d j } = C _ { a d j } + \\left ( C _ { i } - C _ { a d j } \\right ) \\times k', text='C _ { i , a d j } = C _ { a d j } + \\left ( C _ { i } - C _ { a d j } \\right ) \\times k', formatting=None, hyperlink=None)]
2025-06-10 20:20:43,785 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:20:43,785 - DEBUG - Processing text item: label=formula, text=C _ { i , a d j } = C _ { a d j } + \left ( C _ { i } - C _ { a d j } \right ) \times k
2025-06-10 20:20:43,786 - DEBUG - Recognized string extracted: C _ { i , a d j } = C _ { a d j } + \left ( C _ { i } - C _ { a d j } \right ) \times k
2025-06-10 20:20:43,786 - INFO - All done. Returning 5 recognized text results.
2025-06-10 20:20:43,786 - DEBUG - Snippet 10.3390_ijerph15040736_730_item_0 recognized text:
S E = \frac { S D _ { o b s } } { \sqrt { n } }
2025-06-10 20:20:43,787 - DEBUG - Snippet 10.3390_ijerph15040736_730_item_1 recognized text:
C U = \frac { S E } { C _ { o b s } }
2025-06-10 20:20:43,787 - DEBUG - Snippet 10.3390_ijerph15040736_730_item_2 recognized text:
C I ( \pm 9 5 \% _ { o } ) = ( 1 \pm 1 . 9 6 C U ) \times P W C _ { a d j }
2025-06-10 20:20:43,787 - DEBUG - Snippet 10.3390_ijerph15040736_730_item_3 recognized text:
k = \frac { S D _ { o b s } } { S D _ { p r e d } }
2025-06-10 20:20:43,787 - DEBUG - Snippet 10.3390_ijerph15040736_730_item_4 recognized text:
C _ { i , a d j } = C _ { a d j } + \left ( C _ { i } - C _ { a d j } \right ) \times k
2025-06-10 20:20:43,889 - INFO - Finished converting document 10.3390_ijerph15040736_730.pdf in 33.06 sec.
2025-06-10 20:20:43,961 - DEBUG - Finished converting page batch time=3998.941
2025-06-10 20:20:43,975 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:20:44,044 - INFO - Extraction successful row 147, tokens=17648
2025-06-10 20:20:44,066 - INFO - Going to convert document batch...
2025-06-10 20:20:44,066 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:20:44,066 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:20:44,125 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:20:44,202 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:20:44,203 - INFO - Processing document 10.4209_aaqr.2009.10.0061_772.pdf
2025-06-10 20:20:44,256 - DEBUG - [Page 36] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:44,485 - DEBUG - Snippet 10.1214_10-aoas351_689_item_2: generation shape=torch.Size([1, 443])
2025-06-10 20:20:44,486 - DEBUG - Snippet 10.1214_10-aoas351_689_item_2 raw docling: (tokens=97)
<formula><loc_0><loc_0><loc_500><loc_500>I S ( l ; u ; y ) = \left [ ( u - l ) + \frac { \L } { \alpha } ( l - y ) 1 _ { \{ y < l \} } + \frac { \L } { \alpha } ( u - y ) 1 _ { \{ u < y \} } \right ] ,</formula><end_of_utterance>
2025-06-10 20:20:44,486 - DEBUG - Starting _parse_docling_output
2025-06-10 20:20:44,486 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>I S ( l ; u ; y ) = \left [ ( u - l ) + \frac { \L } { \alpha } ( l - y ) 1 _ { \{ y < l \} } + \frac { \L } { \alpha } ( u - y ) 1 _ { \{ u < y \} } \right ] ,</formula><end_of_utterance>
2025-06-10 20:20:44,486 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:20:44,487 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>I S ( l ; u ; y ) = \\left [ ( u - l ) + \\frac { \\L } { \\alpha } ( l - y ) 1 _ { \\{ y < l \\} } + \\frac { \\L } { \\alpha } ( u - y ) 1 _ { \\{ u < y \\} } \\right ] ,</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=779x156 at 0x7F969CFACDD0>)]
2025-06-10 20:20:44,487 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:20:44,491 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=779.0, b=156.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 84))], orig='I S ( l ; u ; y ) = \\left [ ( u - l ) + \\frac { \\L } { \\alpha } ( l - y ) 1 _ { \\{ y', text='I S ( l ; u ; y ) = \\left [ ( u - l ) + \\frac { \\L } { \\alpha } ( l - y ) 1 _ { \\{ y', formatting=None, hyperlink=None)]
2025-06-10 20:20:44,491 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:20:44,491 - DEBUG - Processing text item: label=formula, text=I S ( l ; u ; y ) = \left [ ( u - l ) + \frac { \L } { \alpha } ( l - y ) 1 _ { \{ y
2025-06-10 20:20:44,492 - DEBUG - Recognized string extracted: I S ( l ; u ; y ) = \left [ ( u - l ) + \frac { \L } { \alpha } ( l - y ) 1 _ { \{ y
2025-06-10 20:20:44,492 - DEBUG - Generating chat message for label: formula
2025-06-10 20:20:44,492 - DEBUG - Snippet 10.1214_10-aoas351_689_item_3 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:20:44,560 - DEBUG - Snippet 10.1214_10-aoas351_689_item_3 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:20:44,577 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:44,674 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:20:44,727 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:20:44,733 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:20:45,038 - DEBUG - Snippet 10.3390_atmos14121806_744_item_3: generation shape=torch.Size([1, 425])
2025-06-10 20:20:45,045 - DEBUG - Snippet 10.3390_atmos14121806_744_item_3 raw docling: (tokens=79)
<formula><loc_0><loc_0><loc_500><loc_500>C _ { i j } = \frac { \sum _ { a = 1 } ^ { b } C _ { a } \times t _ { i j a } } { \sum _ { a = 1 } ^ { b } t _ { i j a } }</formula><end_of_utterance>
2025-06-10 20:20:45,045 - DEBUG - Starting _parse_docling_output
2025-06-10 20:20:45,048 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>C _ { i j } = \frac { \sum _ { a = 1 } ^ { b } C _ { a } \times t _ { i j a } } { \sum _ { a = 1 } ^ { b } t _ { i j a } }</formula><end_of_utterance>
2025-06-10 20:20:45,048 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:20:45,049 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>C _ { i j } = \\frac { \\sum _ { a = 1 } ^ { b } C _ { a } \\times t _ { i j a } } { \\sum _ { a = 1 } ^ { b } t _ { i j a } }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=704x149 at 0x7F96AA7C1C70>)]
2025-06-10 20:20:45,049 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:20:45,053 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=704.0, b=149.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 122))], orig='C _ { i j } = \\frac { \\sum _ { a = 1 } ^ { b } C _ { a } \\times t _ { i j a } } { \\sum _ { a = 1 } ^ { b } t _ { i j a } }', text='C _ { i j } = \\frac { \\sum _ { a = 1 } ^ { b } C _ { a } \\times t _ { i j a } } { \\sum _ { a = 1 } ^ { b } t _ { i j a } }', formatting=None, hyperlink=None)]
2025-06-10 20:20:45,053 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:20:45,053 - DEBUG - Processing text item: label=formula, text=C _ { i j } = \frac { \sum _ { a = 1 } ^ { b } C _ { a } \times t _ { i j a } } { \sum _ { a = 1 } ^ { b } t _ { i j a } }
2025-06-10 20:20:45,053 - DEBUG - Recognized string extracted: C _ { i j } = \frac { \sum _ { a = 1 } ^ { b } C _ { a } \times t _ { i j a } } { \sum _ { a = 1 } ^ { b } t _ { i j a } }
2025-06-10 20:20:45,053 - DEBUG - Generating chat message for label: formula
2025-06-10 20:20:45,054 - DEBUG - Snippet 10.3390_atmos14121806_744_item_4 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:20:45,098 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:20:45,144 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:20:45,150 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:20:45,187 - DEBUG - Snippet 10.3390_atmos14121806_744_item_4 => input_ids shape=torch.Size([1, 610]), prompt_len=610
2025-06-10 20:20:45,192 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:45,224 - DEBUG - Snippet 10.1038_s41467-024-55450-0_721_item_1: generation shape=torch.Size([1, 407])
2025-06-10 20:20:45,225 - DEBUG - Snippet 10.1038_s41467-024-55450-0_721_item_1 raw docling: (tokens=61)
<formula><loc_0><loc_0><loc_500><loc_500>v _ { p w } = \frac { \sum p o p _ { i } \times \hat { v } _ { i } } { \sum p o p _ { i } }</formula><end_of_utterance>
2025-06-10 20:20:45,226 - DEBUG - Starting _parse_docling_output
2025-06-10 20:20:45,226 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>v _ { p w } = \frac { \sum p o p _ { i } \times \hat { v } _ { i } } { \sum p o p _ { i } }</formula><end_of_utterance>
2025-06-10 20:20:45,226 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:20:45,227 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>v _ { p w } = \\frac { \\sum p o p _ { i } \\times \\hat { v } _ { i } } { \\sum p o p _ { i } }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=467x109 at 0x7F96DFF3B620>)]
2025-06-10 20:20:45,227 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:20:45,230 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=467.0, b=109.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 91))], orig='v _ { p w } = \\frac { \\sum p o p _ { i } \\times \\hat { v } _ { i } } { \\sum p o p _ { i } }', text='v _ { p w } = \\frac { \\sum p o p _ { i } \\times \\hat { v } _ { i } } { \\sum p o p _ { i } }', formatting=None, hyperlink=None)]
2025-06-10 20:20:45,230 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:20:45,230 - DEBUG - Processing text item: label=formula, text=v _ { p w } = \frac { \sum p o p _ { i } \times \hat { v } _ { i } } { \sum p o p _ { i } }
2025-06-10 20:20:45,231 - DEBUG - Recognized string extracted: v _ { p w } = \frac { \sum p o p _ { i } \times \hat { v } _ { i } } { \sum p o p _ { i } }
2025-06-10 20:20:45,231 - DEBUG - Generating chat message for label: formula
2025-06-10 20:20:45,231 - DEBUG - Snippet 10.1038_s41467-024-55450-0_721_item_2 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:20:45,308 - DEBUG - Snippet 10.1038_s41467-024-55450-0_721_item_2 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:20:45,431 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:45,484 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:20:45,484 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:20:45,485 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:20:45,522 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:20:45,569 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:20:45,606 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:20:45,643 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:20:45,693 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:20:45,752 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:20:45,752 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:20:45,753 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:20:45,779 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:20:45,789 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:20:45,827 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:20:45,895 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:20:45,910 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:20:45,934 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:20:45,948 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:20:46,010 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:20:46,023 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:20:46,048 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:20:46,078 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:46,185 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:20:46,193 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:20:46,230 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:20:46,288 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:20:46,444 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:20:46,629 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:20:46,716 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:20:46,827 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:20:46,827 - INFO - Processing document 10.2188_jea.je20110049_780.pdf
2025-06-10 20:20:46,897 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:20:46,898 - INFO - Processing document 10.1186_1476-069x-11-82_782.pdf
2025-06-10 20:20:46,986 - DEBUG - [Page 37] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:47,434 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:47,553 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:47,667 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:47,748 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:47,907 - DEBUG - Snippet 10.1214_10-aoas351_689_item_3: generation shape=torch.Size([1, 459])
2025-06-10 20:20:47,909 - DEBUG - Snippet 10.1214_10-aoas351_689_item_3 raw docling: (tokens=113)
<formula><loc_0><loc_0><loc_500><loc_500>C o v ( Y _ { 1 } ( s ) , Y _ { 1 } ( s ^ { \prime } ) ) = A _ { 1 1 } ^ { 2 } \exp ( - \phi _ { 1 } \| s - s ^ { \prime } \| ) + \tau _ { 1 } ^ { 2 } \delta _ { s , s ^ { \prime } } ,</formula><end_of_utterance>
2025-06-10 20:20:47,909 - DEBUG - Starting _parse_docling_output
2025-06-10 20:20:47,909 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>C o v ( Y _ { 1 } ( s ) , Y _ { 1 } ( s ^ { \prime } ) ) = A _ { 1 1 } ^ { 2 } \exp ( - \phi _ { 1 } \| s - s ^ { \prime } \| ) + \tau _ { 1 } ^ { 2 } \delta _ { s , s ^ { \prime } } ,</formula><end_of_utterance>
2025-06-10 20:20:47,909 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:20:47,910 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>C o v ( Y _ { 1 } ( s ) , Y _ { 1 } ( s ^ { \\prime } ) ) = A _ { 1 1 } ^ { 2 } \\exp ( - \\phi _ { 1 } \\| s - s ^ { \\prime } \\| ) + \\tau _ { 1 } ^ { 2 } \\delta _ { s , s ^ { \\prime } } ,</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=672x73 at 0x7F96B2921100>)]
2025-06-10 20:20:47,910 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:20:47,913 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=672.0, b=73.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 184))], orig='C o v ( Y _ { 1 } ( s ) , Y _ { 1 } ( s ^ { \\prime } ) ) = A _ { 1 1 } ^ { 2 } \\exp ( - \\phi _ { 1 } \\| s - s ^ { \\prime } \\| ) + \\tau _ { 1 } ^ { 2 } \\delta _ { s , s ^ { \\prime } } ,', text='C o v ( Y _ { 1 } ( s ) , Y _ { 1 } ( s ^ { \\prime } ) ) = A _ { 1 1 } ^ { 2 } \\exp ( - \\phi _ { 1 } \\| s - s ^ { \\prime } \\| ) + \\tau _ { 1 } ^ { 2 } \\delta _ { s , s ^ { \\prime } } ,', formatting=None, hyperlink=None)]
2025-06-10 20:20:47,913 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:20:47,913 - DEBUG - Processing text item: label=formula, text=C o v ( Y _ { 1 } ( s ) , Y _ { 1 } ( s ^ { \prime } ) ) = A _ { 1 1 } ^ { 2 } \exp ( - \phi _ { 1 } \| s - s ^ { \prime } \| ) + \tau _ { 1 } ^ { 2 } \delta _ { s , s ^ { \prime } } ,
2025-06-10 20:20:47,913 - DEBUG - Recognized string extracted: C o v ( Y _ { 1 } ( s ) , Y _ { 1 } ( s ^ { \prime } ) ) = A _ { 1 1 } ^ { 2 } \exp ( - \phi _ { 1 } \| s - s ^ { \prime } \| ) + \tau _ { 1 } ^ { 2 } \delta _ { s , s ^ { \prime } } ,
2025-06-10 20:20:47,914 - DEBUG - Generating chat message for label: formula
2025-06-10 20:20:47,914 - DEBUG - Snippet 10.1214_10-aoas351_689_item_4 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:20:47,943 - DEBUG - Finished converting page batch time=4002.923
2025-06-10 20:20:47,980 - DEBUG - Snippet 10.1214_10-aoas351_689_item_4 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:20:48,415 - DEBUG - [Page 38] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:48,507 - DEBUG - Snippet 10.1038_s41467-024-55450-0_721_item_2: generation shape=torch.Size([1, 455])
2025-06-10 20:20:48,509 - DEBUG - Snippet 10.1038_s41467-024-55450-0_721_item_2 raw docling: (tokens=109)
<formula><loc_0><loc_0><loc_500><loc_500>E L _ { U , D } ( U _ { x } , D _ { y } ) = \frac { \sum p o p _ { i } \times I _ { U , D } ( U _ { i } > U _ { x } , D _ { i } > D _ { y } ) } { \sum p o p _ { i } } \times 1 0 0 \%</formula><end_of_utterance>
2025-06-10 20:20:48,509 - DEBUG - Starting _parse_docling_output
2025-06-10 20:20:48,509 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>E L _ { U , D } ( U _ { x } , D _ { y } ) = \frac { \sum p o p _ { i } \times I _ { U , D } ( U _ { i } > U _ { x } , D _ { i } > D _ { y } ) } { \sum p o p _ { i } } \times 1 0 0 \%</formula><end_of_utterance>
2025-06-10 20:20:48,510 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:20:48,510 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>E L _ { U , D } ( U _ { x } , D _ { y } ) = \\frac { \\sum p o p _ { i } \\times I _ { U , D } ( U _ { i } > U _ { x } , D _ { i } > D _ { y } ) } { \\sum p o p _ { i } } \\times 1 0 0 \\%</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=695x132 at 0x7F96C3E35FD0>)]
2025-06-10 20:20:48,510 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:20:48,514 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=695.0, b=132.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 182))], orig='E L _ { U , D } ( U _ { x } , D _ { y } ) = \\frac { \\sum p o p _ { i } \\times I _ { U , D } ( U _ { i } > U _ { x } , D _ { i } > D _ { y } ) } { \\sum p o p _ { i } } \\times 1 0 0 \\%', text='E L _ { U , D } ( U _ { x } , D _ { y } ) = \\frac { \\sum p o p _ { i } \\times I _ { U , D } ( U _ { i } > U _ { x } , D _ { i } > D _ { y } ) } { \\sum p o p _ { i } } \\times 1 0 0 \\%', formatting=None, hyperlink=None)]
2025-06-10 20:20:48,514 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:20:48,515 - DEBUG - Processing text item: label=formula, text=E L _ { U , D } ( U _ { x } , D _ { y } ) = \frac { \sum p o p _ { i } \times I _ { U , D } ( U _ { i } > U _ { x } , D _ { i } > D _ { y } ) } { \sum p o p _ { i } } \times 1 0 0 \%
2025-06-10 20:20:48,515 - DEBUG - Recognized string extracted: E L _ { U , D } ( U _ { x } , D _ { y } ) = \frac { \sum p o p _ { i } \times I _ { U , D } ( U _ { i } > U _ { x } , D _ { i } > D _ { y } ) } { \sum p o p _ { i } } \times 1 0 0 \%
2025-06-10 20:20:48,515 - DEBUG - Generating chat message for label: formula
2025-06-10 20:20:48,515 - DEBUG - Snippet 10.1038_s41467-024-55450-0_721_item_3 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:20:48,586 - DEBUG - Snippet 10.1038_s41467-024-55450-0_721_item_3 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:20:48,662 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:48,876 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:48,928 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:49,167 - DEBUG - [Page 39] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:49,169 - DEBUG - Finished converting page batch time=4004.149
2025-06-10 20:20:49,225 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:49,813 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:49,815 - DEBUG - Dynamic vertical threshold: 122.43240000000006, Overlap threshold: 0.7
2025-06-10 20:20:49,815 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:49,853 - DEBUG - Snippet 10.1038_s41467-024-55450-0_721_item_3: generation shape=torch.Size([1, 392])
2025-06-10 20:20:49,854 - DEBUG - Snippet 10.1038_s41467-024-55450-0_721_item_3 raw docling: (tokens=46)
<formula><loc_0><loc_0><loc_500><loc_500>R R _ { i } = e ^ { \gamma ( v _ { m i } - v _ { s } ) }</formula><end_of_utterance>
2025-06-10 20:20:49,854 - DEBUG - Starting _parse_docling_output
2025-06-10 20:20:49,854 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>R R _ { i } = e ^ { \gamma ( v _ { m i } - v _ { s } ) }</formula><end_of_utterance>
2025-06-10 20:20:49,855 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:20:49,855 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>R R _ { i } = e ^ { \\gamma ( v _ { m i } - v _ { s } ) }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=447x84 at 0x7F96C3E36F30>)]
2025-06-10 20:20:49,855 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:20:49,857 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=447.0, b=84.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 56))], orig='R R _ { i } = e ^ { \\gamma ( v _ { m i } - v _ { s } ) }', text='R R _ { i } = e ^ { \\gamma ( v _ { m i } - v _ { s } ) }', formatting=None, hyperlink=None)]
2025-06-10 20:20:49,857 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:20:49,857 - DEBUG - Processing text item: label=formula, text=R R _ { i } = e ^ { \gamma ( v _ { m i } - v _ { s } ) }
2025-06-10 20:20:49,857 - DEBUG - Recognized string extracted: R R _ { i } = e ^ { \gamma ( v _ { m i } - v _ { s } ) }
2025-06-10 20:20:49,858 - DEBUG - Generating chat message for label: formula
2025-06-10 20:20:49,858 - DEBUG - Snippet 10.1038_s41467-024-55450-0_721_item_4 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:20:49,929 - DEBUG - Snippet 10.1038_s41467-024-55450-0_721_item_4 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:20:50,023 - DEBUG - [Page 40] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:50,582 - DEBUG - Snippet 10.3390_atmos14121806_744_item_4: generation shape=torch.Size([1, 784])
2025-06-10 20:20:50,584 - DEBUG - Snippet 10.3390_atmos14121806_744_item_4 raw docling: (tokens=173)
<formula><loc_0><loc_0><loc_500><loc_500>W _ { i j } = \begin{cases} & 1 . 0 0 , \, n _ { i j } > 3 n _ { a v e } \\ & 0 . 7 0 , \, 3 n _ { a v e } \geq n _ { i j } > 1 . 5 n _ { a v e } \\ & 0 . 4 0 , \, 1 . 5 n _ { a v e } \geq n _ { i j } > n _ { a v e } \\ & 0 . 2 0 , \, n _ { a v e } > n _ { i j } \end{cases}</formula><end_of_utterance>
2025-06-10 20:20:50,584 - DEBUG - Starting _parse_docling_output
2025-06-10 20:20:50,584 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>W _ { i j } = \begin{cases} & 1 . 0 0 , \, n _ { i j } > 3 n _ { a v e } \\ & 0 . 7 0 , \, 3 n _ { a v e } \geq n _ { i j } > 1 . 5 n _ { a v e } \\ & 0 . 4 0 , \, 1 . 5 n _ { a v e } \geq n _ { i j } > n _ { a v e } \\ & 0 . 2 0 , \, n _ { a v e } > n _ { i j } \end{cases}</formula><end_of_utterance>
2025-06-10 20:20:50,584 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:20:50,585 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>W _ { i j } = \\begin{cases} & 1 . 0 0 , \\, n _ { i j } > 3 n _ { a v e } \\\\ & 0 . 7 0 , \\, 3 n _ { a v e } \\geq n _ { i j } > 1 . 5 n _ { a v e } \\\\ & 0 . 4 0 , \\, 1 . 5 n _ { a v e } \\geq n _ { i j } > n _ { a v e } \\\\ & 0 . 2 0 , \\, n _ { a v e } > n _ { i j } \\end{cases}</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=815x235 at 0x7F96AA7C19D0>)]
2025-06-10 20:20:50,585 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:20:50,591 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=815.0, b=235.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 274))], orig='W _ { i j } = \\begin{cases} & 1 . 0 0 , \\, n _ { i j } > 3 n _ { a v e } \\\\ & 0 . 7 0 , \\, 3 n _ { a v e } \\geq n _ { i j } > 1 . 5 n _ { a v e } \\\\ & 0 . 4 0 , \\, 1 . 5 n _ { a v e } \\geq n _ { i j } > n _ { a v e } \\\\ & 0 . 2 0 , \\, n _ { a v e } > n _ { i j } \\end{cases}', text='W _ { i j } = \\begin{cases} & 1 . 0 0 , \\, n _ { i j } > 3 n _ { a v e } \\\\ & 0 . 7 0 , \\, 3 n _ { a v e } \\geq n _ { i j } > 1 . 5 n _ { a v e } \\\\ & 0 . 4 0 , \\, 1 . 5 n _ { a v e } \\geq n _ { i j } > n _ { a v e } \\\\ & 0 . 2 0 , \\, n _ { a v e } > n _ { i j } \\end{cases}', formatting=None, hyperlink=None)]
2025-06-10 20:20:50,591 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:20:50,592 - DEBUG - Processing text item: label=formula, text=W _ { i j } = \begin{cases} & 1 . 0 0 , \, n _ { i j } > 3 n _ { a v e } \\ & 0 . 7 0 , \, 3 n _ { a v e } \geq n _ { i j } > 1 . 5 n _ { a v e } \\ & 0 . 4 0 , \, 1 . 5 n _ { a v e } \geq n _ { i j } > n _ { a v e } \\ & 0 . 2 0 , \, n _ { a v e } > n _ { i j } \end{cases}
2025-06-10 20:20:50,592 - DEBUG - Recognized string extracted: W _ { i j } = \begin{cases} & 1 . 0 0 , \, n _ { i j } > 3 n _ { a v e } \\ & 0 . 7 0 , \, 3 n _ { a v e } \geq n _ { i j } > 1 . 5 n _ { a v e } \\ & 0 . 4 0 , \, 1 . 5 n _ { a v e } \geq n _ { i j } > n _ { a v e } \\ & 0 . 2 0 , \, n _ { a v e } > n _ { i j } \end{cases}
2025-06-10 20:20:50,592 - INFO - All done. Returning 5 recognized text results.
2025-06-10 20:20:50,592 - DEBUG - Snippet 10.3390_atmos14121806_744_item_0 recognized text:
MALFORMED_FORMULA
2025-06-10 20:20:50,593 - DEBUG - Snippet 10.3390_atmos14121806_744_item_1 recognized text:
S O A F P _ { S } = \sum _ { i } V O C _ { i } \times F A C _ { i }
2025-06-10 20:20:50,593 - DEBUG - Snippet 10.3390_atmos14121806_744_item_2 recognized text:
P S C F _ { i j } = \frac { n _ { i j } } { n _ { i j } }
2025-06-10 20:20:50,593 - DEBUG - Snippet 10.3390_atmos14121806_744_item_3 recognized text:
C _ { i j } = \frac { \sum _ { a = 1 } ^ { b } C _ { a } \times t _ { i j a } } { \sum _ { a = 1 } ^ { b } t _ { i j a } }
2025-06-10 20:20:50,593 - DEBUG - Snippet 10.3390_atmos14121806_744_item_4 recognized text:
W _ { i j } = \begin{cases} & 1 . 0 0 , \, n _ { i j } > 3 n _ { a v e } \\ & 0 . 7 0 , \, 3 n _ { a v e } \geq n _ { i j } > 1 . 5 n _ { a v e } \\ & 0 . 4 0 , \, 1 . 5 n _ { a v e } \geq n _ { i j } > n _ { a v e } \\ & 0 . 2 0 , \, n _ { a v e } > n _ { i j } \end{cases}
2025-06-10 20:20:50,695 - DEBUG - Creating masked image for page 4 with 12 clusters.
2025-06-10 20:20:50,696 - INFO - Masked image successfully created for page 4.
2025-06-10 20:20:50,701 - INFO - Starting prediction for 2 images with labels: ['formula', 'formula']
2025-06-10 20:20:50,701 - DEBUG - Generating chat message for label: formula
2025-06-10 20:20:50,702 - DEBUG - Snippet 10.3390_atmos14121806_744_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:20:50,731 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:50,768 - DEBUG - Snippet 10.3390_atmos14121806_744_item_0 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:20:50,801 - DEBUG - [Page 41] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:50,876 - DEBUG - Finished converting page batch time=4005.856
2025-06-10 20:20:51,081 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:51,234 - DEBUG - Snippet 10.1038_s41467-024-55450-0_721_item_4: generation shape=torch.Size([1, 390])
2025-06-10 20:20:51,234 - DEBUG - Snippet 10.1038_s41467-024-55450-0_721_item_4 raw docling: (tokens=44)
<formula><loc_0><loc_0><loc_500><loc_500>p a f _ { i } = 1 - \frac { 1 } { R R _ { i } }</formula><end_of_utterance>
2025-06-10 20:20:51,235 - DEBUG - Starting _parse_docling_output
2025-06-10 20:20:51,235 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>p a f _ { i } = 1 - \frac { 1 } { R R _ { i } }</formula><end_of_utterance>
2025-06-10 20:20:51,235 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:20:51,235 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>p a f _ { i } = 1 - \\frac { 1 } { R R _ { i } }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=447x100 at 0x7F96C8CA7B00>)]
2025-06-10 20:20:51,236 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:20:51,238 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=447.0, b=100.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 47))], orig='p a f _ { i } = 1 - \\frac { 1 } { R R _ { i } }', text='p a f _ { i } = 1 - \\frac { 1 } { R R _ { i } }', formatting=None, hyperlink=None)]
2025-06-10 20:20:51,238 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:20:51,238 - DEBUG - Processing text item: label=formula, text=p a f _ { i } = 1 - \frac { 1 } { R R _ { i } }
2025-06-10 20:20:51,239 - DEBUG - Recognized string extracted: p a f _ { i } = 1 - \frac { 1 } { R R _ { i } }
2025-06-10 20:20:51,239 - INFO - All done. Returning 5 recognized text results.
2025-06-10 20:20:51,239 - DEBUG - Snippet 10.1038_s41467-024-55450-0_721_item_0 recognized text:
\emph { mean bias = } \frac { 1 } { k } \sum ( \hat { v } - v )
2025-06-10 20:20:51,239 - DEBUG - Snippet 10.1038_s41467-024-55450-0_721_item_1 recognized text:
v _ { p w } = \frac { \sum p o p _ { i } \times \hat { v } _ { i } } { \sum p o p _ { i } }
2025-06-10 20:20:51,239 - DEBUG - Snippet 10.1038_s41467-024-55450-0_721_item_2 recognized text:
E L _ { U , D } ( U _ { x } , D _ { y } ) = \frac { \sum p o p _ { i } \times I _ { U , D } ( U _ { i } > U _ { x } , D _ { i } > D _ { y } ) } { \sum p o p _ { i } } \times 1 0 0 \%
2025-06-10 20:20:51,239 - DEBUG - Snippet 10.1038_s41467-024-55450-0_721_item_3 recognized text:
R R _ { i } = e ^ { \gamma ( v _ { m i } - v _ { s } ) }
2025-06-10 20:20:51,240 - DEBUG - Snippet 10.1038_s41467-024-55450-0_721_item_4 recognized text:
p a f _ { i } = 1 - \frac { 1 } { R R _ { i } }
2025-06-10 20:20:51,243 - INFO - Starting prediction for 2 images with labels: ['formula', 'formula']
2025-06-10 20:20:51,243 - DEBUG - Generating chat message for label: formula
2025-06-10 20:20:51,244 - DEBUG - Snippet 10.1038_s41467-024-55450-0_721_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:20:51,290 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:51,315 - DEBUG - Snippet 10.1038_s41467-024-55450-0_721_item_0 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:20:51,799 - DEBUG - [Page 42] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:51,901 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:51,902 - DEBUG - Finished converting page batch time=4006.882
2025-06-10 20:20:52,117 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:52,350 - DEBUG - Snippet 10.1214_10-aoas351_689_item_4: generation shape=torch.Size([1, 497])
2025-06-10 20:20:52,352 - DEBUG - Snippet 10.1214_10-aoas351_689_item_4 raw docling: (tokens=151)
<formula><loc_0><loc_0><loc_500><loc_500>C o v ( Y _ { 2 } ( s ) , Y _ { 2 } ( s ^ { \prime } ) ) = A _ { 4 1 } ^ { 2 } \exp ( - \phi _ { 1 } \| s - s ^ { \prime } \| ) + A _ { 4 4 } ^ { 2 } \exp ( - \phi _ { 4 } \| s - s ^ { \prime } \| ) + \tau _ { 2 } ^ { 2 } \delta _ { s , s ^ { \prime } } ,</formula><end_of_utterance>
2025-06-10 20:20:52,352 - DEBUG - Starting _parse_docling_output
2025-06-10 20:20:52,352 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>C o v ( Y _ { 2 } ( s ) , Y _ { 2 } ( s ^ { \prime } ) ) = A _ { 4 1 } ^ { 2 } \exp ( - \phi _ { 1 } \| s - s ^ { \prime } \| ) + A _ { 4 4 } ^ { 2 } \exp ( - \phi _ { 4 } \| s - s ^ { \prime } \| ) + \tau _ { 2 } ^ { 2 } \delta _ { s , s ^ { \prime } } ,</formula><end_of_utterance>
2025-06-10 20:20:52,352 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:20:52,353 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>C o v ( Y _ { 2 } ( s ) , Y _ { 2 } ( s ^ { \\prime } ) ) = A _ { 4 1 } ^ { 2 } \\exp ( - \\phi _ { 1 } \\| s - s ^ { \\prime } \\| ) + A _ { 4 4 } ^ { 2 } \\exp ( - \\phi _ { 4 } \\| s - s ^ { \\prime } \\| ) + \\tau _ { 2 } ^ { 2 } \\delta _ { s , s ^ { \\prime } } ,</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=996x72 at 0x7F96B2922810>)]
2025-06-10 20:20:52,353 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:20:52,357 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=996.0, b=72.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 255))], orig='C o v ( Y _ { 2 } ( s ) , Y _ { 2 } ( s ^ { \\prime } ) ) = A _ { 4 1 } ^ { 2 } \\exp ( - \\phi _ { 1 } \\| s - s ^ { \\prime } \\| ) + A _ { 4 4 } ^ { 2 } \\exp ( - \\phi _ { 4 } \\| s - s ^ { \\prime } \\| ) + \\tau _ { 2 } ^ { 2 } \\delta _ { s , s ^ { \\prime } } ,', text='C o v ( Y _ { 2 } ( s ) , Y _ { 2 } ( s ^ { \\prime } ) ) = A _ { 4 1 } ^ { 2 } \\exp ( - \\phi _ { 1 } \\| s - s ^ { \\prime } \\| ) + A _ { 4 4 } ^ { 2 } \\exp ( - \\phi _ { 4 } \\| s - s ^ { \\prime } \\| ) + \\tau _ { 2 } ^ { 2 } \\delta _ { s , s ^ { \\prime } } ,', formatting=None, hyperlink=None)]
2025-06-10 20:20:52,357 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:20:52,358 - DEBUG - Processing text item: label=formula, text=C o v ( Y _ { 2 } ( s ) , Y _ { 2 } ( s ^ { \prime } ) ) = A _ { 4 1 } ^ { 2 } \exp ( - \phi _ { 1 } \| s - s ^ { \prime } \| ) + A _ { 4 4 } ^ { 2 } \exp ( - \phi _ { 4 } \| s - s ^ { \prime } \| ) + \tau _ { 2 } ^ { 2 } \delta _ { s , s ^ { \prime } } ,
2025-06-10 20:20:52,358 - DEBUG - Recognized string extracted: C o v ( Y _ { 2 } ( s ) , Y _ { 2 } ( s ^ { \prime } ) ) = A _ { 4 1 } ^ { 2 } \exp ( - \phi _ { 1 } \| s - s ^ { \prime } \| ) + A _ { 4 4 } ^ { 2 } \exp ( - \phi _ { 4 } \| s - s ^ { \prime } \| ) + \tau _ { 2 } ^ { 2 } \delta _ { s , s ^ { \prime } } ,
2025-06-10 20:20:52,358 - INFO - All done. Returning 5 recognized text results.
2025-06-10 20:20:52,358 - DEBUG - Snippet 10.1214_10-aoas351_689_item_0 recognized text:
\mathfrak { d } _ { t } = \mathfrak { D } _ { B o t h , t } \cup \mathfrak { D } _ { O , t } \cup \mathfrak { D } _ { P M , t } ,
2025-06-10 20:20:52,359 - DEBUG - Snippet 10.1214_10-aoas351_689_item_1 recognized text:
C R P S ( F , y ) = \int ( F ( z ) - 1 _ { \{ z \geq y \} } ) ^ { 2 } d z ,
2025-06-10 20:20:52,359 - DEBUG - Snippet 10.1214_10-aoas351_689_item_2 recognized text:
I S ( l ; u ; y ) = \left [ ( u - l ) + \frac { \L } { \alpha } ( l - y ) 1 _ { \{ y
2025-06-10 20:20:52,359 - DEBUG - Snippet 10.1214_10-aoas351_689_item_3 recognized text:
C o v ( Y _ { 1 } ( s ) , Y _ { 1 } ( s ^ { \prime } ) ) = A _ { 1 1 } ^ { 2 } \exp ( - \phi _ { 1 } \| s - s ^ { \prime } \| ) + \tau _ { 1 } ^ { 2 } \delta _ { s , s ^ { \prime } } ,
2025-06-10 20:20:52,359 - DEBUG - Snippet 10.1214_10-aoas351_689_item_4 recognized text:
C o v ( Y _ { 2 } ( s ) , Y _ { 2 } ( s ^ { \prime } ) ) = A _ { 4 1 } ^ { 2 } \exp ( - \phi _ { 1 } \| s - s ^ { \prime } \| ) + A _ { 4 4 } ^ { 2 } \exp ( - \phi _ { 4 } \| s - s ^ { \prime } \| ) + \tau _ { 2 } ^ { 2 } \delta _ { s , s ^ { \prime } } ,
2025-06-10 20:20:52,428 - DEBUG - Creating masked image for page 30 with 12 clusters.
2025-06-10 20:20:52,429 - INFO - Masked image successfully created for page 30.
2025-06-10 20:20:52,439 - INFO - Starting prediction for 5 images with labels: ['formula', 'formula', 'formula', 'formula', 'formula']
2025-06-10 20:20:52,440 - DEBUG - Generating chat message for label: formula
2025-06-10 20:20:52,440 - DEBUG - Snippet 10.1214_10-aoas351_689_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:20:52,572 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:52,574 - DEBUG - Finished converting page batch time=4007.554
2025-06-10 20:20:52,576 - DEBUG - Snippet 10.1214_10-aoas351_689_item_0 => input_ids shape=torch.Size([1, 610]), prompt_len=610
2025-06-10 20:20:52,625 - DEBUG - Snippet 10.1038_s41467-024-55450-0_721_item_0: generation shape=torch.Size([1, 393])
2025-06-10 20:20:52,626 - DEBUG - Snippet 10.1038_s41467-024-55450-0_721_item_0 raw docling: (tokens=47)
<formula><loc_0><loc_0><loc_500><loc_500>t p a f = \sum \nolimits \rho p _ { i } \times p a f _ { i }</formula><end_of_utterance>
2025-06-10 20:20:52,627 - DEBUG - Starting _parse_docling_output
2025-06-10 20:20:52,627 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>t p a f = \sum \nolimits \rho p _ { i } \times p a f _ { i }</formula><end_of_utterance>
2025-06-10 20:20:52,627 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:20:52,627 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>t p a f = \\sum \\nolimits \\rho p _ { i } \\times p a f _ { i }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=486x107 at 0x7F96DFF3E780>)]
2025-06-10 20:20:52,628 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:20:52,631 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=486.0, b=107.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 60))], orig='t p a f = \\sum \\nolimits \\rho p _ { i } \\times p a f _ { i }', text='t p a f = \\sum \\nolimits \\rho p _ { i } \\times p a f _ { i }', formatting=None, hyperlink=None)]
2025-06-10 20:20:52,631 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:20:52,631 - DEBUG - Processing text item: label=formula, text=t p a f = \sum \nolimits \rho p _ { i } \times p a f _ { i }
2025-06-10 20:20:52,631 - DEBUG - Recognized string extracted: t p a f = \sum \nolimits \rho p _ { i } \times p a f _ { i }
2025-06-10 20:20:52,631 - DEBUG - Generating chat message for label: formula
2025-06-10 20:20:52,632 - DEBUG - Snippet 10.1038_s41467-024-55450-0_721_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:20:52,697 - DEBUG - [Page 43] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:52,698 - DEBUG - Finished converting page batch time=4007.679
2025-06-10 20:20:52,699 - DEBUG - Snippet 10.1038_s41467-024-55450-0_721_item_1 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:20:52,737 - DEBUG - Dynamic vertical threshold: 44.64720000000016, Overlap threshold: 0.7
2025-06-10 20:20:52,740 - DEBUG - Checking merge:
  Current: 10, Next: 12
2025-06-10 20:20:52,740 - DEBUG -   Vertical gap: 9.695999999999913, Overlap ratio: 0.9999970665798374
2025-06-10 20:20:52,741 - DEBUG -   Left boundary diff: 0.0009999999999763531, Right boundary diff: 0.008000000000038199
2025-06-10 20:20:52,741 - DEBUG -   Alignment factor (ratio): 3.3208455703191956e-05
2025-06-10 20:20:52,741 - DEBUG -   -> c1 10 formula number: 2, c2 12 formula number: 3
2025-06-10 20:20:52,741 - DEBUG -   -> Not merging clusters 10 and 12 due to different formula numbers: 2 vs 3
2025-06-10 20:20:52,741 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:52,889 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:53,053 - DEBUG - Finished converting page batch time=4008.033
2025-06-10 20:20:53,055 - DEBUG - Snippet 10.3390_atmos14121806_744_item_0: generation shape=torch.Size([1, 426])
2025-06-10 20:20:53,056 - DEBUG - Snippet 10.3390_atmos14121806_744_item_0 raw docling: (tokens=80)
<formula><loc_0><loc_0><loc_500><loc_500>\Delta M _ { i , y } = P _ { y } \times I _ { i , y } \times \left [ 1 - 1 / e ^ { \beta _ { i } ( C _ { y } - C _ { 0 } ) } \right ]</formula><end_of_utterance>
2025-06-10 20:20:53,056 - DEBUG - Starting _parse_docling_output
2025-06-10 20:20:53,056 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>\Delta M _ { i , y } = P _ { y } \times I _ { i , y } \times \left [ 1 - 1 / e ^ { \beta _ { i } ( C _ { y } - C _ { 0 } ) } \right ]</formula><end_of_utterance>
2025-06-10 20:20:53,056 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:20:53,057 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>\\Delta M _ { i , y } = P _ { y } \\times I _ { i , y } \\times \\left [ 1 - 1 / e ^ { \\beta _ { i } ( C _ { y } - C _ { 0 } ) } \\right ]</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=826x90 at 0x7F96AA7C2C00>)]
2025-06-10 20:20:53,057 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:20:53,060 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=826.0, b=90.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 133))], orig='\\Delta M _ { i , y } = P _ { y } \\times I _ { i , y } \\times \\left [ 1 - 1 / e ^ { \\beta _ { i } ( C _ { y } - C _ { 0 } ) } \\right ]', text='\\Delta M _ { i , y } = P _ { y } \\times I _ { i , y } \\times \\left [ 1 - 1 / e ^ { \\beta _ { i } ( C _ { y } - C _ { 0 } ) } \\right ]', formatting=None, hyperlink=None)]
2025-06-10 20:20:53,060 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:20:53,060 - DEBUG - Processing text item: label=formula, text=\Delta M _ { i , y } = P _ { y } \times I _ { i , y } \times \left [ 1 - 1 / e ^ { \beta _ { i } ( C _ { y } - C _ { 0 } ) } \right ]
2025-06-10 20:20:53,060 - DEBUG - Recognized string extracted: \Delta M _ { i , y } = P _ { y } \times I _ { i , y } \times \left [ 1 - 1 / e ^ { \beta _ { i } ( C _ { y } - C _ { 0 } ) } \right ]
2025-06-10 20:20:53,061 - DEBUG - Generating chat message for label: formula
2025-06-10 20:20:53,061 - DEBUG - Snippet 10.3390_atmos14121806_744_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:20:53,130 - DEBUG - Snippet 10.3390_atmos14121806_744_item_1 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:20:53,174 - DEBUG - [Page 44] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:53,175 - DEBUG - Finished converting page batch time=4008.155
2025-06-10 20:20:53,573 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:53,575 - DEBUG - Finished converting page batch time=4008.555
2025-06-10 20:20:53,584 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:53,586 - DEBUG - Creating masked image for page 12 with 22 clusters.
2025-06-10 20:20:53,587 - INFO - Masked image successfully created for page 12.
2025-06-10 20:20:53,725 - DEBUG - Creating masked image for page 13 with 16 clusters.
2025-06-10 20:20:53,726 - INFO - Masked image successfully created for page 13.
2025-06-10 20:20:53,737 - INFO - Starting prediction for 5 images with labels: ['formula', 'formula', 'formula', 'formula', 'formula']
2025-06-10 20:20:53,737 - DEBUG - Generating chat message for label: formula
2025-06-10 20:20:53,738 - DEBUG - Snippet 10.3390_catal11080998_724_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:20:53,834 - INFO - Finished converting document 10.1186_1476-069x-11-5_771.pdf in 16.87 sec.
2025-06-10 20:20:53,921 - DEBUG - Snippet 10.3390_catal11080998_724_item_0 => input_ids shape=torch.Size([1, 610]), prompt_len=610
2025-06-10 20:20:53,950 - DEBUG - Snippet 10.1038_s41467-024-55450-0_721_item_1: generation shape=torch.Size([1, 389])
2025-06-10 20:20:53,951 - DEBUG - Snippet 10.1038_s41467-024-55450-0_721_item_1 raw docling: (tokens=43)
<formula><loc_0><loc_0><loc_500><loc_500>d e a = \sum p o p _ { i } \times t p a f \times m o r</formula><end_of_utterance>
2025-06-10 20:20:53,951 - DEBUG - Starting _parse_docling_output
2025-06-10 20:20:53,952 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>d e a = \sum p o p _ { i } \times t p a f \times m o r</formula><end_of_utterance>
2025-06-10 20:20:53,952 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:20:53,952 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>d e a = \\sum p o p _ { i } \\times t p a f \\times m o r</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=521x83 at 0x7F96DFFEC500>)]
2025-06-10 20:20:53,953 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:20:53,955 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=521.0, b=83.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 54))], orig='d e a = \\sum p o p _ { i } \\times t p a f \\times m o r', text='d e a = \\sum p o p _ { i } \\times t p a f \\times m o r', formatting=None, hyperlink=None)]
2025-06-10 20:20:53,955 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:20:53,956 - DEBUG - Processing text item: label=formula, text=d e a = \sum p o p _ { i } \times t p a f \times m o r
2025-06-10 20:20:53,956 - DEBUG - Recognized string extracted: d e a = \sum p o p _ { i } \times t p a f \times m o r
2025-06-10 20:20:53,956 - INFO - All done. Returning 2 recognized text results.
2025-06-10 20:20:53,957 - DEBUG - Snippet 10.1038_s41467-024-55450-0_721_item_0 recognized text:
t p a f = \sum \nolimits \rho p _ { i } \times p a f _ { i }
2025-06-10 20:20:53,957 - DEBUG - Snippet 10.1038_s41467-024-55450-0_721_item_1 recognized text:
d e a = \sum p o p _ { i } \times t p a f \times m o r
2025-06-10 20:20:53,981 - INFO - Extraction successful row 153, tokens=25060
2025-06-10 20:20:54,016 - INFO - Going to convert document batch...
2025-06-10 20:20:54,016 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:20:54,017 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:20:54,104 - INFO - Finished converting document 10.1038_s41467-024-55450-0_721.pdf in 58.75 sec.
2025-06-10 20:20:54,120 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:20:54,122 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:54,254 - INFO - Extraction successful row 143, tokens=20950
2025-06-10 20:20:54,277 - INFO - Going to convert document batch...
2025-06-10 20:20:54,277 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:20:54,277 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:20:54,329 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:20:54,818 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:55,023 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:55,248 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:20:55,306 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:20:55,393 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:20:55,399 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:20:55,567 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:20:55,573 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:20:55,771 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:20:55,771 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:20:55,776 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:20:55,813 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:20:55,818 - DEBUG - Snippet 10.3390_catal11080998_724_item_0: generation shape=torch.Size([1, 661])
2025-06-10 20:20:55,819 - DEBUG - Snippet 10.3390_catal11080998_724_item_0 raw docling: (tokens=50)
<formula><loc_0><loc_0><loc_500><loc_500>M + H _ { 2 } O \to M ( \bullet O H ) + H ^ { + } + e ^ { - }</formula><end_of_utterance>
2025-06-10 20:20:55,819 - DEBUG - Starting _parse_docling_output
2025-06-10 20:20:55,819 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>M + H _ { 2 } O \to M ( \bullet O H ) + H ^ { + } + e ^ { - }</formula><end_of_utterance>
2025-06-10 20:20:55,819 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:20:55,820 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>M + H _ { 2 } O \\to M ( \\bullet O H ) + H ^ { + } + e ^ { - }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=1257x315 at 0x7F96A6126270>)]
2025-06-10 20:20:55,820 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:20:55,828 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=1257.0, b=315.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 61))], orig='M + H _ { 2 } O \\to M ( \\bullet O H ) + H ^ { + } + e ^ { - }', text='M + H _ { 2 } O \\to M ( \\bullet O H ) + H ^ { + } + e ^ { - }', formatting=None, hyperlink=None)]
2025-06-10 20:20:55,829 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:20:55,829 - DEBUG - Processing text item: label=formula, text=M + H _ { 2 } O \to M ( \bullet O H ) + H ^ { + } + e ^ { - }
2025-06-10 20:20:55,829 - DEBUG - Recognized string extracted: M + H _ { 2 } O \to M ( \bullet O H ) + H ^ { + } + e ^ { - }
2025-06-10 20:20:55,829 - DEBUG - Generating chat message for label: formula
2025-06-10 20:20:55,829 - DEBUG - Snippet 10.3390_catal11080998_724_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:20:55,910 - DEBUG - Snippet 10.3390_catal11080998_724_item_1 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:20:55,929 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:20:55,965 - DEBUG - Snippet 10.3390_atmos14121806_744_item_1: generation shape=torch.Size([1, 419])
2025-06-10 20:20:55,966 - DEBUG - Snippet 10.3390_atmos14121806_744_item_1 raw docling: (tokens=73)
<formula><loc_0><loc_0><loc_500><loc_500>V S L _ { y } = V S L _ { b a s e } \times \left ( \frac { I _ { y } } { I _ { b a s e } } \right ) ^ { \beta _ { E } }</formula><end_of_utterance>
2025-06-10 20:20:55,966 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:20:55,968 - DEBUG - Starting _parse_docling_output
2025-06-10 20:20:55,968 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>V S L _ { y } = V S L _ { b a s e } \times \left ( \frac { I _ { y } } { I _ { b a s e } } \right ) ^ { \beta _ { E } }</formula><end_of_utterance>
2025-06-10 20:20:55,968 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:20:55,969 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>V S L _ { y } = V S L _ { b a s e } \\times \\left ( \\frac { I _ { y } } { I _ { b a s e } } \\right ) ^ { \\beta _ { E } }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=761x128 at 0x7F96D63B4D70>)]
2025-06-10 20:20:55,969 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:20:55,972 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=761.0, b=128.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 119))], orig='V S L _ { y } = V S L _ { b a s e } \\times \\left ( \\frac { I _ { y } } { I _ { b a s e } } \\right ) ^ { \\beta _ { E } }', text='V S L _ { y } = V S L _ { b a s e } \\times \\left ( \\frac { I _ { y } } { I _ { b a s e } } \\right ) ^ { \\beta _ { E } }', formatting=None, hyperlink=None)]
2025-06-10 20:20:55,972 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:20:55,973 - DEBUG - Processing text item: label=formula, text=V S L _ { y } = V S L _ { b a s e } \times \left ( \frac { I _ { y } } { I _ { b a s e } } \right ) ^ { \beta _ { E } }
2025-06-10 20:20:55,973 - DEBUG - Recognized string extracted: V S L _ { y } = V S L _ { b a s e } \times \left ( \frac { I _ { y } } { I _ { b a s e } } \right ) ^ { \beta _ { E } }
2025-06-10 20:20:55,973 - INFO - All done. Returning 2 recognized text results.
2025-06-10 20:20:55,973 - DEBUG - Snippet 10.3390_atmos14121806_744_item_0 recognized text:
\Delta M _ { i , y } = P _ { y } \times I _ { i , y } \times \left [ 1 - 1 / e ^ { \beta _ { i } ( C _ { y } - C _ { 0 } ) } \right ]
2025-06-10 20:20:55,973 - DEBUG - Snippet 10.3390_atmos14121806_744_item_1 recognized text:
V S L _ { y } = V S L _ { b a s e } \times \left ( \frac { I _ { y } } { I _ { b a s e } } \right ) ^ { \beta _ { E } }
2025-06-10 20:20:55,998 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:20:55,999 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:20:55,999 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:20:56,009 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:20:56,016 - DEBUG - Snippet 10.1214_10-aoas351_689_item_0: generation shape=torch.Size([1, 708])
2025-06-10 20:20:56,017 - DEBUG - Snippet 10.1214_10-aoas351_689_item_0 raw docling: (tokens=97)
<formula><loc_0><loc_0><loc_500><loc_500>_ { 2 } ( s ^ { \prime } ) = A _ { 1 1 } ^ { 2 } \exp ( - \phi _ { 1 } \| s - s ^ { \prime } \| ) + \tau _ { 1 } ^ { 2 } \delta _ { s , s ^ { \prime } } ,</formula><end_of_utterance>
2025-06-10 20:20:56,017 - DEBUG - Starting _parse_docling_output
2025-06-10 20:20:56,017 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>_ { 2 } ( s ^ { \prime } ) = A _ { 1 1 } ^ { 2 } \exp ( - \phi _ { 1 } \| s - s ^ { \prime } \| ) + \tau _ { 1 } ^ { 2 } \delta _ { s , s ^ { \prime } } ,</formula><end_of_utterance>
2025-06-10 20:20:56,017 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:20:56,017 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>_ { 2 } ( s ^ { \\prime } ) = A _ { 1 1 } ^ { 2 } \\exp ( - \\phi _ { 1 } \\| s - s ^ { \\prime } \\| ) + \\tau _ { 1 } ^ { 2 } \\delta _ { s , s ^ { \\prime } } ,</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=807x204 at 0x7F9688D11040>)]
2025-06-10 20:20:56,018 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:20:56,023 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=807.0, b=204.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 154))], orig='_ { 2 } ( s ^ { \\prime } ) = A _ { 1 1 } ^ { 2 } \\exp ( - \\phi _ { 1 } \\| s - s ^ { \\prime } \\| ) + \\tau _ { 1 } ^ { 2 } \\delta _ { s , s ^ { \\prime } } ,', text='_ { 2 } ( s ^ { \\prime } ) = A _ { 1 1 } ^ { 2 } \\exp ( - \\phi _ { 1 } \\| s - s ^ { \\prime } \\| ) + \\tau _ { 1 } ^ { 2 } \\delta _ { s , s ^ { \\prime } } ,', formatting=None, hyperlink=None)]
2025-06-10 20:20:56,023 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:20:56,023 - DEBUG - Processing text item: label=formula, text=_ { 2 } ( s ^ { \prime } ) = A _ { 1 1 } ^ { 2 } \exp ( - \phi _ { 1 } \| s - s ^ { \prime } \| ) + \tau _ { 1 } ^ { 2 } \delta _ { s , s ^ { \prime } } ,
2025-06-10 20:20:56,024 - DEBUG - Recognized string extracted: _ { 2 } ( s ^ { \prime } ) = A _ { 1 1 } ^ { 2 } \exp ( - \phi _ { 1 } \| s - s ^ { \prime } \| ) + \tau _ { 1 } ^ { 2 } \delta _ { s , s ^ { \prime } } ,
2025-06-10 20:20:56,024 - DEBUG - Generating chat message for label: formula
2025-06-10 20:20:56,024 - DEBUG - Snippet 10.1214_10-aoas351_689_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:20:56,038 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:20:56,045 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:20:56,053 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:56,077 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:20:56,080 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:20:56,112 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:20:56,132 - INFO - Finished converting document 10.3390_atmos14121806_744.pdf in 37.41 sec.
2025-06-10 20:20:56,154 - DEBUG - Snippet 10.1214_10-aoas351_689_item_1 => input_ids shape=torch.Size([1, 610]), prompt_len=610
2025-06-10 20:20:56,155 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:20:56,191 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:20:56,202 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:56,202 - DEBUG - Finished converting page batch time=4011.182
2025-06-10 20:20:56,225 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:20:56,350 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:20:56,352 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:20:56,354 - DEBUG - Creating masked image for page 2 with 17 clusters.
2025-06-10 20:20:56,355 - INFO - Masked image successfully created for page 2.
2025-06-10 20:20:56,358 - INFO - Extraction successful row 149, tokens=26242
2025-06-10 20:20:56,359 - INFO - Starting prediction for 1 images with labels: ['formula']
2025-06-10 20:20:56,359 - DEBUG - Generating chat message for label: formula
2025-06-10 20:20:56,359 - DEBUG - Snippet 10.1186_1476-069x-11-82_782_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:20:56,379 - INFO - Going to convert document batch...
2025-06-10 20:20:56,379 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:20:56,380 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:20:56,388 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:20:56,390 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:20:56,403 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:56,404 - DEBUG - Finished converting page batch time=4011.385
2025-06-10 20:20:56,428 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:20:56,428 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:20:56,496 - DEBUG - Snippet 10.1186_1476-069x-11-82_782_item_0 => input_ids shape=torch.Size([1, 610]), prompt_len=610
2025-06-10 20:20:56,546 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:20:56,587 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:20:56,628 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:56,629 - DEBUG - Finished converting page batch time=4011.609
2025-06-10 20:20:56,702 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:20:56,763 - DEBUG - Creating masked image for page 4 with 14 clusters.
2025-06-10 20:20:56,765 - INFO - Masked image successfully created for page 4.
2025-06-10 20:20:56,771 - INFO - Starting prediction for 3 images with labels: ['formula', 'formula', 'formula']
2025-06-10 20:20:56,771 - DEBUG - Generating chat message for label: formula
2025-06-10 20:20:56,771 - DEBUG - Snippet 10.4209_aaqr.2009.10.0061_772_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:20:56,840 - DEBUG - Snippet 10.4209_aaqr.2009.10.0061_772_item_0 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:20:56,869 - DEBUG - Snippet 10.3390_catal11080998_724_item_1: generation shape=torch.Size([1, 375])
2025-06-10 20:20:56,869 - DEBUG - Snippet 10.3390_catal11080998_724_item_1 raw docling: (tokens=29)
<formula><loc_0><loc_0><loc_500><loc_500>M O + R \to M + R O</formula><end_of_utterance>
2025-06-10 20:20:56,869 - DEBUG - Starting _parse_docling_output
2025-06-10 20:20:56,870 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>M O + R \to M + R O</formula><end_of_utterance>
2025-06-10 20:20:56,870 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:20:56,870 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>M O + R \\to M + R O</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=1249x79 at 0x7F96CE1C7620>)]
2025-06-10 20:20:56,870 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:20:56,872 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:20:56,873 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=1249.0, b=79.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 19))], orig='M O + R \\to M + R O', text='M O + R \\to M + R O', formatting=None, hyperlink=None)]
2025-06-10 20:20:56,873 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:20:56,874 - DEBUG - Processing text item: label=formula, text=M O + R \to M + R O
2025-06-10 20:20:56,874 - DEBUG - Recognized string extracted: M O + R \to M + R O
2025-06-10 20:20:56,874 - DEBUG - Generating chat message for label: formula
2025-06-10 20:20:56,874 - DEBUG - Snippet 10.3390_catal11080998_724_item_2 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:20:56,940 - DEBUG - Snippet 10.3390_catal11080998_724_item_2 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:20:56,996 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:20:57,147 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:20:57,147 - INFO - Processing document 10.1590_s0034-8910.2014048005218_785.pdf
2025-06-10 20:20:57,230 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:20:57,231 - INFO - Processing document 10.1186_s12940-019-0476-4_784.pdf
2025-06-10 20:20:57,313 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:20:57,361 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:20:57,367 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:20:57,447 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:57,757 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:57,773 - WARNING - Repetitive generation detected with pattern: 'Delta \'
2025-06-10 20:20:57,774 - DEBUG - Snippet 10.4209_aaqr.2009.10.0061_772_item_0: generation shape=torch.Size([1, 371])
2025-06-10 20:20:57,776 - DEBUG - Snippet 10.4209_aaqr.2009.10.0061_772_item_0 raw docling: (tokens=25)
<formula><loc_0><loc_0><loc_500><loc_500>\Delta \Delta \Delta \Delta \
2025-06-10 20:20:57,776 - DEBUG - Starting _parse_docling_output
2025-06-10 20:20:57,776 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>\Delta \Delta \Delta \Delta \
2025-06-10 20:20:57,776 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:20:57,777 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>\\Delta \\Delta \\Delta \\Delta \\', image=<PIL.Image.Image image mode=RGB size=710x100 at 0x7F9692A69940>)]
2025-06-10 20:20:57,777 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:20:57,779 - DEBUG - DoclingDocument loaded successfully. Extracted texts: []
2025-06-10 20:20:57,780 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:20:57,780 - WARNING - Extracted text is empty or malformed. Skipping formula.
2025-06-10 20:20:57,780 - DEBUG - Generating chat message for label: formula
2025-06-10 20:20:57,781 - DEBUG - Snippet 10.4209_aaqr.2009.10.0061_772_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:20:57,848 - DEBUG - Snippet 10.4209_aaqr.2009.10.0061_772_item_1 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:20:57,851 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:57,861 - DEBUG - Snippet 10.1214_10-aoas351_689_item_1: generation shape=torch.Size([1, 667])
2025-06-10 20:20:57,862 - DEBUG - Snippet 10.1214_10-aoas351_689_item_1 raw docling: (tokens=56)
<formula><loc_0><loc_0><loc_500><loc_500>= A _ { 1 1 } ^ { 2 } \exp ( - \phi _ { 1 } \| s - s ^ { \prime } \| )</formula><end_of_utterance>
2025-06-10 20:20:57,862 - DEBUG - Starting _parse_docling_output
2025-06-10 20:20:57,862 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>= A _ { 1 1 } ^ { 2 } \exp ( - \phi _ { 1 } \| s - s ^ { \prime } \| )</formula><end_of_utterance>
2025-06-10 20:20:57,862 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:20:57,862 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>= A _ { 1 1 } ^ { 2 } \\exp ( - \\phi _ { 1 } \\| s - s ^ { \\prime } \\| )</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=318x112 at 0x7F9688D113A0>)]
2025-06-10 20:20:57,863 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:20:57,865 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=318.0, b=112.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 70))], orig='= A _ { 1 1 } ^ { 2 } \\exp ( - \\phi _ { 1 } \\| s - s ^ { \\prime } \\| )', text='= A _ { 1 1 } ^ { 2 } \\exp ( - \\phi _ { 1 } \\| s - s ^ { \\prime } \\| )', formatting=None, hyperlink=None)]
2025-06-10 20:20:57,865 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:20:57,865 - DEBUG - Processing text item: label=formula, text== A _ { 1 1 } ^ { 2 } \exp ( - \phi _ { 1 } \| s - s ^ { \prime } \| )
2025-06-10 20:20:57,865 - DEBUG - Recognized string extracted: = A _ { 1 1 } ^ { 2 } \exp ( - \phi _ { 1 } \| s - s ^ { \prime } \| )
2025-06-10 20:20:57,866 - DEBUG - Generating chat message for label: formula
2025-06-10 20:20:57,866 - DEBUG - Snippet 10.1214_10-aoas351_689_item_2 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:20:57,937 - DEBUG - Snippet 10.1214_10-aoas351_689_item_2 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:20:58,018 - WARNING - Repetitive generation detected with pattern: ' \epsilon'
2025-06-10 20:20:58,019 - DEBUG - Snippet 10.1186_1476-069x-11-82_782_item_0: generation shape=torch.Size([1, 658])
2025-06-10 20:20:58,020 - DEBUG - Snippet 10.1186_1476-069x-11-82_782_item_0 raw docling: (tokens=47)
<formula><loc_0><loc_0><loc_500><loc_500>\log [ E ( Y _ { t } ) ] = \beta _ { 0 } + f ( \epsilon \epsilon \epsilon \epsilon
2025-06-10 20:20:58,020 - DEBUG - Starting _parse_docling_output
2025-06-10 20:20:58,020 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>\log [ E ( Y _ { t } ) ] = \beta _ { 0 } + f ( \epsilon \epsilon \epsilon \epsilon
2025-06-10 20:20:58,020 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:20:58,021 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>\\log [ E ( Y _ { t } ) ] = \\beta _ { 0 } + f ( \\epsilon \\epsilon \\epsilon \\epsilon', image=<PIL.Image.Image image mode=RGB size=678x302 at 0x7F9713945CD0>)]
2025-06-10 20:20:58,021 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:20:58,029 - DEBUG - DoclingDocument loaded successfully. Extracted texts: []
2025-06-10 20:20:58,029 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:20:58,029 - WARNING - Extracted text is empty or malformed. Skipping formula.
2025-06-10 20:20:58,029 - INFO - All done. Returning 1 recognized text results.
2025-06-10 20:20:58,030 - DEBUG - Snippet 10.1186_1476-069x-11-82_782_item_0 recognized text:
MALFORMED_FORMULA
2025-06-10 20:20:58,079 - DEBUG - Snippet 10.3390_catal11080998_724_item_2: generation shape=torch.Size([1, 382])
2025-06-10 20:20:58,080 - DEBUG - Snippet 10.3390_catal11080998_724_item_2 raw docling: (tokens=36)
<formula><loc_0><loc_0><loc_500><loc_500>M O \to M + 1 / 2 O _ { 2 }</formula><end_of_utterance>
2025-06-10 20:20:58,080 - DEBUG - Starting _parse_docling_output
2025-06-10 20:20:58,080 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>M O \to M + 1 / 2 O _ { 2 }</formula><end_of_utterance>
2025-06-10 20:20:58,081 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:20:58,081 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>M O \\to M + 1 / 2 O _ { 2 }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=695x61 at 0x7F96A9910BF0>)]
2025-06-10 20:20:58,081 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:20:58,083 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=695.0, b=61.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 27))], orig='M O \\to M + 1 / 2 O _ { 2 }', text='M O \\to M + 1 / 2 O _ { 2 }', formatting=None, hyperlink=None)]
2025-06-10 20:20:58,083 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:20:58,083 - DEBUG - Processing text item: label=formula, text=M O \to M + 1 / 2 O _ { 2 }
2025-06-10 20:20:58,084 - DEBUG - Recognized string extracted: M O \to M + 1 / 2 O _ { 2 }
2025-06-10 20:20:58,084 - DEBUG - Generating chat message for label: formula
2025-06-10 20:20:58,084 - DEBUG - Snippet 10.3390_catal11080998_724_item_3 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:20:58,095 - INFO - Finished converting document 10.1186_1476-069x-11-82_782.pdf in 14.05 sec.
2025-06-10 20:20:58,096 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:20:58,096 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:20:58,097 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:20:58,134 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:20:58,148 - DEBUG - Snippet 10.3390_catal11080998_724_item_3 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:20:58,169 - INFO - Extraction successful row 156, tokens=11172
2025-06-10 20:20:58,193 - INFO - Going to convert document batch...
2025-06-10 20:20:58,194 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:20:58,194 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:20:58,211 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:20:58,240 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:20:58,263 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:20:58,302 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:20:58,343 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:20:58,364 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:58,379 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:20:58,524 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:20:58,559 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:20:58,596 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:20:58,749 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:20:58,839 - DEBUG - Dynamic vertical threshold: 80.28539999999991, Overlap threshold: 0.7
2025-06-10 20:20:58,840 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:58,929 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:20:58,980 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:20:58,985 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:20:59,082 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:20:59,312 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:20:59,313 - INFO - Processing document 10.1371_journal.pone.0076759_787.pdf
2025-06-10 20:20:59,513 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:20:59,514 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:20:59,514 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:20:59,549 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:20:59,593 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:20:59,630 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:20:59,682 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:20:59,770 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:20:59,807 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:20:59,943 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:20:59,949 - DEBUG - Snippet 10.3390_catal11080998_724_item_3: generation shape=torch.Size([1, 408])
2025-06-10 20:20:59,949 - DEBUG - Snippet 10.3390_catal11080998_724_item_3 raw docling: (tokens=62)
<formula><loc_0><loc_0><loc_500><loc_500>M ( \bullet O H ) + R \to M + m C O _ { 2 } + n H _ { 2 } O + H ^ { + } + e ^ { - }</formula><end_of_utterance>
2025-06-10 20:20:59,949 - DEBUG - Starting _parse_docling_output
2025-06-10 20:20:59,950 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>M ( \bullet O H ) + R \to M + m C O _ { 2 } + n H _ { 2 } O + H ^ { + } + e ^ { - }</formula><end_of_utterance>
2025-06-10 20:20:59,950 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:20:59,950 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>M ( \\bullet O H ) + R \\to M + m C O _ { 2 } + n H _ { 2 } O + H ^ { + } + e ^ { - }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=876x65 at 0x7F96A9913260>)]
2025-06-10 20:20:59,950 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:20:59,953 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=876.0, b=65.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 83))], orig='M ( \\bullet O H ) + R \\to M + m C O _ { 2 } + n H _ { 2 } O + H ^ { + } + e ^ { - }', text='M ( \\bullet O H ) + R \\to M + m C O _ { 2 } + n H _ { 2 } O + H ^ { + } + e ^ { - }', formatting=None, hyperlink=None)]
2025-06-10 20:20:59,953 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:20:59,953 - DEBUG - Processing text item: label=formula, text=M ( \bullet O H ) + R \to M + m C O _ { 2 } + n H _ { 2 } O + H ^ { + } + e ^ { - }
2025-06-10 20:20:59,953 - DEBUG - Recognized string extracted: M ( \bullet O H ) + R \to M + m C O _ { 2 } + n H _ { 2 } O + H ^ { + } + e ^ { - }
2025-06-10 20:20:59,954 - DEBUG - Generating chat message for label: formula
2025-06-10 20:20:59,954 - DEBUG - Snippet 10.3390_catal11080998_724_item_4 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:20:59,985 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:20:59,994 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:00,019 - DEBUG - Snippet 10.3390_catal11080998_724_item_4 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:21:00,023 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:21:00,091 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:00,160 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:20:58,203 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:58,214 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:58,216 - DEBUG - Finished converting page batch time=4015.386
2025-06-10 20:20:58,326 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:58,342 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:20:58,426 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:58,427 - DEBUG - Finished converting page batch time=4015.597
2025-06-10 20:20:58,444 - DEBUG - Snippet 10.1214_10-aoas351_689_item_2: generation shape=torch.Size([1, 440])
2025-06-10 20:20:58,445 - DEBUG - Snippet 10.1214_10-aoas351_689_item_2 raw docling: (tokens=94)
<formula><loc_0><loc_0><loc_500><loc_500>= A _ { 4 1 } ^ { 2 } \exp ( - \phi _ { 1 } \| s - s ^ { \prime } \| ) + A _ { 4 4 } ^ { 2 } \exp ( - \phi _ { 4 } \| s - s ^ { \prime } \| )</formula><end_of_utterance>
2025-06-10 20:20:58,445 - DEBUG - Starting _parse_docling_output
2025-06-10 20:20:58,445 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>= A _ { 4 1 } ^ { 2 } \exp ( - \phi _ { 1 } \| s - s ^ { \prime } \| ) + A _ { 4 4 } ^ { 2 } \exp ( - \phi _ { 4 } \| s - s ^ { \prime } \| )</formula><end_of_utterance>
2025-06-10 20:20:58,446 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:20:58,446 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>= A _ { 4 1 } ^ { 2 } \\exp ( - \\phi _ { 1 } \\| s - s ^ { \\prime } \\| ) + A _ { 4 4 } ^ { 2 } \\exp ( - \\phi _ { 4 } \\| s - s ^ { \\prime } \\| )</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=640x112 at 0x7F96B2988740>)]
2025-06-10 20:20:58,446 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:20:58,449 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=640.0, b=112.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 141))], orig='= A _ { 4 1 } ^ { 2 } \\exp ( - \\phi _ { 1 } \\| s - s ^ { \\prime } \\| ) + A _ { 4 4 } ^ { 2 } \\exp ( - \\phi _ { 4 } \\| s - s ^ { \\prime } \\| )', text='= A _ { 4 1 } ^ { 2 } \\exp ( - \\phi _ { 1 } \\| s - s ^ { \\prime } \\| ) + A _ { 4 4 } ^ { 2 } \\exp ( - \\phi _ { 4 } \\| s - s ^ { \\prime } \\| )', formatting=None, hyperlink=None)]
2025-06-10 20:20:58,450 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:20:58,450 - DEBUG - Processing text item: label=formula, text== A _ { 4 1 } ^ { 2 } \exp ( - \phi _ { 1 } \| s - s ^ { \prime } \| ) + A _ { 4 4 } ^ { 2 } \exp ( - \phi _ { 4 } \| s - s ^ { \prime } \| )
2025-06-10 20:20:58,450 - DEBUG - Recognized string extracted: = A _ { 4 1 } ^ { 2 } \exp ( - \phi _ { 1 } \| s - s ^ { \prime } \| ) + A _ { 4 4 } ^ { 2 } \exp ( - \phi _ { 4 } \| s - s ^ { \prime } \| )
2025-06-10 20:20:58,450 - DEBUG - Generating chat message for label: formula
2025-06-10 20:20:58,451 - DEBUG - Snippet 10.1214_10-aoas351_689_item_3 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:20:58,538 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:20:58,539 - INFO - Processing document 10.3390_atmos11080868_789.pdf
2025-06-10 20:20:58,563 - INFO - Finished converting document 10.2188_jea.je20110049_780.pdf in 17.13 sec.
2025-06-10 20:20:58,577 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:58,674 - INFO - Extraction successful row 155, tokens=14853
2025-06-10 20:20:58,703 - DEBUG - Snippet 10.1214_10-aoas351_689_item_3 => input_ids shape=torch.Size([1, 875]), prompt_len=875
2025-06-10 20:20:58,704 - INFO - Going to convert document batch...
2025-06-10 20:20:58,705 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:20:58,705 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:20:58,738 - DEBUG - Snippet 10.4209_aaqr.2009.10.0061_772_item_1: generation shape=torch.Size([1, 457])
2025-06-10 20:20:58,739 - DEBUG - Snippet 10.4209_aaqr.2009.10.0061_772_item_1 raw docling: (tokens=111)
<formula><loc_0><loc_0><loc_500><loc_500>c a t i o n \, m i c r o e q u i v a l e n t s = N a ^ { + / 2 3 } + N H _ { 4 } ^ { + / 1 8 } + K ^ { + / 3 9 } + M g ^ { 2 + / 1 2 } + C a ^ { 2 + / 2 0 }</formula><end_of_utterance>
2025-06-10 20:20:58,739 - DEBUG - Starting _parse_docling_output
2025-06-10 20:20:58,739 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>c a t i o n \, m i c r o e q u i v a l e n t s = N a ^ { + / 2 3 } + N H _ { 4 } ^ { + / 1 8 } + K ^ { + / 3 9 } + M g ^ { 2 + / 1 2 } + C a ^ { 2 + / 2 0 }</formula><end_of_utterance>
2025-06-10 20:20:58,740 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:20:58,740 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>c a t i o n \\, m i c r o e q u i v a l e n t s = N a ^ { + / 2 3 } + N H _ { 4 } ^ { + / 1 8 } + K ^ { + / 3 9 } + M g ^ { 2 + / 1 2 } + C a ^ { 2 + / 2 0 }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=711x109 at 0x7F96970352E0>)]
2025-06-10 20:20:58,740 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:20:58,744 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=711.0, b=109.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 156))], orig='c a t i o n \\, m i c r o e q u i v a l e n t s = N a ^ { + / 2 3 } + N H _ { 4 } ^ { + / 1 8 } + K ^ { + / 3 9 } + M g ^ { 2 + / 1 2 } + C a ^ { 2 + / 2 0 }', text='c a t i o n \\, m i c r o e q u i v a l e n t s = N a ^ { + / 2 3 } + N H _ { 4 } ^ { + / 1 8 } + K ^ { + / 3 9 } + M g ^ { 2 + / 1 2 } + C a ^ { 2 + / 2 0 }', formatting=None, hyperlink=None)]
2025-06-10 20:20:58,744 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:20:58,744 - DEBUG - Processing text item: label=formula, text=c a t i o n \, m i c r o e q u i v a l e n t s = N a ^ { + / 2 3 } + N H _ { 4 } ^ { + / 1 8 } + K ^ { + / 3 9 } + M g ^ { 2 + / 1 2 } + C a ^ { 2 + / 2 0 }
2025-06-10 20:20:58,744 - DEBUG - Recognized string extracted: c a t i o n \, m i c r o e q u i v a l e n t s = N a ^ { + / 2 3 } + N H _ { 4 } ^ { + / 1 8 } + K ^ { + / 3 9 } + M g ^ { 2 + / 1 2 } + C a ^ { 2 + / 2 0 }
2025-06-10 20:20:58,745 - DEBUG - Generating chat message for label: formula
2025-06-10 20:20:58,745 - DEBUG - Snippet 10.4209_aaqr.2009.10.0061_772_item_2 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:20:58,755 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:20:58,791 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:58,813 - DEBUG - Snippet 10.4209_aaqr.2009.10.0061_772_item_2 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:20:59,088 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:20:59,255 - DEBUG - Finished converting page batch time=4016.425
2025-06-10 20:20:59,393 - DEBUG - Snippet 10.3390_catal11080998_724_item_4: generation shape=torch.Size([1, 400])
2025-06-10 20:20:59,394 - DEBUG - Snippet 10.3390_catal11080998_724_item_4 raw docling: (tokens=54)
<formula><loc_0><loc_0><loc_500><loc_500>M ( \bullet O H ) \to M + 1 / 2 O _ { 2 } + H ^ { + } + e ^ { - }</formula><end_of_utterance>
2025-06-10 20:20:59,394 - DEBUG - Starting _parse_docling_output
2025-06-10 20:20:59,394 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>M ( \bullet O H ) \to M + 1 / 2 O _ { 2 } + H ^ { + } + e ^ { - }</formula><end_of_utterance>
2025-06-10 20:20:59,394 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:20:59,395 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>M ( \\bullet O H ) \\to M + 1 / 2 O _ { 2 } + H ^ { + } + e ^ { - }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=1233x78 at 0x7F96A9913020>)]
2025-06-10 20:20:59,395 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:20:59,398 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=1233.0, b=78.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 65))], orig='M ( \\bullet O H ) \\to M + 1 / 2 O _ { 2 } + H ^ { + } + e ^ { - }', text='M ( \\bullet O H ) \\to M + 1 / 2 O _ { 2 } + H ^ { + } + e ^ { - }', formatting=None, hyperlink=None)]
2025-06-10 20:20:59,398 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:20:59,398 - DEBUG - Processing text item: label=formula, text=M ( \bullet O H ) \to M + 1 / 2 O _ { 2 } + H ^ { + } + e ^ { - }
2025-06-10 20:20:59,398 - DEBUG - Recognized string extracted: M ( \bullet O H ) \to M + 1 / 2 O _ { 2 } + H ^ { + } + e ^ { - }
2025-06-10 20:20:59,399 - INFO - All done. Returning 5 recognized text results.
2025-06-10 20:20:59,399 - DEBUG - Snippet 10.3390_catal11080998_724_item_0 recognized text:
M + H _ { 2 } O \to M ( \bullet O H ) + H ^ { + } + e ^ { - }
2025-06-10 20:20:59,399 - DEBUG - Snippet 10.3390_catal11080998_724_item_1 recognized text:
M O + R \to M + R O
2025-06-10 20:20:59,399 - DEBUG - Snippet 10.3390_catal11080998_724_item_2 recognized text:
M O \to M + 1 / 2 O _ { 2 }
2025-06-10 20:20:59,399 - DEBUG - Snippet 10.3390_catal11080998_724_item_3 recognized text:
M ( \bullet O H ) + R \to M + m C O _ { 2 } + n H _ { 2 } O + H ^ { + } + e ^ { - }
2025-06-10 20:20:59,400 - DEBUG - Snippet 10.3390_catal11080998_724_item_4 recognized text:
M ( \bullet O H ) \to M + 1 / 2 O _ { 2 } + H ^ { + } + e ^ { - }
2025-06-10 20:20:59,463 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:20:59,501 - DEBUG - Creating masked image for page 19 with 15 clusters.
2025-06-10 20:20:59,502 - INFO - Masked image successfully created for page 19.
2025-06-10 20:20:59,507 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:20:59,509 - INFO - Starting prediction for 5 images with labels: ['formula', 'formula', 'formula', 'formula', 'formula']
2025-06-10 20:20:59,510 - DEBUG - Generating chat message for label: formula
2025-06-10 20:20:59,510 - DEBUG - Snippet 10.3390_catal11080998_724_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:20:59,513 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:20:59,582 - DEBUG - Snippet 10.3390_catal11080998_724_item_0 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:20:59,610 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:00,076 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:00,206 - DEBUG - Dynamic vertical threshold: 39.173400000000065, Overlap threshold: 0.7
2025-06-10 20:21:00,206 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:00,299 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:00,508 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:21:00,509 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:21:00,509 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:21:00,548 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:00,582 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:00,617 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:21:00,655 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:21:00,695 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:00,738 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:21:00,864 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:01,145 - DEBUG - Snippet 10.4209_aaqr.2009.10.0061_772_item_2: generation shape=torch.Size([1, 425])
2025-06-10 20:21:01,146 - DEBUG - Snippet 10.4209_aaqr.2009.10.0061_772_item_2 raw docling: (tokens=79)
<formula><loc_0><loc_0><loc_500><loc_500>\anion microequivalents = F / 1 9 + C I / 3 5 . 5 + N O _ { 3 } ^ { - } / 6 2 + S O _ { 4 } ^ { 2 - / 4 8 }</formula><end_of_utterance>
2025-06-10 20:21:01,146 - DEBUG - Starting _parse_docling_output
2025-06-10 20:21:01,147 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>\anion microequivalents = F / 1 9 + C I / 3 5 . 5 + N O _ { 3 } ^ { - } / 6 2 + S O _ { 4 } ^ { 2 - / 4 8 }</formula><end_of_utterance>
2025-06-10 20:21:01,147 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:21:01,147 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>\\anion microequivalents = F / 1 9 + C I / 3 5 . 5 + N O _ { 3 } ^ { - } / 6 2 + S O _ { 4 } ^ { 2 - / 4 8 }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=711x113 at 0x7F968C23C590>)]
2025-06-10 20:21:01,148 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:21:01,152 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=711.0, b=113.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 107))], orig='\\anion microequivalents = F / 1 9 + C I / 3 5 . 5 + N O _ { 3 } ^ { - } / 6 2 + S O _ { 4 } ^ { 2 - / 4 8 }', text='\\anion microequivalents = F / 1 9 + C I / 3 5 . 5 + N O _ { 3 } ^ { - } / 6 2 + S O _ { 4 } ^ { 2 - / 4 8 }', formatting=None, hyperlink=None)]
2025-06-10 20:21:01,153 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:21:01,153 - DEBUG - Processing text item: label=formula, text=\anion microequivalents = F / 1 9 + C I / 3 5 . 5 + N O _ { 3 } ^ { - } / 6 2 + S O _ { 4 } ^ { 2 - / 4 8 }
2025-06-10 20:21:01,153 - DEBUG - Recognized string extracted: \anion microequivalents = F / 1 9 + C I / 3 5 . 5 + N O _ { 3 } ^ { - } / 6 2 + S O _ { 4 } ^ { 2 - / 4 8 }
2025-06-10 20:21:01,153 - INFO - All done. Returning 3 recognized text results.
2025-06-10 20:21:01,153 - DEBUG - Snippet 10.4209_aaqr.2009.10.0061_772_item_0 recognized text:
MALFORMED_FORMULA
2025-06-10 20:21:01,154 - DEBUG - Snippet 10.4209_aaqr.2009.10.0061_772_item_1 recognized text:
c a t i o n \, m i c r o e q u i v a l e n t s = N a ^ { + / 2 3 } + N H _ { 4 } ^ { + / 1 8 } + K ^ { + / 3 9 } + M g ^ { 2 + / 1 2 } + C a ^ { 2 + / 2 0 }
2025-06-10 20:21:01,154 - DEBUG - Snippet 10.4209_aaqr.2009.10.0061_772_item_2 recognized text:
\anion microequivalents = F / 1 9 + C I / 3 5 . 5 + N O _ { 3 } ^ { - } / 6 2 + S O _ { 4 } ^ { 2 - / 4 8 }
2025-06-10 20:21:01,190 - DEBUG - Finished converting page batch time=4018.360
2025-06-10 20:21:01,227 - INFO - Finished converting document 10.4209_aaqr.2009.10.0061_772.pdf in 23.23 sec.
2025-06-10 20:21:01,299 - INFO - Extraction successful row 154, tokens=15556
2025-06-10 20:21:01,340 - INFO - Going to convert document batch...
2025-06-10 20:21:01,341 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:21:01,341 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:21:01,393 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:21:01,458 - DEBUG - Snippet 10.3390_catal11080998_724_item_0: generation shape=torch.Size([1, 409])
2025-06-10 20:21:01,459 - DEBUG - Snippet 10.3390_catal11080998_724_item_0 raw docling: (tokens=63)
<formula><loc_0><loc_0><loc_500><loc_500>- \left ( \frac { d [ O _ { 3 } ] } { d t } \right ) _ { p H } = k ^ { \prime } [ O _ { 3 } ]</formula><end_of_utterance>
2025-06-10 20:21:01,459 - DEBUG - Starting _parse_docling_output
2025-06-10 20:21:01,459 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>- \left ( \frac { d [ O _ { 3 } ] } { d t } \right ) _ { p H } = k ^ { \prime } [ O _ { 3 } ]</formula><end_of_utterance>
2025-06-10 20:21:01,459 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:21:01,459 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>- \\left ( \\frac { d [ O _ { 3 } ] } { d t } \\right ) _ { p H } = k ^ { \\prime } [ O _ { 3 } ]</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=724x129 at 0x7F96A9911520>)]
2025-06-10 20:21:01,460 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:21:01,463 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=724.0, b=129.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 93))], orig='- \\left ( \\frac { d [ O _ { 3 } ] } { d t } \\right ) _ { p H } = k ^ { \\prime } [ O _ { 3 } ]', text='- \\left ( \\frac { d [ O _ { 3 } ] } { d t } \\right ) _ { p H } = k ^ { \\prime } [ O _ { 3 } ]', formatting=None, hyperlink=None)]
2025-06-10 20:21:01,463 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:21:01,464 - DEBUG - Processing text item: label=formula, text=- \left ( \frac { d [ O _ { 3 } ] } { d t } \right ) _ { p H } = k ^ { \prime } [ O _ { 3 } ]
2025-06-10 20:21:01,464 - DEBUG - Recognized string extracted: - \left ( \frac { d [ O _ { 3 } ] } { d t } \right ) _ { p H } = k ^ { \prime } [ O _ { 3 } ]
2025-06-10 20:21:01,464 - DEBUG - Generating chat message for label: formula
2025-06-10 20:21:01,464 - DEBUG - Snippet 10.3390_catal11080998_724_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:21:01,526 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:01,530 - DEBUG - Snippet 10.3390_catal11080998_724_item_1 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:21:01,647 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:01,779 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:21:01,816 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:21:01,860 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:01,955 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:21:02,091 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:02,133 - DEBUG - Dynamic vertical threshold: 63.435600000000036, Overlap threshold: 0.7
2025-06-10 20:21:02,133 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:02,134 - DEBUG - Finished converting page batch time=4019.304
2025-06-10 20:21:02,390 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:21:02,440 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:21:02,446 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:21:02,455 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:02,456 - DEBUG - Finished converting page batch time=4019.626
2025-06-10 20:21:02,467 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:21:02,549 - INFO - Finished converting document 10.1590_s0034-8910.2014048005218_785.pdf in 10.48 sec.
2025-06-10 20:21:02,581 - DEBUG - Dynamic vertical threshold: 32.47559999999995, Overlap threshold: 0.7
2025-06-10 20:21:02,586 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:02,618 - INFO - Extraction successful row 158, tokens=8997
2025-06-10 20:21:02,649 - INFO - Going to convert document batch...
2025-06-10 20:21:02,649 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:21:02,650 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:21:02,698 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:21:02,698 - INFO - Processing document 10.3390_ijerph13050454_790.pdf
2025-06-10 20:21:02,707 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:21:02,736 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:02,882 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:21:02,882 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:21:02,882 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:21:02,920 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:03,077 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:03,081 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:03,114 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:21:03,150 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:21:03,166 - DEBUG - Finished converting page batch time=4020.336
2025-06-10 20:21:03,176 - DEBUG - Snippet 10.3390_catal11080998_724_item_1: generation shape=torch.Size([1, 403])
2025-06-10 20:21:03,177 - DEBUG - Snippet 10.3390_catal11080998_724_item_1 raw docling: (tokens=57)
<formula><loc_0><loc_0><loc_500><loc_500>O _ { 3 } + H O _ { 2 } ^ { - } \to O _ { 3 } ^ { - } + H O _ { 2 }</formula><end_of_utterance>
2025-06-10 20:21:03,177 - DEBUG - Starting _parse_docling_output
2025-06-10 20:21:03,177 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>O _ { 3 } + H O _ { 2 } ^ { - } \to O _ { 3 } ^ { - } + H O _ { 2 }</formula><end_of_utterance>
2025-06-10 20:21:03,177 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:21:03,178 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>O _ { 3 } + H O _ { 2 } ^ { - } \\to O _ { 3 } ^ { - } + H O _ { 2 }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=746x72 at 0x7F96A99117F0>)]
2025-06-10 20:21:03,178 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:21:03,180 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=746.0, b=72.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 67))], orig='O _ { 3 } + H O _ { 2 } ^ { - } \\to O _ { 3 } ^ { - } + H O _ { 2 }', text='O _ { 3 } + H O _ { 2 } ^ { - } \\to O _ { 3 } ^ { - } + H O _ { 2 }', formatting=None, hyperlink=None)]
2025-06-10 20:21:03,180 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:21:03,180 - DEBUG - Processing text item: label=formula, text=O _ { 3 } + H O _ { 2 } ^ { - } \to O _ { 3 } ^ { - } + H O _ { 2 }
2025-06-10 20:21:03,181 - DEBUG - Recognized string extracted: O _ { 3 } + H O _ { 2 } ^ { - } \to O _ { 3 } ^ { - } + H O _ { 2 }
2025-06-10 20:21:03,181 - DEBUG - Generating chat message for label: formula
2025-06-10 20:21:03,181 - DEBUG - Snippet 10.3390_catal11080998_724_item_2 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:21:03,186 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:03,226 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:21:03,246 - DEBUG - Snippet 10.3390_catal11080998_724_item_2 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:21:03,374 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:03,384 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:21:03,409 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:21:03,441 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:21:03,447 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:21:03,447 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:21:03,493 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:03,610 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:21:03,840 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:21:03,841 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:21:03,841 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:21:03,843 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:03,875 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:03,909 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:21:03,913 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:03,996 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:21:04,045 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:21:04,081 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:04,103 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:21:04,104 - INFO - Processing document 10.1186_s41256-018-0080-0_792.pdf
2025-06-10 20:21:04,125 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:21:04,141 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:04,253 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:04,276 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:04,299 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:04,453 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:21:04,490 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:21:04,634 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:21:04,684 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:04,807 - DEBUG - Snippet 10.3390_catal11080998_724_item_2: generation shape=torch.Size([1, 401])
2025-06-10 20:21:04,809 - DEBUG - Snippet 10.3390_catal11080998_724_item_2 raw docling: (tokens=55)
<formula><loc_0><loc_0><loc_500><loc_500>O _ { 3 } + O _ { 2 } ^ { - } \to O _ { 3 } ^ { - } + O _ { 2 }</formula><end_of_utterance>
2025-06-10 20:21:04,809 - DEBUG - Starting _parse_docling_output
2025-06-10 20:21:04,809 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>O _ { 3 } + O _ { 2 } ^ { - } \to O _ { 3 } ^ { - } + O _ { 2 }</formula><end_of_utterance>
2025-06-10 20:21:04,809 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:21:04,809 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>O _ { 3 } + O _ { 2 } ^ { - } \\to O _ { 3 } ^ { - } + O _ { 2 }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=724x71 at 0x7F96A9913B00>)]
2025-06-10 20:21:04,810 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:21:04,812 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=724.0, b=71.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 63))], orig='O _ { 3 } + O _ { 2 } ^ { - } \\to O _ { 3 } ^ { - } + O _ { 2 }', text='O _ { 3 } + O _ { 2 } ^ { - } \\to O _ { 3 } ^ { - } + O _ { 2 }', formatting=None, hyperlink=None)]
2025-06-10 20:21:04,812 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:21:04,812 - DEBUG - Processing text item: label=formula, text=O _ { 3 } + O _ { 2 } ^ { - } \to O _ { 3 } ^ { - } + O _ { 2 }
2025-06-10 20:21:04,812 - DEBUG - Recognized string extracted: O _ { 3 } + O _ { 2 } ^ { - } \to O _ { 3 } ^ { - } + O _ { 2 }
2025-06-10 20:21:04,813 - DEBUG - Generating chat message for label: formula
2025-06-10 20:21:04,813 - DEBUG - Snippet 10.3390_catal11080998_724_item_3 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:21:04,879 - DEBUG - Snippet 10.3390_catal11080998_724_item_3 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:21:04,925 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:21:05,009 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:05,087 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:05,113 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:21:05,113 - INFO - Processing document 10.20882_adicciones.233_793.pdf
2025-06-10 20:21:05,171 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:05,234 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:05,434 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:05,436 - DEBUG - Finished converting page batch time=4022.606
2025-06-10 20:21:05,683 - DEBUG - Finished converting page batch time=4022.853
2025-06-10 20:21:05,753 - DEBUG - Dynamic vertical threshold: 73.81440000000008, Overlap threshold: 0.7
2025-06-10 20:21:05,753 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:05,754 - DEBUG - Finished converting page batch time=4022.924
2025-06-10 20:21:06,007 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:06,240 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:06,388 - DEBUG - Dynamic vertical threshold: 64.23030000000007, Overlap threshold: 0.7
2025-06-10 20:21:06,389 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:06,484 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:06,799 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:06,800 - DEBUG - Finished converting page batch time=4023.970
2025-06-10 20:21:06,948 - DEBUG - Creating masked image for page 1 with 16 clusters.
2025-06-10 20:21:06,950 - INFO - Masked image successfully created for page 1.
2025-06-10 20:21:06,954 - INFO - Starting prediction for 1 images with labels: ['formula']
2025-06-10 20:21:06,954 - DEBUG - Generating chat message for label: formula
2025-06-10 20:21:06,955 - DEBUG - Snippet 10.1186_s12940-019-0476-4_784_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:21:07,106 - DEBUG - Snippet 10.1186_s12940-019-0476-4_784_item_0 => input_ids shape=torch.Size([1, 610]), prompt_len=610
2025-06-10 20:21:07,141 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:07,143 - DEBUG - Finished converting page batch time=4024.313
2025-06-10 20:21:07,205 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:07,306 - DEBUG - Creating masked image for page 2 with 30 clusters.
2025-06-10 20:21:07,307 - INFO - Masked image successfully created for page 2.
2025-06-10 20:21:07,312 - INFO - Starting prediction for 2 images with labels: ['formula', 'formula']
2025-06-10 20:21:07,313 - DEBUG - Generating chat message for label: formula
2025-06-10 20:21:07,313 - DEBUG - Snippet 10.1371_journal.pone.0076759_787_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:21:07,383 - DEBUG - Snippet 10.1371_journal.pone.0076759_787_item_0 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:21:07,487 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:07,551 - DEBUG - Snippet 10.3390_catal11080998_724_item_3: generation shape=torch.Size([1, 433])
2025-06-10 20:21:07,553 - DEBUG - Snippet 10.3390_catal11080998_724_item_3 raw docling: (tokens=87)
<formula><loc_0><loc_0><loc_500><loc_500>O _ { 3 } + H _ { 2 } O \to 2 \bullet O H + O _ { 2 } , k = 1 . 1 \times 1 0 ^ { - 4 } \, M ^ { - 1 } \, s ^ { - 1 }</formula><end_of_utterance>
2025-06-10 20:21:07,553 - DEBUG - Starting _parse_docling_output
2025-06-10 20:21:07,553 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>O _ { 3 } + H _ { 2 } O \to 2 \bullet O H + O _ { 2 } , k = 1 . 1 \times 1 0 ^ { - 4 } \, M ^ { - 1 } \, s ^ { - 1 }</formula><end_of_utterance>
2025-06-10 20:21:07,553 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:21:07,554 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>O _ { 3 } + H _ { 2 } O \\to 2 \\bullet O H + O _ { 2 } , k = 1 . 1 \\times 1 0 ^ { - 4 } \\, M ^ { - 1 } \\, s ^ { - 1 }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=900x68 at 0x7F96A9912D50>)]
2025-06-10 20:21:07,554 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:21:07,557 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=900.0, b=68.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 116))], orig='O _ { 3 } + H _ { 2 } O \\to 2 \\bullet O H + O _ { 2 } , k = 1 . 1 \\times 1 0 ^ { - 4 } \\, M ^ { - 1 } \\, s ^ { - 1 }', text='O _ { 3 } + H _ { 2 } O \\to 2 \\bullet O H + O _ { 2 } , k = 1 . 1 \\times 1 0 ^ { - 4 } \\, M ^ { - 1 } \\, s ^ { - 1 }', formatting=None, hyperlink=None)]
2025-06-10 20:21:07,557 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:21:07,557 - DEBUG - Processing text item: label=formula, text=O _ { 3 } + H _ { 2 } O \to 2 \bullet O H + O _ { 2 } , k = 1 . 1 \times 1 0 ^ { - 4 } \, M ^ { - 1 } \, s ^ { - 1 }
2025-06-10 20:21:07,557 - DEBUG - Recognized string extracted: O _ { 3 } + H _ { 2 } O \to 2 \bullet O H + O _ { 2 } , k = 1 . 1 \times 1 0 ^ { - 4 } \, M ^ { - 1 } \, s ^ { - 1 }
2025-06-10 20:21:07,558 - DEBUG - Generating chat message for label: formula
2025-06-10 20:21:07,558 - DEBUG - Snippet 10.3390_catal11080998_724_item_4 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:21:07,603 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:07,625 - DEBUG - Snippet 10.3390_catal11080998_724_item_4 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:21:07,935 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:08,101 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:08,340 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:08,677 - DEBUG - Finished converting page batch time=4025.847
2025-06-10 20:21:08,905 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:08,906 - DEBUG - Finished converting page batch time=4026.077
2025-06-10 20:21:09,032 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:09,033 - DEBUG - Finished converting page batch time=4026.203
2025-06-10 20:21:09,494 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:09,684 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:09,706 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:09,717 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:09,865 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:09,866 - DEBUG - Finished converting page batch time=4027.036
2025-06-10 20:21:09,992 - DEBUG - Snippet 10.1214_10-aoas351_689_item_3: generation shape=torch.Size([1, 1233])
2025-06-10 20:21:09,993 - DEBUG - Snippet 10.1214_10-aoas351_689_item_3 raw docling: (tokens=357)
<formula><loc_0><loc_0><loc_500><loc_500>= A _ { 1 1 } ^ { 2 } \exp ( - \phi _ { 1 } \| s - s ^ { \prime } \| ) \\ + \sum _ { k = 2 } ^ { 3 } [ A _ { k k } ^ { 2 } \cdot x _ { k - 1 } ( B ) x _ { k - 1 } ( B ^ { \prime } ) \cdot \exp ( - \phi _ { k } \| s - s ^ { \prime } \| ) ] + \tau _ { 1 } ^ { 2 } \delta _ { s , s ^ { \prime } } , \\ = A _ { 4 1 } ^ { 2 } \exp ( - \phi _ { 1 } \| s - s ^ { \prime } \| ) + A _ { 4 4 } ^ { 2 } \exp ( - \phi _ { 4 } \| s - s ^ { \prime } \| ) \\ + \sum _ { k = 5 } ^ { 6 } [ A _ { k k } ^ { 2 } \cdot x _ { ( k - 4 ) } ( B ) x _ { ( k - 4 ) } ( B ^ { \prime } ) \cdot \exp ( - \phi _ { k } \| s - s ^ { \prime } \| ) ] + \tau _ { 2 } ^ { 2 } \delta _ { s , s ^ { \prime } } ,</formula><end_of_utterance>
2025-06-10 20:21:09,993 - DEBUG - Starting _parse_docling_output
2025-06-10 20:21:09,993 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>= A _ { 1 1 } ^ { 2 } \exp ( - \phi _ { 1 } \| s - s ^ { \prime } \| ) \\ + \sum _ { k = 2 } ^ { 3 } [ A _ { k k } ^ { 2 } \cdot x _ { k - 1 } ( B ) x _ { k - 1 } ( B ^ { \prime } ) \cdot \exp ( - \phi _ { k } \| s - s ^ { \prime } \| ) ] + \tau _ { 1 } ^ { 2 } \delta _ { s , s ^ { \prime } } , \\ = A _ { 4 1 } ^ { 2 } \exp ( - \phi _ { 1 } \| s - s ^ { \prime } \| ) + A _ { 4 4 } ^ { 2 } \exp ( - \phi _ { 4 } \| s - s ^ { \prime } \| ) \\ + \sum _ { k = 5 } ^ { 6 } [ A _ { k k } ^ { 2 } \cdot x _ { ( k - 4 ) } ( B ) x _ { ( k - 4 ) } ( B ^ { \prime } ) \cdot \exp ( - \phi _ { k } \| s - s ^ { \prime } \| ) ] + \tau _ { 2 } ^ { 2 } \delta _ { s , s ^ { \prime } } ,</formula><end_of_utterance>
2025-06-10 20:21:09,994 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:21:09,994 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>= A _ { 1 1 } ^ { 2 } \\exp ( - \\phi _ { 1 } \\| s - s ^ { \\prime } \\| ) \\\\ + \\sum _ { k = 2 } ^ { 3 } [ A _ { k k } ^ { 2 } \\cdot x _ { k - 1 } ( B ) x _ { k - 1 } ( B ^ { \\prime } ) \\cdot \\exp ( - \\phi _ { k } \\| s - s ^ { \\prime } \\| ) ] + \\tau _ { 1 } ^ { 2 } \\delta _ { s , s ^ { \\prime } } , \\\\ = A _ { 4 1 } ^ { 2 } \\exp ( - \\phi _ { 1 } \\| s - s ^ { \\prime } \\| ) + A _ { 4 4 } ^ { 2 } \\exp ( - \\phi _ { 4 } \\| s - s ^ { \\prime } \\| ) \\\\ + \\sum _ { k = 5 } ^ { 6 } [ A _ { k k } ^ { 2 } \\cdot x _ { ( k - 4 ) } ( B ) x _ { ( k - 4 ) } ( B ^ { \\prime } ) \\cdot \\exp ( - \\phi _ { k } \\| s - s ^ { \\prime } \\| ) ] + \\tau _ { 2 } ^ { 2 } \\delta _ { s , s ^ { \\prime } } ,</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=816x534 at 0x7F96B2950560>)]
2025-06-10 20:21:09,994 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:21:10,007 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=816.0, b=534.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 673))], orig='= A _ { 1 1 } ^ { 2 } \\exp ( - \\phi _ { 1 } \\| s - s ^ { \\prime } \\| ) \\\\ + \\sum _ { k = 2 } ^ { 3 } [ A _ { k k } ^ { 2 } \\cdot x _ { k - 1 } ( B ) x _ { k - 1 } ( B ^ { \\prime } ) \\cdot \\exp ( - \\phi _ { k } \\| s - s ^ { \\prime } \\| ) ] + \\tau _ { 1 } ^ { 2 } \\delta _ { s , s ^ { \\prime } } , \\\\ = A _ { 4 1 } ^ { 2 } \\exp ( - \\phi _ { 1 } \\| s - s ^ { \\prime } \\| ) + A _ { 4 4 } ^ { 2 } \\exp ( - \\phi _ { 4 } \\| s - s ^ { \\prime } \\| ) \\\\ + \\sum _ { k = 5 } ^ { 6 } [ A _ { k k } ^ { 2 } \\cdot x _ { ( k - 4 ) } ( B ) x _ { ( k - 4 ) } ( B ^ { \\prime } ) \\cdot \\exp ( - \\phi _ { k } \\| s - s ^ { \\prime } \\| ) ] + \\tau _ { 2 } ^ { 2 } \\delta _ { s , s ^ { \\prime } } ,', text='= A _ { 1 1 } ^ { 2 } \\exp ( - \\phi _ { 1 } \\| s - s ^ { \\prime } \\| ) \\\\ + \\sum _ { k = 2 } ^ { 3 } [ A _ { k k } ^ { 2 } \\cdot x _ { k - 1 } ( B ) x _ { k - 1 } ( B ^ { \\prime } ) \\cdot \\exp ( - \\phi _ { k } \\| s - s ^ { \\prime } \\| ) ] + \\tau _ { 1 } ^ { 2 } \\delta _ { s , s ^ { \\prime } } , \\\\ = A _ { 4 1 } ^ { 2 } \\exp ( - \\phi _ { 1 } \\| s - s ^ { \\prime } \\| ) + A _ { 4 4 } ^ { 2 } \\exp ( - \\phi _ { 4 } \\| s - s ^ { \\prime } \\| ) \\\\ + \\sum _ { k = 5 } ^ { 6 } [ A _ { k k } ^ { 2 } \\cdot x _ { ( k - 4 ) } ( B ) x _ { ( k - 4 ) } ( B ^ { \\prime } ) \\cdot \\exp ( - \\phi _ { k } \\| s - s ^ { \\prime } \\| ) ] + \\tau _ { 2 } ^ { 2 } \\delta _ { s , s ^ { \\prime } } ,', formatting=None, hyperlink=None)]
2025-06-10 20:21:10,007 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:21:10,007 - DEBUG - Processing text item: label=formula, text== A _ { 1 1 } ^ { 2 } \exp ( - \phi _ { 1 } \| s - s ^ { \prime } \| ) \\ + \sum _ { k = 2 } ^ { 3 } [ A _ { k k } ^ { 2 } \cdot x _ { k - 1 } ( B ) x _ { k - 1 } ( B ^ { \prime } ) \cdot \exp ( - \phi _ { k } \| s - s ^ { \prime } \| ) ] + \tau _ { 1 } ^ { 2 } \delta _ { s , s ^ { \prime } } , \\ = A _ { 4 1 } ^ { 2 } \exp ( - \phi _ { 1 } \| s - s ^ { \prime } \| ) + A _ { 4 4 } ^ { 2 } \exp ( - \phi _ { 4 } \| s - s ^ { \prime } \| ) \\ + \sum _ { k = 5 } ^ { 6 } [ A _ { k k } ^ { 2 } \cdot x _ { ( k - 4 ) } ( B ) x _ { ( k - 4 ) } ( B ^ { \prime } ) \cdot \exp ( - \phi _ { k } \| s - s ^ { \prime } \| ) ] + \tau _ { 2 } ^ { 2 } \delta _ { s , s ^ { \prime } } ,
2025-06-10 20:21:10,008 - DEBUG - Recognized string extracted: = A _ { 1 1 } ^ { 2 } \exp ( - \phi _ { 1 } \| s - s ^ { \prime } \| ) \\ + \sum _ { k = 2 } ^ { 3 } [ A _ { k k } ^ { 2 } \cdot x _ { k - 1 } ( B ) x _ { k - 1 } ( B ^ { \prime } ) \cdot \exp ( - \phi _ { k } \| s - s ^ { \prime } \| ) ] + \tau _ { 1 } ^ { 2 } \delta _ { s , s ^ { \prime } } , \\ = A _ { 4 1 } ^ { 2 } \exp ( - \phi _ { 1 } \| s - s ^ { \prime } \| ) + A _ { 4 4 } ^ { 2 } \exp ( - \phi _ { 4 } \| s - s ^ { \prime } \| ) \\ + \sum _ { k = 5 } ^ { 6 } [ A _ { k k } ^ { 2 } \cdot x _ { ( k - 4 ) } ( B ) x _ { ( k - 4 ) } ( B ^ { \prime } ) \cdot \exp ( - \phi _ { k } \| s - s ^ { \prime } \| ) ] + \tau _ { 2 } ^ { 2 } \delta _ { s , s ^ { \prime } } ,
2025-06-10 20:21:10,008 - DEBUG - Generating chat message for label: formula
2025-06-10 20:21:10,008 - DEBUG - Snippet 10.1214_10-aoas351_689_item_4 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:21:10,034 - DEBUG - Creating masked image for page 3 with 14 clusters.
2025-06-10 20:21:10,035 - INFO - Masked image successfully created for page 3.
2025-06-10 20:21:10,109 - DEBUG - Snippet 10.3390_catal11080998_724_item_4: generation shape=torch.Size([1, 429])
2025-06-10 20:21:10,111 - DEBUG - Snippet 10.3390_catal11080998_724_item_4 raw docling: (tokens=83)
<formula><loc_0><loc_0><loc_500><loc_500>O _ { 3 } + O H ^ { - } \to \bullet O _ { 2 } ^ { - } + H O _ { 2 } \bullet , k = 7 0 \, M ^ { - 1 } \, s ^ { - 1 }</formula><end_of_utterance>
2025-06-10 20:21:10,111 - DEBUG - Starting _parse_docling_output
2025-06-10 20:21:10,111 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>O _ { 3 } + O H ^ { - } \to \bullet O _ { 2 } ^ { - } + H O _ { 2 } \bullet , k = 7 0 \, M ^ { - 1 } \, s ^ { - 1 }</formula><end_of_utterance>
2025-06-10 20:21:10,112 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:21:10,112 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>O _ { 3 } + O H ^ { - } \\to \\bullet O _ { 2 } ^ { - } + H O _ { 2 } \\bullet , k = 7 0 \\, M ^ { - 1 } \\, s ^ { - 1 }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=864x71 at 0x7F96A9910F50>)]
2025-06-10 20:21:10,112 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:21:10,115 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=864.0, b=71.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 115))], orig='O _ { 3 } + O H ^ { - } \\to \\bullet O _ { 2 } ^ { - } + H O _ { 2 } \\bullet , k = 7 0 \\, M ^ { - 1 } \\, s ^ { - 1 }', text='O _ { 3 } + O H ^ { - } \\to \\bullet O _ { 2 } ^ { - } + H O _ { 2 } \\bullet , k = 7 0 \\, M ^ { - 1 } \\, s ^ { - 1 }', formatting=None, hyperlink=None)]
2025-06-10 20:21:10,115 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:21:10,116 - DEBUG - Processing text item: label=formula, text=O _ { 3 } + O H ^ { - } \to \bullet O _ { 2 } ^ { - } + H O _ { 2 } \bullet , k = 7 0 \, M ^ { - 1 } \, s ^ { - 1 }
2025-06-10 20:21:10,116 - DEBUG - Recognized string extracted: O _ { 3 } + O H ^ { - } \to \bullet O _ { 2 } ^ { - } + H O _ { 2 } \bullet , k = 7 0 \, M ^ { - 1 } \, s ^ { - 1 }
2025-06-10 20:21:10,116 - INFO - All done. Returning 5 recognized text results.
2025-06-10 20:21:10,117 - DEBUG - Snippet 10.3390_catal11080998_724_item_0 recognized text:
- \left ( \frac { d [ O _ { 3 } ] } { d t } \right ) _ { p H } = k ^ { \prime } [ O _ { 3 } ]
2025-06-10 20:21:10,117 - DEBUG - Snippet 10.3390_catal11080998_724_item_1 recognized text:
O _ { 3 } + H O _ { 2 } ^ { - } \to O _ { 3 } ^ { - } + H O _ { 2 }
2025-06-10 20:21:10,117 - DEBUG - Snippet 10.3390_catal11080998_724_item_2 recognized text:
O _ { 3 } + O _ { 2 } ^ { - } \to O _ { 3 } ^ { - } + O _ { 2 }
2025-06-10 20:21:10,117 - DEBUG - Snippet 10.3390_catal11080998_724_item_3 recognized text:
O _ { 3 } + H _ { 2 } O \to 2 \bullet O H + O _ { 2 } , k = 1 . 1 \times 1 0 ^ { - 4 } \, M ^ { - 1 } \, s ^ { - 1 }
2025-06-10 20:21:10,118 - DEBUG - Snippet 10.3390_catal11080998_724_item_4 recognized text:
O _ { 3 } + O H ^ { - } \to \bullet O _ { 2 } ^ { - } + H O _ { 2 } \bullet , k = 7 0 \, M ^ { - 1 } \, s ^ { - 1 }
2025-06-10 20:21:10,146 - DEBUG - Snippet 10.1214_10-aoas351_689_item_4 => input_ids shape=torch.Size([1, 610]), prompt_len=610
2025-06-10 20:21:10,152 - DEBUG - Creating masked image for page 4 with 12 clusters.
2025-06-10 20:21:10,154 - INFO - Masked image successfully created for page 4.
2025-06-10 20:21:10,166 - INFO - Starting prediction for 5 images with labels: ['formula', 'formula', 'formula', 'formula', 'formula']
2025-06-10 20:21:10,166 - DEBUG - Generating chat message for label: formula
2025-06-10 20:21:10,167 - DEBUG - Snippet 10.3390_atmos11080868_789_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:21:10,239 - DEBUG - Snippet 10.3390_atmos11080868_789_item_0 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:21:10,245 - DEBUG - Creating masked image for page 23 with 27 clusters.
2025-06-10 20:21:10,248 - INFO - Masked image successfully created for page 23.
2025-06-10 20:21:10,367 - DEBUG - Creating masked image for page 24 with 17 clusters.
2025-06-10 20:21:10,369 - INFO - Masked image successfully created for page 24.
2025-06-10 20:21:10,377 - INFO - Starting prediction for 5 images with labels: ['formula', 'formula', 'formula', 'formula', 'formula']
2025-06-10 20:21:10,377 - DEBUG - Generating chat message for label: formula
2025-06-10 20:21:10,378 - DEBUG - Snippet 10.3390_catal11080998_724_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:21:10,420 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:10,420 - DEBUG - Finished converting page batch time=4027.591
2025-06-10 20:21:10,457 - DEBUG - Snippet 10.3390_catal11080998_724_item_0 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:21:10,546 - DEBUG - Snippet 10.1186_s12940-019-0476-4_784_item_0: generation shape=torch.Size([1, 723])
2025-06-10 20:21:10,548 - DEBUG - Snippet 10.1186_s12940-019-0476-4_784_item_0 raw docling: (tokens=112)
<formula><loc_0><loc_0><loc_500><loc_500>L o g \, E [ ( Y ) ] = \alpha + s ( T ) + \beta _ { 1 } D O W + \beta _ { 2 } S A R S \\ + \beta _ { 3 } F L U + \beta _ { 4 } P H + \beta _ { 5 } a f t e r P H \\ + s ( D B T ) + s ( R H )</formula><end_of_utterance>
2025-06-10 20:21:10,548 - DEBUG - Starting _parse_docling_output
2025-06-10 20:21:10,548 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>L o g \, E [ ( Y ) ] = \alpha + s ( T ) + \beta _ { 1 } D O W + \beta _ { 2 } S A R S \\ + \beta _ { 3 } F L U + \beta _ { 4 } P H + \beta _ { 5 } a f t e r P H \\ + s ( D B T ) + s ( R H )</formula><end_of_utterance>
2025-06-10 20:21:10,548 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:21:10,549 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>L o g \\, E [ ( Y ) ] = \\alpha + s ( T ) + \\beta _ { 1 } D O W + \\beta _ { 2 } S A R S \\\\ + \\beta _ { 3 } F L U + \\beta _ { 4 } P H + \\beta _ { 5 } a f t e r P H \\\\ + s ( D B T ) + s ( R H )</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=531x197 at 0x7F9712876600>)]
2025-06-10 20:21:10,549 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:21:10,553 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=531.0, b=197.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 189))], orig='L o g \\, E [ ( Y ) ] = \\alpha + s ( T ) + \\beta _ { 1 } D O W + \\beta _ { 2 } S A R S \\\\ + \\beta _ { 3 } F L U + \\beta _ { 4 } P H + \\beta _ { 5 } a f t e r P H \\\\ + s ( D B T ) + s ( R H )', text='L o g \\, E [ ( Y ) ] = \\alpha + s ( T ) + \\beta _ { 1 } D O W + \\beta _ { 2 } S A R S \\\\ + \\beta _ { 3 } F L U + \\beta _ { 4 } P H + \\beta _ { 5 } a f t e r P H \\\\ + s ( D B T ) + s ( R H )', formatting=None, hyperlink=None)]
2025-06-10 20:21:10,553 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:21:10,554 - DEBUG - Processing text item: label=formula, text=L o g \, E [ ( Y ) ] = \alpha + s ( T ) + \beta _ { 1 } D O W + \beta _ { 2 } S A R S \\ + \beta _ { 3 } F L U + \beta _ { 4 } P H + \beta _ { 5 } a f t e r P H \\ + s ( D B T ) + s ( R H )
2025-06-10 20:21:10,554 - DEBUG - Recognized string extracted: L o g \, E [ ( Y ) ] = \alpha + s ( T ) + \beta _ { 1 } D O W + \beta _ { 2 } S A R S \\ + \beta _ { 3 } F L U + \beta _ { 4 } P H + \beta _ { 5 } a f t e r P H \\ + s ( D B T ) + s ( R H )
2025-06-10 20:21:10,554 - INFO - All done. Returning 1 recognized text results.
2025-06-10 20:21:10,555 - DEBUG - Snippet 10.1186_s12940-019-0476-4_784_item_0 recognized text:
L o g \, E [ ( Y ) ] = \alpha + s ( T ) + \beta _ { 1 } D O W + \beta _ { 2 } S A R S \\ + \beta _ { 3 } F L U + \beta _ { 4 } P H + \beta _ { 5 } a f t e r P H \\ + s ( D B T ) + s ( R H )
2025-06-10 20:21:10,641 - INFO - Finished converting document 10.1186_s12940-019-0476-4_784.pdf in 18.85 sec.
2025-06-10 20:21:10,727 - INFO - Extraction successful row 157, tokens=17188
2025-06-10 20:21:10,750 - INFO - Going to convert document batch...
2025-06-10 20:21:10,750 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:21:10,751 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:21:10,783 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:10,877 - DEBUG - Snippet 10.1371_journal.pone.0076759_787_item_0: generation shape=torch.Size([1, 457])
2025-06-10 20:21:10,879 - DEBUG - Snippet 10.1371_journal.pone.0076759_787_item_0 raw docling: (tokens=111)
<formula><loc_0><loc_0><loc_500><loc_500>\log [ E ( Y _ { t } ) ] = \alpha _ { 0 } + \sum _ { i = 1 } ^ { q } \beta _ { i } ( X _ { i } ) + \sum _ { j = 1 } ^ { p } f _ { j } ( Z _ { j } , d f ) + W _ { t } ( w e k ) \quad ( 1 )</formula><end_of_utterance>
2025-06-10 20:21:10,879 - DEBUG - Starting _parse_docling_output
2025-06-10 20:21:10,879 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>\log [ E ( Y _ { t } ) ] = \alpha _ { 0 } + \sum _ { i = 1 } ^ { q } \beta _ { i } ( X _ { i } ) + \sum _ { j = 1 } ^ { p } f _ { j } ( Z _ { j } , d f ) + W _ { t } ( w e k ) \quad ( 1 )</formula><end_of_utterance>
2025-06-10 20:21:10,879 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:21:10,880 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>\\log [ E ( Y _ { t } ) ] = \\alpha _ { 0 } + \\sum _ { i = 1 } ^ { q } \\beta _ { i } ( X _ { i } ) + \\sum _ { j = 1 } ^ { p } f _ { j } ( Z _ { j } , d f ) + W _ { t } ( w e k ) \\quad ( 1 )</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=666x131 at 0x7F96D24F3500>)]
2025-06-10 20:21:10,880 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:21:10,883 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=666.0, b=131.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 187))], orig='\\log [ E ( Y _ { t } ) ] = \\alpha _ { 0 } + \\sum _ { i = 1 } ^ { q } \\beta _ { i } ( X _ { i } ) + \\sum _ { j = 1 } ^ { p } f _ { j } ( Z _ { j } , d f ) + W _ { t } ( w e k ) \\quad ( 1 )', text='\\log [ E ( Y _ { t } ) ] = \\alpha _ { 0 } + \\sum _ { i = 1 } ^ { q } \\beta _ { i } ( X _ { i } ) + \\sum _ { j = 1 } ^ { p } f _ { j } ( Z _ { j } , d f ) + W _ { t } ( w e k ) \\quad ( 1 )', formatting=None, hyperlink=None)]
2025-06-10 20:21:10,883 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:21:10,884 - DEBUG - Processing text item: label=formula, text=\log [ E ( Y _ { t } ) ] = \alpha _ { 0 } + \sum _ { i = 1 } ^ { q } \beta _ { i } ( X _ { i } ) + \sum _ { j = 1 } ^ { p } f _ { j } ( Z _ { j } , d f ) + W _ { t } ( w e k ) \quad ( 1 )
2025-06-10 20:21:10,884 - DEBUG - Recognized string extracted: \log [ E ( Y _ { t } ) ] = \alpha _ { 0 } + \sum _ { i = 1 } ^ { q } \beta _ { i } ( X _ { i } ) + \sum _ { j = 1 } ^ { p } f _ { j } ( Z _ { j } , d f ) + W _ { t } ( w e k ) \quad ( 1 )
2025-06-10 20:21:10,884 - DEBUG - Generating chat message for label: formula
2025-06-10 20:21:10,884 - DEBUG - Snippet 10.1371_journal.pone.0076759_787_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:21:10,949 - DEBUG - Snippet 10.1371_journal.pone.0076759_787_item_1 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:21:11,060 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:11,457 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:11,669 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:12,034 - DEBUG - Snippet 10.3390_atmos11080868_789_item_0: generation shape=torch.Size([1, 404])
2025-06-10 20:21:12,035 - DEBUG - Snippet 10.3390_atmos11080868_789_item_0 raw docling: (tokens=58)
<formula><loc_0><loc_0><loc_500><loc_500>\sum _ { m = 1 } ^ { o } v _ { m } ( X _ { i m } - X _ { 0 m } W ) ^ { 2 }</formula><end_of_utterance>
2025-06-10 20:21:12,035 - DEBUG - Starting _parse_docling_output
2025-06-10 20:21:12,036 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>\sum _ { m = 1 } ^ { o } v _ { m } ( X _ { i m } - X _ { 0 m } W ) ^ { 2 }</formula><end_of_utterance>
2025-06-10 20:21:12,036 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:21:12,036 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>\\sum _ { m = 1 } ^ { o } v _ { m } ( X _ { i m } - X _ { 0 m } W ) ^ { 2 }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=790x157 at 0x7F96DFB5A720>)]
2025-06-10 20:21:12,036 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:21:12,040 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=790.0, b=157.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 74))], orig='\\sum _ { m = 1 } ^ { o } v _ { m } ( X _ { i m } - X _ { 0 m } W ) ^ { 2 }', text='\\sum _ { m = 1 } ^ { o } v _ { m } ( X _ { i m } - X _ { 0 m } W ) ^ { 2 }', formatting=None, hyperlink=None)]
2025-06-10 20:21:12,040 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:21:12,041 - DEBUG - Processing text item: label=formula, text=\sum _ { m = 1 } ^ { o } v _ { m } ( X _ { i m } - X _ { 0 m } W ) ^ { 2 }
2025-06-10 20:21:12,041 - DEBUG - Recognized string extracted: \sum _ { m = 1 } ^ { o } v _ { m } ( X _ { i m } - X _ { 0 m } W ) ^ { 2 }
2025-06-10 20:21:12,041 - DEBUG - Generating chat message for label: formula
2025-06-10 20:21:12,041 - DEBUG - Snippet 10.3390_atmos11080868_789_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:21:12,111 - DEBUG - Snippet 10.3390_atmos11080868_789_item_1 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:21:12,113 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:12,114 - DEBUG - Finished converting page batch time=4029.284
2025-06-10 20:21:12,254 - DEBUG - Creating masked image for page 3 with 12 clusters.
2025-06-10 20:21:12,255 - INFO - Masked image successfully created for page 3.
2025-06-10 20:21:12,260 - INFO - Starting prediction for 1 images with labels: ['formula']
2025-06-10 20:21:12,260 - DEBUG - Generating chat message for label: formula
2025-06-10 20:21:12,260 - DEBUG - Snippet 10.3390_ijerph13050454_790_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:21:12,330 - DEBUG - Snippet 10.3390_ijerph13050454_790_item_0 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:21:12,368 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:21:12,418 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:12,653 - DEBUG - Snippet 10.3390_catal11080998_724_item_0: generation shape=torch.Size([1, 416])
2025-06-10 20:21:12,655 - DEBUG - Snippet 10.3390_catal11080998_724_item_0 raw docling: (tokens=70)
<formula><loc_0><loc_0><loc_500><loc_500>O _ { 3 } + \bullet O H \to O _ { 2 } + H O _ { 2 } \bullet \Longrightarrow \bullet O _ { 2 } - + H ^ { + }</formula><end_of_utterance>
2025-06-10 20:21:12,655 - DEBUG - Starting _parse_docling_output
2025-06-10 20:21:12,655 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>O _ { 3 } + \bullet O H \to O _ { 2 } + H O _ { 2 } \bullet \Longrightarrow \bullet O _ { 2 } - + H ^ { + }</formula><end_of_utterance>
2025-06-10 20:21:12,655 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:21:12,656 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>O _ { 3 } + \\bullet O H \\to O _ { 2 } + H O _ { 2 } \\bullet \\Longrightarrow \\bullet O _ { 2 } - + H ^ { + }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=829x72 at 0x7F96A9913260>)]
2025-06-10 20:21:12,656 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:21:12,658 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=829.0, b=72.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 107))], orig='O _ { 3 } + \\bullet O H \\to O _ { 2 } + H O _ { 2 } \\bullet \\Longrightarrow \\bullet O _ { 2 } - + H ^ { + }', text='O _ { 3 } + \\bullet O H \\to O _ { 2 } + H O _ { 2 } \\bullet \\Longrightarrow \\bullet O _ { 2 } - + H ^ { + }', formatting=None, hyperlink=None)]
2025-06-10 20:21:12,659 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:21:12,659 - DEBUG - Processing text item: label=formula, text=O _ { 3 } + \bullet O H \to O _ { 2 } + H O _ { 2 } \bullet \Longrightarrow \bullet O _ { 2 } - + H ^ { + }
2025-06-10 20:21:12,659 - DEBUG - Recognized string extracted: O _ { 3 } + \bullet O H \to O _ { 2 } + H O _ { 2 } \bullet \Longrightarrow \bullet O _ { 2 } - + H ^ { + }
2025-06-10 20:21:12,659 - DEBUG - Generating chat message for label: formula
2025-06-10 20:21:12,660 - DEBUG - Snippet 10.3390_catal11080998_724_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:21:12,732 - DEBUG - Snippet 10.3390_catal11080998_724_item_1 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:21:13,171 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:13,182 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:21:13,225 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:21:13,233 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:21:13,708 - DEBUG - Snippet 10.1371_journal.pone.0076759_787_item_1: generation shape=torch.Size([1, 424])
2025-06-10 20:21:13,709 - DEBUG - Snippet 10.1371_journal.pone.0076759_787_item_1 raw docling: (tokens=78)
<formula><loc_0><loc_0><loc_500><loc_500>( \hat { Q } _ { 1 } - \hat { Q } _ { 2 } ) \pm 1 . 9 6 \sqrt { S \hat { E } _ { 1 } + S \hat { E } _ { 2 } }</formula><end_of_utterance>
2025-06-10 20:21:13,710 - DEBUG - Starting _parse_docling_output
2025-06-10 20:21:13,710 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>( \hat { Q } _ { 1 } - \hat { Q } _ { 2 } ) \pm 1 . 9 6 \sqrt { S \hat { E } _ { 1 } + S \hat { E } _ { 2 } }</formula><end_of_utterance>
2025-06-10 20:21:13,710 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:21:13,710 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>( \\hat { Q } _ { 1 } - \\hat { Q } _ { 2 } ) \\pm 1 . 9 6 \\sqrt { S \\hat { E } _ { 1 } + S \\hat { E } _ { 2 } }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=514x61 at 0x7F96D58B72F0>)]
2025-06-10 20:21:13,710 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:21:13,712 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=514.0, b=61.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 109))], orig='( \\hat { Q } _ { 1 } - \\hat { Q } _ { 2 } ) \\pm 1 . 9 6 \\sqrt { S \\hat { E } _ { 1 } + S \\hat { E } _ { 2 } }', text='( \\hat { Q } _ { 1 } - \\hat { Q } _ { 2 } ) \\pm 1 . 9 6 \\sqrt { S \\hat { E } _ { 1 } + S \\hat { E } _ { 2 } }', formatting=None, hyperlink=None)]
2025-06-10 20:21:13,713 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:21:13,713 - DEBUG - Processing text item: label=formula, text=( \hat { Q } _ { 1 } - \hat { Q } _ { 2 } ) \pm 1 . 9 6 \sqrt { S \hat { E } _ { 1 } + S \hat { E } _ { 2 } }
2025-06-10 20:21:13,713 - DEBUG - Recognized string extracted: ( \hat { Q } _ { 1 } - \hat { Q } _ { 2 } ) \pm 1 . 9 6 \sqrt { S \hat { E } _ { 1 } + S \hat { E } _ { 2 } }
2025-06-10 20:21:13,713 - INFO - All done. Returning 2 recognized text results.
2025-06-10 20:21:13,713 - DEBUG - Snippet 10.1371_journal.pone.0076759_787_item_0 recognized text:
\log [ E ( Y _ { t } ) ] = \alpha _ { 0 } + \sum _ { i = 1 } ^ { q } \beta _ { i } ( X _ { i } ) + \sum _ { j = 1 } ^ { p } f _ { j } ( Z _ { j } , d f ) + W _ { t } ( w e k ) \quad ( 1 )
2025-06-10 20:21:13,714 - DEBUG - Snippet 10.1371_journal.pone.0076759_787_item_1 recognized text:
( \hat { Q } _ { 1 } - \hat { Q } _ { 2 } ) \pm 1 . 9 6 \sqrt { S \hat { E } _ { 1 } + S \hat { E } _ { 2 } }
2025-06-10 20:21:13,719 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:21:13,720 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:21:13,720 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:21:13,754 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:13,775 - DEBUG - Snippet 10.3390_atmos11080868_789_item_1: generation shape=torch.Size([1, 403])
2025-06-10 20:21:13,775 - DEBUG - Snippet 10.3390_atmos11080868_789_item_1 raw docling: (tokens=57)
<formula><loc_0><loc_0><loc_500><loc_500>Y _ { i t } = \sum _ { j = 1 } ^ { 1 3 } w _ { j } ^ { * } Y _ { j t }</formula><end_of_utterance>
2025-06-10 20:21:13,776 - DEBUG - Starting _parse_docling_output
2025-06-10 20:21:13,776 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>Y _ { i t } = \sum _ { j = 1 } ^ { 1 3 } w _ { j } ^ { * } Y _ { j t }</formula><end_of_utterance>
2025-06-10 20:21:13,776 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:21:13,776 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>Y _ { i t } = \\sum _ { j = 1 } ^ { 1 3 } w _ { j } ^ { * } Y _ { j t }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=750x156 at 0x7F9714D5C2C0>)]
2025-06-10 20:21:13,777 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:21:13,781 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=750.0, b=156.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 70))], orig='Y _ { i t } = \\sum _ { j = 1 } ^ { 1 3 } w _ { j } ^ { * } Y _ { j t }', text='Y _ { i t } = \\sum _ { j = 1 } ^ { 1 3 } w _ { j } ^ { * } Y _ { j t }', formatting=None, hyperlink=None)]
2025-06-10 20:21:13,781 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:21:13,781 - DEBUG - Processing text item: label=formula, text=Y _ { i t } = \sum _ { j = 1 } ^ { 1 3 } w _ { j } ^ { * } Y _ { j t }
2025-06-10 20:21:13,781 - DEBUG - Recognized string extracted: Y _ { i t } = \sum _ { j = 1 } ^ { 1 3 } w _ { j } ^ { * } Y _ { j t }
2025-06-10 20:21:13,781 - DEBUG - Generating chat message for label: formula
2025-06-10 20:21:13,782 - DEBUG - Snippet 10.3390_atmos11080868_789_item_2 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:21:13,782 - INFO - Finished converting document 10.1371_journal.pone.0076759_787.pdf in 19.61 sec.
2025-06-10 20:21:13,790 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:13,828 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:21:13,850 - INFO - Extraction successful row 159, tokens=11698
2025-06-10 20:21:13,853 - DEBUG - Snippet 10.3390_atmos11080868_789_item_2 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:21:13,864 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:21:13,873 - INFO - Going to convert document batch...
2025-06-10 20:21:13,874 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:21:13,874 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:21:13,900 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:13,934 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:21:13,935 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:21:14,068 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:14,105 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:21:14,114 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:14,143 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:21:14,307 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:21:14,494 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:14,495 - DEBUG - Finished converting page batch time=4031.666
2025-06-10 20:21:14,603 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:21:14,801 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:21:14,802 - INFO - Processing document 10.1371_journal.pone.0108076_794.pdf
2025-06-10 20:21:14,859 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:21:14,905 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:21:14,911 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:21:15,639 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:15,754 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:21:15,755 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:21:15,755 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:21:15,789 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:15,790 - DEBUG - Finished converting page batch time=4032.960
2025-06-10 20:21:15,792 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:15,796 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:15,797 - DEBUG - Finished converting page batch time=4032.967
2025-06-10 20:21:15,832 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:15,868 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:21:15,907 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:21:15,955 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:15,967 - DEBUG - Creating masked image for page 2 with 18 clusters.
2025-06-10 20:21:15,968 - INFO - Masked image successfully created for page 2.
2025-06-10 20:21:15,973 - INFO - Starting prediction for 2 images with labels: ['formula', 'formula']
2025-06-10 20:21:15,973 - DEBUG - Generating chat message for label: formula
2025-06-10 20:21:15,973 - DEBUG - Snippet 10.1186_s41256-018-0080-0_792_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:21:15,989 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:21:16,108 - DEBUG - Snippet 10.1186_s41256-018-0080-0_792_item_0 => input_ids shape=torch.Size([1, 610]), prompt_len=610
2025-06-10 20:21:16,142 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:16,180 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:21:16,224 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:21:16,260 - DEBUG - Snippet 10.3390_catal11080998_724_item_1: generation shape=torch.Size([1, 437])
2025-06-10 20:21:16,261 - DEBUG - Snippet 10.3390_catal11080998_724_item_1 raw docling: (tokens=91)
<formula><loc_0><loc_0><loc_500><loc_500>O _ { 3 } + H O _ { 2 } \bullet \Longrightarrow 2 O _ { 2 } + \bullet O H , k = 1 . 6 \times 1 0 ^ { 9 } \, M ^ { - 1 } \, s ^ { - 1 }</formula><end_of_utterance>
2025-06-10 20:21:16,261 - DEBUG - Starting _parse_docling_output
2025-06-10 20:21:16,261 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>O _ { 3 } + H O _ { 2 } \bullet \Longrightarrow 2 O _ { 2 } + \bullet O H , k = 1 . 6 \times 1 0 ^ { 9 } \, M ^ { - 1 } \, s ^ { - 1 }</formula><end_of_utterance>
2025-06-10 20:21:16,262 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:21:16,262 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>O _ { 3 } + H O _ { 2 } \\bullet \\Longrightarrow 2 O _ { 2 } + \\bullet O H , k = 1 . 6 \\times 1 0 ^ { 9 } \\, M ^ { - 1 } \\, s ^ { - 1 }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=895x72 at 0x7F96A9910710>)]
2025-06-10 20:21:16,263 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:21:16,265 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=895.0, b=72.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 134))], orig='O _ { 3 } + H O _ { 2 } \\bullet \\Longrightarrow 2 O _ { 2 } + \\bullet O H , k = 1 . 6 \\times 1 0 ^ { 9 } \\, M ^ { - 1 } \\, s ^ { - 1 }', text='O _ { 3 } + H O _ { 2 } \\bullet \\Longrightarrow 2 O _ { 2 } + \\bullet O H , k = 1 . 6 \\times 1 0 ^ { 9 } \\, M ^ { - 1 } \\, s ^ { - 1 }', formatting=None, hyperlink=None)]
2025-06-10 20:21:16,266 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:21:16,266 - DEBUG - Processing text item: label=formula, text=O _ { 3 } + H O _ { 2 } \bullet \Longrightarrow 2 O _ { 2 } + \bullet O H , k = 1 . 6 \times 1 0 ^ { 9 } \, M ^ { - 1 } \, s ^ { - 1 }
2025-06-10 20:21:16,266 - DEBUG - Recognized string extracted: O _ { 3 } + H O _ { 2 } \bullet \Longrightarrow 2 O _ { 2 } + \bullet O H , k = 1 . 6 \times 1 0 ^ { 9 } \, M ^ { - 1 } \, s ^ { - 1 }
2025-06-10 20:21:16,266 - DEBUG - Generating chat message for label: formula
2025-06-10 20:21:16,267 - DEBUG - Snippet 10.3390_catal11080998_724_item_2 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:21:16,335 - DEBUG - Snippet 10.3390_catal11080998_724_item_2 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:21:16,382 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:21:16,651 - DEBUG - Snippet 10.3390_ijerph13050454_790_item_0: generation shape=torch.Size([1, 469])
2025-06-10 20:21:16,652 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:21:16,652 - DEBUG - Snippet 10.3390_ijerph13050454_790_item_0 raw docling: (tokens=123)
<formula><loc_0><loc_0><loc_500><loc_500>\log \left ( \mu _ { t } \right ) = D O W _ { t + I C D _ { t } + c b ( T M P _ { t - 1 } ) + n s \left ( t i m e , \, d f \right ) } \\ + i n t x \left ( T M P _ { t - 1 } , i n t e n s e \, f l u d a y _ { t } \right )</formula><end_of_utterance>
2025-06-10 20:21:16,652 - DEBUG - Starting _parse_docling_output
2025-06-10 20:21:16,652 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>\log \left ( \mu _ { t } \right ) = D O W _ { t + I C D _ { t } + c b ( T M P _ { t - 1 } ) + n s \left ( t i m e , \, d f \right ) } \\ + i n t x \left ( T M P _ { t - 1 } , i n t e n s e \, f l u d a y _ { t } \right )</formula><end_of_utterance>
2025-06-10 20:21:16,653 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:21:16,653 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>\\log \\left ( \\mu _ { t } \\right ) = D O W _ { t + I C D _ { t } + c b ( T M P _ { t - 1 } ) + n s \\left ( t i m e , \\, d f \\right ) } \\\\ + i n t x \\left ( T M P _ { t - 1 } , i n t e n s e \\, f l u d a y _ { t } \\right )</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=998x181 at 0x7F96D8FDD1C0>)]
2025-06-10 20:21:16,653 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:21:16,661 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=998.0, b=181.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 220))], orig='\\log \\left ( \\mu _ { t } \\right ) = D O W _ { t + I C D _ { t } + c b ( T M P _ { t - 1 } ) + n s \\left ( t i m e , \\, d f \\right ) } \\\\ + i n t x \\left ( T M P _ { t - 1 } , i n t e n s e \\, f l u d a y _ { t } \\right )', text='\\log \\left ( \\mu _ { t } \\right ) = D O W _ { t + I C D _ { t } + c b ( T M P _ { t - 1 } ) + n s \\left ( t i m e , \\, d f \\right ) } \\\\ + i n t x \\left ( T M P _ { t - 1 } , i n t e n s e \\, f l u d a y _ { t } \\right )', formatting=None, hyperlink=None)]
2025-06-10 20:21:16,662 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:21:16,662 - DEBUG - Processing text item: label=formula, text=\log \left ( \mu _ { t } \right ) = D O W _ { t + I C D _ { t } + c b ( T M P _ { t - 1 } ) + n s \left ( t i m e , \, d f \right ) } \\ + i n t x \left ( T M P _ { t - 1 } , i n t e n s e \, f l u d a y _ { t } \right )
2025-06-10 20:21:16,662 - DEBUG - Recognized string extracted: \log \left ( \mu _ { t } \right ) = D O W _ { t + I C D _ { t } + c b ( T M P _ { t - 1 } ) + n s \left ( t i m e , \, d f \right ) } \\ + i n t x \left ( T M P _ { t - 1 } , i n t e n s e \, f l u d a y _ { t } \right )
2025-06-10 20:21:16,662 - INFO - All done. Returning 1 recognized text results.
2025-06-10 20:21:16,663 - DEBUG - Snippet 10.3390_ijerph13050454_790_item_0 recognized text:
\log \left ( \mu _ { t } \right ) = D O W _ { t + I C D _ { t } + c b ( T M P _ { t - 1 } ) + n s \left ( t i m e , \, d f \right ) } \\ + i n t x \left ( T M P _ { t - 1 } , i n t e n s e \, f l u d a y _ { t } \right )
2025-06-10 20:21:16,775 - INFO - Finished converting document 10.3390_ijerph13050454_790.pdf in 18.10 sec.
2025-06-10 20:21:16,809 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:16,879 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:21:16,879 - INFO - Processing document 10.20882_adicciones.114_797.pdf
2025-06-10 20:21:16,882 - INFO - Extraction successful row 161, tokens=13838
2025-06-10 20:21:16,902 - DEBUG - Snippet 10.1214_10-aoas351_689_item_4: generation shape=torch.Size([1, 793])
2025-06-10 20:21:16,903 - DEBUG - Snippet 10.1214_10-aoas351_689_item_4 raw docling: (tokens=182)
<formula><loc_0><loc_0><loc_500><loc_500>C o v ( Y _ { 1 } ( s ) , Y _ { 2 } ( s ^ { \prime } ) ) \\ = A _ { 1 1 } A _ { 4 1 } \cdot \exp ( - \phi _ { 1 } \| s - s ^ { \prime } \| ) \\ + \sum _ { k = 2 } ^ { 3 } [ A _ { k k } A _ { ( k + 3 ) k } \cdot x _ { k - 1 } ( B ) x _ { k - 1 } ( B ^ { \prime } ) \cdot \exp ( - \phi _ { k } \| s - s ^ { \prime } \| ) ] ,</formula><end_of_utterance>
2025-06-10 20:21:16,904 - DEBUG - Starting _parse_docling_output
2025-06-10 20:21:16,904 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>C o v ( Y _ { 1 } ( s ) , Y _ { 2 } ( s ^ { \prime } ) ) \\ = A _ { 1 1 } A _ { 4 1 } \cdot \exp ( - \phi _ { 1 } \| s - s ^ { \prime } \| ) \\ + \sum _ { k = 2 } ^ { 3 } [ A _ { k k } A _ { ( k + 3 ) k } \cdot x _ { k - 1 } ( B ) x _ { k - 1 } ( B ^ { \prime } ) \cdot \exp ( - \phi _ { k } \| s - s ^ { \prime } \| ) ] ,</formula><end_of_utterance>
2025-06-10 20:21:16,904 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:21:16,904 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>C o v ( Y _ { 1 } ( s ) , Y _ { 2 } ( s ^ { \\prime } ) ) \\\\ = A _ { 1 1 } A _ { 4 1 } \\cdot \\exp ( - \\phi _ { 1 } \\| s - s ^ { \\prime } \\| ) \\\\ + \\sum _ { k = 2 } ^ { 3 } [ A _ { k k } A _ { ( k + 3 ) k } \\cdot x _ { k - 1 } ( B ) x _ { k - 1 } ( B ^ { \\prime } ) \\cdot \\exp ( - \\phi _ { k } \\| s - s ^ { \\prime } \\| ) ] ,</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=966x370 at 0x7F96B2950200>)]
2025-06-10 20:21:16,905 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:21:16,915 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=966.0, b=370.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 322))], orig='C o v ( Y _ { 1 } ( s ) , Y _ { 2 } ( s ^ { \\prime } ) ) \\\\ = A _ { 1 1 } A _ { 4 1 } \\cdot \\exp ( - \\phi _ { 1 } \\| s - s ^ { \\prime } \\| ) \\\\ + \\sum _ { k = 2 } ^ { 3 } [ A _ { k k } A _ { ( k + 3 ) k } \\cdot x _ { k - 1 } ( B ) x _ { k - 1 } ( B ^ { \\prime } ) \\cdot \\exp ( - \\phi _ { k } \\| s - s ^ { \\prime } \\| ) ] ,', text='C o v ( Y _ { 1 } ( s ) , Y _ { 2 } ( s ^ { \\prime } ) ) \\\\ = A _ { 1 1 } A _ { 4 1 } \\cdot \\exp ( - \\phi _ { 1 } \\| s - s ^ { \\prime } \\| ) \\\\ + \\sum _ { k = 2 } ^ { 3 } [ A _ { k k } A _ { ( k + 3 ) k } \\cdot x _ { k - 1 } ( B ) x _ { k - 1 } ( B ^ { \\prime } ) \\cdot \\exp ( - \\phi _ { k } \\| s - s ^ { \\prime } \\| ) ] ,', formatting=None, hyperlink=None)]
2025-06-10 20:21:16,915 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:21:16,915 - DEBUG - Processing text item: label=formula, text=C o v ( Y _ { 1 } ( s ) , Y _ { 2 } ( s ^ { \prime } ) ) \\ = A _ { 1 1 } A _ { 4 1 } \cdot \exp ( - \phi _ { 1 } \| s - s ^ { \prime } \| ) \\ + \sum _ { k = 2 } ^ { 3 } [ A _ { k k } A _ { ( k + 3 ) k } \cdot x _ { k - 1 } ( B ) x _ { k - 1 } ( B ^ { \prime } ) \cdot \exp ( - \phi _ { k } \| s - s ^ { \prime } \| ) ] ,
2025-06-10 20:21:16,915 - INFO - Going to convert document batch...
2025-06-10 20:21:16,915 - DEBUG - Recognized string extracted: C o v ( Y _ { 1 } ( s ) , Y _ { 2 } ( s ^ { \prime } ) ) \\ = A _ { 1 1 } A _ { 4 1 } \cdot \exp ( - \phi _ { 1 } \| s - s ^ { \prime } \| ) \\ + \sum _ { k = 2 } ^ { 3 } [ A _ { k k } A _ { ( k + 3 ) k } \cdot x _ { k - 1 } ( B ) x _ { k - 1 } ( B ^ { \prime } ) \cdot \exp ( - \phi _ { k } \| s - s ^ { \prime } \| ) ] ,
2025-06-10 20:21:16,916 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:21:16,916 - INFO - All done. Returning 5 recognized text results.
2025-06-10 20:21:16,916 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:21:16,916 - DEBUG - Snippet 10.1214_10-aoas351_689_item_0 recognized text:
_ { 2 } ( s ^ { \prime } ) = A _ { 1 1 } ^ { 2 } \exp ( - \phi _ { 1 } \| s - s ^ { \prime } \| ) + \tau _ { 1 } ^ { 2 } \delta _ { s , s ^ { \prime } } ,
2025-06-10 20:21:16,916 - DEBUG - Snippet 10.1214_10-aoas351_689_item_1 recognized text:
= A _ { 1 1 } ^ { 2 } \exp ( - \phi _ { 1 } \| s - s ^ { \prime } \| )
2025-06-10 20:21:16,917 - DEBUG - Snippet 10.1214_10-aoas351_689_item_2 recognized text:
= A _ { 4 1 } ^ { 2 } \exp ( - \phi _ { 1 } \| s - s ^ { \prime } \| ) + A _ { 4 4 } ^ { 2 } \exp ( - \phi _ { 4 } \| s - s ^ { \prime } \| )
2025-06-10 20:21:16,917 - DEBUG - Snippet 10.1214_10-aoas351_689_item_3 recognized text:
= A _ { 1 1 } ^ { 2 } \exp ( - \phi _ { 1 } \| s - s ^ { \prime } \| ) \\ + \sum _ { k = 2 } ^ { 3 } [ A _ { k k } ^ { 2 } \cdot x _ { k - 1 } ( B ) x _ { k - 1 } ( B ^ { \prime } ) \cdot \exp ( - \phi _ { k } \| s - s ^ { \prime } \| ) ] + \tau _ { 1 } ^ { 2 } \delta _ { s , s ^ { \prime } } , \\ = A _ { 4 1 } ^ { 2 } \exp ( - \phi _ { 1 } \| s - s ^ { \prime } \| ) + A _ { 4 4 } ^ { 2 } \exp ( - \phi _ { 4 } \| s - s ^ { \prime } \| ) \\ + \sum _ { k = 5 } ^ { 6 } [ A _ { k k } ^ { 2 } \cdot x _ { ( k - 4 ) } ( B ) x _ { ( k - 4 ) } ( B ^ { \prime } ) \cdot \exp ( - \phi _ { k } \| s - s ^ { \prime } \| ) ] + \tau _ { 2 } ^ { 2 } \delta _ { s , s ^ { \prime } } ,
2025-06-10 20:21:16,917 - DEBUG - Snippet 10.1214_10-aoas351_689_item_4 recognized text:
C o v ( Y _ { 1 } ( s ) , Y _ { 2 } ( s ^ { \prime } ) ) \\ = A _ { 1 1 } A _ { 4 1 } \cdot \exp ( - \phi _ { 1 } \| s - s ^ { \prime } \| ) \\ + \sum _ { k = 2 } ^ { 3 } [ A _ { k k } A _ { ( k + 3 ) k } \cdot x _ { k - 1 } ( B ) x _ { k - 1 } ( B ^ { \prime } ) \cdot \exp ( - \phi _ { k } \| s - s ^ { \prime } \| ) ] ,
2025-06-10 20:21:16,924 - INFO - Starting prediction for 2 images with labels: ['formula', 'formula']
2025-06-10 20:21:16,924 - DEBUG - Generating chat message for label: formula
2025-06-10 20:21:16,924 - DEBUG - Snippet 10.1214_10-aoas351_689_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:21:16,967 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:21:16,997 - DEBUG - Snippet 10.1214_10-aoas351_689_item_0 => input_ids shape=torch.Size([1, 348]), prompt_len=348
2025-06-10 20:21:17,043 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:17,154 - DEBUG - [Page 9] Reclassifying cluster 0 from form to TEXT (area ratio: 1.00, cells: 0, density: 0.000000).
2025-06-10 20:21:17,154 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 1
2025-06-10 20:21:17,155 - DEBUG - Finished converting page batch time=4034.325
2025-06-10 20:21:17,272 - INFO - Finished converting document 10.20882_adicciones.233_793.pdf in 14.66 sec.
2025-06-10 20:21:17,336 - INFO - Extraction successful row 163, tokens=14249
2025-06-10 20:21:17,359 - INFO - Going to convert document batch...
2025-06-10 20:21:17,360 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:21:17,360 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:21:17,410 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:17,416 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:21:17,522 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:17,619 - DEBUG - Snippet 10.3390_atmos11080868_789_item_2: generation shape=torch.Size([1, 478])
2025-06-10 20:21:17,620 - DEBUG - Snippet 10.3390_atmos11080868_789_item_2 raw docling: (tokens=132)
<formula><loc_0><loc_0><loc_500><loc_500>N R M S E _ { i j } = R M S E _ { i j } / \overline { X } _ { i j } = \frac { 1 } { \overline { X } _ { i j } } \sqrt { \frac { \sum _ { t = 1 } ^ { T _ { 0 } } \left ( X _ { i j t } - X _ { 0 j t } \right ) ^ { 2 } } { T _ { 0 } } }</formula><end_of_utterance>
2025-06-10 20:21:17,620 - DEBUG - Starting _parse_docling_output
2025-06-10 20:21:17,621 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>N R M S E _ { i j } = R M S E _ { i j } / \overline { X } _ { i j } = \frac { 1 } { \overline { X } _ { i j } } \sqrt { \frac { \sum _ { t = 1 } ^ { T _ { 0 } } \left ( X _ { i j t } - X _ { 0 j t } \right ) ^ { 2 } } { T _ { 0 } } }</formula><end_of_utterance>
2025-06-10 20:21:17,621 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:21:17,621 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>N R M S E _ { i j } = R M S E _ { i j } / \\overline { X } _ { i j } = \\frac { 1 } { \\overline { X } _ { i j } } \\sqrt { \\frac { \\sum _ { t = 1 } ^ { T _ { 0 } } \\left ( X _ { i j t } - X _ { 0 j t } \\right ) ^ { 2 } } { T _ { 0 } } }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=987x169 at 0x7F9714D5F8F0>)]
2025-06-10 20:21:17,621 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:21:17,627 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=987.0, b=169.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 233))], orig='N R M S E _ { i j } = R M S E _ { i j } / \\overline { X } _ { i j } = \\frac { 1 } { \\overline { X } _ { i j } } \\sqrt { \\frac { \\sum _ { t = 1 } ^ { T _ { 0 } } \\left ( X _ { i j t } - X _ { 0 j t } \\right ) ^ { 2 } } { T _ { 0 } } }', text='N R M S E _ { i j } = R M S E _ { i j } / \\overline { X } _ { i j } = \\frac { 1 } { \\overline { X } _ { i j } } \\sqrt { \\frac { \\sum _ { t = 1 } ^ { T _ { 0 } } \\left ( X _ { i j t } - X _ { 0 j t } \\right ) ^ { 2 } } { T _ { 0 } } }', formatting=None, hyperlink=None)]
2025-06-10 20:21:17,627 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:21:17,627 - DEBUG - Processing text item: label=formula, text=N R M S E _ { i j } = R M S E _ { i j } / \overline { X } _ { i j } = \frac { 1 } { \overline { X } _ { i j } } \sqrt { \frac { \sum _ { t = 1 } ^ { T _ { 0 } } \left ( X _ { i j t } - X _ { 0 j t } \right ) ^ { 2 } } { T _ { 0 } } }
2025-06-10 20:21:17,628 - DEBUG - Recognized string extracted: N R M S E _ { i j } = R M S E _ { i j } / \overline { X } _ { i j } = \frac { 1 } { \overline { X } _ { i j } } \sqrt { \frac { \sum _ { t = 1 } ^ { T _ { 0 } } \left ( X _ { i j t } - X _ { 0 j t } \right ) ^ { 2 } } { T _ { 0 } } }
2025-06-10 20:21:17,628 - DEBUG - Generating chat message for label: formula
2025-06-10 20:21:17,628 - DEBUG - Snippet 10.3390_atmos11080868_789_item_3 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:21:17,694 - DEBUG - Snippet 10.3390_atmos11080868_789_item_3 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:21:17,815 - DEBUG - Snippet 10.1214_10-aoas351_689_item_0: generation shape=torch.Size([1, 376])
2025-06-10 20:21:17,816 - DEBUG - Snippet 10.1214_10-aoas351_689_item_0 raw docling: (tokens=24)
<formula><loc_0><loc_0><loc_500><loc_500><_SQL_> 
</formula><end_of_utterance>
2025-06-10 20:21:17,816 - DEBUG - Starting _parse_docling_output
2025-06-10 20:21:17,816 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500><_SQL_> 
</formula><end_of_utterance>
2025-06-10 20:21:17,816 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:21:17,817 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500><_SQL_> \n</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=9x54 at 0x7F96D573D700>)]
2025-06-10 20:21:17,817 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:21:17,818 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=9.0, b=54.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 0))], orig='', text='', formatting=None, hyperlink=None)]
2025-06-10 20:21:17,818 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:21:17,818 - DEBUG - Processing text item: label=formula, text=
2025-06-10 20:21:17,818 - WARNING - Extracted text is empty or malformed. Skipping formula.
2025-06-10 20:21:17,818 - DEBUG - Generating chat message for label: formula
2025-06-10 20:21:17,819 - DEBUG - Snippet 10.1214_10-aoas351_689_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:21:17,823 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:21:17,868 - DEBUG - Snippet 10.3390_catal11080998_724_item_2: generation shape=torch.Size([1, 398])
2025-06-10 20:21:17,869 - DEBUG - Snippet 10.3390_catal11080998_724_item_2 raw docling: (tokens=52)
<formula><loc_0><loc_0><loc_500><loc_500>2 H O _ { 2 } ^ { * } \to O _ { 2 } + H _ { 2 } O _ { 2 }</formula><end_of_utterance>
2025-06-10 20:21:17,869 - DEBUG - Starting _parse_docling_output
2025-06-10 20:21:17,870 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>2 H O _ { 2 } ^ { * } \to O _ { 2 } + H _ { 2 } O _ { 2 }</formula><end_of_utterance>
2025-06-10 20:21:17,870 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:21:17,870 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>2 H O _ { 2 } ^ { * } \\to O _ { 2 } + H _ { 2 } O _ { 2 }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=714x61 at 0x7F96A9913650>)]
2025-06-10 20:21:17,870 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:21:17,872 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=714.0, b=61.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 57))], orig='2 H O _ { 2 } ^ { * } \\to O _ { 2 } + H _ { 2 } O _ { 2 }', text='2 H O _ { 2 } ^ { * } \\to O _ { 2 } + H _ { 2 } O _ { 2 }', formatting=None, hyperlink=None)]
2025-06-10 20:21:17,872 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:21:17,873 - DEBUG - Processing text item: label=formula, text=2 H O _ { 2 } ^ { * } \to O _ { 2 } + H _ { 2 } O _ { 2 }
2025-06-10 20:21:17,873 - DEBUG - Recognized string extracted: 2 H O _ { 2 } ^ { * } \to O _ { 2 } + H _ { 2 } O _ { 2 }
2025-06-10 20:21:17,873 - DEBUG - Generating chat message for label: formula
2025-06-10 20:21:17,873 - DEBUG - Snippet 10.3390_catal11080998_724_item_3 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:21:17,881 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:21:17,887 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:21:17,946 - DEBUG - Snippet 10.3390_catal11080998_724_item_3 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:21:18,112 - DEBUG - Snippet 10.1214_10-aoas351_689_item_1 => input_ids shape=torch.Size([1, 876]), prompt_len=876
2025-06-10 20:21:18,193 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:21:18,241 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:21:18,246 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:21:18,540 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:21:18,541 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:21:18,541 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:21:18,576 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:18,614 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:18,620 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:18,621 - DEBUG - Finished converting page batch time=4035.791
2025-06-10 20:21:18,659 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:21:18,724 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:21:18,846 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:21:18,846 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:21:18,846 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:21:18,969 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:18,973 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:19,205 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:19,210 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:19,246 - WARNING - Repetitive generation detected with pattern: ' 2 2'
2025-06-10 20:21:19,246 - DEBUG - Snippet 10.1214_10-aoas351_689_item_1: generation shape=torch.Size([1, 914])
2025-06-10 20:21:19,247 - DEBUG - Snippet 10.1214_10-aoas351_689_item_1 raw docling: (tokens=37)
<formula><loc_83><loc_52><loc_472><loc_85>+ 3 2 2 2 2 2 2 2 2
2025-06-10 20:21:19,247 - DEBUG - Starting _parse_docling_output
2025-06-10 20:21:19,248 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_83><loc_52><loc_472><loc_85>+ 3 2 2 2 2 2 2 2 2
2025-06-10 20:21:19,248 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:21:19,248 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_83><loc_52><loc_472><loc_85>+ 3 2 2 2 2 2 2 2 2', image=<PIL.Image.Image image mode=RGB size=866x1219 at 0x7F96B299BC20>)]
2025-06-10 20:21:19,248 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:21:19,250 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:21:19,258 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:19,278 - DEBUG - DoclingDocument loaded successfully. Extracted texts: []
2025-06-10 20:21:19,279 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:21:19,279 - WARNING - Extracted text is empty or malformed. Skipping formula.
2025-06-10 20:21:19,279 - INFO - All done. Returning 2 recognized text results.
2025-06-10 20:21:19,279 - DEBUG - Snippet 10.1214_10-aoas351_689_item_0 recognized text:
MALFORMED_FORMULA
2025-06-10 20:21:19,280 - DEBUG - Snippet 10.1214_10-aoas351_689_item_1 recognized text:
MALFORMED_FORMULA
2025-06-10 20:21:19,294 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:21:19,332 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:21:19,372 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:19,372 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:19,407 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:21:19,411 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:21:19,446 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:21:19,478 - DEBUG - Snippet 10.3390_catal11080998_724_item_3: generation shape=torch.Size([1, 397])
2025-06-10 20:21:19,479 - DEBUG - Snippet 10.3390_catal11080998_724_item_3 raw docling: (tokens=51)
<formula><loc_0><loc_0><loc_500><loc_500>O _ { 3 } + O H ^ { - } \to H O _ { 2 } \bullet + O _ { 2 }</formula><end_of_utterance>
2025-06-10 20:21:19,479 - DEBUG - Starting _parse_docling_output
2025-06-10 20:21:19,480 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>O _ { 3 } + O H ^ { - } \to H O _ { 2 } \bullet + O _ { 2 }</formula><end_of_utterance>
2025-06-10 20:21:19,480 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:21:19,480 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>O _ { 3 } + O H ^ { - } \\to H O _ { 2 } \\bullet + O _ { 2 }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=739x72 at 0x7F96A9910860>)]
2025-06-10 20:21:19,480 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:21:19,482 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=739.0, b=72.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 59))], orig='O _ { 3 } + O H ^ { - } \\to H O _ { 2 } \\bullet + O _ { 2 }', text='O _ { 3 } + O H ^ { - } \\to H O _ { 2 } \\bullet + O _ { 2 }', formatting=None, hyperlink=None)]
2025-06-10 20:21:19,483 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:21:19,483 - DEBUG - Processing text item: label=formula, text=O _ { 3 } + O H ^ { - } \to H O _ { 2 } \bullet + O _ { 2 }
2025-06-10 20:21:19,481 - INFO - Finished converting document 10.1214_10-aoas351_689.pdf in 144.14 sec.
2025-06-10 20:21:19,483 - DEBUG - Recognized string extracted: O _ { 3 } + O H ^ { - } \to H O _ { 2 } \bullet + O _ { 2 }
2025-06-10 20:21:19,483 - DEBUG - Generating chat message for label: formula
2025-06-10 20:21:19,484 - DEBUG - Snippet 10.3390_catal11080998_724_item_4 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:21:19,551 - DEBUG - Snippet 10.3390_catal11080998_724_item_4 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:21:19,555 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:19,590 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:21:19,616 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:21:19,628 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:21:19,661 - DEBUG - Snippet 10.3390_atmos11080868_789_item_3: generation shape=torch.Size([1, 413])
2025-06-10 20:21:19,662 - DEBUG - Snippet 10.3390_atmos11080868_789_item_3 raw docling: (tokens=67)
<formula><loc_0><loc_0><loc_500><loc_500>E ( y ) = m o r _ { i , t } \times \left ( m o r _ { 0 , t _ { 0 } } / m o r _ { 0 , t } \right )</formula><end_of_utterance>
2025-06-10 20:21:19,662 - DEBUG - Starting _parse_docling_output
2025-06-10 20:21:19,663 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>E ( y ) = m o r _ { i , t } \times \left ( m o r _ { 0 , t _ { 0 } } / m o r _ { 0 , t } \right )</formula><end_of_utterance>
2025-06-10 20:21:19,663 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:21:19,663 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>E ( y ) = m o r _ { i , t } \\times \\left ( m o r _ { 0 , t _ { 0 } } / m o r _ { 0 , t } \\right )</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=850x80 at 0x7F9714D5D160>)]
2025-06-10 20:21:19,664 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:21:19,667 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=850.0, b=80.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 97))], orig='E ( y ) = m o r _ { i , t } \\times \\left ( m o r _ { 0 , t _ { 0 } } / m o r _ { 0 , t } \\right )', text='E ( y ) = m o r _ { i , t } \\times \\left ( m o r _ { 0 , t _ { 0 } } / m o r _ { 0 , t } \\right )', formatting=None, hyperlink=None)]
2025-06-10 20:21:19,667 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:21:19,667 - DEBUG - Processing text item: label=formula, text=E ( y ) = m o r _ { i , t } \times \left ( m o r _ { 0 , t _ { 0 } } / m o r _ { 0 , t } \right )
2025-06-10 20:21:19,667 - DEBUG - Recognized string extracted: E ( y ) = m o r _ { i , t } \times \left ( m o r _ { 0 , t _ { 0 } } / m o r _ { 0 , t } \right )
2025-06-10 20:21:19,667 - DEBUG - Generating chat message for label: formula
2025-06-10 20:21:19,668 - DEBUG - Snippet 10.3390_atmos11080868_789_item_4 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:21:19,739 - DEBUG - Snippet 10.3390_atmos11080868_789_item_4 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:21:19,786 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:21:19,872 - INFO - Extraction successful row 132, tokens=28708
2025-06-10 20:21:19,887 - DEBUG - Dynamic vertical threshold: 29.941200000000027, Overlap threshold: 0.7
2025-06-10 20:21:19,888 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:19,897 - INFO - Going to convert document batch...
2025-06-10 20:21:19,897 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:21:19,897 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:21:19,903 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:21:19,946 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:21:20,080 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:21:20,089 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:21:20,089 - INFO - Processing document 10.1136_heartjnl-2021-320082_798.pdf
2025-06-10 20:21:20,255 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:20,300 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:21:20,300 - INFO - Processing document 10.3390_ijerph16111904_801.pdf
2025-06-10 20:21:20,336 - DEBUG - Snippet 10.1186_s41256-018-0080-0_792_item_0: generation shape=torch.Size([1, 744])
2025-06-10 20:21:20,337 - DEBUG - Snippet 10.1186_s41256-018-0080-0_792_item_0 raw docling: (tokens=133)
<formula><loc_0><loc_0><loc_500><loc_500>\log [ E ( y _ { t } ) ] = \beta Z _ { t } + s ( t i m e , d f _ { 1 } ) + a s . f a c t o r ( d o w ) \\ + a s . f a c t o r ( h o l i d a y ) + s ( t e m p e r a t u r e , 3 ) \\ + s ( h u m i d i t y , 3 ) + i n t e r c e p t</formula><end_of_utterance>
2025-06-10 20:21:20,337 - DEBUG - Starting _parse_docling_output
2025-06-10 20:21:20,337 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>\log [ E ( y _ { t } ) ] = \beta Z _ { t } + s ( t i m e , d f _ { 1 } ) + a s . f a c t o r ( d o w ) \\ + a s . f a c t o r ( h o l i d a y ) + s ( t e m p e r a t u r e , 3 ) \\ + s ( h u m i d i t y , 3 ) + i n t e r c e p t</formula><end_of_utterance>
2025-06-10 20:21:20,337 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:21:20,338 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>\\log [ E ( y _ { t } ) ] = \\beta Z _ { t } + s ( t i m e , d f _ { 1 } ) + a s . f a c t o r ( d o w ) \\\\ + a s . f a c t o r ( h o l i d a y ) + s ( t e m p e r a t u r e , 3 ) \\\\ + s ( h u m i d i t y , 3 ) + i n t e r c e p t</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=633x198 at 0x7F968233D970>)]
2025-06-10 20:21:20,338 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:21:20,343 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=633.0, b=198.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 228))], orig='\\log [ E ( y _ { t } ) ] = \\beta Z _ { t } + s ( t i m e , d f _ { 1 } ) + a s . f a c t o r ( d o w ) \\\\ + a s . f a c t o r ( h o l i d a y ) + s ( t e m p e r a t u r e , 3 ) \\\\ + s ( h u m i d i t y , 3 ) + i n t e r c e p t', text='\\log [ E ( y _ { t } ) ] = \\beta Z _ { t } + s ( t i m e , d f _ { 1 } ) + a s . f a c t o r ( d o w ) \\\\ + a s . f a c t o r ( h o l i d a y ) + s ( t e m p e r a t u r e , 3 ) \\\\ + s ( h u m i d i t y , 3 ) + i n t e r c e p t', formatting=None, hyperlink=None)]
2025-06-10 20:21:20,344 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:21:20,344 - DEBUG - Processing text item: label=formula, text=\log [ E ( y _ { t } ) ] = \beta Z _ { t } + s ( t i m e , d f _ { 1 } ) + a s . f a c t o r ( d o w ) \\ + a s . f a c t o r ( h o l i d a y ) + s ( t e m p e r a t u r e , 3 ) \\ + s ( h u m i d i t y , 3 ) + i n t e r c e p t
2025-06-10 20:21:20,344 - DEBUG - Recognized string extracted: \log [ E ( y _ { t } ) ] = \beta Z _ { t } + s ( t i m e , d f _ { 1 } ) + a s . f a c t o r ( d o w ) \\ + a s . f a c t o r ( h o l i d a y ) + s ( t e m p e r a t u r e , 3 ) \\ + s ( h u m i d i t y , 3 ) + i n t e r c e p t
2025-06-10 20:21:20,344 - DEBUG - Generating chat message for label: formula
2025-06-10 20:21:20,345 - DEBUG - Snippet 10.1186_s41256-018-0080-0_792_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:21:20,477 - DEBUG - Snippet 10.1186_s41256-018-0080-0_792_item_1 => input_ids shape=torch.Size([1, 610]), prompt_len=610
2025-06-10 20:21:20,715 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:21:20,771 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:21:20,778 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:21:20,935 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:21,307 - DEBUG - Snippet 10.3390_catal11080998_724_item_4: generation shape=torch.Size([1, 409])
2025-06-10 20:21:21,307 - DEBUG - Snippet 10.3390_catal11080998_724_item_4 raw docling: (tokens=63)
<formula><loc_0><loc_0><loc_500><loc_500>O _ { 3 } + H _ { 2 } O ^ { - } \to H O _ { 2 } \bullet + \bullet O _ { 3 } ^ { - }</formula><end_of_utterance>
2025-06-10 20:21:21,307 - DEBUG - Starting _parse_docling_output
2025-06-10 20:21:21,308 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>O _ { 3 } + H _ { 2 } O ^ { - } \to H O _ { 2 } \bullet + \bullet O _ { 3 } ^ { - }</formula><end_of_utterance>
2025-06-10 20:21:21,308 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:21:21,308 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>O _ { 3 } + H _ { 2 } O ^ { - } \\to H O _ { 2 } \\bullet + \\bullet O _ { 3 } ^ { - }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=764x71 at 0x7F96A99136E0>)]
2025-06-10 20:21:21,308 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:21:21,311 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=764.0, b=71.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 83))], orig='O _ { 3 } + H _ { 2 } O ^ { - } \\to H O _ { 2 } \\bullet + \\bullet O _ { 3 } ^ { - }', text='O _ { 3 } + H _ { 2 } O ^ { - } \\to H O _ { 2 } \\bullet + \\bullet O _ { 3 } ^ { - }', formatting=None, hyperlink=None)]
2025-06-10 20:21:21,311 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:21:21,311 - DEBUG - Processing text item: label=formula, text=O _ { 3 } + H _ { 2 } O ^ { - } \to H O _ { 2 } \bullet + \bullet O _ { 3 } ^ { - }
2025-06-10 20:21:21,311 - DEBUG - Recognized string extracted: O _ { 3 } + H _ { 2 } O ^ { - } \to H O _ { 2 } \bullet + \bullet O _ { 3 } ^ { - }
2025-06-10 20:21:21,311 - INFO - All done. Returning 5 recognized text results.
2025-06-10 20:21:21,312 - DEBUG - Snippet 10.3390_catal11080998_724_item_0 recognized text:
O _ { 3 } + \bullet O H \to O _ { 2 } + H O _ { 2 } \bullet \Longrightarrow \bullet O _ { 2 } - + H ^ { + }
2025-06-10 20:21:21,312 - DEBUG - Snippet 10.3390_catal11080998_724_item_1 recognized text:
O _ { 3 } + H O _ { 2 } \bullet \Longrightarrow 2 O _ { 2 } + \bullet O H , k = 1 . 6 \times 1 0 ^ { 9 } \, M ^ { - 1 } \, s ^ { - 1 }
2025-06-10 20:21:21,312 - DEBUG - Snippet 10.3390_catal11080998_724_item_2 recognized text:
2 H O _ { 2 } ^ { * } \to O _ { 2 } + H _ { 2 } O _ { 2 }
2025-06-10 20:21:21,312 - DEBUG - Snippet 10.3390_catal11080998_724_item_3 recognized text:
O _ { 3 } + O H ^ { - } \to H O _ { 2 } \bullet + O _ { 2 }
2025-06-10 20:21:21,312 - DEBUG - Snippet 10.3390_catal11080998_724_item_4 recognized text:
O _ { 3 } + H _ { 2 } O ^ { - } \to H O _ { 2 } \bullet + \bullet O _ { 3 } ^ { - }
2025-06-10 20:21:21,320 - INFO - Starting prediction for 5 images with labels: ['formula', 'formula', 'formula', 'formula', 'formula']
2025-06-10 20:21:21,320 - DEBUG - Generating chat message for label: formula
2025-06-10 20:21:21,320 - DEBUG - Snippet 10.3390_catal11080998_724_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:21:21,357 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:21:21,357 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:21:21,357 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:21:21,395 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:21,396 - DEBUG - Snippet 10.3390_catal11080998_724_item_0 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:21:21,433 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:21,470 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:21:21,491 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:21,508 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:21,515 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:21:21,555 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:21,593 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:21:21,613 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:21,767 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:21,803 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:21:21,841 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:21:21,988 - DEBUG - Snippet 10.3390_atmos11080868_789_item_4: generation shape=torch.Size([1, 422])
2025-06-10 20:21:21,992 - DEBUG - Snippet 10.3390_atmos11080868_789_item_4 raw docling: (tokens=76)
<formula><loc_0><loc_0><loc_500><loc_500>\log E ( y ) = \beta _ { 0 } + \beta _ { 1 } \times t + \beta _ { 2 } \times t _ { a f t e r } + s e a s o n + A R ( 1 )</formula><end_of_utterance>
2025-06-10 20:21:21,992 - DEBUG - Starting _parse_docling_output
2025-06-10 20:21:21,992 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>\log E ( y ) = \beta _ { 0 } + \beta _ { 1 } \times t + \beta _ { 2 } \times t _ { a f t e r } + s e a s o n + A R ( 1 )</formula><end_of_utterance>
2025-06-10 20:21:21,993 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:21:21,993 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>\\log E ( y ) = \\beta _ { 0 } + \\beta _ { 1 } \\times t + \\beta _ { 2 } \\times t _ { a f t e r } + s e a s o n + A R ( 1 )</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=982x65 at 0x7F9714D5ECC0>)]
2025-06-10 20:21:21,993 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:21:21,996 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=982.0, b=65.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 120))], orig='\\log E ( y ) = \\beta _ { 0 } + \\beta _ { 1 } \\times t + \\beta _ { 2 } \\times t _ { a f t e r } + s e a s o n + A R ( 1 )', text='\\log E ( y ) = \\beta _ { 0 } + \\beta _ { 1 } \\times t + \\beta _ { 2 } \\times t _ { a f t e r } + s e a s o n + A R ( 1 )', formatting=None, hyperlink=None)]
2025-06-10 20:21:21,996 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:21:21,996 - DEBUG - Processing text item: label=formula, text=\log E ( y ) = \beta _ { 0 } + \beta _ { 1 } \times t + \beta _ { 2 } \times t _ { a f t e r } + s e a s o n + A R ( 1 )
2025-06-10 20:21:21,996 - DEBUG - Recognized string extracted: \log E ( y ) = \beta _ { 0 } + \beta _ { 1 } \times t + \beta _ { 2 } \times t _ { a f t e r } + s e a s o n + A R ( 1 )
2025-06-10 20:21:21,997 - INFO - All done. Returning 5 recognized text results.
2025-06-10 20:21:21,997 - DEBUG - Snippet 10.3390_atmos11080868_789_item_0 recognized text:
\sum _ { m = 1 } ^ { o } v _ { m } ( X _ { i m } - X _ { 0 m } W ) ^ { 2 }
2025-06-10 20:21:21,997 - DEBUG - Snippet 10.3390_atmos11080868_789_item_1 recognized text:
Y _ { i t } = \sum _ { j = 1 } ^ { 1 3 } w _ { j } ^ { * } Y _ { j t }
2025-06-10 20:21:21,997 - DEBUG - Snippet 10.3390_atmos11080868_789_item_2 recognized text:
N R M S E _ { i j } = R M S E _ { i j } / \overline { X } _ { i j } = \frac { 1 } { \overline { X } _ { i j } } \sqrt { \frac { \sum _ { t = 1 } ^ { T _ { 0 } } \left ( X _ { i j t } - X _ { 0 j t } \right ) ^ { 2 } } { T _ { 0 } } }
2025-06-10 20:21:21,997 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:21:21,998 - DEBUG - Snippet 10.3390_atmos11080868_789_item_3 recognized text:
E ( y ) = m o r _ { i , t } \times \left ( m o r _ { 0 , t _ { 0 } } / m o r _ { 0 , t } \right )
2025-06-10 20:21:21,998 - DEBUG - Snippet 10.3390_atmos11080868_789_item_4 recognized text:
\log E ( y ) = \beta _ { 0 } + \beta _ { 1 } \times t + \beta _ { 2 } \times t _ { a f t e r } + s e a s o n + A R ( 1 )
2025-06-10 20:21:22,110 - INFO - Finished converting document 10.3390_atmos11080868_789.pdf in 26.13 sec.
2025-06-10 20:21:22,138 - DEBUG - Finished converting page batch time=4039.308
2025-06-10 20:21:22,268 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:21:22,351 - INFO - Extraction successful row 160, tokens=19175
2025-06-10 20:21:22,374 - INFO - Going to convert document batch...
2025-06-10 20:21:22,374 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:21:22,375 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:21:22,428 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:21:22,462 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:21:22,462 - INFO - Processing document 10.1186_s12889-017-4332-6_803.pdf
2025-06-10 20:21:22,512 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:22,513 - DEBUG - Finished converting page batch time=4039.683
2025-06-10 20:21:22,571 - DEBUG - Dynamic vertical threshold: 79.53479999999996, Overlap threshold: 0.7
2025-06-10 20:21:22,571 - DEBUG - Checking merge:
  Current: 6, Next: 7
2025-06-10 20:21:22,572 - DEBUG -   Vertical gap: 36.67500000000001, Overlap ratio: 1.0
2025-06-10 20:21:22,572 - DEBUG -   Left boundary diff: 11.57899999999998, Right boundary diff: 0.0
2025-06-10 20:21:22,572 - DEBUG -   Alignment factor (ratio): 0.030332123523702566
2025-06-10 20:21:22,572 - DEBUG -   -> c1 6 formula number: 1, c2 7 formula number: 2
2025-06-10 20:21:22,573 - DEBUG -   -> Not merging clusters 6 and 7 due to different formula numbers: 1 vs 2
2025-06-10 20:21:22,573 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:22,614 - INFO - Finished converting document 10.1371_journal.pone.0108076_794.pdf in 11.89 sec.
2025-06-10 20:21:22,671 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:22,687 - INFO - Extraction successful row 164, tokens=8786
2025-06-10 20:21:22,704 - INFO - Going to convert document batch...
2025-06-10 20:21:22,704 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:21:22,705 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:21:22,759 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:21:22,774 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:22,775 - DEBUG - Finished converting page batch time=4039.945
2025-06-10 20:21:22,780 - DEBUG - Snippet 10.3390_catal11080998_724_item_0: generation shape=torch.Size([1, 396])
2025-06-10 20:21:22,783 - DEBUG - Snippet 10.3390_catal11080998_724_item_0 raw docling: (tokens=50)
<formula><loc_0><loc_0><loc_500><loc_500>O _ { 3 } + I n \to \bullet O _ { 3 } ^ { - } + \ln ^ { + }</formula><end_of_utterance>
2025-06-10 20:21:22,783 - DEBUG - Starting _parse_docling_output
2025-06-10 20:21:22,783 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>O _ { 3 } + I n \to \bullet O _ { 3 } ^ { - } + \ln ^ { + }</formula><end_of_utterance>
2025-06-10 20:21:22,784 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:21:22,784 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>O _ { 3 } + I n \\to \\bullet O _ { 3 } ^ { - } + \\ln ^ { + }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=720x71 at 0x7F96CE1C6B40>)]
2025-06-10 20:21:22,784 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:21:22,786 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=720.0, b=71.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 59))], orig='O _ { 3 } + I n \\to \\bullet O _ { 3 } ^ { - } + \\ln ^ { + }', text='O _ { 3 } + I n \\to \\bullet O _ { 3 } ^ { - } + \\ln ^ { + }', formatting=None, hyperlink=None)]
2025-06-10 20:21:22,786 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:21:22,787 - DEBUG - Processing text item: label=formula, text=O _ { 3 } + I n \to \bullet O _ { 3 } ^ { - } + \ln ^ { + }
2025-06-10 20:21:22,787 - DEBUG - Recognized string extracted: O _ { 3 } + I n \to \bullet O _ { 3 } ^ { - } + \ln ^ { + }
2025-06-10 20:21:22,787 - DEBUG - Generating chat message for label: formula
2025-06-10 20:21:22,787 - DEBUG - Snippet 10.3390_catal11080998_724_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:21:22,853 - DEBUG - Snippet 10.3390_catal11080998_724_item_1 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:21:22,987 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:23,055 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:23,101 - DEBUG - Snippet 10.1186_s41256-018-0080-0_792_item_1: generation shape=torch.Size([1, 699])
2025-06-10 20:21:23,103 - DEBUG - Snippet 10.1186_s41256-018-0080-0_792_item_1 raw docling: (tokens=88)
<formula><loc_0><loc_0><loc_500><loc_500>( \hat { Q } _ { 1 } - \hat { Q } _ { 2 } ) \pm 1 . 9 6 \sqrt { \hat { S } _ { E 1 } ^ { 2 } + \hat { S } _ { E 2 } ^ { 2 } }</formula><end_of_utterance>
2025-06-10 20:21:23,103 - DEBUG - Starting _parse_docling_output
2025-06-10 20:21:23,103 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>( \hat { Q } _ { 1 } - \hat { Q } _ { 2 } ) \pm 1 . 9 6 \sqrt { \hat { S } _ { E 1 } ^ { 2 } + \hat { S } _ { E 2 } ^ { 2 } }</formula><end_of_utterance>
2025-06-10 20:21:23,104 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:21:23,104 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>( \\hat { Q } _ { 1 } - \\hat { Q } _ { 2 } ) \\pm 1 . 9 6 \\sqrt { \\hat { S } _ { E 1 } ^ { 2 } + \\hat { S } _ { E 2 } ^ { 2 } }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=370x118 at 0x7F969156C140>)]
2025-06-10 20:21:23,104 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:21:23,106 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=370.0, b=118.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 125))], orig='( \\hat { Q } _ { 1 } - \\hat { Q } _ { 2 } ) \\pm 1 . 9 6 \\sqrt { \\hat { S } _ { E 1 } ^ { 2 } + \\hat { S } _ { E 2 } ^ { 2 } }', text='( \\hat { Q } _ { 1 } - \\hat { Q } _ { 2 } ) \\pm 1 . 9 6 \\sqrt { \\hat { S } _ { E 1 } ^ { 2 } + \\hat { S } _ { E 2 } ^ { 2 } }', formatting=None, hyperlink=None)]
2025-06-10 20:21:23,107 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:21:23,107 - DEBUG - Processing text item: label=formula, text=( \hat { Q } _ { 1 } - \hat { Q } _ { 2 } ) \pm 1 . 9 6 \sqrt { \hat { S } _ { E 1 } ^ { 2 } + \hat { S } _ { E 2 } ^ { 2 } }
2025-06-10 20:21:23,107 - DEBUG - Recognized string extracted: ( \hat { Q } _ { 1 } - \hat { Q } _ { 2 } ) \pm 1 . 9 6 \sqrt { \hat { S } _ { E 1 } ^ { 2 } + \hat { S } _ { E 2 } ^ { 2 } }
2025-06-10 20:21:23,107 - INFO - All done. Returning 2 recognized text results.
2025-06-10 20:21:23,108 - DEBUG - Snippet 10.1186_s41256-018-0080-0_792_item_0 recognized text:
\log [ E ( y _ { t } ) ] = \beta Z _ { t } + s ( t i m e , d f _ { 1 } ) + a s . f a c t o r ( d o w ) \\ + a s . f a c t o r ( h o l i d a y ) + s ( t e m p e r a t u r e , 3 ) \\ + s ( h u m i d i t y , 3 ) + i n t e r c e p t
2025-06-10 20:21:23,108 - DEBUG - Snippet 10.1186_s41256-018-0080-0_792_item_1 recognized text:
( \hat { Q } _ { 1 } - \hat { Q } _ { 2 } ) \pm 1 . 9 6 \sqrt { \hat { S } _ { E 1 } ^ { 2 } + \hat { S } _ { E 2 } ^ { 2 } }
2025-06-10 20:21:23,141 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:21:23,184 - INFO - Finished converting document 10.1186_s41256-018-0080-0_792.pdf in 21.88 sec.
2025-06-10 20:21:23,193 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:21:23,199 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:21:23,268 - INFO - Extraction successful row 162, tokens=13390
2025-06-10 20:21:23,298 - INFO - Going to convert document batch...
2025-06-10 20:21:23,302 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:21:23,305 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:21:23,352 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:21:23,686 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:21:23,687 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:21:23,687 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:21:23,724 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:23,759 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:23,795 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:21:23,796 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:21:23,833 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:21:23,868 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:23,870 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:23,909 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:21:23,983 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:24,055 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:24,086 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:21:24,090 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:21:24,139 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:24,140 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:21:24,140 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:21:24,147 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:21:24,237 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:24,295 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:21:24,311 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:21:24,317 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:21:24,364 - DEBUG - Snippet 10.3390_catal11080998_724_item_1: generation shape=torch.Size([1, 398])
2025-06-10 20:21:24,365 - DEBUG - Snippet 10.3390_catal11080998_724_item_1 raw docling: (tokens=52)
<formula><loc_0><loc_0><loc_500><loc_500>H O _ { 2 } \bullet \Longrightarrow \bullet O _ { 2 } ^ { - } + H ^ { + }</formula><end_of_utterance>
2025-06-10 20:21:24,365 - DEBUG - Starting _parse_docling_output
2025-06-10 20:21:24,365 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>H O _ { 2 } \bullet \Longrightarrow \bullet O _ { 2 } ^ { - } + H ^ { + }</formula><end_of_utterance>
2025-06-10 20:21:24,365 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:21:24,366 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>H O _ { 2 } \\bullet \\Longrightarrow \\bullet O _ { 2 } ^ { - } + H ^ { + }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=711x71 at 0x7F96A61264E0>)]
2025-06-10 20:21:24,366 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:21:24,368 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=711.0, b=71.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 73))], orig='H O _ { 2 } \\bullet \\Longrightarrow \\bullet O _ { 2 } ^ { - } + H ^ { + }', text='H O _ { 2 } \\bullet \\Longrightarrow \\bullet O _ { 2 } ^ { - } + H ^ { + }', formatting=None, hyperlink=None)]
2025-06-10 20:21:24,368 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:21:24,368 - DEBUG - Processing text item: label=formula, text=H O _ { 2 } \bullet \Longrightarrow \bullet O _ { 2 } ^ { - } + H ^ { + }
2025-06-10 20:21:24,368 - DEBUG - Recognized string extracted: H O _ { 2 } \bullet \Longrightarrow \bullet O _ { 2 } ^ { - } + H ^ { + }
2025-06-10 20:21:24,368 - DEBUG - Generating chat message for label: formula
2025-06-10 20:21:24,369 - DEBUG - Snippet 10.3390_catal11080998_724_item_2 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:21:24,388 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:24,437 - DEBUG - Snippet 10.3390_catal11080998_724_item_2 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:21:24,540 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:21:24,541 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:21:24,541 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:21:24,591 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:24,596 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:21:24,629 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:24,665 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:21:24,701 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:21:24,737 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:24,773 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:21:24,791 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:21:24,792 - INFO - Processing document 10.2174_1874192401812010071_804.pdf
2025-06-10 20:21:24,816 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:21:24,816 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:21:24,816 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:21:24,853 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:24,890 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:24,926 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:24,934 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:21:24,961 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:21:24,976 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:21:24,985 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:25,005 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:21:25,013 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:25,074 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:21:25,085 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:25,086 - DEBUG - Finished converting page batch time=4042.256
2025-06-10 20:21:25,148 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:25,216 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:21:25,221 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:25,261 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:21:25,306 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:21:25,352 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:25,457 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:21:25,525 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:21:25,670 - DEBUG - Finished converting page batch time=4042.840
2025-06-10 20:21:25,673 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:25,710 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:21:25,711 - INFO - Processing document 10.3390_atmos11010018_809.pdf
2025-06-10 20:21:25,780 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:21:25,832 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:25,955 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:25,969 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:21:25,970 - INFO - Processing document 10.21203_rs.3.rs-25309_v1_807.pdf
2025-06-10 20:21:26,166 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:26,248 - DEBUG - [Page 7] Reclassifying cluster 0 from form to TEXT (area ratio: 1.00, cells: 0, density: 0.000000).
2025-06-10 20:21:26,248 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:26,249 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 1
2025-06-10 20:21:26,249 - DEBUG - Finished converting page batch time=4043.419
2025-06-10 20:21:26,260 - DEBUG - Finished converting page batch time=4043.430
2025-06-10 20:21:26,295 - DEBUG - Snippet 10.3390_catal11080998_724_item_2: generation shape=torch.Size([1, 407])
2025-06-10 20:21:26,296 - DEBUG - Snippet 10.3390_catal11080998_724_item_2 raw docling: (tokens=61)
<formula><loc_0><loc_0><loc_500><loc_500>O _ { 3 } + \bullet O _ { 2 } ^ { - } \to \bullet O _ { 3 } ^ { - } + O _ { 2 }</formula><end_of_utterance>
2025-06-10 20:21:26,296 - DEBUG - Starting _parse_docling_output
2025-06-10 20:21:26,296 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>O _ { 3 } + \bullet O _ { 2 } ^ { - } \to \bullet O _ { 3 } ^ { - } + O _ { 2 }</formula><end_of_utterance>
2025-06-10 20:21:26,296 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:21:26,296 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>O _ { 3 } + \\bullet O _ { 2 } ^ { - } \\to \\bullet O _ { 3 } ^ { - } + O _ { 2 }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=739x72 at 0x7F96A6125BB0>)]
2025-06-10 20:21:26,297 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:21:26,299 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=739.0, b=72.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 79))], orig='O _ { 3 } + \\bullet O _ { 2 } ^ { - } \\to \\bullet O _ { 3 } ^ { - } + O _ { 2 }', text='O _ { 3 } + \\bullet O _ { 2 } ^ { - } \\to \\bullet O _ { 3 } ^ { - } + O _ { 2 }', formatting=None, hyperlink=None)]
2025-06-10 20:21:26,299 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:21:26,299 - DEBUG - Processing text item: label=formula, text=O _ { 3 } + \bullet O _ { 2 } ^ { - } \to \bullet O _ { 3 } ^ { - } + O _ { 2 }
2025-06-10 20:21:26,299 - DEBUG - Recognized string extracted: O _ { 3 } + \bullet O _ { 2 } ^ { - } \to \bullet O _ { 3 } ^ { - } + O _ { 2 }
2025-06-10 20:21:26,299 - DEBUG - Generating chat message for label: formula
2025-06-10 20:21:26,300 - DEBUG - Snippet 10.3390_catal11080998_724_item_3 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:21:26,365 - DEBUG - Snippet 10.3390_catal11080998_724_item_3 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:21:26,399 - DEBUG - Creating masked image for page 2 with 16 clusters.
2025-06-10 20:21:26,401 - INFO - Masked image successfully created for page 2.
2025-06-10 20:21:26,403 - INFO - Starting prediction for 1 images with labels: ['formula']
2025-06-10 20:21:26,403 - DEBUG - Generating chat message for label: formula
2025-06-10 20:21:26,403 - DEBUG - Snippet 10.20882_adicciones.114_797_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:21:26,492 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:26,530 - DEBUG - Snippet 10.20882_adicciones.114_797_item_0 => input_ids shape=torch.Size([1, 610]), prompt_len=610
2025-06-10 20:21:26,785 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:26,791 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:27,040 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:27,090 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:27,405 - DEBUG - Dynamic vertical threshold: 74.52000000000007, Overlap threshold: 0.7
2025-06-10 20:21:27,406 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:27,482 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:27,486 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:27,513 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:27,659 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:27,715 - DEBUG - Snippet 10.3390_catal11080998_724_item_3: generation shape=torch.Size([1, 394])
2025-06-10 20:21:27,715 - DEBUG - Snippet 10.3390_catal11080998_724_item_3 raw docling: (tokens=48)
<formula><loc_0><loc_0><loc_500><loc_500> O _ { 3 } ^ { - } + H ^ { + } \to H O _ { 3 } \bullet</formula><end_of_utterance>
2025-06-10 20:21:27,716 - DEBUG - Starting _parse_docling_output
2025-06-10 20:21:27,716 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500> O _ { 3 } ^ { - } + H ^ { + } \to H O _ { 3 } \bullet</formula><end_of_utterance>
2025-06-10 20:21:27,716 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:21:27,716 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500> O _ { 3 } ^ { - } + H ^ { + } \\to H O _ { 3 } \\bullet</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=711x72 at 0x7F96A9912F90>)]
2025-06-10 20:21:27,717 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:21:27,719 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=711.0, b=72.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 55))], orig=' O _ { 3 } ^ { - } + H ^ { + } \\to H O _ { 3 } \\bullet', text=' O _ { 3 } ^ { - } + H ^ { + } \\to H O _ { 3 } \\bullet', formatting=None, hyperlink=None)]
2025-06-10 20:21:27,719 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:21:27,720 - DEBUG - Processing text item: label=formula, text= O _ { 3 } ^ { - } + H ^ { + } \to H O _ { 3 } \bullet
2025-06-10 20:21:27,720 - DEBUG - Recognized string extracted:  O _ { 3 } ^ { - } + H ^ { + } \to H O _ { 3 } \bullet
2025-06-10 20:21:27,720 - DEBUG - Generating chat message for label: formula
2025-06-10 20:21:27,720 - DEBUG - Snippet 10.3390_catal11080998_724_item_4 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:21:27,739 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:27,787 - DEBUG - Snippet 10.3390_catal11080998_724_item_4 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:21:27,827 - DEBUG - Snippet 10.20882_adicciones.114_797_item_0: generation shape=torch.Size([1, 656])
2025-06-10 20:21:27,828 - DEBUG - Snippet 10.20882_adicciones.114_797_item_0 raw docling: (tokens=45)
<formula><loc_0><loc_0><loc_500><loc_500>\nabla _ { X _ { t } } = X _ { t } - X _ { t - 1 }</formula><end_of_utterance>
2025-06-10 20:21:27,828 - DEBUG - Starting _parse_docling_output
2025-06-10 20:21:27,828 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>\nabla _ { X _ { t } } = X _ { t } - X _ { t - 1 }</formula><end_of_utterance>
2025-06-10 20:21:27,828 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:21:27,829 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>\\nabla _ { X _ { t } } = X _ { t } - X _ { t - 1 }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=178x73 at 0x7F96B163FB90>)]
2025-06-10 20:21:27,829 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:21:27,830 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=178.0, b=73.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 50))], orig='\\nabla _ { X _ { t } } = X _ { t } - X _ { t - 1 }', text='\\nabla _ { X _ { t } } = X _ { t } - X _ { t - 1 }', formatting=None, hyperlink=None)]
2025-06-10 20:21:27,830 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:21:27,831 - DEBUG - Processing text item: label=formula, text=\nabla _ { X _ { t } } = X _ { t } - X _ { t - 1 }
2025-06-10 20:21:27,831 - DEBUG - Recognized string extracted: \nabla _ { X _ { t } } = X _ { t } - X _ { t - 1 }
2025-06-10 20:21:27,831 - INFO - All done. Returning 1 recognized text results.
2025-06-10 20:21:27,831 - DEBUG - Snippet 10.20882_adicciones.114_797_item_0 recognized text:
\nabla _ { X _ { t } } = X _ { t } - X _ { t - 1 }
2025-06-10 20:21:27,897 - INFO - Finished converting document 10.20882_adicciones.114_797.pdf in 14.05 sec.
2025-06-10 20:21:27,954 - INFO - Extraction successful row 165, tokens=9038
2025-06-10 20:21:27,985 - INFO - Going to convert document batch...
2025-06-10 20:21:27,985 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:21:27,986 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:21:28,151 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:21:28,227 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:28,237 - DEBUG - Finished converting page batch time=4045.407
2025-06-10 20:21:28,307 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:28,337 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:28,338 - DEBUG - Finished converting page batch time=4045.508
2025-06-10 20:21:28,428 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:28,464 - INFO - Finished converting document 10.1136_heartjnl-2021-320082_798.pdf in 11.58 sec.
2025-06-10 20:21:28,510 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:28,523 - INFO - Extraction successful row 166, tokens=10559
2025-06-10 20:21:28,549 - INFO - Going to convert document batch...
2025-06-10 20:21:28,549 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:21:28,550 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:21:28,596 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:28,596 - DEBUG - Finished converting page batch time=4045.766
2025-06-10 20:21:28,601 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:21:28,695 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:28,912 - DEBUG - Finished converting page batch time=4046.082
2025-06-10 20:21:28,940 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:21:28,998 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:21:29,004 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:21:29,049 - DEBUG - Snippet 10.3390_catal11080998_724_item_4: generation shape=torch.Size([1, 392])
2025-06-10 20:21:29,050 - DEBUG - Snippet 10.3390_catal11080998_724_item_4 raw docling: (tokens=46)
<formula><loc_0><loc_0><loc_500><loc_500>H O _ { 3 } \bullet \to H O _ { \bullet } + O _ { 2 }</formula><end_of_utterance>
2025-06-10 20:21:29,050 - DEBUG - Starting _parse_docling_output
2025-06-10 20:21:29,050 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>H O _ { 3 } \bullet \to H O _ { \bullet } + O _ { 2 }</formula><end_of_utterance>
2025-06-10 20:21:29,050 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:21:29,051 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>H O _ { 3 } \\bullet \\to H O _ { \\bullet } + O _ { 2 }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=703x61 at 0x7F96A9912AB0>)]
2025-06-10 20:21:29,051 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:21:29,053 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=703.0, b=61.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 53))], orig='H O _ { 3 } \\bullet \\to H O _ { \\bullet } + O _ { 2 }', text='H O _ { 3 } \\bullet \\to H O _ { \\bullet } + O _ { 2 }', formatting=None, hyperlink=None)]
2025-06-10 20:21:29,053 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:21:29,053 - DEBUG - Processing text item: label=formula, text=H O _ { 3 } \bullet \to H O _ { \bullet } + O _ { 2 }
2025-06-10 20:21:29,053 - DEBUG - Recognized string extracted: H O _ { 3 } \bullet \to H O _ { \bullet } + O _ { 2 }
2025-06-10 20:21:29,053 - INFO - All done. Returning 5 recognized text results.
2025-06-10 20:21:29,054 - DEBUG - Snippet 10.3390_catal11080998_724_item_0 recognized text:
O _ { 3 } + I n \to \bullet O _ { 3 } ^ { - } + \ln ^ { + }
2025-06-10 20:21:29,054 - DEBUG - Snippet 10.3390_catal11080998_724_item_1 recognized text:
H O _ { 2 } \bullet \Longrightarrow \bullet O _ { 2 } ^ { - } + H ^ { + }
2025-06-10 20:21:29,054 - DEBUG - Snippet 10.3390_catal11080998_724_item_2 recognized text:
O _ { 3 } + \bullet O _ { 2 } ^ { - } \to \bullet O _ { 3 } ^ { - } + O _ { 2 }
2025-06-10 20:21:29,055 - DEBUG - Snippet 10.3390_catal11080998_724_item_3 recognized text:
 O _ { 3 } ^ { - } + H ^ { + } \to H O _ { 3 } \bullet
2025-06-10 20:21:29,055 - DEBUG - Snippet 10.3390_catal11080998_724_item_4 recognized text:
H O _ { 3 } \bullet \to H O _ { \bullet } + O _ { 2 }
2025-06-10 20:21:29,127 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:29,165 - DEBUG - Creating masked image for page 25 with 27 clusters.
2025-06-10 20:21:29,172 - INFO - Masked image successfully created for page 25.
2025-06-10 20:21:29,183 - INFO - Starting prediction for 5 images with labels: ['formula', 'formula', 'formula', 'formula', 'formula']
2025-06-10 20:21:29,190 - DEBUG - Generating chat message for label: formula
2025-06-10 20:21:29,191 - DEBUG - Snippet 10.3390_catal11080998_724_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:21:29,253 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:21:29,261 - DEBUG - Snippet 10.3390_catal11080998_724_item_0 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:21:29,304 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:21:29,310 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:21:29,379 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:29,558 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:21:29,562 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:21:29,566 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:21:29,607 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:29,642 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:29,679 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:21:29,719 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:21:29,760 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:29,796 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:21:29,904 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:21:29,904 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:21:29,905 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:21:29,932 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:29,940 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:29,970 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:21:29,976 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:30,009 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:21:30,013 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:21:30,057 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:21:30,128 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:30,134 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:30,155 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:21:30,169 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:21:30,293 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:28,167 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:21:28,204 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:21:28,268 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:21:28,276 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:28,300 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:28,301 - DEBUG - Finished converting page batch time=4047.634
2025-06-10 20:21:28,309 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:28,324 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:28,325 - DEBUG - Finished converting page batch time=4047.658
2025-06-10 20:21:28,372 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:21:28,419 - DEBUG - Snippet 10.3390_catal11080998_724_item_0: generation shape=torch.Size([1, 390])
2025-06-10 20:21:28,420 - DEBUG - Snippet 10.3390_catal11080998_724_item_0 raw docling: (tokens=44)
<formula><loc_0><loc_0><loc_500><loc_500>H O _ { 3 } \bullet + P \to end \, p r o d u c t s</formula><end_of_utterance>
2025-06-10 20:21:28,420 - DEBUG - Starting _parse_docling_output
2025-06-10 20:21:28,420 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>H O _ { 3 } \bullet + P \to end \, p r o d u c t s</formula><end_of_utterance>
2025-06-10 20:21:28,421 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:21:28,421 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>H O _ { 3 } \\bullet + P \\to end \\, p r o d u c t s</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=750x61 at 0x7F96D7FF0D40>)]
2025-06-10 20:21:28,421 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:21:28,423 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=750.0, b=61.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 50))], orig='H O _ { 3 } \\bullet + P \\to end \\, p r o d u c t s', text='H O _ { 3 } \\bullet + P \\to end \\, p r o d u c t s', formatting=None, hyperlink=None)]
2025-06-10 20:21:28,424 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:21:28,424 - DEBUG - Processing text item: label=formula, text=H O _ { 3 } \bullet + P \to end \, p r o d u c t s
2025-06-10 20:21:28,424 - DEBUG - Recognized string extracted: H O _ { 3 } \bullet + P \to end \, p r o d u c t s
2025-06-10 20:21:28,424 - DEBUG - Generating chat message for label: formula
2025-06-10 20:21:28,425 - DEBUG - Snippet 10.3390_catal11080998_724_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:21:28,460 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:21:28,461 - INFO - Processing document 10.1186_1476-069x-9-37_830.pdf
2025-06-10 20:21:28,491 - DEBUG - Snippet 10.3390_catal11080998_724_item_1 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:21:28,689 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:21:28,899 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:21:28,900 - INFO - Processing document 10.7717_peerj.3574_839.pdf
2025-06-10 20:21:28,944 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:28,945 - DEBUG - Finished converting page batch time=4048.277
2025-06-10 20:21:28,980 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:28,983 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:29,383 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:29,516 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:29,535 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:29,655 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:29,715 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:29,781 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:29,849 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:29,849 - DEBUG - Finished converting page batch time=4049.182
2025-06-10 20:21:29,978 - DEBUG - Creating masked image for page 2 with 9 clusters.
2025-06-10 20:21:29,980 - INFO - Masked image successfully created for page 2.
2025-06-10 20:21:29,984 - INFO - Starting prediction for 1 images with labels: ['formula']
2025-06-10 20:21:29,985 - DEBUG - Generating chat message for label: formula
2025-06-10 20:21:29,985 - DEBUG - Snippet 10.3390_atmos11010018_809_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:21:30,005 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:30,043 - DEBUG - Snippet 10.3390_catal11080998_724_item_1: generation shape=torch.Size([1, 398])
2025-06-10 20:21:30,044 - DEBUG - Snippet 10.3390_catal11080998_724_item_1 raw docling: (tokens=52)
<formula><loc_0><loc_0><loc_500><loc_500>F e ^ { 2 + } + O _ { 3 } \to F e O ^ { 2 + } + O _ { 2 }</formula><end_of_utterance>
2025-06-10 20:21:30,045 - DEBUG - Starting _parse_docling_output
2025-06-10 20:21:30,045 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>F e ^ { 2 + } + O _ { 3 } \to F e O ^ { 2 + } + O _ { 2 }</formula><end_of_utterance>
2025-06-10 20:21:30,045 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:21:30,045 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>F e ^ { 2 + } + O _ { 3 } \\to F e O ^ { 2 + } + O _ { 2 }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=736x71 at 0x7F96A9913260>)]
2025-06-10 20:21:30,045 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:21:30,047 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=736.0, b=71.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 57))], orig='F e ^ { 2 + } + O _ { 3 } \\to F e O ^ { 2 + } + O _ { 2 }', text='F e ^ { 2 + } + O _ { 3 } \\to F e O ^ { 2 + } + O _ { 2 }', formatting=None, hyperlink=None)]
2025-06-10 20:21:30,048 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:21:30,048 - DEBUG - Processing text item: label=formula, text=F e ^ { 2 + } + O _ { 3 } \to F e O ^ { 2 + } + O _ { 2 }
2025-06-10 20:21:30,048 - DEBUG - Recognized string extracted: F e ^ { 2 + } + O _ { 3 } \to F e O ^ { 2 + } + O _ { 2 }
2025-06-10 20:21:30,048 - DEBUG - Generating chat message for label: formula
2025-06-10 20:21:30,048 - DEBUG - Snippet 10.3390_catal11080998_724_item_2 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:21:30,058 - DEBUG - Snippet 10.3390_atmos11010018_809_item_0 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:21:30,119 - DEBUG - Snippet 10.3390_catal11080998_724_item_2 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:21:30,165 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:30,518 - DEBUG - [Page 14] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:30,575 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:30,576 - DEBUG - Finished converting page batch time=4049.909
2025-06-10 20:21:30,701 - DEBUG - Dynamic vertical threshold: 44.29979999999998, Overlap threshold: 0.7
2025-06-10 20:21:30,701 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:30,849 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:30,998 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:31,033 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:31,116 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:31,117 - DEBUG - Finished converting page batch time=4050.450
2025-06-10 20:21:31,238 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:31,238 - DEBUG - Finished converting page batch time=4050.571
2025-06-10 20:21:31,253 - DEBUG - [Page 15] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:31,254 - DEBUG - Finished converting page batch time=4050.586
2025-06-10 20:21:31,321 - INFO - Finished converting document 10.21203_rs.3.rs-25309_v1_807.pdf in 10.80 sec.
2025-06-10 20:21:31,397 - INFO - Extraction successful row 170, tokens=8764
2025-06-10 20:21:31,434 - INFO - Going to convert document batch...
2025-06-10 20:21:31,434 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:21:31,435 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:21:31,482 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:31,487 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:21:31,579 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:31,648 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:31,727 - DEBUG - Snippet 10.3390_catal11080998_724_item_2: generation shape=torch.Size([1, 405])
2025-06-10 20:21:31,728 - DEBUG - Snippet 10.3390_catal11080998_724_item_2 raw docling: (tokens=59)
<formula><loc_0><loc_0><loc_500><loc_500>F e O ^ { 2 + } + H _ { 2 } O \to F e ^ { 3 + } + \bullet O H + O H ^ { - }</formula><end_of_utterance>
2025-06-10 20:21:31,728 - DEBUG - Starting _parse_docling_output
2025-06-10 20:21:31,728 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>F e O ^ { 2 + } + H _ { 2 } O \to F e ^ { 3 + } + \bullet O H + O H ^ { - }</formula><end_of_utterance>
2025-06-10 20:21:31,729 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:21:31,729 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>F e O ^ { 2 + } + H _ { 2 } O \\to F e ^ { 3 + } + \\bullet O H + O H ^ { - }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=814x65 at 0x7F96A9911F40>)]
2025-06-10 20:21:31,729 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:21:31,732 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=814.0, b=65.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 75))], orig='F e O ^ { 2 + } + H _ { 2 } O \\to F e ^ { 3 + } + \\bullet O H + O H ^ { - }', text='F e O ^ { 2 + } + H _ { 2 } O \\to F e ^ { 3 + } + \\bullet O H + O H ^ { - }', formatting=None, hyperlink=None)]
2025-06-10 20:21:31,732 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:21:31,732 - DEBUG - Processing text item: label=formula, text=F e O ^ { 2 + } + H _ { 2 } O \to F e ^ { 3 + } + \bullet O H + O H ^ { - }
2025-06-10 20:21:31,732 - DEBUG - Recognized string extracted: F e O ^ { 2 + } + H _ { 2 } O \to F e ^ { 3 + } + \bullet O H + O H ^ { - }
2025-06-10 20:21:31,732 - DEBUG - Generating chat message for label: formula
2025-06-10 20:21:31,733 - DEBUG - Snippet 10.3390_catal11080998_724_item_3 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:21:31,799 - DEBUG - Snippet 10.3390_catal11080998_724_item_3 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:21:31,917 - DEBUG - [Page 16] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:31,918 - DEBUG - Finished converting page batch time=4051.250
2025-06-10 20:21:32,058 - DEBUG - Creating masked image for page 2 with 15 clusters.
2025-06-10 20:21:32,059 - INFO - Masked image successfully created for page 2.
2025-06-10 20:21:32,067 - INFO - Starting prediction for 2 images with labels: ['formula', 'formula']
2025-06-10 20:21:32,067 - DEBUG - Generating chat message for label: formula
2025-06-10 20:21:32,068 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:32,068 - DEBUG - Snippet 10.3390_ijerph16111904_801_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:21:32,141 - DEBUG - Snippet 10.3390_ijerph16111904_801_item_0 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:21:32,148 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:21:32,175 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:32,207 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:21:32,214 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:21:32,294 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:32,296 - DEBUG - Finished converting page batch time=4051.629
2025-06-10 20:21:32,403 - INFO - Finished converting document 10.1186_s12889-017-4332-6_803.pdf in 14.69 sec.
2025-06-10 20:21:32,411 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:32,469 - INFO - Extraction successful row 168, tokens=13203
2025-06-10 20:21:32,491 - INFO - Going to convert document batch...
2025-06-10 20:21:32,492 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:21:32,492 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:21:32,545 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:21:32,906 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:21:32,907 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:21:32,907 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:21:32,929 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:32,942 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:32,981 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:33,022 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:21:33,066 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:21:33,102 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:33,127 - DEBUG - Snippet 10.3390_catal11080998_724_item_3: generation shape=torch.Size([1, 392])
2025-06-10 20:21:33,128 - DEBUG - Snippet 10.3390_catal11080998_724_item_3 raw docling: (tokens=46)
<formula><loc_0><loc_0><loc_500><loc_500>O _ { 3 ^ { - } S } \Rightarrow O _ { - } S + O _ { 2 }</formula><end_of_utterance>
2025-06-10 20:21:33,128 - DEBUG - Starting _parse_docling_output
2025-06-10 20:21:33,128 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>O _ { 3 ^ { - } S } \Rightarrow O _ { - } S + O _ { 2 }</formula><end_of_utterance>
2025-06-10 20:21:33,128 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:21:33,129 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>O _ { 3 ^ { - } S } \\Rightarrow O _ { - } S + O _ { 2 }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=688x61 at 0x7F96A9910710>)]
2025-06-10 20:21:33,129 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:21:33,131 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=688.0, b=61.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 55))], orig='O _ { 3 ^ { - } S } \\Rightarrow O _ { - } S + O _ { 2 }', text='O _ { 3 ^ { - } S } \\Rightarrow O _ { - } S + O _ { 2 }', formatting=None, hyperlink=None)]
2025-06-10 20:21:33,131 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:21:33,131 - DEBUG - Processing text item: label=formula, text=O _ { 3 ^ { - } S } \Rightarrow O _ { - } S + O _ { 2 }
2025-06-10 20:21:33,131 - DEBUG - Recognized string extracted: O _ { 3 ^ { - } S } \Rightarrow O _ { - } S + O _ { 2 }
2025-06-10 20:21:33,131 - DEBUG - Generating chat message for label: formula
2025-06-10 20:21:33,132 - DEBUG - Snippet 10.3390_catal11080998_724_item_4 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:21:33,145 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:21:33,280 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:33,290 - DEBUG - Snippet 10.3390_catal11080998_724_item_4 => input_ids shape=torch.Size([1, 610]), prompt_len=610
2025-06-10 20:21:33,316 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:21:33,331 - DEBUG - Finished converting page batch time=4052.664
2025-06-10 20:21:33,356 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:21:33,406 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:21:33,459 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:21:33,467 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:21:33,504 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:21:33,561 - DEBUG - Finished converting page batch time=4052.893
2025-06-10 20:21:33,634 - DEBUG - Finished converting page batch time=4052.967
2025-06-10 20:21:33,659 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:33,821 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:21:33,990 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:33,991 - DEBUG - Finished converting page batch time=4053.323
2025-06-10 20:21:34,015 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:21:34,015 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:21:34,016 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:21:34,041 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:21:34,041 - INFO - Processing document 10.3390_atmos7120158_852.pdf
2025-06-10 20:21:34,049 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:34,088 - INFO - Finished converting document 10.2174_1874192401812010071_804.pdf in 13.90 sec.
2025-06-10 20:21:34,090 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:34,142 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:21:34,162 - INFO - Extraction successful row 169, tokens=14016
2025-06-10 20:21:34,193 - INFO - Going to convert document batch...
2025-06-10 20:21:34,193 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:21:34,194 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:21:34,236 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:34,244 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:21:34,245 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:21:34,290 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:34,340 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:21:34,471 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:34,510 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:34,512 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:21:34,549 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:21:34,706 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:21:34,899 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:34,974 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:21:35,151 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:35,151 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:21:35,198 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:21:35,199 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:21:35,200 - INFO - Processing document 10.1136_bmj.n534_856.pdf
2025-06-10 20:21:35,205 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:21:35,374 - DEBUG - Snippet 10.3390_atmos11010018_809_item_0: generation shape=torch.Size([1, 535])
2025-06-10 20:21:35,378 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:35,380 - DEBUG - Snippet 10.3390_atmos11010018_809_item_0 raw docling: (tokens=189)
<formula><loc_0><loc_0><loc_500><loc_500>Y _ { t } \sim \quasi - \rho i s o n \left ( \mu _ { t } \right ) \\ \ln ( \mu _ { t } ) = \ \beta _ { 0 } + \beta _ { 1 } ( P M _ { 1 0 t - i } ) + s ( T e m p e r a t u r e _ { t - i } , \ d f ) + D O W _ { t } \\ + s ( R e l a t i v e \ h u m i d i t y , \ d f ) + s ( A i r p r e s s u r e _ { t } , \ d f ) + s ( T i m e _ { t } , \ d f ) ,</formula><end_of_utterance>
2025-06-10 20:21:35,381 - DEBUG - Starting _parse_docling_output
2025-06-10 20:21:35,381 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>Y _ { t } \sim \quasi - \rho i s o n \left ( \mu _ { t } \right ) \\ \ln ( \mu _ { t } ) = \ \beta _ { 0 } + \beta _ { 1 } ( P M _ { 1 0 t - i } ) + s ( T e m p e r a t u r e _ { t - i } , \ d f ) + D O W _ { t } \\ + s ( R e l a t i v e \ h u m i d i t y , \ d f ) + s ( A i r p r e s s u r e _ { t } , \ d f ) + s ( T i m e _ { t } , \ d f ) ,</formula><end_of_utterance>
2025-06-10 20:21:35,381 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:21:35,381 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>Y _ { t } \\sim \\quasi - \\rho i s o n \\left ( \\mu _ { t } \\right ) \\\\ \\ln ( \\mu _ { t } ) = \\ \\beta _ { 0 } + \\beta _ { 1 } ( P M _ { 1 0 t - i } ) + s ( T e m p e r a t u r e _ { t - i } , \\ d f ) + D O W _ { t } \\\\ + s ( R e l a t i v e \\ h u m i d i t y , \\ d f ) + s ( A i r p r e s s u r e _ { t } , \\ d f ) + s ( T i m e _ { t } , \\ d f ) ,</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=1054x182 at 0x7F9683E089B0>)]
2025-06-10 20:21:35,382 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:21:35,389 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=1054.0, b=182.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 345))], orig='Y _ { t } \\sim \\quasi - \\rho i s o n \\left ( \\mu _ { t } \\right ) \\\\ \\ln ( \\mu _ { t } ) = \\ \\beta _ { 0 } + \\beta _ { 1 } ( P M _ { 1 0 t - i } ) + s ( T e m p e r a t u r e _ { t - i } , \\ d f ) + D O W _ { t } \\\\ + s ( R e l a t i v e \\ h u m i d i t y , \\ d f ) + s ( A i r p r e s s u r e _ { t } , \\ d f ) + s ( T i m e _ { t } , \\ d f ) ,', text='Y _ { t } \\sim \\quasi - \\rho i s o n \\left ( \\mu _ { t } \\right ) \\\\ \\ln ( \\mu _ { t } ) = \\ \\beta _ { 0 } + \\beta _ { 1 } ( P M _ { 1 0 t - i } ) + s ( T e m p e r a t u r e _ { t - i } , \\ d f ) + D O W _ { t } \\\\ + s ( R e l a t i v e \\ h u m i d i t y , \\ d f ) + s ( A i r p r e s s u r e _ { t } , \\ d f ) + s ( T i m e _ { t } , \\ d f ) ,', formatting=None, hyperlink=None)]
2025-06-10 20:21:35,389 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:21:35,389 - DEBUG - Processing text item: label=formula, text=Y _ { t } \sim \quasi - \rho i s o n \left ( \mu _ { t } \right ) \\ \ln ( \mu _ { t } ) = \ \beta _ { 0 } + \beta _ { 1 } ( P M _ { 1 0 t - i } ) + s ( T e m p e r a t u r e _ { t - i } , \ d f ) + D O W _ { t } \\ + s ( R e l a t i v e \ h u m i d i t y , \ d f ) + s ( A i r p r e s s u r e _ { t } , \ d f ) + s ( T i m e _ { t } , \ d f ) ,
2025-06-10 20:21:35,389 - DEBUG - Recognized string extracted: Y _ { t } \sim \quasi - \rho i s o n \left ( \mu _ { t } \right ) \\ \ln ( \mu _ { t } ) = \ \beta _ { 0 } + \beta _ { 1 } ( P M _ { 1 0 t - i } ) + s ( T e m p e r a t u r e _ { t - i } , \ d f ) + D O W _ { t } \\ + s ( R e l a t i v e \ h u m i d i t y , \ d f ) + s ( A i r p r e s s u r e _ { t } , \ d f ) + s ( T i m e _ { t } , \ d f ) ,
2025-06-10 20:21:35,396 - INFO - All done. Returning 1 recognized text results.
2025-06-10 20:21:35,396 - DEBUG - Snippet 10.3390_atmos11010018_809_item_0 recognized text:
Y _ { t } \sim \quasi - \rho i s o n \left ( \mu _ { t } \right ) \\ \ln ( \mu _ { t } ) = \ \beta _ { 0 } + \beta _ { 1 } ( P M _ { 1 0 t - i } ) + s ( T e m p e r a t u r e _ { t - i } , \ d f ) + D O W _ { t } \\ + s ( R e l a t i v e \ h u m i d i t y , \ d f ) + s ( A i r p r e s s u r e _ { t } , \ d f ) + s ( T i m e _ { t } , \ d f ) ,
2025-06-10 20:21:35,458 - INFO - Finished converting document 10.3390_atmos11010018_809.pdf in 14.35 sec.
2025-06-10 20:21:35,547 - INFO - Extraction successful row 171, tokens=10016
2025-06-10 20:21:35,572 - INFO - Going to convert document batch...
2025-06-10 20:21:35,572 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:21:35,573 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:21:35,629 - DEBUG - Snippet 10.3390_catal11080998_724_item_4: generation shape=torch.Size([1, 691])
2025-06-10 20:21:35,630 - DEBUG - Snippet 10.3390_catal11080998_724_item_4 raw docling: (tokens=80)
<formula><loc_0><loc_0><loc_500><loc_500>O _ { 3 } - S \xrightarrow { \cdot } O _ { 3 } + O _ { 2 } \\ O _ { 3 } + O _ { - } S \xrightarrow { \cdot } 2 O _ { 2 } + S</formula><end_of_utterance>
2025-06-10 20:21:35,630 - DEBUG - Starting _parse_docling_output
2025-06-10 20:21:35,630 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>O _ { 3 } - S \xrightarrow { \cdot } O _ { 3 } + O _ { 2 } \\ O _ { 3 } + O _ { - } S \xrightarrow { \cdot } 2 O _ { 2 } + S</formula><end_of_utterance>
2025-06-10 20:21:35,631 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:21:35,631 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>O _ { 3 } - S \\xrightarrow { \\cdot } O _ { 3 } + O _ { 2 } \\\\ O _ { 3 } + O _ { - } S \\xrightarrow { \\cdot } 2 O _ { 2 } + S</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=708x224 at 0x7F96A9910740>)]
2025-06-10 20:21:35,631 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:21:35,636 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=708.0, b=224.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 124))], orig='O _ { 3 } - S \\xrightarrow { \\cdot } O _ { 3 } + O _ { 2 } \\\\ O _ { 3 } + O _ { - } S \\xrightarrow { \\cdot } 2 O _ { 2 } + S', text='O _ { 3 } - S \\xrightarrow { \\cdot } O _ { 3 } + O _ { 2 } \\\\ O _ { 3 } + O _ { - } S \\xrightarrow { \\cdot } 2 O _ { 2 } + S', formatting=None, hyperlink=None)]
2025-06-10 20:21:35,636 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:21:35,637 - DEBUG - Processing text item: label=formula, text=O _ { 3 } - S \xrightarrow { \cdot } O _ { 3 } + O _ { 2 } \\ O _ { 3 } + O _ { - } S \xrightarrow { \cdot } 2 O _ { 2 } + S
2025-06-10 20:21:35,637 - DEBUG - Recognized string extracted: O _ { 3 } - S \xrightarrow { \cdot } O _ { 3 } + O _ { 2 } \\ O _ { 3 } + O _ { - } S \xrightarrow { \cdot } 2 O _ { 2 } + S
2025-06-10 20:21:35,637 - INFO - All done. Returning 5 recognized text results.
2025-06-10 20:21:35,637 - DEBUG - Snippet 10.3390_catal11080998_724_item_0 recognized text:
H O _ { 3 } \bullet + P \to end \, p r o d u c t s
2025-06-10 20:21:35,637 - DEBUG - Snippet 10.3390_catal11080998_724_item_1 recognized text:
F e ^ { 2 + } + O _ { 3 } \to F e O ^ { 2 + } + O _ { 2 }
2025-06-10 20:21:35,638 - DEBUG - Snippet 10.3390_catal11080998_724_item_2 recognized text:
F e O ^ { 2 + } + H _ { 2 } O \to F e ^ { 3 + } + \bullet O H + O H ^ { - }
2025-06-10 20:21:35,638 - DEBUG - Snippet 10.3390_catal11080998_724_item_3 recognized text:
O _ { 3 ^ { - } S } \Rightarrow O _ { - } S + O _ { 2 }
2025-06-10 20:21:35,638 - DEBUG - Snippet 10.3390_catal11080998_724_item_4 recognized text:
O _ { 3 } - S \xrightarrow { \cdot } O _ { 3 } + O _ { 2 } \\ O _ { 3 } + O _ { - } S \xrightarrow { \cdot } 2 O _ { 2 } + S
2025-06-10 20:21:35,651 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:35,668 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:21:35,752 - DEBUG - Creating masked image for page 26 with 15 clusters.
2025-06-10 20:21:35,753 - INFO - Masked image successfully created for page 26.
2025-06-10 20:21:35,762 - INFO - Starting prediction for 5 images with labels: ['formula', 'formula', 'formula', 'formula', 'formula']
2025-06-10 20:21:35,763 - DEBUG - Generating chat message for label: formula
2025-06-10 20:21:35,763 - DEBUG - Snippet 10.3390_catal11080998_724_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:21:35,830 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:21:35,831 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:21:35,831 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:21:35,836 - DEBUG - Snippet 10.3390_catal11080998_724_item_0 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:21:35,866 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:35,902 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:36,006 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:36,016 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:21:36,113 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:21:36,150 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:36,188 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:21:36,240 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:36,344 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:36,499 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:21:36,540 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:21:36,546 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:36,546 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:21:36,547 - DEBUG - Finished converting page batch time=4055.880
2025-06-10 20:21:36,553 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:21:36,643 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:21:36,808 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:21:36,824 - DEBUG - Snippet 10.3390_catal11080998_724_item_0: generation shape=torch.Size([1, 380])
2025-06-10 20:21:36,825 - DEBUG - Snippet 10.3390_catal11080998_724_item_0 raw docling: (tokens=34)
<formula><loc_0><loc_0><loc_500><loc_500>O H ^ { - } + S \equiv O H - S</formula><end_of_utterance>
2025-06-10 20:21:36,825 - DEBUG - Starting _parse_docling_output
2025-06-10 20:21:36,826 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>O H ^ { - } + S \equiv O H - S</formula><end_of_utterance>
2025-06-10 20:21:36,826 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:21:36,826 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>O H ^ { - } + S \\equiv O H - S</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=693x65 at 0x7F96A6125A30>)]
2025-06-10 20:21:36,826 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:21:36,828 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=693.0, b=65.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 30))], orig='O H ^ { - } + S \\equiv O H - S', text='O H ^ { - } + S \\equiv O H - S', formatting=None, hyperlink=None)]
2025-06-10 20:21:36,828 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:21:36,829 - DEBUG - Processing text item: label=formula, text=O H ^ { - } + S \equiv O H - S
2025-06-10 20:21:36,829 - DEBUG - Recognized string extracted: O H ^ { - } + S \equiv O H - S
2025-06-10 20:21:36,829 - DEBUG - Generating chat message for label: formula
2025-06-10 20:21:36,829 - DEBUG - Snippet 10.3390_catal11080998_724_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:21:36,897 - DEBUG - Snippet 10.3390_catal11080998_724_item_1 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:21:37,055 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:21:37,056 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:21:37,056 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:21:37,089 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:37,099 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:37,123 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:21:37,127 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:37,162 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:21:37,203 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:21:37,245 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:37,252 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:37,269 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:37,274 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:37,285 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:21:37,323 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:21:37,323 - INFO - Processing document 10.1371_journal.pone.0066403_859.pdf
2025-06-10 20:21:37,447 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:37,488 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:21:37,525 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:21:37,723 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:21:37,884 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:38,078 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:21:38,118 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:38,197 - DEBUG - [Page 14] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:38,309 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:21:38,310 - INFO - Processing document 10.1183_16000617.0242-2020_866.pdf
2025-06-10 20:21:38,329 - DEBUG - Snippet 10.3390_catal11080998_724_item_1: generation shape=torch.Size([1, 396])
2025-06-10 20:21:38,330 - DEBUG - Snippet 10.3390_catal11080998_724_item_1 raw docling: (tokens=50)
<formula><loc_0><loc_0><loc_500><loc_500>O _ { 3 } + O H - S \Rightarrow \bullet O _ { 3 } - S + H O \bullet</formula><end_of_utterance>
2025-06-10 20:21:38,330 - DEBUG - Starting _parse_docling_output
2025-06-10 20:21:38,330 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>O _ { 3 } + O H - S \Rightarrow \bullet O _ { 3 } - S + H O \bullet</formula><end_of_utterance>
2025-06-10 20:21:38,330 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:21:38,331 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>O _ { 3 } + O H - S \\Rightarrow \\bullet O _ { 3 } - S + H O \\bullet</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=757x55 at 0x7F96A9913920>)]
2025-06-10 20:21:38,331 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:21:38,333 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=757.0, b=55.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 67))], orig='O _ { 3 } + O H - S \\Rightarrow \\bullet O _ { 3 } - S + H O \\bullet', text='O _ { 3 } + O H - S \\Rightarrow \\bullet O _ { 3 } - S + H O \\bullet', formatting=None, hyperlink=None)]
2025-06-10 20:21:38,334 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:21:38,334 - DEBUG - Processing text item: label=formula, text=O _ { 3 } + O H - S \Rightarrow \bullet O _ { 3 } - S + H O \bullet
2025-06-10 20:21:38,334 - DEBUG - Recognized string extracted: O _ { 3 } + O H - S \Rightarrow \bullet O _ { 3 } - S + H O \bullet
2025-06-10 20:21:38,334 - DEBUG - Generating chat message for label: formula
2025-06-10 20:21:38,335 - DEBUG - Snippet 10.3390_catal11080998_724_item_2 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:21:38,402 - DEBUG - Snippet 10.3390_catal11080998_724_item_2 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:21:38,509 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:38,771 - DEBUG - Finished converting page batch time=4058.103
2025-06-10 20:21:38,781 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:39,028 - DEBUG - [Page 15] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:39,302 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:39,309 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:39,311 - DEBUG - Finished converting page batch time=4058.644
2025-06-10 20:21:39,326 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:39,332 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:39,581 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:39,582 - DEBUG - Finished converting page batch time=4058.914
2025-06-10 20:21:39,591 - DEBUG - Snippet 10.3390_ijerph16111904_801_item_0: generation shape=torch.Size([1, 596])
2025-06-10 20:21:39,593 - DEBUG - Snippet 10.3390_ijerph16111904_801_item_0 raw docling: (tokens=250)
<formula><loc_0><loc_0><loc_500><loc_500>\ln ( E ( y _ { t } ) ) = \beta _ { 0 } + \beta _ { 1 } ( P M _ { 1 0 _ { t + t - i } } ) + \beta _ { 2 } ( t e m p _ { t \colon t - i } ) + \beta _ { 3 } ( D T R _ { t \colon t - i } ) + \beta _ { 4 } ( h u m i d _ { t \colon t - i } ) \\ + \beta _ { 5 } ( p r e s s _ { t \colon t - i } ) + \beta _ { 6 } ( O _ { 3 _ { t \colon t - i } } ) + \beta _ { 7 } ( N O _ { 2 _ { t \colon t - i } } ) + f a c t o r ( D O W _ { t } ) \\ + n s ( t i m e _ { t } , d f ) .</formula><end_of_utterance>
2025-06-10 20:21:39,593 - DEBUG - Starting _parse_docling_output
2025-06-10 20:21:39,594 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>\ln ( E ( y _ { t } ) ) = \beta _ { 0 } + \beta _ { 1 } ( P M _ { 1 0 _ { t + t - i } } ) + \beta _ { 2 } ( t e m p _ { t \colon t - i } ) + \beta _ { 3 } ( D T R _ { t \colon t - i } ) + \beta _ { 4 } ( h u m i d _ { t \colon t - i } ) \\ + \beta _ { 5 } ( p r e s s _ { t \colon t - i } ) + \beta _ { 6 } ( O _ { 3 _ { t \colon t - i } } ) + \beta _ { 7 } ( N O _ { 2 _ { t \colon t - i } } ) + f a c t o r ( D O W _ { t } ) \\ + n s ( t i m e _ { t } , d f ) .</formula><end_of_utterance>
2025-06-10 20:21:39,594 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:21:39,594 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>\\ln ( E ( y _ { t } ) ) = \\beta _ { 0 } + \\beta _ { 1 } ( P M _ { 1 0 _ { t + t - i } } ) + \\beta _ { 2 } ( t e m p _ { t \\colon t - i } ) + \\beta _ { 3 } ( D T R _ { t \\colon t - i } ) + \\beta _ { 4 } ( h u m i d _ { t \\colon t - i } ) \\\\ + \\beta _ { 5 } ( p r e s s _ { t \\colon t - i } ) + \\beta _ { 6 } ( O _ { 3 _ { t \\colon t - i } } ) + \\beta _ { 7 } ( N O _ { 2 _ { t \\colon t - i } } ) + f a c t o r ( D O W _ { t } ) \\\\ + n s ( t i m e _ { t } , d f ) .</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=1108x206 at 0x7F96B1D1EF90>)]
2025-06-10 20:21:39,594 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:21:39,603 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=1108.0, b=206.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 463))], orig='\\ln ( E ( y _ { t } ) ) = \\beta _ { 0 } + \\beta _ { 1 } ( P M _ { 1 0 _ { t + t - i } } ) + \\beta _ { 2 } ( t e m p _ { t \\colon t - i } ) + \\beta _ { 3 } ( D T R _ { t \\colon t - i } ) + \\beta _ { 4 } ( h u m i d _ { t \\colon t - i } ) \\\\ + \\beta _ { 5 } ( p r e s s _ { t \\colon t - i } ) + \\beta _ { 6 } ( O _ { 3 _ { t \\colon t - i } } ) + \\beta _ { 7 } ( N O _ { 2 _ { t \\colon t - i } } ) + f a c t o r ( D O W _ { t } ) \\\\ + n s ( t i m e _ { t } , d f ) .', text='\\ln ( E ( y _ { t } ) ) = \\beta _ { 0 } + \\beta _ { 1 } ( P M _ { 1 0 _ { t + t - i } } ) + \\beta _ { 2 } ( t e m p _ { t \\colon t - i } ) + \\beta _ { 3 } ( D T R _ { t \\colon t - i } ) + \\beta _ { 4 } ( h u m i d _ { t \\colon t - i } ) \\\\ + \\beta _ { 5 } ( p r e s s _ { t \\colon t - i } ) + \\beta _ { 6 } ( O _ { 3 _ { t \\colon t - i } } ) + \\beta _ { 7 } ( N O _ { 2 _ { t \\colon t - i } } ) + f a c t o r ( D O W _ { t } ) \\\\ + n s ( t i m e _ { t } , d f ) .', formatting=None, hyperlink=None)]
2025-06-10 20:21:39,603 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:21:39,604 - DEBUG - Processing text item: label=formula, text=\ln ( E ( y _ { t } ) ) = \beta _ { 0 } + \beta _ { 1 } ( P M _ { 1 0 _ { t + t - i } } ) + \beta _ { 2 } ( t e m p _ { t \colon t - i } ) + \beta _ { 3 } ( D T R _ { t \colon t - i } ) + \beta _ { 4 } ( h u m i d _ { t \colon t - i } ) \\ + \beta _ { 5 } ( p r e s s _ { t \colon t - i } ) + \beta _ { 6 } ( O _ { 3 _ { t \colon t - i } } ) + \beta _ { 7 } ( N O _ { 2 _ { t \colon t - i } } ) + f a c t o r ( D O W _ { t } ) \\ + n s ( t i m e _ { t } , d f ) .
2025-06-10 20:21:39,604 - DEBUG - Recognized string extracted: \ln ( E ( y _ { t } ) ) = \beta _ { 0 } + \beta _ { 1 } ( P M _ { 1 0 _ { t + t - i } } ) + \beta _ { 2 } ( t e m p _ { t \colon t - i } ) + \beta _ { 3 } ( D T R _ { t \colon t - i } ) + \beta _ { 4 } ( h u m i d _ { t \colon t - i } ) \\ + \beta _ { 5 } ( p r e s s _ { t \colon t - i } ) + \beta _ { 6 } ( O _ { 3 _ { t \colon t - i } } ) + \beta _ { 7 } ( N O _ { 2 _ { t \colon t - i } } ) + f a c t o r ( D O W _ { t } ) \\ + n s ( t i m e _ { t } , d f ) .
2025-06-10 20:21:39,604 - DEBUG - Generating chat message for label: formula
2025-06-10 20:21:39,604 - DEBUG - Snippet 10.3390_ijerph16111904_801_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:21:39,676 - DEBUG - Snippet 10.3390_ijerph16111904_801_item_1 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:21:39,706 - DEBUG - Finished converting page batch time=4059.039
2025-06-10 20:21:39,780 - DEBUG - Creating masked image for page 1 with 27 clusters.
2025-06-10 20:21:39,782 - INFO - Masked image successfully created for page 1.
2025-06-10 20:21:39,786 - INFO - Starting prediction for 1 images with labels: ['formula']
2025-06-10 20:21:39,786 - DEBUG - Generating chat message for label: formula
2025-06-10 20:21:39,786 - DEBUG - Snippet 10.1186_1476-069x-9-37_830_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:21:39,857 - DEBUG - Snippet 10.1186_1476-069x-9-37_830_item_0 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:21:39,860 - DEBUG - Snippet 10.3390_catal11080998_724_item_2: generation shape=torch.Size([1, 394])
2025-06-10 20:21:39,861 - DEBUG - Snippet 10.3390_catal11080998_724_item_2 raw docling: (tokens=48)
<formula><loc_0><loc_0><loc_500><loc_500>\bullet O _ { 3 } - S \Rightarrow \bullet O _ { - } S + O _ { 2 }</formula><end_of_utterance>
2025-06-10 20:21:39,861 - DEBUG - Starting _parse_docling_output
2025-06-10 20:21:39,861 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>\bullet O _ { 3 } - S \Rightarrow \bullet O _ { - } S + O _ { 2 }</formula><end_of_utterance>
2025-06-10 20:21:39,861 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:21:39,862 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>\\bullet O _ { 3 } - S \\Rightarrow \\bullet O _ { - } S + O _ { 2 }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=703x61 at 0x7F96A393D190>)]
2025-06-10 20:21:39,862 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:21:39,864 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=703.0, b=61.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 65))], orig='\\bullet O _ { 3 } - S \\Rightarrow \\bullet O _ { - } S + O _ { 2 }', text='\\bullet O _ { 3 } - S \\Rightarrow \\bullet O _ { - } S + O _ { 2 }', formatting=None, hyperlink=None)]
2025-06-10 20:21:39,864 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:21:39,864 - DEBUG - Processing text item: label=formula, text=\bullet O _ { 3 } - S \Rightarrow \bullet O _ { - } S + O _ { 2 }
2025-06-10 20:21:39,864 - DEBUG - Recognized string extracted: \bullet O _ { 3 } - S \Rightarrow \bullet O _ { - } S + O _ { 2 }
2025-06-10 20:21:39,864 - DEBUG - Generating chat message for label: formula
2025-06-10 20:21:39,865 - DEBUG - Snippet 10.3390_catal11080998_724_item_3 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:21:39,868 - DEBUG - [Page 16] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:39,890 - DEBUG - Dynamic vertical threshold: 52.11539999999996, Overlap threshold: 0.7
2025-06-10 20:21:39,890 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:39,940 - DEBUG - Snippet 10.3390_catal11080998_724_item_3 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:21:40,405 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:40,591 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:40,664 - DEBUG - [Page 17] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:41,566 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:41,749 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:41,751 - DEBUG - Finished converting page batch time=4061.084
2025-06-10 20:21:41,864 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:41,865 - DEBUG - Finished converting page batch time=4061.198
2025-06-10 20:21:42,044 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:42,060 - DEBUG - Snippet 10.3390_catal11080998_724_item_3: generation shape=torch.Size([1, 407])
2025-06-10 20:21:42,060 - DEBUG - Snippet 10.3390_catal11080998_724_item_3 raw docling: (tokens=61)
<formula><loc_0><loc_0><loc_500><loc_500>O _ { 3 } + \bullet O _ { 2 } ^ { - } \to \bullet O _ { 3 } ^ { - } + O _ { 2 }</formula><end_of_utterance>
2025-06-10 20:21:42,061 - DEBUG - Starting _parse_docling_output
2025-06-10 20:21:42,061 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>O _ { 3 } + \bullet O _ { 2 } ^ { - } \to \bullet O _ { 3 } ^ { - } + O _ { 2 }</formula><end_of_utterance>
2025-06-10 20:21:42,061 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:21:42,061 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>O _ { 3 } + \\bullet O _ { 2 } ^ { - } \\to \\bullet O _ { 3 } ^ { - } + O _ { 2 }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=739x72 at 0x7F96A393F200>)]
2025-06-10 20:21:42,062 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:21:42,064 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=739.0, b=72.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 79))], orig='O _ { 3 } + \\bullet O _ { 2 } ^ { - } \\to \\bullet O _ { 3 } ^ { - } + O _ { 2 }', text='O _ { 3 } + \\bullet O _ { 2 } ^ { - } \\to \\bullet O _ { 3 } ^ { - } + O _ { 2 }', formatting=None, hyperlink=None)]
2025-06-10 20:21:42,064 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:21:42,064 - DEBUG - Processing text item: label=formula, text=O _ { 3 } + \bullet O _ { 2 } ^ { - } \to \bullet O _ { 3 } ^ { - } + O _ { 2 }
2025-06-10 20:21:42,065 - DEBUG - Recognized string extracted: O _ { 3 } + \bullet O _ { 2 } ^ { - } \to \bullet O _ { 3 } ^ { - } + O _ { 2 }
2025-06-10 20:21:42,065 - DEBUG - Generating chat message for label: formula
2025-06-10 20:21:42,065 - DEBUG - Snippet 10.3390_catal11080998_724_item_4 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:21:42,100 - DEBUG - [Page 18] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:42,136 - DEBUG - Snippet 10.3390_catal11080998_724_item_4 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:21:42,508 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:42,517 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:42,683 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:42,684 - DEBUG - Finished converting page batch time=4062.017
2025-06-10 20:21:42,761 - DEBUG - Snippet 10.1186_1476-069x-9-37_830_item_0: generation shape=torch.Size([1, 430])
2025-06-10 20:21:42,763 - DEBUG - Snippet 10.1186_1476-069x-9-37_830_item_0 raw docling: (tokens=84)
<formula><loc_0><loc_0><loc_500><loc_500>T _ { a p p } = - 2 . 6 5 3 + 0 . 9 9 4 ( T _ { a i r } ) + 0 . 0 1 5 3 ( T _ { d e w p t } ) ^ { 2 }</formula><end_of_utterance>
2025-06-10 20:21:42,765 - DEBUG - Starting _parse_docling_output
2025-06-10 20:21:42,765 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>T _ { a p p } = - 2 . 6 5 3 + 0 . 9 9 4 ( T _ { a i r } ) + 0 . 0 1 5 3 ( T _ { d e w p t } ) ^ { 2 }</formula><end_of_utterance>
2025-06-10 20:21:42,766 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:21:42,766 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>T _ { a p p } = - 2 . 6 5 3 + 0 . 9 9 4 ( T _ { a i r } ) + 0 . 0 1 5 3 ( T _ { d e w p t } ) ^ { 2 }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=582x109 at 0x7F96DCC94950>)]
2025-06-10 20:21:42,766 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:21:42,769 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=582.0, b=109.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 101))], orig='T _ { a p p } = - 2 . 6 5 3 + 0 . 9 9 4 ( T _ { a i r } ) + 0 . 0 1 5 3 ( T _ { d e w p t } ) ^ { 2 }', text='T _ { a p p } = - 2 . 6 5 3 + 0 . 9 9 4 ( T _ { a i r } ) + 0 . 0 1 5 3 ( T _ { d e w p t } ) ^ { 2 }', formatting=None, hyperlink=None)]
2025-06-10 20:21:42,769 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:21:42,769 - DEBUG - Processing text item: label=formula, text=T _ { a p p } = - 2 . 6 5 3 + 0 . 9 9 4 ( T _ { a i r } ) + 0 . 0 1 5 3 ( T _ { d e w p t } ) ^ { 2 }
2025-06-10 20:21:42,770 - DEBUG - Recognized string extracted: T _ { a p p } = - 2 . 6 5 3 + 0 . 9 9 4 ( T _ { a i r } ) + 0 . 0 1 5 3 ( T _ { d e w p t } ) ^ { 2 }
2025-06-10 20:21:42,770 - INFO - All done. Returning 1 recognized text results.
2025-06-10 20:21:42,770 - DEBUG - Snippet 10.1186_1476-069x-9-37_830_item_0 recognized text:
T _ { a p p } = - 2 . 6 5 3 + 0 . 9 9 4 ( T _ { a i r } ) + 0 . 0 1 5 3 ( T _ { d e w p t } ) ^ { 2 }
2025-06-10 20:21:42,844 - INFO - Finished converting document 10.1186_1476-069x-9-37_830.pdf in 17.05 sec.
2025-06-10 20:21:42,930 - INFO - Extraction successful row 172, tokens=16651
2025-06-10 20:21:42,951 - INFO - Going to convert document batch...
2025-06-10 20:21:42,951 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:21:42,951 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:21:42,994 - DEBUG - Finished converting page batch time=4062.326
2025-06-10 20:21:43,000 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:21:43,647 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:43,654 - DEBUG - Snippet 10.3390_catal11080998_724_item_4: generation shape=torch.Size([1, 395])
2025-06-10 20:21:43,655 - DEBUG - Snippet 10.3390_catal11080998_724_item_4 raw docling: (tokens=49)
<formula><loc_0><loc_0><loc_500><loc_500>\bullet O _ { 3 } ^ { - } + H ^ { + } \to H O _ { 3 } \bullet</formula><end_of_utterance>
2025-06-10 20:21:43,655 - DEBUG - Starting _parse_docling_output
2025-06-10 20:21:43,655 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>\bullet O _ { 3 } ^ { - } + H ^ { + } \to H O _ { 3 } \bullet</formula><end_of_utterance>
2025-06-10 20:21:43,655 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:21:43,656 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>\\bullet O _ { 3 } ^ { - } + H ^ { + } \\to H O _ { 3 } \\bullet</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=711x72 at 0x7F96A393DB20>)]
2025-06-10 20:21:43,656 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:21:43,657 - DEBUG - [Page 19] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:43,658 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=711.0, b=72.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 61))], orig='\\bullet O _ { 3 } ^ { - } + H ^ { + } \\to H O _ { 3 } \\bullet', text='\\bullet O _ { 3 } ^ { - } + H ^ { + } \\to H O _ { 3 } \\bullet', formatting=None, hyperlink=None)]
2025-06-10 20:21:43,658 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:21:43,659 - DEBUG - Processing text item: label=formula, text=\bullet O _ { 3 } ^ { - } + H ^ { + } \to H O _ { 3 } \bullet
2025-06-10 20:21:43,659 - DEBUG - Recognized string extracted: \bullet O _ { 3 } ^ { - } + H ^ { + } \to H O _ { 3 } \bullet
2025-06-10 20:21:43,659 - INFO - All done. Returning 5 recognized text results.
2025-06-10 20:21:43,659 - DEBUG - Snippet 10.3390_catal11080998_724_item_0 recognized text:
O H ^ { - } + S \equiv O H - S
2025-06-10 20:21:43,659 - DEBUG - Snippet 10.3390_catal11080998_724_item_1 recognized text:
O _ { 3 } + O H - S \Rightarrow \bullet O _ { 3 } - S + H O \bullet
2025-06-10 20:21:43,659 - DEBUG - Snippet 10.3390_catal11080998_724_item_2 recognized text:
\bullet O _ { 3 } - S \Rightarrow \bullet O _ { - } S + O _ { 2 }
2025-06-10 20:21:43,664 - DEBUG - Snippet 10.3390_catal11080998_724_item_3 recognized text:
O _ { 3 } + \bullet O _ { 2 } ^ { - } \to \bullet O _ { 3 } ^ { - } + O _ { 2 }
2025-06-10 20:21:43,668 - DEBUG - Snippet 10.3390_catal11080998_724_item_4 recognized text:
\bullet O _ { 3 } ^ { - } + H ^ { + } \to H O _ { 3 } \bullet
2025-06-10 20:21:43,718 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:21:43,775 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:21:43,781 - DEBUG - Creating masked image for page 28 with 25 clusters.
2025-06-10 20:21:43,781 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:21:43,782 - INFO - Masked image successfully created for page 28.
2025-06-10 20:21:43,790 - INFO - Starting prediction for 5 images with labels: ['formula', 'formula', 'formula', 'formula', 'formula']
2025-06-10 20:21:43,791 - DEBUG - Generating chat message for label: formula
2025-06-10 20:21:43,791 - DEBUG - Snippet 10.3390_catal11080998_724_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:21:43,871 - DEBUG - Snippet 10.3390_catal11080998_724_item_0 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:21:43,886 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:43,937 - DEBUG - [Page 5] Keeping cluster 0 as table (area ratio: 0.73, cells: 492, density: 0.001427).
2025-06-10 20:21:43,944 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:44,099 - DEBUG - Finished converting page batch time=4063.431
2025-06-10 20:21:44,303 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:44,374 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:44,443 - DEBUG - [Page 20] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:44,570 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:21:44,571 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:21:44,571 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:21:44,605 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:44,662 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:44,699 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:21:44,738 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:21:44,765 - DEBUG - [Page 21] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:44,800 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:44,839 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:21:44,971 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:45,006 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:45,011 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:21:45,053 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:21:45,060 - DEBUG - [Page 22] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:45,200 - DEBUG - Snippet 10.3390_catal11080998_724_item_0: generation shape=torch.Size([1, 392])
2025-06-10 20:21:45,201 - DEBUG - Snippet 10.3390_catal11080998_724_item_0 raw docling: (tokens=46)
<formula><loc_0><loc_0><loc_500><loc_500>H O _ { 3 } \bullet \to H O _ { \bullet } + O _ { 2 }</formula><end_of_utterance>
2025-06-10 20:21:45,201 - DEBUG - Starting _parse_docling_output
2025-06-10 20:21:45,201 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>H O _ { 3 } \bullet \to H O _ { \bullet } + O _ { 2 }</formula><end_of_utterance>
2025-06-10 20:21:45,201 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:21:45,202 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>H O _ { 3 } \\bullet \\to H O _ { \\bullet } + O _ { 2 }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=703x62 at 0x7F96A9910740>)]
2025-06-10 20:21:45,202 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:21:45,204 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=703.0, b=62.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 53))], orig='H O _ { 3 } \\bullet \\to H O _ { \\bullet } + O _ { 2 }', text='H O _ { 3 } \\bullet \\to H O _ { \\bullet } + O _ { 2 }', formatting=None, hyperlink=None)]
2025-06-10 20:21:45,204 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:21:45,205 - DEBUG - Processing text item: label=formula, text=H O _ { 3 } \bullet \to H O _ { \bullet } + O _ { 2 }
2025-06-10 20:21:45,205 - DEBUG - Recognized string extracted: H O _ { 3 } \bullet \to H O _ { \bullet } + O _ { 2 }
2025-06-10 20:21:45,205 - DEBUG - Generating chat message for label: formula
2025-06-10 20:21:45,205 - DEBUG - Snippet 10.3390_catal11080998_724_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:21:45,208 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:21:45,274 - DEBUG - Snippet 10.3390_catal11080998_724_item_1 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:21:45,307 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:45,489 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:21:45,570 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:45,571 - DEBUG - Finished converting page batch time=4064.903
2025-06-10 20:21:45,723 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:21:45,723 - INFO - Processing document 10.51523_2708-6011.2007-4-4-27_871.pdf
2025-06-10 20:21:45,872 - DEBUG - [Page 23] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:45,873 - DEBUG - Finished converting page batch time=4065.206
2025-06-10 20:21:46,176 - DEBUG - [Page 24] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:46,282 - DEBUG - Snippet 10.3390_catal11080998_724_item_1: generation shape=torch.Size([1, 382])
2025-06-10 20:21:46,284 - DEBUG - Snippet 10.3390_catal11080998_724_item_1 raw docling: (tokens=36)
<formula><loc_0><loc_0><loc_500><loc_500>\bullet + P \to end \, p r o d u c t s</formula><end_of_utterance>
2025-06-10 20:21:46,284 - DEBUG - Starting _parse_docling_output
2025-06-10 20:21:46,284 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>\bullet + P \to end \, p r o d u c t s</formula><end_of_utterance>
2025-06-10 20:21:46,284 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:21:46,285 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>\\bullet + P \\to end \\, p r o d u c t s</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=688x55 at 0x7F96A9910860>)]
2025-06-10 20:21:46,285 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:21:46,287 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=688.0, b=55.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 38))], orig='\\bullet + P \\to end \\, p r o d u c t s', text='\\bullet + P \\to end \\, p r o d u c t s', formatting=None, hyperlink=None)]
2025-06-10 20:21:46,287 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:21:46,287 - DEBUG - Processing text item: label=formula, text=\bullet + P \to end \, p r o d u c t s
2025-06-10 20:21:46,288 - DEBUG - Recognized string extracted: \bullet + P \to end \, p r o d u c t s
2025-06-10 20:21:46,288 - DEBUG - Generating chat message for label: formula
2025-06-10 20:21:46,288 - DEBUG - Snippet 10.3390_catal11080998_724_item_2 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:21:46,356 - DEBUG - Snippet 10.3390_catal11080998_724_item_2 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:21:46,424 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:46,431 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:46,467 - DEBUG - [Page 25] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:46,496 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:46,666 - DEBUG - [Page 26] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:46,669 - DEBUG - Finished converting page batch time=4066.001
2025-06-10 20:21:46,758 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:46,816 - INFO - Finished converting document 10.7717_peerj.3574_839.pdf in 20.45 sec.
2025-06-10 20:21:46,832 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:47,097 - INFO - Extraction successful row 173, tokens=25288
2025-06-10 20:21:47,120 - INFO - Going to convert document batch...
2025-06-10 20:21:47,120 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:21:47,121 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:21:47,174 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:21:47,255 - DEBUG - Snippet 10.3390_ijerph16111904_801_item_1: generation shape=torch.Size([1, 599])
2025-06-10 20:21:47,257 - DEBUG - Snippet 10.3390_ijerph16111904_801_item_1 raw docling: (tokens=253)
<formula><loc_0><loc_0><loc_500><loc_500>\ln ( E ( y _ { t } ) ) = \beta _ { 0 } + \beta _ { 1 } ( P M _ { 1 0 _ { t t - i } } ) \colon f a c t o r ( S S C _ { t , j } ) + \beta _ { 2 } ( t e m p _ { t , t - i } ) + \beta _ { 3 } ( D T R _ { t , t - i } ) + \beta _ { 4 } ( h u m i d _ { t , t - i } ) \\ + \beta _ { 5 } ( p r e s s _ { t , t - i } ) + \beta _ { 6 } ( O _ { 3 , t ; t - i } ) + \beta _ { 7 } ( N O _ { 2 , t ; t - i } ) + f a c t o r ( D O W _ { t } ) \\ + n s ( t i m e _ { t , d f } ) .</formula><end_of_utterance>
2025-06-10 20:21:47,257 - DEBUG - Starting _parse_docling_output
2025-06-10 20:21:47,257 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>\ln ( E ( y _ { t } ) ) = \beta _ { 0 } + \beta _ { 1 } ( P M _ { 1 0 _ { t t - i } } ) \colon f a c t o r ( S S C _ { t , j } ) + \beta _ { 2 } ( t e m p _ { t , t - i } ) + \beta _ { 3 } ( D T R _ { t , t - i } ) + \beta _ { 4 } ( h u m i d _ { t , t - i } ) \\ + \beta _ { 5 } ( p r e s s _ { t , t - i } ) + \beta _ { 6 } ( O _ { 3 , t ; t - i } ) + \beta _ { 7 } ( N O _ { 2 , t ; t - i } ) + f a c t o r ( D O W _ { t } ) \\ + n s ( t i m e _ { t , d f } ) .</formula><end_of_utterance>
2025-06-10 20:21:47,258 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:21:47,258 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>\\ln ( E ( y _ { t } ) ) = \\beta _ { 0 } + \\beta _ { 1 } ( P M _ { 1 0 _ { t t - i } } ) \\colon f a c t o r ( S S C _ { t , j } ) + \\beta _ { 2 } ( t e m p _ { t , t - i } ) + \\beta _ { 3 } ( D T R _ { t , t - i } ) + \\beta _ { 4 } ( h u m i d _ { t , t - i } ) \\\\ + \\beta _ { 5 } ( p r e s s _ { t , t - i } ) + \\beta _ { 6 } ( O _ { 3 , t ; t - i } ) + \\beta _ { 7 } ( N O _ { 2 , t ; t - i } ) + f a c t o r ( D O W _ { t } ) \\\\ + n s ( t i m e _ { t , d f } ) .</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=1142x186 at 0x7F971C49AA50>)]
2025-06-10 20:21:47,258 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:21:47,267 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=1142.0, b=186.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 464))], orig='\\ln ( E ( y _ { t } ) ) = \\beta _ { 0 } + \\beta _ { 1 } ( P M _ { 1 0 _ { t t - i } } ) \\colon f a c t o r ( S S C _ { t , j } ) + \\beta _ { 2 } ( t e m p _ { t , t - i } ) + \\beta _ { 3 } ( D T R _ { t , t - i } ) + \\beta _ { 4 } ( h u m i d _ { t , t - i } ) \\\\ + \\beta _ { 5 } ( p r e s s _ { t , t - i } ) + \\beta _ { 6 } ( O _ { 3 , t ; t - i } ) + \\beta _ { 7 } ( N O _ { 2 , t ; t - i } ) + f a c t o r ( D O W _ { t } ) \\\\ + n s ( t i m e _ { t , d f } ) .', text='\\ln ( E ( y _ { t } ) ) = \\beta _ { 0 } + \\beta _ { 1 } ( P M _ { 1 0 _ { t t - i } } ) \\colon f a c t o r ( S S C _ { t , j } ) + \\beta _ { 2 } ( t e m p _ { t , t - i } ) + \\beta _ { 3 } ( D T R _ { t , t - i } ) + \\beta _ { 4 } ( h u m i d _ { t , t - i } ) \\\\ + \\beta _ { 5 } ( p r e s s _ { t , t - i } ) + \\beta _ { 6 } ( O _ { 3 , t ; t - i } ) + \\beta _ { 7 } ( N O _ { 2 , t ; t - i } ) + f a c t o r ( D O W _ { t } ) \\\\ + n s ( t i m e _ { t , d f } ) .', formatting=None, hyperlink=None)]
2025-06-10 20:21:47,267 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:21:47,268 - DEBUG - Processing text item: label=formula, text=\ln ( E ( y _ { t } ) ) = \beta _ { 0 } + \beta _ { 1 } ( P M _ { 1 0 _ { t t - i } } ) \colon f a c t o r ( S S C _ { t , j } ) + \beta _ { 2 } ( t e m p _ { t , t - i } ) + \beta _ { 3 } ( D T R _ { t , t - i } ) + \beta _ { 4 } ( h u m i d _ { t , t - i } ) \\ + \beta _ { 5 } ( p r e s s _ { t , t - i } ) + \beta _ { 6 } ( O _ { 3 , t ; t - i } ) + \beta _ { 7 } ( N O _ { 2 , t ; t - i } ) + f a c t o r ( D O W _ { t } ) \\ + n s ( t i m e _ { t , d f } ) .
2025-06-10 20:21:47,268 - DEBUG - Recognized string extracted: \ln ( E ( y _ { t } ) ) = \beta _ { 0 } + \beta _ { 1 } ( P M _ { 1 0 _ { t t - i } } ) \colon f a c t o r ( S S C _ { t , j } ) + \beta _ { 2 } ( t e m p _ { t , t - i } ) + \beta _ { 3 } ( D T R _ { t , t - i } ) + \beta _ { 4 } ( h u m i d _ { t , t - i } ) \\ + \beta _ { 5 } ( p r e s s _ { t , t - i } ) + \beta _ { 6 } ( O _ { 3 , t ; t - i } ) + \beta _ { 7 } ( N O _ { 2 , t ; t - i } ) + f a c t o r ( D O W _ { t } ) \\ + n s ( t i m e _ { t , d f } ) .
2025-06-10 20:21:47,268 - INFO - All done. Returning 2 recognized text results.
2025-06-10 20:21:47,268 - DEBUG - Snippet 10.3390_ijerph16111904_801_item_0 recognized text:
\ln ( E ( y _ { t } ) ) = \beta _ { 0 } + \beta _ { 1 } ( P M _ { 1 0 _ { t + t - i } } ) + \beta _ { 2 } ( t e m p _ { t \colon t - i } ) + \beta _ { 3 } ( D T R _ { t \colon t - i } ) + \beta _ { 4 } ( h u m i d _ { t \colon t - i } ) \\ + \beta _ { 5 } ( p r e s s _ { t \colon t - i } ) + \beta _ { 6 } ( O _ { 3 _ { t \colon t - i } } ) + \beta _ { 7 } ( N O _ { 2 _ { t \colon t - i } } ) + f a c t o r ( D O W _ { t } ) \\ + n s ( t i m e _ { t } , d f ) .
2025-06-10 20:21:47,269 - DEBUG - Snippet 10.3390_ijerph16111904_801_item_1 recognized text:
\ln ( E ( y _ { t } ) ) = \beta _ { 0 } + \beta _ { 1 } ( P M _ { 1 0 _ { t t - i } } ) \colon f a c t o r ( S S C _ { t , j } ) + \beta _ { 2 } ( t e m p _ { t , t - i } ) + \beta _ { 3 } ( D T R _ { t , t - i } ) + \beta _ { 4 } ( h u m i d _ { t , t - i } ) \\ + \beta _ { 5 } ( p r e s s _ { t , t - i } ) + \beta _ { 6 } ( O _ { 3 , t ; t - i } ) + \beta _ { 7 } ( N O _ { 2 , t ; t - i } ) + f a c t o r ( D O W _ { t } ) \\ + n s ( t i m e _ { t , d f } ) .
2025-06-10 20:21:47,298 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:47,316 - DEBUG - Finished converting page batch time=4066.649
2025-06-10 20:21:47,373 - INFO - Finished converting document 10.3390_ijerph16111904_801.pdf in 32.20 sec.
2025-06-10 20:21:47,510 - INFO - Extraction successful row 167, tokens=32127
2025-06-10 20:21:47,535 - INFO - Going to convert document batch...
2025-06-10 20:21:47,536 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:21:47,536 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:21:47,585 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:21:47,833 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:47,882 - DEBUG - [Page 14] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:47,905 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:21:47,957 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:21:47,964 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:21:47,997 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:47,998 - DEBUG - Finished converting page batch time=4067.331
2025-06-10 20:21:48,049 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:48,364 - DEBUG - Snippet 10.3390_catal11080998_724_item_2: generation shape=torch.Size([1, 411])
2025-06-10 20:21:48,365 - DEBUG - Snippet 10.3390_catal11080998_724_item_2 raw docling: (tokens=65)
<formula><loc_0><loc_0><loc_500><loc_500>O _ { 3 } + M e - O H _ { 2 } ^ { + } \to M e - O H ^ { + } \bullet + H O _ { 3 } \bullet</formula><end_of_utterance>
2025-06-10 20:21:48,372 - DEBUG - Starting _parse_docling_output
2025-06-10 20:21:48,372 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>O _ { 3 } + M e - O H _ { 2 } ^ { + } \to M e - O H ^ { + } \bullet + H O _ { 3 } \bullet</formula><end_of_utterance>
2025-06-10 20:21:48,373 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:21:48,373 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>O _ { 3 } + M e - O H _ { 2 } ^ { + } \\to M e - O H ^ { + } \\bullet + H O _ { 3 } \\bullet</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=818x71 at 0x7F96A9911190>)]
2025-06-10 20:21:48,373 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:21:48,376 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=818.0, b=71.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 89))], orig='O _ { 3 } + M e - O H _ { 2 } ^ { + } \\to M e - O H ^ { + } \\bullet + H O _ { 3 } \\bullet', text='O _ { 3 } + M e - O H _ { 2 } ^ { + } \\to M e - O H ^ { + } \\bullet + H O _ { 3 } \\bullet', formatting=None, hyperlink=None)]
2025-06-10 20:21:48,376 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:21:48,376 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:21:48,376 - DEBUG - Processing text item: label=formula, text=O _ { 3 } + M e - O H _ { 2 } ^ { + } \to M e - O H ^ { + } \bullet + H O _ { 3 } \bullet
2025-06-10 20:21:48,377 - DEBUG - Recognized string extracted: O _ { 3 } + M e - O H _ { 2 } ^ { + } \to M e - O H ^ { + } \bullet + H O _ { 3 } \bullet
2025-06-10 20:21:48,377 - DEBUG - Generating chat message for label: formula
2025-06-10 20:21:48,377 - DEBUG - Snippet 10.3390_catal11080998_724_item_3 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:21:48,445 - DEBUG - Snippet 10.3390_catal11080998_724_item_3 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:21:48,510 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:21:48,516 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:21:48,555 - DEBUG - [Page 15] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:48,555 - DEBUG - Finished converting page batch time=4067.888
2025-06-10 20:21:48,741 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:21:48,748 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:21:48,748 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:21:48,789 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:48,828 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:48,867 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:21:48,904 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:21:48,939 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:48,954 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:48,975 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:21:48,990 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:21:48,990 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:21:48,990 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:21:49,024 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:49,064 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:49,069 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:49,070 - DEBUG - Finished converting page batch time=4068.403
2025-06-10 20:21:49,105 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:21:49,106 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:49,141 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:21:49,147 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:21:49,173 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:49,186 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:49,202 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:21:49,221 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:21:49,324 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:49,346 - DEBUG - [Page 16] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:49,369 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:49,371 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:21:49,404 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:21:49,547 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:21:49,669 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:21:49,675 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:49,701 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:21:49,785 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:49,860 - DEBUG - [Page 17] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:49,865 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:21:49,866 - INFO - Processing document 10.3390_ijerph111111772_873.pdf
2025-06-10 20:21:49,988 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:50,009 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:21:50,191 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:21:50,192 - INFO - Processing document 10.1186_s12940-016-0102-7_876.pdf
2025-06-10 20:21:50,222 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:50,223 - DEBUG - Finished converting page batch time=4069.556
2025-06-10 20:21:50,226 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:50,356 - DEBUG - Snippet 10.3390_catal11080998_724_item_3: generation shape=torch.Size([1, 414])
2025-06-10 20:21:50,360 - DEBUG - Snippet 10.3390_catal11080998_724_item_3 raw docling: (tokens=68)
<formula><loc_0><loc_0><loc_500><loc_500>2 O _ { 3 } + M e - O H \to M e - O _ { 2 } ^ { - } \bullet + H O _ { 3 } \bullet + O _ { 2 }</formula><end_of_utterance>
2025-06-10 20:21:50,364 - DEBUG - Starting _parse_docling_output
2025-06-10 20:21:50,364 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>2 O _ { 3 } + M e - O H \to M e - O _ { 2 } ^ { - } \bullet + H O _ { 3 } \bullet + O _ { 2 }</formula><end_of_utterance>
2025-06-10 20:21:50,364 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:21:50,364 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>2 O _ { 3 } + M e - O H \\to M e - O _ { 2 } ^ { - } \\bullet + H O _ { 3 } \\bullet + O _ { 2 }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=840x72 at 0x7F96A9913080>)]
2025-06-10 20:21:50,365 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:21:50,365 - DEBUG - Creating masked image for page 2 with 16 clusters.
2025-06-10 20:21:50,367 - INFO - Masked image successfully created for page 2.
2025-06-10 20:21:50,367 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=840.0, b=72.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 93))], orig='2 O _ { 3 } + M e - O H \\to M e - O _ { 2 } ^ { - } \\bullet + H O _ { 3 } \\bullet + O _ { 2 }', text='2 O _ { 3 } + M e - O H \\to M e - O _ { 2 } ^ { - } \\bullet + H O _ { 3 } \\bullet + O _ { 2 }', formatting=None, hyperlink=None)]
2025-06-10 20:21:50,368 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:21:50,368 - DEBUG - Processing text item: label=formula, text=2 O _ { 3 } + M e - O H \to M e - O _ { 2 } ^ { - } \bullet + H O _ { 3 } \bullet + O _ { 2 }
2025-06-10 20:21:50,368 - DEBUG - Recognized string extracted: 2 O _ { 3 } + M e - O H \to M e - O _ { 2 } ^ { - } \bullet + H O _ { 3 } \bullet + O _ { 2 }
2025-06-10 20:21:50,368 - DEBUG - Generating chat message for label: formula
2025-06-10 20:21:50,369 - DEBUG - Snippet 10.3390_catal11080998_724_item_4 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:21:50,370 - INFO - Starting prediction for 1 images with labels: ['formula']
2025-06-10 20:21:50,370 - DEBUG - Generating chat message for label: formula
2025-06-10 20:21:50,370 - DEBUG - Snippet 10.1371_journal.pone.0066403_859_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:21:50,440 - DEBUG - Snippet 10.3390_catal11080998_724_item_4 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:21:50,452 - DEBUG - Snippet 10.1371_journal.pone.0066403_859_item_0 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:21:50,788 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:50,817 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:50,870 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:51,143 - DEBUG - [Page 18] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:51,199 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:51,201 - DEBUG - Finished converting page batch time=4070.534
2025-06-10 20:21:51,370 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:51,657 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:51,659 - DEBUG - Finished converting page batch time=4070.991
2025-06-10 20:21:51,702 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:51,704 - DEBUG - Finished converting page batch time=4071.036
2025-06-10 20:21:51,787 - INFO - Finished converting document 10.51523_2708-6011.2007-4-4-27_871.pdf in 8.85 sec.
2025-06-10 20:21:51,794 - DEBUG - [Page 19] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:51,795 - DEBUG - Finished converting page batch time=4071.128
2025-06-10 20:21:51,796 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:51,797 - DEBUG - Finished converting page batch time=4071.130
2025-06-10 20:21:51,820 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:51,821 - DEBUG - Finished converting page batch time=4071.154
2025-06-10 20:21:51,858 - INFO - Extraction successful row 178, tokens=22264
2025-06-10 20:21:51,882 - INFO - Going to convert document batch...
2025-06-10 20:21:51,882 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:21:51,883 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:21:51,954 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:21:51,996 - INFO - Finished converting document 10.1136_bmj.n534_856.pdf in 19.53 sec.
2025-06-10 20:21:52,049 - DEBUG - Snippet 10.3390_catal11080998_724_item_4: generation shape=torch.Size([1, 403])
2025-06-10 20:21:52,050 - DEBUG - Snippet 10.3390_catal11080998_724_item_4 raw docling: (tokens=57)
<formula><loc_0><loc_0><loc_500><loc_500>M e - O H ^ { + } \bullet + H _ { 2 } O \to M e - O H _ { 2 } + \bullet O H</formula><end_of_utterance>
2025-06-10 20:21:52,050 - DEBUG - Starting _parse_docling_output
2025-06-10 20:21:52,051 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>M e - O H ^ { + } \bullet + H _ { 2 } O \to M e - O H _ { 2 } + \bullet O H</formula><end_of_utterance>
2025-06-10 20:21:52,051 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:21:52,051 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>M e - O H ^ { + } \\bullet + H _ { 2 } O \\to M e - O H _ { 2 } + \\bullet O H</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=816x65 at 0x7F96A9912F30>)]
2025-06-10 20:21:52,052 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:21:52,054 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=816.0, b=65.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 75))], orig='M e - O H ^ { + } \\bullet + H _ { 2 } O \\to M e - O H _ { 2 } + \\bullet O H', text='M e - O H ^ { + } \\bullet + H _ { 2 } O \\to M e - O H _ { 2 } + \\bullet O H', formatting=None, hyperlink=None)]
2025-06-10 20:21:52,054 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:21:52,054 - DEBUG - Processing text item: label=formula, text=M e - O H ^ { + } \bullet + H _ { 2 } O \to M e - O H _ { 2 } + \bullet O H
2025-06-10 20:21:52,055 - DEBUG - Recognized string extracted: M e - O H ^ { + } \bullet + H _ { 2 } O \to M e - O H _ { 2 } + \bullet O H
2025-06-10 20:21:52,055 - INFO - All done. Returning 5 recognized text results.
2025-06-10 20:21:52,055 - DEBUG - Snippet 10.3390_catal11080998_724_item_0 recognized text:
H O _ { 3 } \bullet \to H O _ { \bullet } + O _ { 2 }
2025-06-10 20:21:52,055 - DEBUG - Snippet 10.3390_catal11080998_724_item_1 recognized text:
\bullet + P \to end \, p r o d u c t s
2025-06-10 20:21:52,056 - DEBUG - Snippet 10.3390_catal11080998_724_item_2 recognized text:
O _ { 3 } + M e - O H _ { 2 } ^ { + } \to M e - O H ^ { + } \bullet + H O _ { 3 } \bullet
2025-06-10 20:21:52,056 - DEBUG - Snippet 10.3390_catal11080998_724_item_3 recognized text:
2 O _ { 3 } + M e - O H \to M e - O _ { 2 } ^ { - } \bullet + H O _ { 3 } \bullet + O _ { 2 }
2025-06-10 20:21:52,056 - DEBUG - Snippet 10.3390_catal11080998_724_item_4 recognized text:
M e - O H ^ { + } \bullet + H _ { 2 } O \to M e - O H _ { 2 } + \bullet O H
2025-06-10 20:21:52,061 - INFO - Starting prediction for 2 images with labels: ['formula', 'formula']
2025-06-10 20:21:52,061 - DEBUG - Generating chat message for label: formula
2025-06-10 20:21:52,062 - DEBUG - Snippet 10.3390_catal11080998_724_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:21:52,110 - INFO - Extraction successful row 175, tokens=21701
2025-06-10 20:21:52,131 - DEBUG - Snippet 10.3390_catal11080998_724_item_0 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:21:52,138 - INFO - Going to convert document batch...
2025-06-10 20:21:52,138 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:21:52,138 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:21:52,185 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:21:52,352 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:52,692 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:21:52,735 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:52,749 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:21:52,755 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:21:52,757 - DEBUG - [Page 20] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:52,918 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:52,934 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:21:52,983 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:21:52,990 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:21:53,079 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:53,222 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:21:53,224 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:21:53,224 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:21:53,287 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:53,329 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:53,349 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:53,373 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:21:53,377 - DEBUG - Snippet 10.1371_journal.pone.0066403_859_item_0: generation shape=torch.Size([1, 445])
2025-06-10 20:21:53,379 - DEBUG - Snippet 10.1371_journal.pone.0066403_859_item_0 raw docling: (tokens=99)
<formula><loc_0><loc_0><loc_500><loc_500>L o g \, E [ Y _ { t } ] = \alpha + c b ( T C , 5 , l a g , 3 ) + s ( D O Y , d f = 4 / y e a r ) \\ + \beta _ { 1 } * D O W + \beta _ { 2 } * P H + C O V s</formula><end_of_utterance>
2025-06-10 20:21:53,379 - DEBUG - Starting _parse_docling_output
2025-06-10 20:21:53,380 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>L o g \, E [ Y _ { t } ] = \alpha + c b ( T C , 5 , l a g , 3 ) + s ( D O Y , d f = 4 / y e a r ) \\ + \beta _ { 1 } * D O W + \beta _ { 2 } * P H + C O V s</formula><end_of_utterance>
2025-06-10 20:21:53,380 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:21:53,380 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>L o g \\, E [ Y _ { t } ] = \\alpha + c b ( T C , 5 , l a g , 3 ) + s ( D O Y , d f = 4 / y e a r ) \\\\ + \\beta _ { 1 } * D O W + \\beta _ { 2 } * P H + C O V s</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=606x128 at 0x7F96D6D22A80>)]
2025-06-10 20:21:53,381 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:21:53,384 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=606.0, b=128.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 156))], orig='L o g \\, E [ Y _ { t } ] = \\alpha + c b ( T C , 5 , l a g , 3 ) + s ( D O Y , d f = 4 / y e a r ) \\\\ + \\beta _ { 1 } * D O W + \\beta _ { 2 } * P H + C O V s', text='L o g \\, E [ Y _ { t } ] = \\alpha + c b ( T C , 5 , l a g , 3 ) + s ( D O Y , d f = 4 / y e a r ) \\\\ + \\beta _ { 1 } * D O W + \\beta _ { 2 } * P H + C O V s', formatting=None, hyperlink=None)]
2025-06-10 20:21:53,385 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:21:53,385 - DEBUG - Processing text item: label=formula, text=L o g \, E [ Y _ { t } ] = \alpha + c b ( T C , 5 , l a g , 3 ) + s ( D O Y , d f = 4 / y e a r ) \\ + \beta _ { 1 } * D O W + \beta _ { 2 } * P H + C O V s
2025-06-10 20:21:53,385 - DEBUG - Recognized string extracted: L o g \, E [ Y _ { t } ] = \alpha + c b ( T C , 5 , l a g , 3 ) + s ( D O Y , d f = 4 / y e a r ) \\ + \beta _ { 1 } * D O W + \beta _ { 2 } * P H + C O V s
2025-06-10 20:21:53,385 - INFO - All done. Returning 1 recognized text results.
2025-06-10 20:21:53,385 - DEBUG - Snippet 10.1371_journal.pone.0066403_859_item_0 recognized text:
L o g \, E [ Y _ { t } ] = \alpha + c b ( T C , 5 , l a g , 3 ) + s ( D O Y , d f = 4 / y e a r ) \\ + \beta _ { 1 } * D O W + \beta _ { 2 } * P H + C O V s
2025-06-10 20:21:53,411 - DEBUG - [Page 21] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:53,462 - INFO - Finished converting document 10.1371_journal.pone.0066403_859.pdf in 19.30 sec.
2025-06-10 20:21:53,551 - INFO - Extraction successful row 176, tokens=14868
2025-06-10 20:21:53,559 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:21:53,559 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:21:53,559 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:21:53,578 - INFO - Going to convert document batch...
2025-06-10 20:21:53,578 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:21:53,579 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:21:53,595 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:53,632 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:53,634 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:21:53,670 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:21:53,677 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:21:53,715 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:53,722 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:21:53,750 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:21:53,758 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:53,798 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:21:53,802 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:53,847 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:53,894 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:53,930 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:21:53,952 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:53,962 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:53,963 - DEBUG - Finished converting page batch time=4073.296
2025-06-10 20:21:53,969 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:21:54,012 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:21:54,043 - DEBUG - [Page 22] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:54,055 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:21:54,135 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:21:54,207 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:21:54,234 - DEBUG - Snippet 10.3390_catal11080998_724_item_0: generation shape=torch.Size([1, 421])
2025-06-10 20:21:54,235 - DEBUG - Snippet 10.3390_catal11080998_724_item_0 raw docling: (tokens=75)
<formula><loc_0><loc_0><loc_500><loc_500>M e - O _ { 2 } ^ { - } \bullet + O _ { 3 } + H _ { 2 } O \to M e - O H + O _ { 2 } + H O _ { 3 } \bullet</formula><end_of_utterance>
2025-06-10 20:21:54,235 - DEBUG - Starting _parse_docling_output
2025-06-10 20:21:54,235 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>M e - O _ { 2 } ^ { - } \bullet + O _ { 3 } + H _ { 2 } O \to M e - O H + O _ { 2 } + H O _ { 3 } \bullet</formula><end_of_utterance>
2025-06-10 20:21:54,235 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:21:54,236 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>M e - O _ { 2 } ^ { - } \\bullet + O _ { 3 } + H _ { 2 } O \\to M e - O H + O _ { 2 } + H O _ { 3 } \\bullet</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=879x72 at 0x7F96A6125760>)]
2025-06-10 20:21:54,236 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:21:54,238 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=879.0, b=72.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 105))], orig='M e - O _ { 2 } ^ { - } \\bullet + O _ { 3 } + H _ { 2 } O \\to M e - O H + O _ { 2 } + H O _ { 3 } \\bullet', text='M e - O _ { 2 } ^ { - } \\bullet + O _ { 3 } + H _ { 2 } O \\to M e - O H + O _ { 2 } + H O _ { 3 } \\bullet', formatting=None, hyperlink=None)]
2025-06-10 20:21:54,239 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:21:54,239 - DEBUG - Processing text item: label=formula, text=M e - O _ { 2 } ^ { - } \bullet + O _ { 3 } + H _ { 2 } O \to M e - O H + O _ { 2 } + H O _ { 3 } \bullet
2025-06-10 20:21:54,239 - DEBUG - Recognized string extracted: M e - O _ { 2 } ^ { - } \bullet + O _ { 3 } + H _ { 2 } O \to M e - O H + O _ { 2 } + H O _ { 3 } \bullet
2025-06-10 20:21:54,239 - DEBUG - Generating chat message for label: formula
2025-06-10 20:21:54,240 - DEBUG - Snippet 10.3390_catal11080998_724_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:21:54,280 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:21:54,303 - DEBUG - Snippet 10.3390_catal11080998_724_item_1 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:21:54,331 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:21:54,337 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:21:54,408 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:21:54,596 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:54,607 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:21:54,612 - INFO - Processing document 10.1136_bmjopen-2019-034854_880.pdf
2025-06-10 20:21:54,662 - DEBUG - [Page 23] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:54,668 - DEBUG - Finished converting page batch time=4074.001
2025-06-10 20:21:54,750 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:54,766 - DEBUG - [Page 14] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:54,791 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:21:54,903 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:21:54,904 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:21:54,904 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:21:54,985 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:55,005 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:21:55,005 - INFO - Processing document 10.1016_j.chest.2021.07.2170_889.pdf
2025-06-10 20:21:55,021 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:55,057 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:21:55,099 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:21:55,111 - DEBUG - Finished converting page batch time=4074.443
2025-06-10 20:21:55,121 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:55,139 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:55,172 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:21:55,319 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:55,356 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:21:55,494 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:55,520 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:21:55,590 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:55,620 - DEBUG - Snippet 10.3390_catal11080998_724_item_1: generation shape=torch.Size([1, 390])
2025-06-10 20:21:55,621 - DEBUG - Snippet 10.3390_catal11080998_724_item_1 raw docling: (tokens=44)
<formula><loc_0><loc_0><loc_500><loc_500>H O _ { 3 } \bullet \rightarrow \bullet O H + O _ { 2 }</formula><end_of_utterance>
2025-06-10 20:21:55,621 - DEBUG - Starting _parse_docling_output
2025-06-10 20:21:55,622 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>H O _ { 3 } \bullet \rightarrow \bullet O H + O _ { 2 }</formula><end_of_utterance>
2025-06-10 20:21:55,622 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:21:55,622 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>H O _ { 3 } \\bullet \\rightarrow \\bullet O H + O _ { 2 }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=703x61 at 0x7F96A6125E50>)]
2025-06-10 20:21:55,622 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:21:55,624 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=703.0, b=61.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 55))], orig='H O _ { 3 } \\bullet \\rightarrow \\bullet O H + O _ { 2 }', text='H O _ { 3 } \\bullet \\rightarrow \\bullet O H + O _ { 2 }', formatting=None, hyperlink=None)]
2025-06-10 20:21:55,625 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:21:55,625 - DEBUG - Processing text item: label=formula, text=H O _ { 3 } \bullet \rightarrow \bullet O H + O _ { 2 }
2025-06-10 20:21:55,625 - DEBUG - Recognized string extracted: H O _ { 3 } \bullet \rightarrow \bullet O H + O _ { 2 }
2025-06-10 20:21:55,625 - INFO - All done. Returning 2 recognized text results.
2025-06-10 20:21:55,626 - DEBUG - Snippet 10.3390_catal11080998_724_item_0 recognized text:
M e - O _ { 2 } ^ { - } \bullet + O _ { 3 } + H _ { 2 } O \to M e - O H + O _ { 2 } + H O _ { 3 } \bullet
2025-06-10 20:21:55,626 - DEBUG - Snippet 10.3390_catal11080998_724_item_1 recognized text:
H O _ { 3 } \bullet \rightarrow \bullet O H + O _ { 2 }
2025-06-10 20:21:55,666 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:55,673 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:21:55,679 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:55,881 - DEBUG - [Page 15] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:55,882 - DEBUG - Finished converting page batch time=4075.215
2025-06-10 20:21:55,942 - INFO - Finished converting document 10.3390_catal11080998_724.pdf in 112.61 sec.
2025-06-10 20:21:55,951 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:21:56,036 - DEBUG - [Page 24] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:56,131 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:21:56,132 - INFO - Processing document 10.3390_ijerph17062130_897.pdf
2025-06-10 20:21:56,202 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:56,401 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:56,557 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:56,558 - DEBUG - Finished converting page batch time=4075.891
2025-06-10 20:21:56,625 - DEBUG - [Page 25] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:56,661 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:56,948 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:56,949 - DEBUG - Finished converting page batch time=4076.282
2025-06-10 20:21:57,015 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:57,031 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:57,050 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:57,207 - INFO - Extraction successful row 146, tokens=71319
2025-06-10 20:21:57,225 - INFO - Going to convert document batch...
2025-06-10 20:21:57,226 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:21:57,226 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:21:57,251 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:57,275 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:21:57,286 - DEBUG - [Page 26] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:57,448 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:57,540 - DEBUG - [Page 16] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:57,694 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:57,711 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:57,723 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:57,891 - DEBUG - [Page 27] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:57,892 - DEBUG - Finished converting page batch time=4077.224
2025-06-10 20:21:57,955 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:58,101 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:58,226 - DEBUG - Dynamic vertical threshold: 38.87100000000005, Overlap threshold: 0.7
2025-06-10 20:21:58,227 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:58,227 - DEBUG - Finished converting page batch time=4077.560
2025-06-10 20:21:58,235 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:21:58,281 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:21:58,287 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:21:58,325 - DEBUG - Finished converting page batch time=4077.657
2025-06-10 20:21:58,510 - DEBUG - [Page 28] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:58,606 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:58,618 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:58,690 - DEBUG - [Page 17] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:58,849 - DEBUG - [Page 29] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:58,850 - DEBUG - Finished converting page batch time=4078.182
2025-06-10 20:21:58,868 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:58,945 - DEBUG - Dynamic vertical threshold: 78.51960000000003, Overlap threshold: 0.7
2025-06-10 20:21:58,945 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:58,951 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:21:58,952 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:21:58,952 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:21:58,981 - DEBUG - [Page 18] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:58,981 - DEBUG - Finished converting page batch time=4078.314
2025-06-10 20:21:58,990 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:59,028 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:59,033 - DEBUG - Finished converting page batch time=4078.365
2025-06-10 20:21:59,052 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:59,087 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:21:59,124 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:21:59,131 - INFO - Finished converting document 10.3390_atmos7120158_852.pdf in 27.73 sec.
2025-06-10 20:21:59,164 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:59,165 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:59,189 - INFO - Finished converting document 10.1183_16000617.0242-2020_866.pdf in 23.64 sec.
2025-06-10 20:21:59,202 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:21:59,341 - DEBUG - Finished converting page batch time=4078.673
2025-06-10 20:21:59,369 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:59,413 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:21:59,421 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:59,426 - INFO - Extraction successful row 177, tokens=31901
2025-06-10 20:21:59,451 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:21:59,457 - INFO - Going to convert document batch...
2025-06-10 20:21:59,458 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:21:59,458 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:21:59,508 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:21:59,515 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:59,621 - INFO - Extraction successful row 174, tokens=38353
2025-06-10 20:21:59,622 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:21:59,668 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:59,783 - INFO - Going to convert document batch...
2025-06-10 20:21:59,783 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:21:59,783 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:21:59,940 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:21:59,969 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:22:00,160 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:22:00,160 - INFO - Processing document 10.1214_14-aoas754_900.pdf
2025-06-10 20:22:00,208 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:00,242 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:22:00,287 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:22:00,293 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:21:58,237 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:58,352 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:58,392 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:21:58,398 - DEBUG - [Page 14] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:58,435 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:21:58,441 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:21:58,531 - DEBUG - [Page 14] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:58,631 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:21:58,632 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:21:58,632 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:21:58,656 - DEBUG - [Page 15] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:58,657 - DEBUG - Finished converting page batch time=4080.194
2025-06-10 20:21:58,667 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:58,705 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:58,740 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:21:58,790 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:21:58,828 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:58,864 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:21:58,930 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:21:58,930 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:21:58,931 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:21:58,964 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:58,991 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:58,998 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:59,027 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:21:59,035 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:21:59,065 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:21:59,076 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:21:59,116 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:59,165 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:21:59,224 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:59,229 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:21:59,318 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:21:59,352 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:59,366 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:21:59,405 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:59,409 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:21:59,508 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:59,538 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:21:59,571 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:21:59,583 - DEBUG - [Page 15] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:59,584 - DEBUG - Finished converting page batch time=4081.120
2025-06-10 20:21:59,725 - DEBUG - [Page 16] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:59,725 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:21:59,726 - INFO - Processing document 10.3390_su9040559_910.pdf
2025-06-10 20:21:59,802 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:21:59,803 - DEBUG - Finished converting page batch time=4081.340
2025-06-10 20:21:59,898 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:22:00,080 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:22:00,080 - INFO - Processing document 10.5194_acp-20-7509-2020_912.pdf
2025-06-10 20:22:00,157 - DEBUG - Dynamic vertical threshold: 67.7592, Overlap threshold: 0.7
2025-06-10 20:22:00,157 - DEBUG - Checking merge:
  Current: 4, Next: 5
2025-06-10 20:22:00,158 - DEBUG -   Vertical gap: 37.749000000000024, Overlap ratio: 0.9999945238786272
2025-06-10 20:22:00,158 - DEBUG -   Left boundary diff: 0.0020000000000095497, Right boundary diff: 53.04199999999997
2025-06-10 20:22:00,158 - DEBUG -   Alignment factor (ratio): 0.18181132644596928
2025-06-10 20:22:00,158 - DEBUG -   -> c1 4 formula number: 2, c2 5 formula number: 3
2025-06-10 20:22:00,159 - DEBUG -   -> Not merging clusters 4 and 5 due to different formula numbers: 2 vs 3
2025-06-10 20:22:00,159 - DEBUG - Checking merge:
  Current: 5, Next: 6
2025-06-10 20:22:00,159 - DEBUG -   Vertical gap: 61.955999999999904, Overlap ratio: 1.0
2025-06-10 20:22:00,159 - DEBUG -   Left boundary diff: 0.0, Right boundary diff: 28.680000000000007
2025-06-10 20:22:00,159 - DEBUG -   Alignment factor (ratio): 0.09436631767361364
2025-06-10 20:22:00,159 - DEBUG -   -> c1 5 formula number: 3, c2 6 formula number: 4
2025-06-10 20:22:00,160 - DEBUG -   -> Not merging clusters 5 and 6 due to different formula numbers: 3 vs 4
2025-06-10 20:22:00,160 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:00,213 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:00,454 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:00,455 - DEBUG - Finished converting page batch time=4081.991
2025-06-10 20:22:00,481 - DEBUG - Dynamic vertical threshold: 54.482400000000055, Overlap threshold: 0.7
2025-06-10 20:22:00,481 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:00,533 - DEBUG - [Page 17] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:00,663 - DEBUG - [Page 16] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:00,680 - DEBUG - Creating masked image for page 3 with 34 clusters.
2025-06-10 20:22:00,682 - INFO - Masked image successfully created for page 3.
2025-06-10 20:22:00,686 - INFO - Starting prediction for 1 images with labels: ['formula']
2025-06-10 20:22:00,686 - DEBUG - Generating chat message for label: formula
2025-06-10 20:22:00,686 - DEBUG - Snippet 10.1136_bmjopen-2019-034854_880_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:22:00,744 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:00,821 - DEBUG - Snippet 10.1136_bmjopen-2019-034854_880_item_0 => input_ids shape=torch.Size([1, 610]), prompt_len=610
2025-06-10 20:22:00,854 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:00,877 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:00,890 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:00,946 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:01,164 - DEBUG - [Page 18] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:01,529 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:01,555 - DEBUG - Dynamic vertical threshold: 61.418699999999944, Overlap threshold: 0.7
2025-06-10 20:22:01,555 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:01,556 - DEBUG - Finished converting page batch time=4083.093
2025-06-10 20:22:01,571 - DEBUG - Finished converting page batch time=4083.107
2025-06-10 20:22:01,646 - DEBUG - [Page 17] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:01,680 - DEBUG - [Page 19] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:01,680 - DEBUG - Finished converting page batch time=4083.217
2025-06-10 20:22:02,109 - DEBUG - Dynamic vertical threshold: 83.08080000000001, Overlap threshold: 0.7
2025-06-10 20:22:02,110 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:02,204 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:02,287 - DEBUG - [Page 20] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:02,312 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:02,487 - DEBUG - Dynamic vertical threshold: 34.51499999999992, Overlap threshold: 0.7
2025-06-10 20:22:02,488 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:02,599 - DEBUG - Dynamic vertical threshold: 59.25419999999997, Overlap threshold: 0.7
2025-06-10 20:22:02,600 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:02,600 - DEBUG - Finished converting page batch time=4084.137
2025-06-10 20:22:02,645 - DEBUG - [Page 18] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:02,798 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:02,904 - DEBUG - [Page 21] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:02,915 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:03,121 - DEBUG - Snippet 10.1136_bmjopen-2019-034854_880_item_0: generation shape=torch.Size([1, 687])
2025-06-10 20:22:03,122 - DEBUG - Snippet 10.1136_bmjopen-2019-034854_880_item_0 raw docling: (tokens=76)
<formula><loc_0><loc_0><loc_500><loc_500>\dot { \mu } \pm \vec { k } - 2 \sqrt { \left [ \vec { \tau } ^ { 2 } + \widehat { S E ( \dot { \mu } ) } ^ { 2 } \right ] }</formula><end_of_utterance>
2025-06-10 20:22:03,123 - DEBUG - Starting _parse_docling_output
2025-06-10 20:22:03,123 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>\dot { \mu } \pm \vec { k } - 2 \sqrt { \left [ \vec { \tau } ^ { 2 } + \widehat { S E ( \dot { \mu } ) } ^ { 2 } \right ] }</formula><end_of_utterance>
2025-06-10 20:22:03,123 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:22:03,124 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>\\dot { \\mu } \\pm \\vec { k } - 2 \\sqrt { \\left [ \\vec { \\tau } ^ { 2 } + \\widehat { S E ( \\dot { \\mu } ) } ^ { 2 } \\right ] }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=534x195 at 0x7F96D1DB7A10>)]
2025-06-10 20:22:03,124 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:22:03,127 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=534.0, b=195.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 124))], orig='\\dot { \\mu } \\pm \\vec { k } - 2 \\sqrt { \\left [ \\vec { \\tau } ^ { 2 } + \\widehat { S E ( \\dot { \\mu } ) } ^ { 2 } \\right ] }', text='\\dot { \\mu } \\pm \\vec { k } - 2 \\sqrt { \\left [ \\vec { \\tau } ^ { 2 } + \\widehat { S E ( \\dot { \\mu } ) } ^ { 2 } \\right ] }', formatting=None, hyperlink=None)]
2025-06-10 20:22:03,128 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:22:03,128 - DEBUG - Processing text item: label=formula, text=\dot { \mu } \pm \vec { k } - 2 \sqrt { \left [ \vec { \tau } ^ { 2 } + \widehat { S E ( \dot { \mu } ) } ^ { 2 } \right ] }
2025-06-10 20:22:03,128 - DEBUG - Recognized string extracted: \dot { \mu } \pm \vec { k } - 2 \sqrt { \left [ \vec { \tau } ^ { 2 } + \widehat { S E ( \dot { \mu } ) } ^ { 2 } \right ] }
2025-06-10 20:22:03,128 - INFO - All done. Returning 1 recognized text results.
2025-06-10 20:22:03,129 - DEBUG - Snippet 10.1136_bmjopen-2019-034854_880_item_0 recognized text:
\dot { \mu } \pm \vec { k } - 2 \sqrt { \left [ \vec { \tau } ^ { 2 } + \widehat { S E ( \dot { \mu } ) } ^ { 2 } \right ] }
2025-06-10 20:22:03,218 - INFO - Finished converting document 10.1136_bmjopen-2019-034854_880.pdf in 13.56 sec.
2025-06-10 20:22:03,223 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:03,303 - INFO - Extraction successful row 181, tokens=10765
2025-06-10 20:22:03,324 - INFO - Going to convert document batch...
2025-06-10 20:22:03,324 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:22:03,325 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:22:03,458 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:03,467 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:22:03,707 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:03,708 - DEBUG - Finished converting page batch time=4085.245
2025-06-10 20:22:03,912 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:04,093 - DEBUG - [Page 22] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:04,148 - DEBUG - Dynamic vertical threshold: 68.56380000000001, Overlap threshold: 0.7
2025-06-10 20:22:04,149 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:04,213 - DEBUG - Finished converting page batch time=4085.749
2025-06-10 20:22:04,248 - DEBUG - [Page 14] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:04,260 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:22:04,313 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 200 1267
2025-06-10 20:22:04,319 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:22:04,582 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:04,654 - DEBUG - [Page 23] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:04,660 - DEBUG - Finished converting page batch time=4086.197
2025-06-10 20:22:04,866 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:04,887 - DEBUG - [Page 19] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:04,893 - DEBUG - Finished converting page batch time=4086.429
2025-06-10 20:22:04,944 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:22:04,946 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:22:04,947 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:22:04,985 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:22:05,025 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:22:05,057 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:05,058 - DEBUG - Finished converting page batch time=4086.594
2025-06-10 20:22:05,059 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:22:05,084 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:05,098 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:22:05,135 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-06-10 20:22:05,166 - DEBUG - [Page 15] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:05,167 - DEBUG - Finished converting page batch time=4086.703
2025-06-10 20:22:05,199 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-10 20:22:05,202 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:05,253 - DEBUG - [Page 16] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:05,346 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 200 0
2025-06-10 20:22:05,356 - DEBUG - [Page 24] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:05,388 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 200 0
2025-06-10 20:22:05,423 - DEBUG - [Page 17] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:05,466 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-10 20:22:05,615 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 200 0
2025-06-10 20:22:05,784 - DEBUG - [Page 25] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:05,856 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:05,857 - DEBUG - Finished converting page batch time=4087.394
2025-06-10 20:22:05,893 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 200 0
2025-06-10 20:22:06,173 - DEBUG - [Page 26] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:06,332 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:22:06,333 - INFO - Processing document 10.3390_ijerph8104013_917.pdf
2025-06-10 20:22:06,379 - DEBUG - [Page 18] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:06,493 - DEBUG - [Page 20] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:06,494 - DEBUG - Finished converting page batch time=4088.030
2025-06-10 20:22:06,498 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:06,542 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:06,548 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:06,651 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:06,694 - DEBUG - [Page 27] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:06,695 - DEBUG - Finished converting page batch time=4088.231
2025-06-10 20:22:06,787 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:07,106 - DEBUG - [Page 19] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:07,107 - DEBUG - Finished converting page batch time=4088.643
2025-06-10 20:22:07,165 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:07,183 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:07,183 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:07,184 - DEBUG - Finished converting page batch time=4088.720
2025-06-10 20:22:07,184 - DEBUG - Finished converting page batch time=4088.721
2025-06-10 20:22:07,248 - DEBUG - [Page 28] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:07,386 - DEBUG - Creating masked image for page 3 with 14 clusters.
2025-06-10 20:22:07,388 - INFO - Masked image successfully created for page 3.
2025-06-10 20:22:07,392 - INFO - Starting prediction for 1 images with labels: ['formula']
2025-06-10 20:22:07,392 - DEBUG - Generating chat message for label: formula
2025-06-10 20:22:07,393 - DEBUG - Snippet 10.3390_ijerph17062130_897_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:22:07,421 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:07,436 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:07,459 - DEBUG - Snippet 10.3390_ijerph17062130_897_item_0 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:22:07,492 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:07,508 - DEBUG - [Page 20] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:07,695 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:07,882 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:07,932 - DEBUG - [Page 21] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:08,244 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:08,245 - DEBUG - Finished converting page batch time=4089.782
2025-06-10 20:22:08,295 - DEBUG - [Page 22] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:08,296 - DEBUG - Finished converting page batch time=4089.833
2025-06-10 20:22:08,415 - DEBUG - Creating masked image for page 4 with 11 clusters.
2025-06-10 20:22:08,417 - INFO - Masked image successfully created for page 4.
2025-06-10 20:22:08,513 - DEBUG - Creating masked image for page 5 with 12 clusters.
2025-06-10 20:22:08,514 - INFO - Masked image successfully created for page 5.
2025-06-10 20:22:08,517 - DEBUG - [Page 29] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:08,526 - INFO - Starting prediction for 5 images with labels: ['formula', 'formula', 'formula', 'formula', 'formula']
2025-06-10 20:22:08,526 - DEBUG - Generating chat message for label: formula
2025-06-10 20:22:08,527 - DEBUG - Snippet 10.1214_14-aoas754_900_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:22:08,601 - DEBUG - Snippet 10.1214_14-aoas754_900_item_0 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:22:08,844 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:08,845 - DEBUG - Finished converting page batch time=4090.381
2025-06-10 20:22:09,026 - DEBUG - [Page 30] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:09,193 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:09,195 - DEBUG - Finished converting page batch time=4090.731
2025-06-10 20:22:09,321 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:09,491 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:09,517 - DEBUG - [Page 31] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:09,518 - DEBUG - Finished converting page batch time=4091.054
2025-06-10 20:22:09,739 - DEBUG - [Page 32] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:09,739 - DEBUG - Finished converting page batch time=4091.276
2025-06-10 20:22:09,764 - DEBUG - Snippet 10.3390_ijerph17062130_897_item_0: generation shape=torch.Size([1, 429])
2025-06-10 20:22:09,765 - DEBUG - Snippet 10.3390_ijerph17062130_897_item_0 raw docling: (tokens=83)
<formula><loc_0><loc_0><loc_500><loc_500>E R = \left | e ^ { - \frac { \log \left ( x _ { 1 } u \right ) } { \log \left ( x _ { 1 } u \right ) } } - 1 } \right | \times 1 0 0 \%</formula><end_of_utterance>
2025-06-10 20:22:09,765 - DEBUG - Starting _parse_docling_output
2025-06-10 20:22:09,765 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>E R = \left | e ^ { - \frac { \log \left ( x _ { 1 } u \right ) } { \log \left ( x _ { 1 } u \right ) } } - 1 } \right | \times 1 0 0 \%</formula><end_of_utterance>
2025-06-10 20:22:09,765 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:22:09,765 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>E R = \\left | e ^ { - \\frac { \\log \\left ( x _ { 1 } u \\right ) } { \\log \\left ( x _ { 1 } u \\right ) } } - 1 } \\right | \\times 1 0 0 \\%</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=836x94 at 0x7F96E02BE270>)]
2025-06-10 20:22:09,766 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:22:09,768 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=836.0, b=94.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 136))], orig='E R = \\left | e ^ { - \\frac { \\log \\left ( x _ { 1 } u \\right ) } { \\log \\left ( x _ { 1 } u \\right ) } } - 1 } \\right | \\times 1 0 0 \\%', text='E R = \\left | e ^ { - \\frac { \\log \\left ( x _ { 1 } u \\right ) } { \\log \\left ( x _ { 1 } u \\right ) } } - 1 } \\right | \\times 1 0 0 \\%', formatting=None, hyperlink=None)]
2025-06-10 20:22:09,769 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:22:09,769 - DEBUG - Processing text item: label=formula, text=E R = \left | e ^ { - \frac { \log \left ( x _ { 1 } u \right ) } { \log \left ( x _ { 1 } u \right ) } } - 1 } \right | \times 1 0 0 \%
2025-06-10 20:22:09,769 - DEBUG - Recognized string extracted: E R = \left | e ^ { - \frac { \log \left ( x _ { 1 } u \right ) } { \log \left ( x _ { 1 } u \right ) } } - 1 } \right | \times 1 0 0 \%
2025-06-10 20:22:09,769 - INFO - All done. Returning 1 recognized text results.
2025-06-10 20:22:09,770 - DEBUG - Snippet 10.3390_ijerph17062130_897_item_0 recognized text:
E R = \left | e ^ { - \frac { \log \left ( x _ { 1 } u \right ) } { \log \left ( x _ { 1 } u \right ) } } - 1 } \right | \times 1 0 0 \%
2025-06-10 20:22:09,800 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:09,861 - INFO - Finished converting document 10.3390_ijerph17062130_897.pdf in 18.51 sec.
2025-06-10 20:22:09,937 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:09,941 - INFO - Finished converting document 10.3390_ijerph111111772_873.pdf in 25.05 sec.
2025-06-10 20:22:09,949 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:09,970 - INFO - Extraction successful row 183, tokens=15933
2025-06-10 20:22:10,020 - INFO - Going to convert document batch...
2025-06-10 20:22:10,021 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:22:10,021 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:22:10,080 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 200 1267
2025-06-10 20:22:10,240 - INFO - Extraction successful row 179, tokens=44998
2025-06-10 20:22:10,265 - INFO - Going to convert document batch...
2025-06-10 20:22:10,265 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:22:10,265 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:22:10,289 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 429 3243
2025-06-10 20:22:10,558 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:10,612 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:10,614 - DEBUG - Finished converting page batch time=4092.150
2025-06-10 20:22:10,746 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:22:10,769 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 429 3243
2025-06-10 20:22:10,770 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:22:10,908 - INFO - Finished converting document 10.1186_s12940-016-0102-7_876.pdf in 25.60 sec.
2025-06-10 20:22:11,021 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:22:11,048 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 429 3243
2025-06-10 20:22:11,049 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:22:11,186 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:11,187 - DEBUG - Finished converting page batch time=4092.724
2025-06-10 20:22:11,270 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:22:11,270 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:22:11,270 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:22:11,292 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:22:11,314 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:22:11,335 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 429 0
2025-06-10 20:22:11,348 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:11,358 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 429 0
2025-06-10 20:22:11,377 - INFO - Extraction successful row 180, tokens=20033
2025-06-10 20:22:11,386 - INFO - Finished converting document 10.1016_j.chest.2021.07.2170_889.pdf in 21.48 sec.
2025-06-10 20:22:11,390 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 429 0
2025-06-10 20:22:11,390 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:11,403 - INFO - Going to convert document batch...
2025-06-10 20:22:11,403 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:22:11,403 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:22:11,406 - DEBUG - Snippet 10.1214_14-aoas754_900_item_0: generation shape=torch.Size([1, 445])
2025-06-10 20:22:11,407 - DEBUG - Snippet 10.1214_14-aoas754_900_item_0 raw docling: (tokens=99)
<formula><loc_0><loc_0><loc_500><loc_500>f _ { c } ( x ) = \sum _ { j = 0 } ^ { M _ { 1 } } \sum _ { k = 0 } ^ { M _ { 2 } } \psi _ { j , k , c } B _ { j , k } ( x , M _ { 1 } , M _ { 2 } ) ,</formula><end_of_utterance>
2025-06-10 20:22:11,407 - DEBUG - Starting _parse_docling_output
2025-06-10 20:22:11,407 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>f _ { c } ( x ) = \sum _ { j = 0 } ^ { M _ { 1 } } \sum _ { k = 0 } ^ { M _ { 2 } } \psi _ { j , k , c } B _ { j , k } ( x , M _ { 1 } , M _ { 2 } ) ,</formula><end_of_utterance>
2025-06-10 20:22:11,408 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:22:11,408 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>f _ { c } ( x ) = \\sum _ { j = 0 } ^ { M _ { 1 } } \\sum _ { k = 0 } ^ { M _ { 2 } } \\psi _ { j , k , c } B _ { j , k } ( x , M _ { 1 } , M _ { 2 } ) ,</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=782x167 at 0x7F96DC0EC1A0>)]
2025-06-10 20:22:11,408 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:22:11,411 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 429 0
2025-06-10 20:22:11,415 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=782.0, b=167.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 150))], orig='f _ { c } ( x ) = \\sum _ { j = 0 } ^ { M _ { 1 } } \\sum _ { k = 0 } ^ { M _ { 2 } } \\psi _ { j , k , c } B _ { j , k } ( x , M _ { 1 } , M _ { 2 } ) ,', text='f _ { c } ( x ) = \\sum _ { j = 0 } ^ { M _ { 1 } } \\sum _ { k = 0 } ^ { M _ { 2 } } \\psi _ { j , k , c } B _ { j , k } ( x , M _ { 1 } , M _ { 2 } ) ,', formatting=None, hyperlink=None)]
2025-06-10 20:22:11,415 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:22:11,415 - DEBUG - Processing text item: label=formula, text=f _ { c } ( x ) = \sum _ { j = 0 } ^ { M _ { 1 } } \sum _ { k = 0 } ^ { M _ { 2 } } \psi _ { j , k , c } B _ { j , k } ( x , M _ { 1 } , M _ { 2 } ) ,
2025-06-10 20:22:11,415 - DEBUG - Recognized string extracted: f _ { c } ( x ) = \sum _ { j = 0 } ^ { M _ { 1 } } \sum _ { k = 0 } ^ { M _ { 2 } } \psi _ { j , k , c } B _ { j , k } ( x , M _ { 1 } , M _ { 2 } ) ,
2025-06-10 20:22:11,416 - DEBUG - Generating chat message for label: formula
2025-06-10 20:22:11,416 - DEBUG - Snippet 10.1214_14-aoas754_900_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:22:11,426 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 429 3243
2025-06-10 20:22:11,491 - DEBUG - Snippet 10.1214_14-aoas754_900_item_1 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:22:11,507 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:22:11,508 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:22:11,508 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:22:11,530 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:22:11,541 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:22:11,552 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:22:11,564 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 429 0
2025-06-10 20:22:11,572 - INFO - Extraction successful row 182, tokens=27653
2025-06-10 20:22:11,573 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 429 0
2025-06-10 20:22:11,588 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 429 0
2025-06-10 20:22:11,594 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 429 0
2025-06-10 20:22:11,606 - INFO - Going to convert document batch...
2025-06-10 20:22:11,606 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:22:11,607 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:22:11,617 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 429 0
2025-06-10 20:22:11,632 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 429 3243
2025-06-10 20:22:11,638 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 429 0
2025-06-10 20:22:11,705 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:11,706 - DEBUG - Finished converting page batch time=4093.242
2025-06-10 20:22:11,739 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 429 0
2025-06-10 20:22:11,758 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:22:11,779 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 429 0
2025-06-10 20:22:11,801 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 429 0
2025-06-10 20:22:11,933 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 429 0
2025-06-10 20:22:11,945 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:11,946 - DEBUG - Finished converting page batch time=4093.482
2025-06-10 20:22:12,009 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 429 0
2025-06-10 20:22:12,125 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:22:12,146 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 429 3243
2025-06-10 20:22:12,147 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:22:12,159 - DEBUG - Creating masked image for page 3 with 13 clusters.
2025-06-10 20:22:12,160 - INFO - Masked image successfully created for page 3.
2025-06-10 20:22:12,165 - INFO - Starting prediction for 1 images with labels: ['formula']
2025-06-10 20:22:12,165 - DEBUG - Generating chat message for label: formula
2025-06-10 20:22:12,166 - DEBUG - Snippet 10.3390_su9040559_910_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:22:12,200 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:12,201 - DEBUG - Finished converting page batch time=4093.737
2025-06-10 20:22:12,203 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 429 0
2025-06-10 20:22:12,223 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:22:12,224 - INFO - Processing document 10.1088_1748-9326_abe6c4_919.pdf
2025-06-10 20:22:12,246 - DEBUG - Snippet 10.3390_su9040559_910_item_0 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:22:12,375 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:22:12,404 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 429 3243
2025-06-10 20:22:12,405 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:22:12,408 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:22:12,409 - INFO - Processing document 10.1515_acgeo-2016-0067_931.pdf
2025-06-10 20:22:12,461 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:12,634 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:12,656 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:12,763 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:22:12,764 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:22:12,764 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:22:12,785 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:22:12,811 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:22:12,833 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 429 0
2025-06-10 20:22:12,856 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 429 0
2025-06-10 20:22:12,888 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 429 0
2025-06-10 20:22:12,910 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 429 0
2025-06-10 20:22:12,965 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:22:12,965 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:22:12,965 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:22:12,987 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:22:13,009 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:22:13,024 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:22:13,030 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 429 0
2025-06-10 20:22:13,048 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 429 0
2025-06-10 20:22:13,056 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 429 0
2025-06-10 20:22:13,070 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 429 0
2025-06-10 20:22:13,078 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 429 0
2025-06-10 20:22:13,094 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:13,100 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 429 0
2025-06-10 20:22:13,139 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:13,225 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 429 0
2025-06-10 20:22:13,229 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:22:13,237 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:13,251 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 429 0
2025-06-10 20:22:13,273 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 429 0
2025-06-10 20:22:13,298 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:13,415 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 429 0
2025-06-10 20:22:13,505 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 429 0
2025-06-10 20:22:13,647 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:13,684 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 429 0
2025-06-10 20:22:13,701 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:22:13,702 - INFO - Processing document 10.13075_ijomeh.1896.00379_933.pdf
2025-06-10 20:22:13,806 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:13,807 - DEBUG - Finished converting page batch time=4095.343
2025-06-10 20:22:13,902 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:22:13,903 - INFO - Processing document 10.1007_s11869-024-01546-x_940.pdf
2025-06-10 20:22:14,138 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:14,151 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:14,317 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:14,325 - DEBUG - [Page 14] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:14,330 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:14,521 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:14,823 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:15,048 - DEBUG - Snippet 10.3390_su9040559_910_item_0: generation shape=torch.Size([1, 442])
2025-06-10 20:22:15,049 - DEBUG - Snippet 10.3390_su9040559_910_item_0 raw docling: (tokens=96)
<formula><loc_0><loc_0><loc_500><loc_500>\log [ E ( Y t ) ] = \alpha + \sum _ { i = 1 } ^ { q } \beta _ { i } ( X _ { i } ) + \sum _ { j = 1 } ^ { p } f _ { j } ( Z _ { j } , d f ) + W t ( \text {week} )</formula><end_of_utterance>
2025-06-10 20:22:15,049 - DEBUG - Starting _parse_docling_output
2025-06-10 20:22:15,049 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>\log [ E ( Y t ) ] = \alpha + \sum _ { i = 1 } ^ { q } \beta _ { i } ( X _ { i } ) + \sum _ { j = 1 } ^ { p } f _ { j } ( Z _ { j } , d f ) + W t ( \text {week} )</formula><end_of_utterance>
2025-06-10 20:22:15,049 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:22:15,050 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>\\log [ E ( Y t ) ] = \\alpha + \\sum _ { i = 1 } ^ { q } \\beta _ { i } ( X _ { i } ) + \\sum _ { j = 1 } ^ { p } f _ { j } ( Z _ { j } , d f ) + W t ( \\text {week} )</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=702x146 at 0x7F96AFBB2630>)]
2025-06-10 20:22:15,050 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:22:15,054 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=702.0, b=146.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 162))], orig='\\log [ E ( Y t ) ] = \\alpha + \\sum _ { i = 1 } ^ { q } \\beta _ { i } ( X _ { i } ) + \\sum _ { j = 1 } ^ { p } f _ { j } ( Z _ { j } , d f ) + W t ( \\text {week} )', text='\\log [ E ( Y t ) ] = \\alpha + \\sum _ { i = 1 } ^ { q } \\beta _ { i } ( X _ { i } ) + \\sum _ { j = 1 } ^ { p } f _ { j } ( Z _ { j } , d f ) + W t ( \\text {week} )', formatting=None, hyperlink=None)]
2025-06-10 20:22:15,055 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:22:15,055 - DEBUG - Processing text item: label=formula, text=\log [ E ( Y t ) ] = \alpha + \sum _ { i = 1 } ^ { q } \beta _ { i } ( X _ { i } ) + \sum _ { j = 1 } ^ { p } f _ { j } ( Z _ { j } , d f ) + W t ( \text {week} )
2025-06-10 20:22:15,055 - DEBUG - Recognized string extracted: \log [ E ( Y t ) ] = \alpha + \sum _ { i = 1 } ^ { q } \beta _ { i } ( X _ { i } ) + \sum _ { j = 1 } ^ { p } f _ { j } ( Z _ { j } , d f ) + W t ( \text {week} )
2025-06-10 20:22:15,055 - INFO - All done. Returning 1 recognized text results.
2025-06-10 20:22:15,055 - DEBUG - Snippet 10.3390_su9040559_910_item_0 recognized text:
\log [ E ( Y t ) ] = \alpha + \sum _ { i = 1 } ^ { q } \beta _ { i } ( X _ { i } ) + \sum _ { j = 1 } ^ { p } f _ { j } ( Z _ { j } , d f ) + W t ( \text {week} )
2025-06-10 20:22:15,067 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:15,068 - DEBUG - Finished converting page batch time=4096.605
2025-06-10 20:22:15,155 - INFO - Finished converting document 10.3390_su9040559_910.pdf in 17.93 sec.
2025-06-10 20:22:15,157 - INFO - Finished converting document 10.3390_ijerph8104013_917.pdf in 11.85 sec.
2025-06-10 20:22:15,160 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:15,161 - DEBUG - Finished converting page batch time=4096.697
2025-06-10 20:22:15,232 - INFO - Extraction successful row 187, tokens=11511
2025-06-10 20:22:15,235 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:15,270 - INFO - Going to convert document batch...
2025-06-10 20:22:15,271 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:22:15,271 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:22:15,297 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 429 3243
2025-06-10 20:22:15,298 - INFO - Extraction successful row 185, tokens=23760
2025-06-10 20:22:15,336 - INFO - Going to convert document batch...
2025-06-10 20:22:15,336 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:22:15,337 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:22:15,361 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 429 3243
2025-06-10 20:22:15,415 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:15,502 - DEBUG - Snippet 10.1214_14-aoas754_900_item_1: generation shape=torch.Size([1, 488])
2025-06-10 20:22:15,504 - DEBUG - Snippet 10.1214_14-aoas754_900_item_1 raw docling: (tokens=142)
<formula><loc_0><loc_0><loc_500><loc_500>\frac { \partial f _ { c } ( x ) } { \partial x _ { 1 } } = M _ { 1 } \sum _ { j = 0 } ^ { M _ { 1 } - 1 } \sum _ { k = 0 } ^ { M _ { 2 } } ( \psi _ { j + 1 , k , c } - \psi _ { j , k , c } ) B _ { j , k } ( x , M _ { 1 } - 1 , M _ { 2 } ) ,</formula><end_of_utterance>
2025-06-10 20:22:15,504 - DEBUG - Starting _parse_docling_output
2025-06-10 20:22:15,505 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>\frac { \partial f _ { c } ( x ) } { \partial x _ { 1 } } = M _ { 1 } \sum _ { j = 0 } ^ { M _ { 1 } - 1 } \sum _ { k = 0 } ^ { M _ { 2 } } ( \psi _ { j + 1 , k , c } - \psi _ { j , k , c } ) B _ { j , k } ( x , M _ { 1 } - 1 , M _ { 2 } ) ,</formula><end_of_utterance>
2025-06-10 20:22:15,512 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:22:15,512 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>\\frac { \\partial f _ { c } ( x ) } { \\partial x _ { 1 } } = M _ { 1 } \\sum _ { j = 0 } ^ { M _ { 1 } - 1 } \\sum _ { k = 0 } ^ { M _ { 2 } } ( \\psi _ { j + 1 , k , c } - \\psi _ { j , k , c } ) B _ { j , k } ( x , M _ { 1 } - 1 , M _ { 2 } ) ,</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=937x169 at 0x7F96AA476990>)]
2025-06-10 20:22:15,513 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:22:15,518 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=937.0, b=169.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 241))], orig='\\frac { \\partial f _ { c } ( x ) } { \\partial x _ { 1 } } = M _ { 1 } \\sum _ { j = 0 } ^ { M _ { 1 } - 1 } \\sum _ { k = 0 } ^ { M _ { 2 } } ( \\psi _ { j + 1 , k , c } - \\psi _ { j , k , c } ) B _ { j , k } ( x , M _ { 1 } - 1 , M _ { 2 } ) ,', text='\\frac { \\partial f _ { c } ( x ) } { \\partial x _ { 1 } } = M _ { 1 } \\sum _ { j = 0 } ^ { M _ { 1 } - 1 } \\sum _ { k = 0 } ^ { M _ { 2 } } ( \\psi _ { j + 1 , k , c } - \\psi _ { j , k , c } ) B _ { j , k } ( x , M _ { 1 } - 1 , M _ { 2 } ) ,', formatting=None, hyperlink=None)]
2025-06-10 20:22:15,519 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:22:15,519 - DEBUG - Processing text item: label=formula, text=\frac { \partial f _ { c } ( x ) } { \partial x _ { 1 } } = M _ { 1 } \sum _ { j = 0 } ^ { M _ { 1 } - 1 } \sum _ { k = 0 } ^ { M _ { 2 } } ( \psi _ { j + 1 , k , c } - \psi _ { j , k , c } ) B _ { j , k } ( x , M _ { 1 } - 1 , M _ { 2 } ) ,
2025-06-10 20:22:15,519 - DEBUG - Recognized string extracted: \frac { \partial f _ { c } ( x ) } { \partial x _ { 1 } } = M _ { 1 } \sum _ { j = 0 } ^ { M _ { 1 } - 1 } \sum _ { k = 0 } ^ { M _ { 2 } } ( \psi _ { j + 1 , k , c } - \psi _ { j , k , c } ) B _ { j , k } ( x , M _ { 1 } - 1 , M _ { 2 } ) ,
2025-06-10 20:22:15,519 - DEBUG - Generating chat message for label: formula
2025-06-10 20:22:15,520 - DEBUG - Snippet 10.1214_14-aoas754_900_item_2 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:22:15,535 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:15,559 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:15,587 - DEBUG - Snippet 10.1214_14-aoas754_900_item_2 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:22:15,646 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:15,718 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:15,846 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:15,847 - DEBUG - Finished converting page batch time=4097.383
2025-06-10 20:22:15,861 - DEBUG - [Page 15] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:15,862 - DEBUG - Finished converting page batch time=4097.398
2025-06-10 20:22:16,029 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:22:16,039 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:16,049 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 429 3243
2025-06-10 20:22:16,050 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:22:16,055 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:16,122 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:22:16,143 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 429 3243
2025-06-10 20:22:16,144 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:22:16,149 - DEBUG - [Page 16] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:16,507 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:16,737 - DEBUG - Dynamic vertical threshold: 44.215200000000145, Overlap threshold: 0.7
2025-06-10 20:22:16,738 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:16,747 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:16,748 - DEBUG - Finished converting page batch time=4098.285
2025-06-10 20:22:16,878 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:22:16,879 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:22:16,879 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:22:16,901 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:22:16,923 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:22:16,948 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:16,959 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 429 0
2025-06-10 20:22:16,981 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 429 0
2025-06-10 20:22:16,985 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:22:16,986 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:22:16,986 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:22:17,004 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 429 0
2025-06-10 20:22:17,009 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:22:17,030 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 429 0
2025-06-10 20:22:17,033 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:22:17,055 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 429 0
2025-06-10 20:22:17,076 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 429 0
2025-06-10 20:22:17,100 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 429 0
2025-06-10 20:22:17,121 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 429 0
2025-06-10 20:22:17,162 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:22:17,185 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 429 0
2025-06-10 20:22:17,206 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 429 0
2025-06-10 20:22:17,245 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:22:17,269 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 429 0
2025-06-10 20:22:17,291 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 429 0
2025-06-10 20:22:17,312 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:17,313 - DEBUG - Finished converting page batch time=4098.850
2025-06-10 20:22:17,332 - DEBUG - Dynamic vertical threshold: 27.554399999999987, Overlap threshold: 0.7
2025-06-10 20:22:17,332 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:17,350 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 429 0
2025-06-10 20:22:17,433 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 429 0
2025-06-10 20:22:17,478 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:17,645 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 429 0
2025-06-10 20:22:17,745 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 429 0
2025-06-10 20:22:17,853 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:22:17,854 - INFO - Processing document 10.1101_489518_945.pdf
2025-06-10 20:22:17,907 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:22:17,907 - INFO - Processing document 10.1101_2022.02.21.22271281_947.pdf
2025-06-10 20:22:17,924 - DEBUG - [Page 17] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:17,991 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:18,024 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:18,291 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:18,292 - DEBUG - Finished converting page batch time=4099.829
2025-06-10 20:22:18,309 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:18,329 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:18,468 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:18,469 - DEBUG - Finished converting page batch time=4100.005
2025-06-10 20:22:18,522 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:18,587 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:18,706 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:18,806 - DEBUG - [Page 18] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:18,862 - DEBUG - Snippet 10.1214_14-aoas754_900_item_2: generation shape=torch.Size([1, 451])
2025-06-10 20:22:18,863 - DEBUG - Snippet 10.1214_14-aoas754_900_item_2 raw docling: (tokens=105)
<formula><loc_0><loc_0><loc_500><loc_500>\psi _ { c } = ( \psi _ { 0 , 0 , c } , \dots , \psi _ { M _ { 1 } , 0 , c } , \psi _ { 0 , 1 , c } , \dots , \psi _ { M _ { 1 } , M _ { 2 } , c } ) ^ { T } \, .</formula><end_of_utterance>
2025-06-10 20:22:18,864 - DEBUG - Starting _parse_docling_output
2025-06-10 20:22:18,864 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>\psi _ { c } = ( \psi _ { 0 , 0 , c } , \dots , \psi _ { M _ { 1 } , 0 , c } , \psi _ { 0 , 1 , c } , \dots , \psi _ { M _ { 1 } , M _ { 2 } , c } ) ^ { T } \, .</formula><end_of_utterance>
2025-06-10 20:22:18,864 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:22:18,864 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>\\psi _ { c } = ( \\psi _ { 0 , 0 , c } , \\dots , \\psi _ { M _ { 1 } , 0 , c } , \\psi _ { 0 , 1 , c } , \\dots , \\psi _ { M _ { 1 } , M _ { 2 } , c } ) ^ { T } \\, .</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=853x79 at 0x7F96AA475310>)]
2025-06-10 20:22:18,865 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:22:18,868 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=853.0, b=79.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 161))], orig='\\psi _ { c } = ( \\psi _ { 0 , 0 , c } , \\dots , \\psi _ { M _ { 1 } , 0 , c } , \\psi _ { 0 , 1 , c } , \\dots , \\psi _ { M _ { 1 } , M _ { 2 } , c } ) ^ { T } \\, .', text='\\psi _ { c } = ( \\psi _ { 0 , 0 , c } , \\dots , \\psi _ { M _ { 1 } , 0 , c } , \\psi _ { 0 , 1 , c } , \\dots , \\psi _ { M _ { 1 } , M _ { 2 } , c } ) ^ { T } \\, .', formatting=None, hyperlink=None)]
2025-06-10 20:22:18,868 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:22:18,868 - DEBUG - Processing text item: label=formula, text=\psi _ { c } = ( \psi _ { 0 , 0 , c } , \dots , \psi _ { M _ { 1 } , 0 , c } , \psi _ { 0 , 1 , c } , \dots , \psi _ { M _ { 1 } , M _ { 2 } , c } ) ^ { T } \, .
2025-06-10 20:22:18,869 - DEBUG - Recognized string extracted: \psi _ { c } = ( \psi _ { 0 , 0 , c } , \dots , \psi _ { M _ { 1 } , 0 , c } , \psi _ { 0 , 1 , c } , \dots , \psi _ { M _ { 1 } , M _ { 2 } , c } ) ^ { T } \, .
2025-06-10 20:22:18,869 - DEBUG - Generating chat message for label: formula
2025-06-10 20:22:18,869 - DEBUG - Snippet 10.1214_14-aoas754_900_item_3 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:22:18,894 - DEBUG - [Page 14] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:18,924 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:18,936 - DEBUG - Snippet 10.1214_14-aoas754_900_item_3 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:22:18,974 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:19,251 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:19,318 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:19,318 - DEBUG - Finished converting page batch time=4100.855
2025-06-10 20:22:19,340 - DEBUG - [Page 15] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:19,341 - DEBUG - Finished converting page batch time=4100.877
2025-06-10 20:22:19,586 - DEBUG - [Page 16] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:19,645 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:19,671 - DEBUG - [Page 17] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:19,784 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:19,925 - DEBUG - [Page 18] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:20,010 - DEBUG - [Page 19] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:20,011 - DEBUG - Finished converting page batch time=4101.548
2025-06-10 20:22:20,197 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:20,264 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:20,291 - DEBUG - [Page 20] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:20,404 - DEBUG - [Page 21] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:20,477 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:20,564 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:20,753 - DEBUG - [Page 19] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:20,755 - DEBUG - Finished converting page batch time=4102.292
2025-06-10 20:22:20,993 - DEBUG - [Page 22] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:20,993 - DEBUG - Finished converting page batch time=4102.530
2025-06-10 20:22:21,051 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:21,054 - DEBUG - Finished converting page batch time=4102.590
2025-06-10 20:22:21,057 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:21,124 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:21,283 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:21,356 - DEBUG - [Page 23] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:21,357 - DEBUG - Finished converting page batch time=4102.893
2025-06-10 20:22:21,570 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:21,633 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:21,733 - DEBUG - [Page 24] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:21,817 - DEBUG - Finished converting page batch time=4103.354
2025-06-10 20:22:21,946 - DEBUG - Snippet 10.1214_14-aoas754_900_item_3: generation shape=torch.Size([1, 454])
2025-06-10 20:22:21,948 - DEBUG - Snippet 10.1214_14-aoas754_900_item_3 raw docling: (tokens=108)
<formula><loc_0><loc_0><loc_500><loc_500>B ( X _ { c } ) = [ B _ { 0 , 0 } ( X _ { c } , M _ { 1 } , M _ { 2 } ) , \dots , B _ { M _ { 1 } , M _ { 2 } } ( X _ { c } , M _ { 1 } , M _ { 2 } ) ] ^ { T } .</formula><end_of_utterance>
2025-06-10 20:22:21,948 - DEBUG - Starting _parse_docling_output
2025-06-10 20:22:21,948 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>B ( X _ { c } ) = [ B _ { 0 , 0 } ( X _ { c } , M _ { 1 } , M _ { 2 } ) , \dots , B _ { M _ { 1 } , M _ { 2 } } ( X _ { c } , M _ { 1 } , M _ { 2 } ) ] ^ { T } .</formula><end_of_utterance>
2025-06-10 20:22:21,948 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:22:21,949 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>B ( X _ { c } ) = [ B _ { 0 , 0 } ( X _ { c } , M _ { 1 } , M _ { 2 } ) , \\dots , B _ { M _ { 1 } , M _ { 2 } } ( X _ { c } , M _ { 1 } , M _ { 2 } ) ] ^ { T } .</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=912x79 at 0x7F96AA477B00>)]
2025-06-10 20:22:21,949 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:22:21,954 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=912.0, b=79.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 161))], orig='B ( X _ { c } ) = [ B _ { 0 , 0 } ( X _ { c } , M _ { 1 } , M _ { 2 } ) , \\dots , B _ { M _ { 1 } , M _ { 2 } } ( X _ { c } , M _ { 1 } , M _ { 2 } ) ] ^ { T } .', text='B ( X _ { c } ) = [ B _ { 0 , 0 } ( X _ { c } , M _ { 1 } , M _ { 2 } ) , \\dots , B _ { M _ { 1 } , M _ { 2 } } ( X _ { c } , M _ { 1 } , M _ { 2 } ) ] ^ { T } .', formatting=None, hyperlink=None)]
2025-06-10 20:22:21,954 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:22:21,954 - DEBUG - Processing text item: label=formula, text=B ( X _ { c } ) = [ B _ { 0 , 0 } ( X _ { c } , M _ { 1 } , M _ { 2 } ) , \dots , B _ { M _ { 1 } , M _ { 2 } } ( X _ { c } , M _ { 1 } , M _ { 2 } ) ] ^ { T } .
2025-06-10 20:22:21,954 - DEBUG - Recognized string extracted: B ( X _ { c } ) = [ B _ { 0 , 0 } ( X _ { c } , M _ { 1 } , M _ { 2 } ) , \dots , B _ { M _ { 1 } , M _ { 2 } } ( X _ { c } , M _ { 1 } , M _ { 2 } ) ] ^ { T } .
2025-06-10 20:22:21,954 - DEBUG - Generating chat message for label: formula
2025-06-10 20:22:21,955 - DEBUG - Snippet 10.1214_14-aoas754_900_item_4 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:22:21,957 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:22,050 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:22,056 - DEBUG - [Page 20] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:22,090 - DEBUG - Snippet 10.1214_14-aoas754_900_item_4 => input_ids shape=torch.Size([1, 610]), prompt_len=610
2025-06-10 20:22:22,095 - DEBUG - [Page 25] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:22,233 - DEBUG - [Page 21] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:22,234 - DEBUG - Finished converting page batch time=4103.770
2025-06-10 20:22:22,323 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:22,325 - DEBUG - Finished converting page batch time=4103.861
2025-06-10 20:22:22,411 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:22,455 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:22,497 - INFO - Finished converting document 10.5194_acp-20-7509-2020_912.pdf in 25.08 sec.
2025-06-10 20:22:22,517 - DEBUG - [Page 26] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:22,651 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:22,652 - DEBUG - Finished converting page batch time=4104.188
2025-06-10 20:22:22,654 - DEBUG - [Page 27] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:22,655 - DEBUG - Finished converting page batch time=4104.191
2025-06-10 20:22:22,710 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:22,710 - INFO - Extraction successful row 186, tokens=26114
2025-06-10 20:22:22,770 - INFO - Finished converting document 10.1515_acgeo-2016-0067_931.pdf in 12.53 sec.
2025-06-10 20:22:22,775 - DEBUG - Creating masked image for page 3 with 21 clusters.
2025-06-10 20:22:22,776 - INFO - Masked image successfully created for page 3.
2025-06-10 20:22:22,795 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:22,796 - INFO - Going to convert document batch...
2025-06-10 20:22:22,802 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:22:22,802 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:22:22,825 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 429 3243
2025-06-10 20:22:22,875 - DEBUG - Creating masked image for page 4 with 21 clusters.
2025-06-10 20:22:22,877 - INFO - Masked image successfully created for page 4.
2025-06-10 20:22:22,881 - INFO - Starting prediction for 2 images with labels: ['formula', 'formula']
2025-06-10 20:22:22,882 - DEBUG - Generating chat message for label: formula
2025-06-10 20:22:22,882 - DEBUG - Snippet 10.13075_ijomeh.1896.00379_933_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:22:22,955 - DEBUG - Snippet 10.13075_ijomeh.1896.00379_933_item_0 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:22:23,000 - INFO - Extraction successful row 189, tokens=16581
2025-06-10 20:22:23,023 - INFO - Going to convert document batch...
2025-06-10 20:22:23,023 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:22:23,024 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:22:23,048 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 429 3243
2025-06-10 20:22:23,140 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:23,225 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:23,226 - DEBUG - Finished converting page batch time=4104.763
2025-06-10 20:22:23,246 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:23,594 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:22:23,597 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:23,627 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 429 3243
2025-06-10 20:22:23,628 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:22:23,634 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:23,635 - DEBUG - Finished converting page batch time=4105.172
2025-06-10 20:22:23,872 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:22:23,897 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 429 3243
2025-06-10 20:22:23,898 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:22:24,135 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:24,152 - DEBUG - Finished converting page batch time=4105.688
2025-06-10 20:22:24,157 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:22:24,164 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:22:24,164 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:22:24,190 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:22:24,215 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:22:24,236 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 429 0
2025-06-10 20:22:24,258 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 429 0
2025-06-10 20:22:24,280 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 429 0
2025-06-10 20:22:24,302 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 429 0
2025-06-10 20:22:24,414 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:22:24,414 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:22:24,415 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:22:24,423 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:22:24,435 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:22:24,446 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 429 0
2025-06-10 20:22:24,457 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:22:24,468 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 429 0
2025-06-10 20:22:24,472 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:24,478 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 429 0
2025-06-10 20:22:24,498 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 429 0
2025-06-10 20:22:24,515 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:24,516 - DEBUG - Finished converting page batch time=4106.053
2025-06-10 20:22:24,535 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:24,536 - DEBUG - Finished converting page batch time=4106.073
2025-06-10 20:22:24,537 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 429 0
2025-06-10 20:22:24,560 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 429 0
2025-06-10 20:22:24,605 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 429 0
2025-06-10 20:22:24,681 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:22:24,702 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 429 0
2025-06-10 20:22:24,722 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 429 0
2025-06-10 20:22:24,743 - INFO - Finished converting document 10.1088_1748-9326_abe6c4_919.pdf in 14.77 sec.
2025-06-10 20:22:24,849 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 429 0
2025-06-10 20:22:24,876 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 429 0
2025-06-10 20:22:24,894 - INFO - Extraction successful row 188, tokens=13759
2025-06-10 20:22:24,977 - INFO - Going to convert document batch...
2025-06-10 20:22:24,978 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:22:24,978 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:22:25,005 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:25,006 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 429 3243
2025-06-10 20:22:25,092 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:22:25,092 - INFO - Processing document 10.5194_acp-15-8889-2015_961.pdf
2025-06-10 20:22:25,113 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 429 0
2025-06-10 20:22:25,293 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:22:25,293 - INFO - Processing document 10.1136_oemed-2018-icohabstracts.1265_965.pdf
2025-06-10 20:22:25,337 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:25,446 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:25,699 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:25,717 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:22:25,738 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 429 3243
2025-06-10 20:22:25,739 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:22:25,881 - DEBUG - [Page 14] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:26,339 - DEBUG - [Page 15] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:26,340 - DEBUG - Finished converting page batch time=4107.877
2025-06-10 20:22:26,520 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:22:26,520 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:22:26,520 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:22:26,529 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:26,541 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:26,543 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:22:26,568 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:22:26,590 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 429 0
2025-06-10 20:22:26,616 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 429 0
2025-06-10 20:22:26,627 - DEBUG - Snippet 10.1214_14-aoas754_900_item_4: generation shape=torch.Size([1, 770])
2025-06-10 20:22:26,628 - DEBUG - Snippet 10.1214_14-aoas754_900_item_4 raw docling: (tokens=159)
<formula><loc_0><loc_0><loc_500><loc_500>T = I _ { M + 1 } \otimes \left ( \begin{array} { c c c c c c c } 1 & 0 & 0 & \cdots & 0 & 0 \\ - 1 & 1 & 0 & \cdots & 0 & 0 \\ 0 & - 1 & 1 & \cdots & 0 & 0 \\ \vdots & \vdots & \vdots & \ddots & \vdots & \vdots \\ 0 & 0 & 0 & \cdots & - 1 & 1 \end{array} \right )</formula><end_of_utterance>
2025-06-10 20:22:26,629 - DEBUG - Starting _parse_docling_output
2025-06-10 20:22:26,629 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>T = I _ { M + 1 } \otimes \left ( \begin{array} { c c c c c c c } 1 & 0 & 0 & \cdots & 0 & 0 \\ - 1 & 1 & 0 & \cdots & 0 & 0 \\ 0 & - 1 & 1 & \cdots & 0 & 0 \\ \vdots & \vdots & \vdots & \ddots & \vdots & \vdots \\ 0 & 0 & 0 & \cdots & - 1 & 1 \end{array} \right )</formula><end_of_utterance>
2025-06-10 20:22:26,629 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:22:26,629 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>T = I _ { M + 1 } \\otimes \\left ( \\begin{array} { c c c c c c c } 1 & 0 & 0 & \\cdots & 0 & 0 \\\\ - 1 & 1 & 0 & \\cdots & 0 & 0 \\\\ 0 & - 1 & 1 & \\cdots & 0 & 0 \\\\ \\vdots & \\vdots & \\vdots & \\ddots & \\vdots & \\vdots \\\\ 0 & 0 & 0 & \\cdots & - 1 & 1 \\end{array} \\right )</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=921x336 at 0x7F96AA477560>)]
2025-06-10 20:22:26,630 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:22:26,638 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=921.0, b=336.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 264))], orig='T = I _ { M + 1 } \\otimes \\left ( \\begin{array} { c c c c c c c } 1 & 0 & 0 & \\cdots & 0 & 0 \\\\ - 1 & 1 & 0 & \\cdots & 0 & 0 \\\\ 0 & - 1 & 1 & \\cdots & 0 & 0 \\\\ \\vdots & \\vdots & \\vdots & \\ddots & \\vdots & \\vdots \\\\ 0 & 0 & 0 & \\cdots & - 1 & 1 \\end{array} \\right )', text='T = I _ { M + 1 } \\otimes \\left ( \\begin{array} { c c c c c c c } 1 & 0 & 0 & \\cdots & 0 & 0 \\\\ - 1 & 1 & 0 & \\cdots & 0 & 0 \\\\ 0 & - 1 & 1 & \\cdots & 0 & 0 \\\\ \\vdots & \\vdots & \\vdots & \\ddots & \\vdots & \\vdots \\\\ 0 & 0 & 0 & \\cdots & - 1 & 1 \\end{array} \\right )', formatting=None, hyperlink=None)]
2025-06-10 20:22:26,639 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:22:26,639 - DEBUG - Processing text item: label=formula, text=T = I _ { M + 1 } \otimes \left ( \begin{array} { c c c c c c c } 1 & 0 & 0 & \cdots & 0 & 0 \\ - 1 & 1 & 0 & \cdots & 0 & 0 \\ 0 & - 1 & 1 & \cdots & 0 & 0 \\ \vdots & \vdots & \vdots & \ddots & \vdots & \vdots \\ 0 & 0 & 0 & \cdots & - 1 & 1 \end{array} \right )
2025-06-10 20:22:26,639 - DEBUG - Recognized string extracted: T = I _ { M + 1 } \otimes \left ( \begin{array} { c c c c c c c } 1 & 0 & 0 & \cdots & 0 & 0 \\ - 1 & 1 & 0 & \cdots & 0 & 0 \\ 0 & - 1 & 1 & \cdots & 0 & 0 \\ \vdots & \vdots & \vdots & \ddots & \vdots & \vdots \\ 0 & 0 & 0 & \cdots & - 1 & 1 \end{array} \right )
2025-06-10 20:22:26,639 - INFO - All done. Returning 5 recognized text results.
2025-06-10 20:22:26,640 - DEBUG - Snippet 10.1214_14-aoas754_900_item_0 recognized text:
f _ { c } ( x ) = \sum _ { j = 0 } ^ { M _ { 1 } } \sum _ { k = 0 } ^ { M _ { 2 } } \psi _ { j , k , c } B _ { j , k } ( x , M _ { 1 } , M _ { 2 } ) ,
2025-06-10 20:22:26,640 - DEBUG - Snippet 10.1214_14-aoas754_900_item_1 recognized text:
\frac { \partial f _ { c } ( x ) } { \partial x _ { 1 } } = M _ { 1 } \sum _ { j = 0 } ^ { M _ { 1 } - 1 } \sum _ { k = 0 } ^ { M _ { 2 } } ( \psi _ { j + 1 , k , c } - \psi _ { j , k , c } ) B _ { j , k } ( x , M _ { 1 } - 1 , M _ { 2 } ) ,
2025-06-10 20:22:26,640 - DEBUG - Snippet 10.1214_14-aoas754_900_item_2 recognized text:
\psi _ { c } = ( \psi _ { 0 , 0 , c } , \dots , \psi _ { M _ { 1 } , 0 , c } , \psi _ { 0 , 1 , c } , \dots , \psi _ { M _ { 1 } , M _ { 2 } , c } ) ^ { T } \, .
2025-06-10 20:22:26,640 - DEBUG - Snippet 10.1214_14-aoas754_900_item_3 recognized text:
B ( X _ { c } ) = [ B _ { 0 , 0 } ( X _ { c } , M _ { 1 } , M _ { 2 } ) , \dots , B _ { M _ { 1 } , M _ { 2 } } ( X _ { c } , M _ { 1 } , M _ { 2 } ) ] ^ { T } .
2025-06-10 20:22:26,640 - DEBUG - Snippet 10.1214_14-aoas754_900_item_4 recognized text:
T = I _ { M + 1 } \otimes \left ( \begin{array} { c c c c c c c } 1 & 0 & 0 & \cdots & 0 & 0 \\ - 1 & 1 & 0 & \cdots & 0 & 0 \\ 0 & - 1 & 1 & \cdots & 0 & 0 \\ \vdots & \vdots & \vdots & \ddots & \vdots & \vdots \\ 0 & 0 & 0 & \cdots & - 1 & 1 \end{array} \right )
2025-06-10 20:22:26,648 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 429 0
2025-06-10 20:22:26,667 - DEBUG - Snippet 10.13075_ijomeh.1896.00379_933_item_0: generation shape=torch.Size([1, 481])
2025-06-10 20:22:26,668 - DEBUG - Snippet 10.13075_ijomeh.1896.00379_933_item_0 raw docling: (tokens=135)
<formula><loc_0><loc_0><loc_500><loc_500>R I = \frac { 1 0 0 0 } { 1 0 . 4 } ( e ^ { 0 . 0 0 0 8 7 1 \times N O _ { 2 } } + e ^ { 0 . 0 0 0 5 3 7 \times O _ { 3 } } + e ^ { 0 . 0 0 0 4 8 7 \times P M _ { 2 5 } } - 3 )</formula><end_of_utterance>
2025-06-10 20:22:26,668 - DEBUG - Starting _parse_docling_output
2025-06-10 20:22:26,669 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>R I = \frac { 1 0 0 0 } { 1 0 . 4 } ( e ^ { 0 . 0 0 0 8 7 1 \times N O _ { 2 } } + e ^ { 0 . 0 0 0 5 3 7 \times O _ { 3 } } + e ^ { 0 . 0 0 0 4 8 7 \times P M _ { 2 5 } } - 3 )</formula><end_of_utterance>
2025-06-10 20:22:26,669 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:22:26,669 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>R I = \\frac { 1 0 0 0 } { 1 0 . 4 } ( e ^ { 0 . 0 0 0 8 7 1 \\times N O _ { 2 } } + e ^ { 0 . 0 0 0 5 3 7 \\times O _ { 3 } } + e ^ { 0 . 0 0 0 4 8 7 \\times P M _ { 2 5 } } - 3 )</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=597x109 at 0x7F9715481F70>)]
2025-06-10 20:22:26,669 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:22:26,670 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 429 0
2025-06-10 20:22:26,672 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=597.0, b=109.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 176))], orig='R I = \\frac { 1 0 0 0 } { 1 0 . 4 } ( e ^ { 0 . 0 0 0 8 7 1 \\times N O _ { 2 } } + e ^ { 0 . 0 0 0 5 3 7 \\times O _ { 3 } } + e ^ { 0 . 0 0 0 4 8 7 \\times P M _ { 2 5 } } - 3 )', text='R I = \\frac { 1 0 0 0 } { 1 0 . 4 } ( e ^ { 0 . 0 0 0 8 7 1 \\times N O _ { 2 } } + e ^ { 0 . 0 0 0 5 3 7 \\times O _ { 3 } } + e ^ { 0 . 0 0 0 4 8 7 \\times P M _ { 2 5 } } - 3 )', formatting=None, hyperlink=None)]
2025-06-10 20:22:26,673 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:22:26,673 - DEBUG - Processing text item: label=formula, text=R I = \frac { 1 0 0 0 } { 1 0 . 4 } ( e ^ { 0 . 0 0 0 8 7 1 \times N O _ { 2 } } + e ^ { 0 . 0 0 0 5 3 7 \times O _ { 3 } } + e ^ { 0 . 0 0 0 4 8 7 \times P M _ { 2 5 } } - 3 )
2025-06-10 20:22:26,673 - DEBUG - Recognized string extracted: R I = \frac { 1 0 0 0 } { 1 0 . 4 } ( e ^ { 0 . 0 0 0 8 7 1 \times N O _ { 2 } } + e ^ { 0 . 0 0 0 5 3 7 \times O _ { 3 } } + e ^ { 0 . 0 0 0 4 8 7 \times P M _ { 2 5 } } - 3 )
2025-06-10 20:22:26,673 - DEBUG - Generating chat message for label: formula
2025-06-10 20:22:26,673 - DEBUG - Snippet 10.13075_ijomeh.1896.00379_933_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:22:26,743 - DEBUG - Creating masked image for page 7 with 8 clusters.
2025-06-10 20:22:26,744 - DEBUG - Snippet 10.13075_ijomeh.1896.00379_933_item_1 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:22:26,744 - INFO - Masked image successfully created for page 7.
2025-06-10 20:22:26,817 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:22:26,839 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 429 0
2025-06-10 20:22:26,840 - DEBUG - Creating masked image for page 8 with 12 clusters.
2025-06-10 20:22:26,840 - INFO - Masked image successfully created for page 8.
2025-06-10 20:22:26,850 - INFO - Starting prediction for 5 images with labels: ['formula', 'formula', 'formula', 'formula', 'formula']
2025-06-10 20:22:26,850 - DEBUG - Generating chat message for label: formula
2025-06-10 20:22:26,850 - DEBUG - Snippet 10.1214_14-aoas754_900_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:22:26,863 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 429 0
2025-06-10 20:22:26,920 - DEBUG - Snippet 10.1214_14-aoas754_900_item_0 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:22:26,988 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 429 0
2025-06-10 20:22:27,237 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:27,258 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 429 0
2025-06-10 20:22:27,278 - DEBUG - [Page 16] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:27,401 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:27,442 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:22:27,442 - INFO - Processing document 10.1525_elementa.273_967.pdf
2025-06-10 20:22:27,464 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:27,466 - DEBUG - Finished converting page batch time=4109.003
2025-06-10 20:22:27,497 - INFO - Finished converting document 10.1136_oemed-2018-icohabstracts.1265_965.pdf in 4.50 sec.
2025-06-10 20:22:27,514 - INFO - Extraction successful row 195, tokens=1499
2025-06-10 20:22:27,556 - INFO - Going to convert document batch...
2025-06-10 20:22:27,556 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 9d25fdd08172e2c174bae045f2ce9d67
2025-06-10 20:22:27,557 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:22:27,581 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.1.0 HTTP/1.1" 429 3243
2025-06-10 20:22:27,708 - DEBUG - [Page 17] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:27,723 - INFO - Finished converting document 10.1007_s11869-024-01546-x_940.pdf in 16.15 sec.
2025-06-10 20:22:27,781 - DEBUG - Dynamic vertical threshold: 22.930199999999957, Overlap threshold: 0.7
2025-06-10 20:22:27,782 - DEBUG - Checking merge:
  Current: 17, Next: 15
2025-06-10 20:22:27,782 - DEBUG -   Vertical gap: 5.079000000000008, Overlap ratio: 1.0
2025-06-10 20:22:27,783 - DEBUG -   Left boundary diff: 13.137, Right boundary diff: 0.0
2025-06-10 20:22:27,783 - DEBUG -   Alignment factor (ratio): 0.05782524776118088
2025-06-10 20:22:27,783 - DEBUG -   -> c1 17 formula number: R1, c2 15 formula number: R2
2025-06-10 20:22:27,783 - DEBUG -   -> Not merging clusters 17 and 15 due to different formula numbers: R1 vs R2
2025-06-10 20:22:27,783 - DEBUG - Checking merge:
  Current: 17, Next: 21
2025-06-10 20:22:27,784 - DEBUG -   Vertical gap: 12.043999999999983, Overlap ratio: 0.25001559497966425
2025-06-10 20:22:27,784 - DEBUG -   Left boundary diff: 240.457, Right boundary diff: 260.787
2025-06-10 20:22:27,784 - DEBUG -   Alignment factor (ratio): 1.13001936901218
2025-06-10 20:22:27,784 - DEBUG -   -> c1 17 formula number: R1, c2 21 formula number: R6
2025-06-10 20:22:27,784 - DEBUG -   -> Not merging clusters 17 and 21 due to different formula numbers: R1 vs R6
2025-06-10 20:22:27,785 - DEBUG - Checking merge:
  Current: 15, Next: 19
2025-06-10 20:22:27,785 - DEBUG -   Vertical gap: 11.045999999999992, Overlap ratio: 0.24017462015322721
2025-06-10 20:22:27,785 - DEBUG -   Left boundary diff: 253.594, Right boundary diff: 260.787
2025-06-10 20:22:27,785 - DEBUG -   Alignment factor (ratio): 1.0987467848046866
2025-06-10 20:22:27,785 - DEBUG -   -> c1 15 formula number: R2, c2 19 formula number: R7
2025-06-10 20:22:27,785 - DEBUG -   -> Not merging clusters 15 and 19 due to different formula numbers: R2 vs R7
2025-06-10 20:22:27,786 - DEBUG - Checking merge:
  Current: 21, Next: 19
2025-06-10 20:22:27,786 - DEBUG -   Vertical gap: 4.079999999999984, Overlap ratio: 1.0
2025-06-10 20:22:27,786 - DEBUG -   Left boundary diff: 0.0, Right boundary diff: 0.0
2025-06-10 20:22:27,786 - DEBUG -   Alignment factor (ratio): 0.0
2025-06-10 20:22:27,786 - DEBUG -   -> c1 21 formula number: R6, c2 19 formula number: R7
2025-06-10 20:22:27,786 - DEBUG -   -> Not merging clusters 21 and 19 due to different formula numbers: R6 vs R7
2025-06-10 20:22:27,787 - DEBUG - Checking merge:
  Current: 18, Next: 16
2025-06-10 20:22:27,787 - DEBUG -   Vertical gap: 2.205000000000041, Overlap ratio: 1.0
2025-06-10 20:22:27,787 - DEBUG -   Left boundary diff: 7.192999999999998, Right boundary diff: 0.0
2025-06-10 20:22:27,787 - DEBUG -   Alignment factor (ratio): 0.03208117299436917
2025-06-10 20:22:27,787 - DEBUG -   -> c1 18 formula number: R3, c2 16 formula number: R4
2025-06-10 20:22:27,787 - DEBUG -   -> Not merging clusters 18 and 16 due to different formula numbers: R3 vs R4
2025-06-10 20:22:27,788 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:27,789 - DEBUG - Finished converting page batch time=4109.325
2025-06-10 20:22:27,903 - INFO - Extraction successful row 191, tokens=14208
2025-06-10 20:22:27,939 - DEBUG - Finished converting page batch time=4109.476
2025-06-10 20:22:28,050 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:28,283 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:28,331 - DEBUG - LayoutPredictor settings: {'safe_tensors_file': '/home/wstation/.cache/huggingface/hub/models--ds4sd--docling-models/snapshots/36bebf56681740529abd09f5473a93a69373fbf0/model_artifacts/layout/model.safetensors', 'device': 'cuda', 'num_threads': 4, 'image_size': 640, 'threshold': 0.3}
2025-06-10 20:22:28,351 - DEBUG - https://huggingface.co:443 "GET /api/models/ds4sd/docling-models/revision/v2.2.0 HTTP/1.1" 429 3243
2025-06-10 20:22:28,352 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:22:28,420 - DEBUG - [Page 18] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:28,512 - WARNING - Repetitive generation detected with pattern: ' \mathrm {'
2025-06-10 20:22:28,513 - DEBUG - Snippet 10.13075_ijomeh.1896.00379_933_item_1: generation shape=torch.Size([1, 411])
2025-06-10 20:22:28,515 - DEBUG - Snippet 10.13075_ijomeh.1896.00379_933_item_1 raw docling: (tokens=65)
<formula><loc_0><loc_0><loc_500><loc_500>\log ( y _ { t } ) = \beta _ { 0 } + \beta x _ { t } + S _ { 1 } ( \mathrm { \mathrm { \mathrm { \mathrm {
2025-06-10 20:22:28,515 - DEBUG - Starting _parse_docling_output
2025-06-10 20:22:28,515 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>\log ( y _ { t } ) = \beta _ { 0 } + \beta x _ { t } + S _ { 1 } ( \mathrm { \mathrm { \mathrm { \mathrm {
2025-06-10 20:22:28,515 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:22:28,515 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>\\log ( y _ { t } ) = \\beta _ { 0 } + \\beta x _ { t } + S _ { 1 } ( \\mathrm { \\mathrm { \\mathrm { \\mathrm {', image=<PIL.Image.Image image mode=RGB size=676x68 at 0x7F96904616A0>)]
2025-06-10 20:22:28,516 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:22:28,519 - DEBUG - DoclingDocument loaded successfully. Extracted texts: []
2025-06-10 20:22:28,519 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:22:28,519 - WARNING - Extracted text is empty or malformed. Skipping formula.
2025-06-10 20:22:28,519 - INFO - All done. Returning 2 recognized text results.
2025-06-10 20:22:28,520 - DEBUG - Snippet 10.13075_ijomeh.1896.00379_933_item_0 recognized text:
R I = \frac { 1 0 0 0 } { 1 0 . 4 } ( e ^ { 0 . 0 0 0 8 7 1 \times N O _ { 2 } } + e ^ { 0 . 0 0 0 5 3 7 \times O _ { 3 } } + e ^ { 0 . 0 0 0 4 8 7 \times P M _ { 2 5 } } - 3 )
2025-06-10 20:22:28,520 - DEBUG - Snippet 10.13075_ijomeh.1896.00379_933_item_1 recognized text:
MALFORMED_FORMULA
2025-06-10 20:22:28,590 - INFO - Finished converting document 10.13075_ijomeh.1896.00379_933.pdf in 17.21 sec.
2025-06-10 20:22:28,683 - INFO - Extraction successful row 190, tokens=10832
2025-06-10 20:22:28,849 - INFO - Accelerator device: 'cuda:0'
2025-06-10 20:22:28,850 - INFO - Loading SmolDocling from ds4sd/SmolDocling-256M-preview on cuda:0...
2025-06-10 20:22:28,850 - INFO - Initializing Processor and Model with model: ds4sd/SmolDocling-256M-preview, torch_dtype: torch.bfloat16, _attn_implementation: flash_attention_2, on device: cuda
2025-06-10 20:22:28,878 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:22:28,898 - DEBUG - [Page 19] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:28,899 - DEBUG - Finished converting page batch time=4110.436
2025-06-10 20:22:28,900 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:22:28,922 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 429 0
2025-06-10 20:22:28,949 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 429 0
2025-06-10 20:22:28,972 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/preprocessor_config.json HTTP/1.1" 429 0
2025-06-10 20:22:28,996 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/tokenizer_config.json HTTP/1.1" 429 0
2025-06-10 20:22:29,036 - DEBUG - Dynamic vertical threshold: 22.93020000000006, Overlap threshold: 0.7
2025-06-10 20:22:29,037 - DEBUG - Checking merge:
  Current: 19, Next: 17
2025-06-10 20:22:29,037 - DEBUG -   Vertical gap: 2.2049999999999272, Overlap ratio: 1.0
2025-06-10 20:22:29,037 - DEBUG -   Left boundary diff: 11.477000000000004, Right boundary diff: 0.0
2025-06-10 20:22:29,037 - DEBUG -   Alignment factor (ratio): 0.0543569123076231
2025-06-10 20:22:29,038 - DEBUG -   -> c1 19 formula number: R8, c2 17 formula number: R9
2025-06-10 20:22:29,038 - DEBUG -   -> Not merging clusters 19 and 17 due to different formula numbers: R8 vs R9
2025-06-10 20:22:29,038 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:29,053 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:29,124 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/processor_config.json HTTP/1.1" 429 0
2025-06-10 20:22:29,146 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.json HTTP/1.1" 429 0
2025-06-10 20:22:29,173 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/chat_template.jinja HTTP/1.1" 429 0
2025-06-10 20:22:29,296 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/config.json HTTP/1.1" 429 0
2025-06-10 20:22:29,362 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:29,485 - DEBUG - [Page 20] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:29,570 - DEBUG - https://huggingface.co:443 "HEAD /ds4sd/SmolDocling-256M-preview/resolve/main/generation_config.json HTTP/1.1" 429 0
2025-06-10 20:22:29,593 - DEBUG - Snippet 10.1214_14-aoas754_900_item_0: generation shape=torch.Size([1, 441])
2025-06-10 20:22:29,593 - DEBUG - Snippet 10.1214_14-aoas754_900_item_0 raw docling: (tokens=95)
<formula><loc_0><loc_0><loc_500><loc_500>\cos ( \theta _ { c } ^ { * } , \theta _ { c ^ { \prime } } ^ { * } ) = \exp \left [ - \frac { d ( c , c ^ { \prime } ) } { \rho } \right ] \times S _ { 2 } \otimes S _ { 1 } ,</formula><end_of_utterance>
2025-06-10 20:22:29,594 - DEBUG - Starting _parse_docling_output
2025-06-10 20:22:29,594 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>\cos ( \theta _ { c } ^ { * } , \theta _ { c ^ { \prime } } ^ { * } ) = \exp \left [ - \frac { d ( c , c ^ { \prime } ) } { \rho } \right ] \times S _ { 2 } \otimes S _ { 1 } ,</formula><end_of_utterance>
2025-06-10 20:22:29,594 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:22:29,594 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>\\cos ( \\theta _ { c } ^ { * } , \\theta _ { c ^ { \\prime } } ^ { * } ) = \\exp \\left [ - \\frac { d ( c , c ^ { \\prime } ) } { \\rho } \\right ] \\times S _ { 2 } \\otimes S _ { 1 } ,</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=804x133 at 0x7F96D894E930>)]
2025-06-10 20:22:29,595 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:22:29,598 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=804.0, b=133.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 176))], orig='\\cos ( \\theta _ { c } ^ { * } , \\theta _ { c ^ { \\prime } } ^ { * } ) = \\exp \\left [ - \\frac { d ( c , c ^ { \\prime } ) } { \\rho } \\right ] \\times S _ { 2 } \\otimes S _ { 1 } ,', text='\\cos ( \\theta _ { c } ^ { * } , \\theta _ { c ^ { \\prime } } ^ { * } ) = \\exp \\left [ - \\frac { d ( c , c ^ { \\prime } ) } { \\rho } \\right ] \\times S _ { 2 } \\otimes S _ { 1 } ,', formatting=None, hyperlink=None)]
2025-06-10 20:22:29,599 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:22:29,599 - DEBUG - Processing text item: label=formula, text=\cos ( \theta _ { c } ^ { * } , \theta _ { c ^ { \prime } } ^ { * } ) = \exp \left [ - \frac { d ( c , c ^ { \prime } ) } { \rho } \right ] \times S _ { 2 } \otimes S _ { 1 } ,
2025-06-10 20:22:29,599 - DEBUG - Recognized string extracted: \cos ( \theta _ { c } ^ { * } , \theta _ { c ^ { \prime } } ^ { * } ) = \exp \left [ - \frac { d ( c , c ^ { \prime } ) } { \rho } \right ] \times S _ { 2 } \otimes S _ { 1 } ,
2025-06-10 20:22:29,599 - DEBUG - Generating chat message for label: formula
2025-06-10 20:22:29,600 - DEBUG - Snippet 10.1214_14-aoas754_900_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:22:29,672 - DEBUG - Snippet 10.1214_14-aoas754_900_item_1 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:22:29,755 - INFO - SmolDoclingPredictor init complete. Device=cuda
2025-06-10 20:22:29,756 - INFO - Processing document 10.26868_25222708.2023.1472_968.pdf
2025-06-10 20:22:29,821 - DEBUG - [Page 14] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:29,941 - DEBUG - Dynamic vertical threshold: 53.26200000000006, Overlap threshold: 0.7
2025-06-10 20:22:29,942 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:30,013 - DEBUG - [Page 21] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:30,190 - DEBUG - [Page 22] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:28,274 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:28,453 - DEBUG - [Page 15] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:28,698 - DEBUG - [Page 0] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:28,886 - DEBUG - [Page 23] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:28,983 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:28,996 - DEBUG - Finished converting page batch time=4112.705
2025-06-10 20:22:29,034 - DEBUG - Finished converting page batch time=4112.743
2025-06-10 20:22:29,282 - DEBUG - [Page 16] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:29,319 - DEBUG - [Page 24] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:29,790 - DEBUG - [Page 25] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:29,824 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:29,826 - DEBUG - Finished converting page batch time=4113.535
2025-06-10 20:22:30,043 - DEBUG - [Page 17] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:30,220 - DEBUG - [Page 1] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:30,439 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:30,440 - DEBUG - Finished converting page batch time=4114.149
2025-06-10 20:22:30,460 - DEBUG - [Page 26] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:30,894 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:31,236 - DEBUG - [Page 18] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:31,247 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:31,371 - DEBUG - Snippet 10.1214_14-aoas754_900_item_1: generation shape=torch.Size([1, 491])
2025-06-10 20:22:31,372 - DEBUG - Snippet 10.1214_14-aoas754_900_item_1 raw docling: (tokens=145)
<formula><loc_0><loc_0><loc_500><loc_500>f _ { c } ( x ) = \sum _ { j = 0 } ^ { M _ { 1 } ^ { c } } \sum _ { k = 0 } ^ { M _ { 2 } ^ { c } } \beta _ { c , j , k } b _ { 1 , j } ^ { c } ( x _ { 1 } , M _ { 1 } ^ { c } ) b _ { 2 , k } ^ { c } ( x _ { 2 } , M _ { 2 } ^ { c } ) ,</formula><end_of_utterance>
2025-06-10 20:22:31,372 - DEBUG - Starting _parse_docling_output
2025-06-10 20:22:31,372 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>f _ { c } ( x ) = \sum _ { j = 0 } ^ { M _ { 1 } ^ { c } } \sum _ { k = 0 } ^ { M _ { 2 } ^ { c } } \beta _ { c , j , k } b _ { 1 , j } ^ { c } ( x _ { 1 } , M _ { 1 } ^ { c } ) b _ { 2 , k } ^ { c } ( x _ { 2 } , M _ { 2 } ^ { c } ) ,</formula><end_of_utterance>
2025-06-10 20:22:31,373 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:22:31,373 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>f _ { c } ( x ) = \\sum _ { j = 0 } ^ { M _ { 1 } ^ { c } } \\sum _ { k = 0 } ^ { M _ { 2 } ^ { c } } \\beta _ { c , j , k } b _ { 1 , j } ^ { c } ( x _ { 1 } , M _ { 1 } ^ { c } ) b _ { 2 , k } ^ { c } ( x _ { 2 } , M _ { 2 } ^ { c } ) ,</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=836x172 at 0x7F96D894C9B0>)]
2025-06-10 20:22:31,373 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:22:31,379 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=836.0, b=172.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 235))], orig='f _ { c } ( x ) = \\sum _ { j = 0 } ^ { M _ { 1 } ^ { c } } \\sum _ { k = 0 } ^ { M _ { 2 } ^ { c } } \\beta _ { c , j , k } b _ { 1 , j } ^ { c } ( x _ { 1 } , M _ { 1 } ^ { c } ) b _ { 2 , k } ^ { c } ( x _ { 2 } , M _ { 2 } ^ { c } ) ,', text='f _ { c } ( x ) = \\sum _ { j = 0 } ^ { M _ { 1 } ^ { c } } \\sum _ { k = 0 } ^ { M _ { 2 } ^ { c } } \\beta _ { c , j , k } b _ { 1 , j } ^ { c } ( x _ { 1 } , M _ { 1 } ^ { c } ) b _ { 2 , k } ^ { c } ( x _ { 2 } , M _ { 2 } ^ { c } ) ,', formatting=None, hyperlink=None)]
2025-06-10 20:22:31,379 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:22:31,379 - DEBUG - Processing text item: label=formula, text=f _ { c } ( x ) = \sum _ { j = 0 } ^ { M _ { 1 } ^ { c } } \sum _ { k = 0 } ^ { M _ { 2 } ^ { c } } \beta _ { c , j , k } b _ { 1 , j } ^ { c } ( x _ { 1 } , M _ { 1 } ^ { c } ) b _ { 2 , k } ^ { c } ( x _ { 2 } , M _ { 2 } ^ { c } ) ,
2025-06-10 20:22:31,379 - DEBUG - Recognized string extracted: f _ { c } ( x ) = \sum _ { j = 0 } ^ { M _ { 1 } ^ { c } } \sum _ { k = 0 } ^ { M _ { 2 } ^ { c } } \beta _ { c , j , k } b _ { 1 , j } ^ { c } ( x _ { 1 } , M _ { 1 } ^ { c } ) b _ { 2 , k } ^ { c } ( x _ { 2 } , M _ { 2 } ^ { c } ) ,
2025-06-10 20:22:31,380 - DEBUG - Generating chat message for label: formula
2025-06-10 20:22:31,380 - DEBUG - Snippet 10.1214_14-aoas754_900_item_2 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:22:31,403 - DEBUG - Dynamic vertical threshold: 32.01300000000005, Overlap threshold: 0.7
2025-06-10 20:22:31,404 - DEBUG - [Page 2] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:31,448 - DEBUG - Snippet 10.1214_14-aoas754_900_item_2 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:22:31,754 - DEBUG - [Page 27] Reclassifying cluster 0 from table to TEXT (area ratio: 0.72, cells: 148, density: 0.000412).
2025-06-10 20:22:31,754 - DEBUG - [Page 27] Total clusters reclassified from large size labels to TEXT: 1
2025-06-10 20:22:31,755 - DEBUG - Finished converting page batch time=4115.465
2025-06-10 20:22:32,050 - DEBUG - [Page 28] Reclassifying cluster 0 from table to TEXT (area ratio: 0.71, cells: 160, density: 0.000446).
2025-06-10 20:22:32,050 - DEBUG - [Page 28] Total clusters reclassified from large size labels to TEXT: 1
2025-06-10 20:22:32,114 - DEBUG - [Page 19] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:32,219 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:32,259 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:32,307 - DEBUG - [Page 29] Reclassifying cluster 0 from table to TEXT (area ratio: 0.72, cells: 104, density: 0.000290).
2025-06-10 20:22:32,308 - DEBUG - [Page 29] Total clusters reclassified from large size labels to TEXT: 1
2025-06-10 20:22:32,627 - DEBUG - [Page 30] Reclassifying cluster 0 from table to TEXT (area ratio: 0.70, cells: 160, density: 0.000456).
2025-06-10 20:22:32,628 - DEBUG - [Page 30] Total clusters reclassified from large size labels to TEXT: 1
2025-06-10 20:22:32,798 - DEBUG - Finished converting page batch time=4116.508
2025-06-10 20:22:32,802 - DEBUG - [Page 31] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:32,883 - DEBUG - Dynamic vertical threshold: 59.30820000000002, Overlap threshold: 0.7
2025-06-10 20:22:32,883 - DEBUG - [Page 3] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:33,020 - DEBUG - Finished converting page batch time=4116.730
2025-06-10 20:22:33,035 - DEBUG - [Page 20] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:33,100 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:33,257 - DEBUG - Snippet 10.1214_14-aoas754_900_item_2: generation shape=torch.Size([1, 411])
2025-06-10 20:22:33,258 - DEBUG - Snippet 10.1214_14-aoas754_900_item_2 raw docling: (tokens=65)
<formula><loc_0><loc_0><loc_500><loc_500>V _ { c } = \left ( V _ { c , 1 1 } ^ { \vee } \ V _ { c , 1 2 } ^ { \vee } \right ) ,</formula><end_of_utterance>
2025-06-10 20:22:33,258 - DEBUG - Starting _parse_docling_output
2025-06-10 20:22:33,258 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>V _ { c } = \left ( V _ { c , 1 1 } ^ { \vee } \ V _ { c , 1 2 } ^ { \vee } \right ) ,</formula><end_of_utterance>
2025-06-10 20:22:33,258 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:22:33,259 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>V _ { c } = \\left ( V _ { c , 1 1 } ^ { \\vee } \\ V _ { c , 1 2 } ^ { \\vee } \\right ) ,</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=688x130 at 0x7F96D73422A0>)]
2025-06-10 20:22:33,259 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:22:33,262 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=688.0, b=130.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 86))], orig='V _ { c } = \\left ( V _ { c , 1 1 } ^ { \\vee } \\ V _ { c , 1 2 } ^ { \\vee } \\right ) ,', text='V _ { c } = \\left ( V _ { c , 1 1 } ^ { \\vee } \\ V _ { c , 1 2 } ^ { \\vee } \\right ) ,', formatting=None, hyperlink=None)]
2025-06-10 20:22:33,263 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:22:33,263 - DEBUG - Processing text item: label=formula, text=V _ { c } = \left ( V _ { c , 1 1 } ^ { \vee } \ V _ { c , 1 2 } ^ { \vee } \right ) ,
2025-06-10 20:22:33,263 - DEBUG - Recognized string extracted: V _ { c } = \left ( V _ { c , 1 1 } ^ { \vee } \ V _ { c , 1 2 } ^ { \vee } \right ) ,
2025-06-10 20:22:33,263 - DEBUG - Generating chat message for label: formula
2025-06-10 20:22:33,264 - DEBUG - Snippet 10.1214_14-aoas754_900_item_3 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:22:33,326 - DEBUG - [Page 32] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:33,332 - DEBUG - Snippet 10.1214_14-aoas754_900_item_3 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:22:33,399 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:33,426 - DEBUG - Finished converting page batch time=4117.136
2025-06-10 20:22:33,700 - DEBUG - [Page 21] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:33,771 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:33,773 - DEBUG - Finished converting page batch time=4117.482
2025-06-10 20:22:34,098 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:34,099 - DEBUG - Finished converting page batch time=4117.808
2025-06-10 20:22:34,147 - DEBUG - [Page 33] Reclassifying cluster 0 from table to TEXT (area ratio: 0.72, cells: 170, density: 0.000473).
2025-06-10 20:22:34,147 - DEBUG - [Page 33] Total clusters reclassified from large size labels to TEXT: 1
2025-06-10 20:22:34,219 - DEBUG - [Page 22] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:34,501 - DEBUG - [Page 4] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:34,566 - DEBUG - [Page 34] Reclassifying cluster 0 from table to TEXT (area ratio: 0.72, cells: 170, density: 0.000472).
2025-06-10 20:22:34,567 - DEBUG - [Page 34] Total clusters reclassified from large size labels to TEXT: 1
2025-06-10 20:22:34,658 - DEBUG - [Page 8] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:34,874 - DEBUG - [Page 35] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:34,953 - DEBUG - [Page 23] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:35,201 - DEBUG - Finished converting page batch time=4118.910
2025-06-10 20:22:35,280 - DEBUG - [Page 9] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:35,391 - DEBUG - [Page 10] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:35,504 - DEBUG - [Page 11] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:35,505 - DEBUG - Finished converting page batch time=4119.215
2025-06-10 20:22:35,561 - DEBUG - Finished converting page batch time=4119.270
2025-06-10 20:22:35,633 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:35,660 - DEBUG - [Page 12] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:35,748 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:35,809 - DEBUG - [Page 24] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:36,024 - DEBUG - Snippet 10.1214_14-aoas754_900_item_3: generation shape=torch.Size([1, 439])
2025-06-10 20:22:36,025 - DEBUG - Snippet 10.1214_14-aoas754_900_item_3 raw docling: (tokens=93)
<formula><loc_0><loc_0><loc_500><loc_500>A _ { c } = [ b _ { c } ^ { T } ( X _ { c } ) b _ { c } ( X _ { c } ) ] ^ { - 1 } b _ { c } ^ { T } ( X _ { c } ) B ( X _ { c } ) T ^ { - 1 } .</formula><end_of_utterance>
2025-06-10 20:22:36,025 - DEBUG - Starting _parse_docling_output
2025-06-10 20:22:36,025 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>A _ { c } = [ b _ { c } ^ { T } ( X _ { c } ) b _ { c } ( X _ { c } ) ] ^ { - 1 } b _ { c } ^ { T } ( X _ { c } ) B ( X _ { c } ) T ^ { - 1 } .</formula><end_of_utterance>
2025-06-10 20:22:36,025 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:22:36,026 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>A _ { c } = [ b _ { c } ^ { T } ( X _ { c } ) b _ { c } ( X _ { c } ) ] ^ { - 1 } b _ { c } ^ { T } ( X _ { c } ) B ( X _ { c } ) T ^ { - 1 } .</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=827x82 at 0x7F96AA474E30>)]
2025-06-10 20:22:36,026 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:22:36,029 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=827.0, b=82.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 143))], orig='A _ { c } = [ b _ { c } ^ { T } ( X _ { c } ) b _ { c } ( X _ { c } ) ] ^ { - 1 } b _ { c } ^ { T } ( X _ { c } ) B ( X _ { c } ) T ^ { - 1 } .', text='A _ { c } = [ b _ { c } ^ { T } ( X _ { c } ) b _ { c } ( X _ { c } ) ] ^ { - 1 } b _ { c } ^ { T } ( X _ { c } ) B ( X _ { c } ) T ^ { - 1 } .', formatting=None, hyperlink=None)]
2025-06-10 20:22:36,030 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:22:36,030 - DEBUG - Processing text item: label=formula, text=A _ { c } = [ b _ { c } ^ { T } ( X _ { c } ) b _ { c } ( X _ { c } ) ] ^ { - 1 } b _ { c } ^ { T } ( X _ { c } ) B ( X _ { c } ) T ^ { - 1 } .
2025-06-10 20:22:36,030 - DEBUG - Recognized string extracted: A _ { c } = [ b _ { c } ^ { T } ( X _ { c } ) b _ { c } ( X _ { c } ) ] ^ { - 1 } b _ { c } ^ { T } ( X _ { c } ) B ( X _ { c } ) T ^ { - 1 } .
2025-06-10 20:22:36,030 - DEBUG - Generating chat message for label: formula
2025-06-10 20:22:36,031 - DEBUG - Snippet 10.1214_14-aoas754_900_item_4 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:22:36,055 - DEBUG - [Page 36] Reclassifying cluster 0 from table to TEXT (area ratio: 0.71, cells: 110, density: 0.000310).
2025-06-10 20:22:36,056 - DEBUG - [Page 36] Total clusters reclassified from large size labels to TEXT: 1
2025-06-10 20:22:36,157 - DEBUG - Snippet 10.1214_14-aoas754_900_item_4 => input_ids shape=torch.Size([1, 610]), prompt_len=610
2025-06-10 20:22:36,322 - DEBUG - [Page 13] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:36,442 - DEBUG - [Page 37] Reclassifying cluster 0 from table to TEXT (area ratio: 0.71, cells: 154, density: 0.000434).
2025-06-10 20:22:36,443 - DEBUG - [Page 37] Total clusters reclassified from large size labels to TEXT: 1
2025-06-10 20:22:36,585 - DEBUG - [Page 25] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:36,668 - DEBUG - [Page 38] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:36,759 - DEBUG - [Page 14] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:36,895 - DEBUG - [Page 5] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:36,953 - DEBUG - [Page 15] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:36,954 - DEBUG - Finished converting page batch time=4120.663
2025-06-10 20:22:37,049 - DEBUG - [Page 14] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:37,112 - DEBUG - [Page 39] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:37,278 - DEBUG - Finished converting page batch time=4120.987
2025-06-10 20:22:37,334 - DEBUG - [Page 26] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:37,400 - DEBUG - [Page 15] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:37,401 - DEBUG - Finished converting page batch time=4121.110
2025-06-10 20:22:37,614 - DEBUG - [Page 16] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:37,632 - DEBUG - [Page 40] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:38,043 - DEBUG - [Page 27] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:38,161 - DEBUG - [Page 16] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:38,303 - DEBUG - [Page 41] Reclassifying cluster 2 from table to TEXT (area ratio: 0.70, cells: 142, density: 0.000404).
2025-06-10 20:22:38,303 - DEBUG - [Page 41] Total clusters reclassified from large size labels to TEXT: 1
2025-06-10 20:22:38,409 - DEBUG - [Page 17] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:38,547 - DEBUG - Finished converting page batch time=4122.256
2025-06-10 20:22:38,627 - DEBUG - [Page 17] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:38,693 - DEBUG - [Page 28] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:38,786 - DEBUG - [Page 6] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:38,802 - DEBUG - [Page 42] Reclassifying cluster 2 from table to TEXT (area ratio: 0.71, cells: 154, density: 0.000431).
2025-06-10 20:22:38,802 - DEBUG - [Page 42] Total clusters reclassified from large size labels to TEXT: 1
2025-06-10 20:22:38,989 - DEBUG - Snippet 10.1214_14-aoas754_900_item_4: generation shape=torch.Size([1, 711])
2025-06-10 20:22:38,990 - DEBUG - Snippet 10.1214_14-aoas754_900_item_4 raw docling: (tokens=100)
<formula><loc_0><loc_0><loc_500><loc_500>\left ( \hat { \beta } _ { c } \right ) \left | \theta _ { c } , \gamma _ { c } , \hat { V } _ { c } \sim N \right | \left ( \left ( A _ { c } \theta _ { c } \right ) , \hat { V } _ { c } \right ) .</formula><end_of_utterance>
2025-06-10 20:22:38,990 - DEBUG - Starting _parse_docling_output
2025-06-10 20:22:38,991 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>\left ( \hat { \beta } _ { c } \right ) \left | \theta _ { c } , \gamma _ { c } , \hat { V } _ { c } \sim N \right | \left ( \left ( A _ { c } \theta _ { c } \right ) , \hat { V } _ { c } \right ) .</formula><end_of_utterance>
2025-06-10 20:22:38,991 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:22:38,991 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>\\left ( \\hat { \\beta } _ { c } \\right ) \\left | \\theta _ { c } , \\gamma _ { c } , \\hat { V } _ { c } \\sim N \\right | \\left ( \\left ( A _ { c } \\theta _ { c } \\right ) , \\hat { V } _ { c } \\right ) .</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=799x205 at 0x7F96AA4768D0>)]
2025-06-10 20:22:38,991 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:22:38,996 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=799.0, b=205.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 198))], orig='\\left ( \\hat { \\beta } _ { c } \\right ) \\left | \\theta _ { c } , \\gamma _ { c } , \\hat { V } _ { c } \\sim N \\right | \\left ( \\left ( A _ { c } \\theta _ { c } \\right ) , \\hat { V } _ { c } \\right ) .', text='\\left ( \\hat { \\beta } _ { c } \\right ) \\left | \\theta _ { c } , \\gamma _ { c } , \\hat { V } _ { c } \\sim N \\right | \\left ( \\left ( A _ { c } \\theta _ { c } \\right ) , \\hat { V } _ { c } \\right ) .', formatting=None, hyperlink=None)]
2025-06-10 20:22:38,997 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:22:38,997 - DEBUG - Processing text item: label=formula, text=\left ( \hat { \beta } _ { c } \right ) \left | \theta _ { c } , \gamma _ { c } , \hat { V } _ { c } \sim N \right | \left ( \left ( A _ { c } \theta _ { c } \right ) , \hat { V } _ { c } \right ) .
2025-06-10 20:22:38,997 - DEBUG - Recognized string extracted: \left ( \hat { \beta } _ { c } \right ) \left | \theta _ { c } , \gamma _ { c } , \hat { V } _ { c } \sim N \right | \left ( \left ( A _ { c } \theta _ { c } \right ) , \hat { V } _ { c } \right ) .
2025-06-10 20:22:38,997 - INFO - All done. Returning 5 recognized text results.
2025-06-10 20:22:38,998 - DEBUG - Snippet 10.1214_14-aoas754_900_item_0 recognized text:
\cos ( \theta _ { c } ^ { * } , \theta _ { c ^ { \prime } } ^ { * } ) = \exp \left [ - \frac { d ( c , c ^ { \prime } ) } { \rho } \right ] \times S _ { 2 } \otimes S _ { 1 } ,
2025-06-10 20:22:38,998 - DEBUG - Snippet 10.1214_14-aoas754_900_item_1 recognized text:
f _ { c } ( x ) = \sum _ { j = 0 } ^ { M _ { 1 } ^ { c } } \sum _ { k = 0 } ^ { M _ { 2 } ^ { c } } \beta _ { c , j , k } b _ { 1 , j } ^ { c } ( x _ { 1 } , M _ { 1 } ^ { c } ) b _ { 2 , k } ^ { c } ( x _ { 2 } , M _ { 2 } ^ { c } ) ,
2025-06-10 20:22:38,998 - DEBUG - Snippet 10.1214_14-aoas754_900_item_2 recognized text:
V _ { c } = \left ( V _ { c , 1 1 } ^ { \vee } \ V _ { c , 1 2 } ^ { \vee } \right ) ,
2025-06-10 20:22:38,998 - DEBUG - Snippet 10.1214_14-aoas754_900_item_3 recognized text:
A _ { c } = [ b _ { c } ^ { T } ( X _ { c } ) b _ { c } ( X _ { c } ) ] ^ { - 1 } b _ { c } ^ { T } ( X _ { c } ) B ( X _ { c } ) T ^ { - 1 } .
2025-06-10 20:22:38,998 - DEBUG - Snippet 10.1214_14-aoas754_900_item_4 recognized text:
\left ( \hat { \beta } _ { c } \right ) \left | \theta _ { c } , \gamma _ { c } , \hat { V } _ { c } \sim N \right | \left ( \left ( A _ { c } \theta _ { c } \right ) , \hat { V } _ { c } \right ) .
2025-06-10 20:22:39,091 - DEBUG - Creating masked image for page 9 with 11 clusters.
2025-06-10 20:22:39,092 - INFO - Masked image successfully created for page 9.
2025-06-10 20:22:39,123 - DEBUG - [Page 43] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:39,191 - DEBUG - Creating masked image for page 13 with 6 clusters.
2025-06-10 20:22:39,192 - INFO - Masked image successfully created for page 13.
2025-06-10 20:22:39,200 - INFO - Starting prediction for 3 images with labels: ['formula', 'formula', 'formula']
2025-06-10 20:22:39,200 - DEBUG - Generating chat message for label: formula
2025-06-10 20:22:39,200 - DEBUG - Snippet 10.1214_14-aoas754_900_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:22:39,272 - DEBUG - Finished converting page batch time=4122.982
2025-06-10 20:22:39,328 - DEBUG - [Page 29] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:39,446 - DEBUG - Snippet 10.1214_14-aoas754_900_item_0 => input_ids shape=torch.Size([1, 875]), prompt_len=875
2025-06-10 20:22:39,586 - DEBUG - [Page 44] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:39,657 - DEBUG - [Page 18] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:39,890 - DEBUG - [Page 18] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:40,027 - DEBUG - [Page 19] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:40,027 - DEBUG - Finished converting page batch time=4123.737
2025-06-10 20:22:40,092 - DEBUG - [Page 19] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:40,093 - DEBUG - Finished converting page batch time=4123.802
2025-06-10 20:22:40,127 - DEBUG - [Page 20] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:40,130 - DEBUG - [Page 7] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:40,131 - DEBUG - Finished converting page batch time=4123.841
2025-06-10 20:22:40,217 - DEBUG - [Page 21] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:40,286 - DEBUG - Creating masked image for page 2 with 23 clusters.
2025-06-10 20:22:40,288 - INFO - Masked image successfully created for page 2.
2025-06-10 20:22:40,310 - DEBUG - [Page 22] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:40,367 - DEBUG - [Page 20] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:40,398 - DEBUG - Creating masked image for page 3 with 23 clusters.
2025-06-10 20:22:40,400 - INFO - Masked image successfully created for page 3.
2025-06-10 20:22:40,405 - INFO - Starting prediction for 3 images with labels: ['formula', 'formula', 'formula']
2025-06-10 20:22:40,405 - DEBUG - Generating chat message for label: formula
2025-06-10 20:22:40,405 - DEBUG - Snippet 10.26868_25222708.2023.1472_968_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:22:40,406 - DEBUG - [Page 23] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:40,406 - DEBUG - Finished converting page batch time=4124.115
2025-06-10 20:22:40,471 - DEBUG - [Page 45] Reclassifying cluster 0 from table to TEXT (area ratio: 0.70, cells: 134, density: 0.000379).
2025-06-10 20:22:40,471 - DEBUG - [Page 45] Total clusters reclassified from large size labels to TEXT: 1
2025-06-10 20:22:40,471 - DEBUG - Snippet 10.26868_25222708.2023.1472_968_item_0 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:22:40,659 - DEBUG - [Page 30] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:40,730 - DEBUG - [Page 46] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:40,764 - DEBUG - [Page 24] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:41,179 - DEBUG - [Page 31] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:41,180 - DEBUG - Finished converting page batch time=4124.889
2025-06-10 20:22:41,180 - DEBUG - [Page 21] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:41,254 - WARNING - Repetitive generation detected with pattern: ' \quad'
2025-06-10 20:22:41,255 - DEBUG - Snippet 10.26868_25222708.2023.1472_968_item_0: generation shape=torch.Size([1, 372])
2025-06-10 20:22:41,255 - DEBUG - Snippet 10.26868_25222708.2023.1472_968_item_0 raw docling: (tokens=26)
<formula><loc_0><loc_0><loc_500><loc_500>- \quad \quad \quad \quad
2025-06-10 20:22:41,256 - DEBUG - Starting _parse_docling_output
2025-06-10 20:22:41,256 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>- \quad \quad \quad \quad
2025-06-10 20:22:41,256 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:22:41,256 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>- \\quad \\quad \\quad \\quad', image=<PIL.Image.Image image mode=RGB size=444x62 at 0x7F96D6647350>)]
2025-06-10 20:22:41,257 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:22:41,258 - DEBUG - DoclingDocument loaded successfully. Extracted texts: []
2025-06-10 20:22:41,258 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:22:41,258 - WARNING - Extracted text is empty or malformed. Skipping formula.
2025-06-10 20:22:41,258 - DEBUG - Generating chat message for label: formula
2025-06-10 20:22:41,259 - DEBUG - Snippet 10.26868_25222708.2023.1472_968_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:22:41,279 - DEBUG - [Page 32] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:41,325 - DEBUG - Snippet 10.26868_25222708.2023.1472_968_item_1 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:22:41,405 - DEBUG - [Page 33] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:41,517 - DEBUG - [Page 22] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:41,530 - DEBUG - [Page 34] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:41,640 - DEBUG - [Page 35] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:41,641 - DEBUG - Finished converting page batch time=4125.350
2025-06-10 20:22:41,691 - DEBUG - [Page 25] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:41,755 - DEBUG - [Page 36] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:41,865 - DEBUG - [Page 37] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:41,989 - DEBUG - [Page 47] Reclassifying cluster 0 from table to TEXT (area ratio: 0.71, cells: 184, density: 0.000514).
2025-06-10 20:22:41,989 - DEBUG - [Page 38] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:41,989 - DEBUG - [Page 47] Total clusters reclassified from large size labels to TEXT: 1
2025-06-10 20:22:41,990 - DEBUG - Finished converting page batch time=4125.699
2025-06-10 20:22:42,035 - DEBUG - [Page 26] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:42,214 - DEBUG - [Page 48] Reclassifying cluster 0 from table to TEXT (area ratio: 0.71, cells: 150, density: 0.000421).
2025-06-10 20:22:42,214 - DEBUG - [Page 48] Total clusters reclassified from large size labels to TEXT: 1
2025-06-10 20:22:42,291 - DEBUG - [Page 39] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:42,391 - DEBUG - [Page 27] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:42,392 - DEBUG - Finished converting page batch time=4126.101
2025-06-10 20:22:42,443 - DEBUG - [Page 49] Reclassifying cluster 0 from table to TEXT (area ratio: 0.71, cells: 132, density: 0.000372).
2025-06-10 20:22:42,443 - DEBUG - [Page 49] Total clusters reclassified from large size labels to TEXT: 1
2025-06-10 20:22:42,717 - DEBUG - [Page 50] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:42,779 - DEBUG - [Page 28] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:42,961 - DEBUG - Finished converting page batch time=4126.670
2025-06-10 20:22:42,999 - DEBUG - [Page 29] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:43,132 - DEBUG - [Page 40] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:43,349 - DEBUG - [Page 30] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:43,508 - DEBUG - Finished converting page batch time=4127.218
2025-06-10 20:22:43,509 - DEBUG - Snippet 10.26868_25222708.2023.1472_968_item_1: generation shape=torch.Size([1, 421])
2025-06-10 20:22:43,510 - DEBUG - Snippet 10.26868_25222708.2023.1472_968_item_1 raw docling: (tokens=75)
<formula><loc_0><loc_0><loc_500><loc_500>M S E _ { N } = \frac { 1 } { n - 2 } \sum _ { t = 0 } ^ { i } ( Y _ { i } - \widehat { Y } _ { l } ) ^ { 2 }</formula><end_of_utterance>
2025-06-10 20:22:43,510 - DEBUG - Starting _parse_docling_output
2025-06-10 20:22:43,510 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>M S E _ { N } = \frac { 1 } { n - 2 } \sum _ { t = 0 } ^ { i } ( Y _ { i } - \widehat { Y } _ { l } ) ^ { 2 }</formula><end_of_utterance>
2025-06-10 20:22:43,510 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:22:43,511 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>M S E _ { N } = \\frac { 1 } { n - 2 } \\sum _ { t = 0 } ^ { i } ( Y _ { i } - \\widehat { Y } _ { l } ) ^ { 2 }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=535x93 at 0x7F96C866A660>)]
2025-06-10 20:22:43,511 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:22:43,513 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=535.0, b=93.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 109))], orig='M S E _ { N } = \\frac { 1 } { n - 2 } \\sum _ { t = 0 } ^ { i } ( Y _ { i } - \\widehat { Y } _ { l } ) ^ { 2 }', text='M S E _ { N } = \\frac { 1 } { n - 2 } \\sum _ { t = 0 } ^ { i } ( Y _ { i } - \\widehat { Y } _ { l } ) ^ { 2 }', formatting=None, hyperlink=None)]
2025-06-10 20:22:43,513 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:22:43,514 - DEBUG - Processing text item: label=formula, text=M S E _ { N } = \frac { 1 } { n - 2 } \sum _ { t = 0 } ^ { i } ( Y _ { i } - \widehat { Y } _ { l } ) ^ { 2 }
2025-06-10 20:22:43,514 - DEBUG - Recognized string extracted: M S E _ { N } = \frac { 1 } { n - 2 } \sum _ { t = 0 } ^ { i } ( Y _ { i } - \widehat { Y } _ { l } ) ^ { 2 }
2025-06-10 20:22:43,514 - DEBUG - Generating chat message for label: formula
2025-06-10 20:22:43,515 - DEBUG - Snippet 10.26868_25222708.2023.1472_968_item_2 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:22:43,589 - DEBUG - Snippet 10.26868_25222708.2023.1472_968_item_2 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:22:43,648 - INFO - Finished converting document 10.1101_489518_945.pdf in 30.59 sec.
2025-06-10 20:22:43,850 - INFO - Extraction successful row 192, tokens=23694
2025-06-10 20:22:44,094 - DEBUG - Snippet 10.1214_14-aoas754_900_item_0: generation shape=torch.Size([1, 1036])
2025-06-10 20:22:44,096 - DEBUG - Snippet 10.1214_14-aoas754_900_item_0 raw docling: (tokens=160)
<formula><loc_0><loc_0><loc_500><loc_500>\mu _ { 0 } \sim N ( 0 , \tau _ { 0 } ^ { 2 } ) , \\ S _ { 2 } \sim I W ( M _ { 2 } + 2 , I ) , \\ S _ { 1 } \sim I W ( M _ { 1 } + 2 , I ) , \\ \tau \sim G _ { a } ( a _ { \tau } , b _ { \tau } ) \ \text { and } \\ \log ( \rho ) \sim N ( \mu _ { \rho } , \sigma _ { \rho } ^ { 2 } ) .</formula><end_of_utterance>
2025-06-10 20:22:44,096 - DEBUG - Starting _parse_docling_output
2025-06-10 20:22:44,096 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>\mu _ { 0 } \sim N ( 0 , \tau _ { 0 } ^ { 2 } ) , \\ S _ { 2 } \sim I W ( M _ { 2 } + 2 , I ) , \\ S _ { 1 } \sim I W ( M _ { 1 } + 2 , I ) , \\ \tau \sim G _ { a } ( a _ { \tau } , b _ { \tau } ) \ \text { and } \\ \log ( \rho ) \sim N ( \mu _ { \rho } , \sigma _ { \rho } ^ { 2 } ) .</formula><end_of_utterance>
2025-06-10 20:22:44,096 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:22:44,097 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>\\mu _ { 0 } \\sim N ( 0 , \\tau _ { 0 } ^ { 2 } ) , \\\\ S _ { 2 } \\sim I W ( M _ { 2 } + 2 , I ) , \\\\ S _ { 1 } \\sim I W ( M _ { 1 } + 2 , I ) , \\\\ \\tau \\sim G _ { a } ( a _ { \\tau } , b _ { \\tau } ) \\ \\text { and } \\\\ \\log ( \\rho ) \\sim N ( \\mu _ { \\rho } , \\sigma _ { \\rho } ^ { 2 } ) .</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=701x412 at 0x7F96DC11B470>)]
2025-06-10 20:22:44,097 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:22:44,105 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=701.0, b=412.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 285))], orig='\\mu _ { 0 } \\sim N ( 0 , \\tau _ { 0 } ^ { 2 } ) , \\\\ S _ { 2 } \\sim I W ( M _ { 2 } + 2 , I ) , \\\\ S _ { 1 } \\sim I W ( M _ { 1 } + 2 , I ) , \\\\ \\tau \\sim G _ { a } ( a _ { \\tau } , b _ { \\tau } ) \\ \\text { and } \\\\ \\log ( \\rho ) \\sim N ( \\mu _ { \\rho } , \\sigma _ { \\rho } ^ { 2 } ) .', text='\\mu _ { 0 } \\sim N ( 0 , \\tau _ { 0 } ^ { 2 } ) , \\\\ S _ { 2 } \\sim I W ( M _ { 2 } + 2 , I ) , \\\\ S _ { 1 } \\sim I W ( M _ { 1 } + 2 , I ) , \\\\ \\tau \\sim G _ { a } ( a _ { \\tau } , b _ { \\tau } ) \\ \\text { and } \\\\ \\log ( \\rho ) \\sim N ( \\mu _ { \\rho } , \\sigma _ { \\rho } ^ { 2 } ) .', formatting=None, hyperlink=None)]
2025-06-10 20:22:44,106 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:22:44,106 - DEBUG - Processing text item: label=formula, text=\mu _ { 0 } \sim N ( 0 , \tau _ { 0 } ^ { 2 } ) , \\ S _ { 2 } \sim I W ( M _ { 2 } + 2 , I ) , \\ S _ { 1 } \sim I W ( M _ { 1 } + 2 , I ) , \\ \tau \sim G _ { a } ( a _ { \tau } , b _ { \tau } ) \ \text { and } \\ \log ( \rho ) \sim N ( \mu _ { \rho } , \sigma _ { \rho } ^ { 2 } ) .
2025-06-10 20:22:44,107 - DEBUG - Recognized string extracted: \mu _ { 0 } \sim N ( 0 , \tau _ { 0 } ^ { 2 } ) , \\ S _ { 2 } \sim I W ( M _ { 2 } + 2 , I ) , \\ S _ { 1 } \sim I W ( M _ { 1 } + 2 , I ) , \\ \tau \sim G _ { a } ( a _ { \tau } , b _ { \tau } ) \ \text { and } \\ \log ( \rho ) \sim N ( \mu _ { \rho } , \sigma _ { \rho } ^ { 2 } ) .
2025-06-10 20:22:44,107 - DEBUG - Generating chat message for label: formula
2025-06-10 20:22:44,107 - DEBUG - Snippet 10.1214_14-aoas754_900_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:22:44,177 - DEBUG - Snippet 10.1214_14-aoas754_900_item_1 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:22:44,281 - DEBUG - [Page 23] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:44,283 - DEBUG - Finished converting page batch time=4127.992
2025-06-10 20:22:44,479 - DEBUG - [Page 51] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:44,724 - DEBUG - Finished converting page batch time=4128.433
2025-06-10 20:22:45,027 - DEBUG - [Page 24] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:45,033 - DEBUG - [Page 52] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:45,855 - DEBUG - [Page 53] Reclassifying cluster 0 from table to TEXT (area ratio: 0.72, cells: 164, density: 0.000455).
2025-06-10 20:22:45,855 - DEBUG - [Page 53] Total clusters reclassified from large size labels to TEXT: 1
2025-06-10 20:22:46,069 - DEBUG - [Page 54] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:46,575 - DEBUG - [Page 25] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:46,805 - DEBUG - [Page 55] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:47,064 - DEBUG - Finished converting page batch time=4130.774
2025-06-10 20:22:47,295 - DEBUG - [Page 56] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:47,385 - DEBUG - Snippet 10.26868_25222708.2023.1472_968_item_2: generation shape=torch.Size([1, 485])
2025-06-10 20:22:47,386 - DEBUG - Snippet 10.26868_25222708.2023.1472_968_item_2 raw docling: (tokens=139)
<formula><loc_0><loc_0><loc_500><loc_500>R M S D \left ( u , w \right ) = \\ \sqrt { \frac { 1 } { n } \sum _ { i = 1 } ^ { n } \left ( \left ( u _ { 1 } - w _ { 1 } \right ) ^ { 2 } + \left ( u _ { 2 } - w _ { 2 } \right ) ^ { 2 } + \cdots + \left ( u _ { n } - w _ { n } \right ) ^ { 2 } }</formula><end_of_utterance>
2025-06-10 20:22:47,386 - DEBUG - Starting _parse_docling_output
2025-06-10 20:22:47,387 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>R M S D \left ( u , w \right ) = \\ \sqrt { \frac { 1 } { n } \sum _ { i = 1 } ^ { n } \left ( \left ( u _ { 1 } - w _ { 1 } \right ) ^ { 2 } + \left ( u _ { 2 } - w _ { 2 } \right ) ^ { 2 } + \cdots + \left ( u _ { n } - w _ { n } \right ) ^ { 2 } }</formula><end_of_utterance>
2025-06-10 20:22:47,387 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:22:47,387 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>R M S D \\left ( u , w \\right ) = \\\\ \\sqrt { \\frac { 1 } { n } \\sum _ { i = 1 } ^ { n } \\left ( \\left ( u _ { 1 } - w _ { 1 } \\right ) ^ { 2 } + \\left ( u _ { 2 } - w _ { 2 } \\right ) ^ { 2 } + \\cdots + \\left ( u _ { n } - w _ { n } \\right ) ^ { 2 } }</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=676x146 at 0x7F96D3924620>)]
2025-06-10 20:22:47,388 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:22:47,391 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=676.0, b=146.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 250))], orig='R M S D \\left ( u , w \\right ) = \\\\ \\sqrt { \\frac { 1 } { n } \\sum _ { i = 1 } ^ { n } \\left ( \\left ( u _ { 1 } - w _ { 1 } \\right ) ^ { 2 } + \\left ( u _ { 2 } - w _ { 2 } \\right ) ^ { 2 } + \\cdots + \\left ( u _ { n } - w _ { n } \\right ) ^ { 2 } }', text='R M S D \\left ( u , w \\right ) = \\\\ \\sqrt { \\frac { 1 } { n } \\sum _ { i = 1 } ^ { n } \\left ( \\left ( u _ { 1 } - w _ { 1 } \\right ) ^ { 2 } + \\left ( u _ { 2 } - w _ { 2 } \\right ) ^ { 2 } + \\cdots + \\left ( u _ { n } - w _ { n } \\right ) ^ { 2 } }', formatting=None, hyperlink=None)]
2025-06-10 20:22:47,392 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:22:47,392 - DEBUG - Processing text item: label=formula, text=R M S D \left ( u , w \right ) = \\ \sqrt { \frac { 1 } { n } \sum _ { i = 1 } ^ { n } \left ( \left ( u _ { 1 } - w _ { 1 } \right ) ^ { 2 } + \left ( u _ { 2 } - w _ { 2 } \right ) ^ { 2 } + \cdots + \left ( u _ { n } - w _ { n } \right ) ^ { 2 } }
2025-06-10 20:22:47,399 - DEBUG - Recognized string extracted: R M S D \left ( u , w \right ) = \\ \sqrt { \frac { 1 } { n } \sum _ { i = 1 } ^ { n } \left ( \left ( u _ { 1 } - w _ { 1 } \right ) ^ { 2 } + \left ( u _ { 2 } - w _ { 2 } \right ) ^ { 2 } + \cdots + \left ( u _ { n } - w _ { n } \right ) ^ { 2 } }
2025-06-10 20:22:47,399 - INFO - All done. Returning 3 recognized text results.
2025-06-10 20:22:47,399 - DEBUG - Snippet 10.26868_25222708.2023.1472_968_item_0 recognized text:
MALFORMED_FORMULA
2025-06-10 20:22:47,399 - DEBUG - Snippet 10.26868_25222708.2023.1472_968_item_1 recognized text:
M S E _ { N } = \frac { 1 } { n - 2 } \sum _ { t = 0 } ^ { i } ( Y _ { i } - \widehat { Y } _ { l } ) ^ { 2 }
2025-06-10 20:22:47,400 - DEBUG - Snippet 10.26868_25222708.2023.1472_968_item_2 recognized text:
R M S D \left ( u , w \right ) = \\ \sqrt { \frac { 1 } { n } \sum _ { i = 1 } ^ { n } \left ( \left ( u _ { 1 } - w _ { 1 } \right ) ^ { 2 } + \left ( u _ { 2 } - w _ { 2 } \right ) ^ { 2 } + \cdots + \left ( u _ { n } - w _ { n } \right ) ^ { 2 } }
2025-06-10 20:22:47,493 - INFO - Finished converting document 10.26868_25222708.2023.1472_968.pdf in 22.15 sec.
2025-06-10 20:22:47,574 - INFO - Extraction successful row 197, tokens=14442
2025-06-10 20:22:47,650 - DEBUG - [Page 26] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:47,755 - DEBUG - Snippet 10.1214_14-aoas754_900_item_1: generation shape=torch.Size([1, 476])
2025-06-10 20:22:47,756 - DEBUG - Snippet 10.1214_14-aoas754_900_item_1 raw docling: (tokens=130)
<formula><loc_0><loc_0><loc_500><loc_500>E ( \gamma _ { c } | \theta _ { c } , \hat { \beta } _ { c } , \hat { \gamma } _ { c } , V _ { c } ) = \hat { \gamma } _ { c } + V _ { c , 2 1 } V _ { c , 1 1 } ^ { - 1 } ( A _ { c } \bar { \theta } _ { c } - \hat { \beta } _ { c } ) ,</formula><end_of_utterance>
2025-06-10 20:22:47,756 - DEBUG - Starting _parse_docling_output
2025-06-10 20:22:47,756 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>E ( \gamma _ { c } | \theta _ { c } , \hat { \beta } _ { c } , \hat { \gamma } _ { c } , V _ { c } ) = \hat { \gamma } _ { c } + V _ { c , 2 1 } V _ { c , 1 1 } ^ { - 1 } ( A _ { c } \bar { \theta } _ { c } - \hat { \beta } _ { c } ) ,</formula><end_of_utterance>
2025-06-10 20:22:47,756 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:22:47,757 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>E ( \\gamma _ { c } | \\theta _ { c } , \\hat { \\beta } _ { c } , \\hat { \\gamma } _ { c } , V _ { c } ) = \\hat { \\gamma } _ { c } + V _ { c , 2 1 } V _ { c , 1 1 } ^ { - 1 } ( A _ { c } \\bar { \\theta } _ { c } - \\hat { \\beta } _ { c } ) ,</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=875x84 at 0x7F96D7FF2C90>)]
2025-06-10 20:22:47,757 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:22:47,760 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=875.0, b=84.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 235))], orig='E ( \\gamma _ { c } | \\theta _ { c } , \\hat { \\beta } _ { c } , \\hat { \\gamma } _ { c } , V _ { c } ) = \\hat { \\gamma } _ { c } + V _ { c , 2 1 } V _ { c , 1 1 } ^ { - 1 } ( A _ { c } \\bar { \\theta } _ { c } - \\hat { \\beta } _ { c } ) ,', text='E ( \\gamma _ { c } | \\theta _ { c } , \\hat { \\beta } _ { c } , \\hat { \\gamma } _ { c } , V _ { c } ) = \\hat { \\gamma } _ { c } + V _ { c , 2 1 } V _ { c , 1 1 } ^ { - 1 } ( A _ { c } \\bar { \\theta } _ { c } - \\hat { \\beta } _ { c } ) ,', formatting=None, hyperlink=None)]
2025-06-10 20:22:47,761 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:22:47,761 - DEBUG - Processing text item: label=formula, text=E ( \gamma _ { c } | \theta _ { c } , \hat { \beta } _ { c } , \hat { \gamma } _ { c } , V _ { c } ) = \hat { \gamma } _ { c } + V _ { c , 2 1 } V _ { c , 1 1 } ^ { - 1 } ( A _ { c } \bar { \theta } _ { c } - \hat { \beta } _ { c } ) ,
2025-06-10 20:22:47,761 - DEBUG - Recognized string extracted: E ( \gamma _ { c } | \theta _ { c } , \hat { \beta } _ { c } , \hat { \gamma } _ { c } , V _ { c } ) = \hat { \gamma } _ { c } + V _ { c , 2 1 } V _ { c , 1 1 } ^ { - 1 } ( A _ { c } \bar { \theta } _ { c } - \hat { \beta } _ { c } ) ,
2025-06-10 20:22:47,761 - DEBUG - Generating chat message for label: formula
2025-06-10 20:22:47,762 - DEBUG - Snippet 10.1214_14-aoas754_900_item_2 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:22:47,833 - DEBUG - Snippet 10.1214_14-aoas754_900_item_2 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:22:47,969 - DEBUG - [Page 57] Reclassifying cluster 2 from table to TEXT (area ratio: 0.71, cells: 188, density: 0.000527).
2025-06-10 20:22:47,969 - DEBUG - [Page 57] Total clusters reclassified from large size labels to TEXT: 1
2025-06-10 20:22:48,218 - DEBUG - [Page 58] Reclassifying cluster 0 from table to TEXT (area ratio: 0.71, cells: 162, density: 0.000455).
2025-06-10 20:22:48,218 - DEBUG - [Page 58] Total clusters reclassified from large size labels to TEXT: 1
2025-06-10 20:22:48,335 - DEBUG - [Page 59] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:48,542 - DEBUG - Finished converting page batch time=4132.251
2025-06-10 20:22:48,711 - DEBUG - [Page 27] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:48,712 - DEBUG - Finished converting page batch time=4132.421
2025-06-10 20:22:49,000 - DEBUG - [Page 60] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:49,528 - DEBUG - [Page 28] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:50,166 - DEBUG - [Page 61] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:50,580 - DEBUG - [Page 29] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:51,004 - DEBUG - [Page 62] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:51,525 - DEBUG - [Page 30] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:51,797 - DEBUG - [Page 31] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:51,799 - DEBUG - Finished converting page batch time=4135.508
2025-06-10 20:22:52,340 - DEBUG - [Page 32] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:52,601 - DEBUG - [Page 63] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:52,658 - DEBUG - Snippet 10.1214_14-aoas754_900_item_2: generation shape=torch.Size([1, 526])
2025-06-10 20:22:52,659 - DEBUG - [Page 31] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:52,659 - DEBUG - Snippet 10.1214_14-aoas754_900_item_2 raw docling: (tokens=180)
<formula><loc_0><loc_0><loc_500><loc_500>( 1 4 ) \, \, \, \frac { \partial ^ { 2 } f _ { c } ( x ) } { \partial x _ { 1 } \partial x _ { 2 } } = M _ { 1 } M _ { 2 } \sum _ { j = 0 } ^ { M _ { 1 } - 1 } \sum _ { k = 0 } ^ { M _ { 2 } - 1 } ( \theta _ { j , k + 1 , c } - \theta _ { j , k , c } ) B _ { j , k } ( x , M _ { 1 } - 1 , M _ { 2 } - 1 ) .</formula><end_of_utterance>
2025-06-10 20:22:52,660 - DEBUG - Starting _parse_docling_output
2025-06-10 20:22:52,660 - DEBUG - Finished converting page batch time=4136.369
2025-06-10 20:22:52,660 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>( 1 4 ) \, \, \, \frac { \partial ^ { 2 } f _ { c } ( x ) } { \partial x _ { 1 } \partial x _ { 2 } } = M _ { 1 } M _ { 2 } \sum _ { j = 0 } ^ { M _ { 1 } - 1 } \sum _ { k = 0 } ^ { M _ { 2 } - 1 } ( \theta _ { j , k + 1 , c } - \theta _ { j , k , c } ) B _ { j , k } ( x , M _ { 1 } - 1 , M _ { 2 } - 1 ) .</formula><end_of_utterance>
2025-06-10 20:22:52,660 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:22:52,660 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>( 1 4 ) \\, \\, \\, \\frac { \\partial ^ { 2 } f _ { c } ( x ) } { \\partial x _ { 1 } \\partial x _ { 2 } } = M _ { 1 } M _ { 2 } \\sum _ { j = 0 } ^ { M _ { 1 } - 1 } \\sum _ { k = 0 } ^ { M _ { 2 } - 1 } ( \\theta _ { j , k + 1 , c } - \\theta _ { j , k , c } ) B _ { j , k } ( x , M _ { 1 } - 1 , M _ { 2 } - 1 ) .</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=1038x168 at 0x7F96D8405D00>)]
2025-06-10 20:22:52,661 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:22:52,667 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=1038.0, b=168.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 307))], orig='( 1 4 ) \\, \\, \\, \\frac { \\partial ^ { 2 } f _ { c } ( x ) } { \\partial x _ { 1 } \\partial x _ { 2 } } = M _ { 1 } M _ { 2 } \\sum _ { j = 0 } ^ { M _ { 1 } - 1 } \\sum _ { k = 0 } ^ { M _ { 2 } - 1 } ( \\theta _ { j , k + 1 , c } - \\theta _ { j , k , c } ) B _ { j , k } ( x , M _ { 1 } - 1 , M _ { 2 } - 1 ) .', text='( 1 4 ) \\, \\, \\, \\frac { \\partial ^ { 2 } f _ { c } ( x ) } { \\partial x _ { 1 } \\partial x _ { 2 } } = M _ { 1 } M _ { 2 } \\sum _ { j = 0 } ^ { M _ { 1 } - 1 } \\sum _ { k = 0 } ^ { M _ { 2 } - 1 } ( \\theta _ { j , k + 1 , c } - \\theta _ { j , k , c } ) B _ { j , k } ( x , M _ { 1 } - 1 , M _ { 2 } - 1 ) .', formatting=None, hyperlink=None)]
2025-06-10 20:22:52,667 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:22:52,668 - DEBUG - Processing text item: label=formula, text=( 1 4 ) \, \, \, \frac { \partial ^ { 2 } f _ { c } ( x ) } { \partial x _ { 1 } \partial x _ { 2 } } = M _ { 1 } M _ { 2 } \sum _ { j = 0 } ^ { M _ { 1 } - 1 } \sum _ { k = 0 } ^ { M _ { 2 } - 1 } ( \theta _ { j , k + 1 , c } - \theta _ { j , k , c } ) B _ { j , k } ( x , M _ { 1 } - 1 , M _ { 2 } - 1 ) .
2025-06-10 20:22:52,668 - DEBUG - Recognized string extracted: ( 1 4 ) \, \, \, \frac { \partial ^ { 2 } f _ { c } ( x ) } { \partial x _ { 1 } \partial x _ { 2 } } = M _ { 1 } M _ { 2 } \sum _ { j = 0 } ^ { M _ { 1 } - 1 } \sum _ { k = 0 } ^ { M _ { 2 } - 1 } ( \theta _ { j , k + 1 , c } - \theta _ { j , k , c } ) B _ { j , k } ( x , M _ { 1 } - 1 , M _ { 2 } - 1 ) .
2025-06-10 20:22:52,668 - INFO - All done. Returning 3 recognized text results.
2025-06-10 20:22:52,668 - DEBUG - Snippet 10.1214_14-aoas754_900_item_0 recognized text:
\mu _ { 0 } \sim N ( 0 , \tau _ { 0 } ^ { 2 } ) , \\ S _ { 2 } \sim I W ( M _ { 2 } + 2 , I ) , \\ S _ { 1 } \sim I W ( M _ { 1 } + 2 , I ) , \\ \tau \sim G _ { a } ( a _ { \tau } , b _ { \tau } ) \ \text { and } \\ \log ( \rho ) \sim N ( \mu _ { \rho } , \sigma _ { \rho } ^ { 2 } ) .
2025-06-10 20:22:52,669 - DEBUG - Snippet 10.1214_14-aoas754_900_item_1 recognized text:
E ( \gamma _ { c } | \theta _ { c } , \hat { \beta } _ { c } , \hat { \gamma } _ { c } , V _ { c } ) = \hat { \gamma } _ { c } + V _ { c , 2 1 } V _ { c , 1 1 } ^ { - 1 } ( A _ { c } \bar { \theta } _ { c } - \hat { \beta } _ { c } ) ,
2025-06-10 20:22:52,669 - DEBUG - Snippet 10.1214_14-aoas754_900_item_2 recognized text:
( 1 4 ) \, \, \, \frac { \partial ^ { 2 } f _ { c } ( x ) } { \partial x _ { 1 } \partial x _ { 2 } } = M _ { 1 } M _ { 2 } \sum _ { j = 0 } ^ { M _ { 1 } - 1 } \sum _ { k = 0 } ^ { M _ { 2 } - 1 } ( \theta _ { j , k + 1 , c } - \theta _ { j , k , c } ) B _ { j , k } ( x , M _ { 1 } - 1 , M _ { 2 } - 1 ) .
2025-06-10 20:22:52,765 - INFO - Finished converting document 10.1214_14-aoas754_900.pdf in 59.93 sec.
2025-06-10 20:22:52,863 - DEBUG - Finished converting page batch time=4136.572
2025-06-10 20:22:52,930 - INFO - Extraction successful row 184, tokens=15461
2025-06-10 20:22:53,072 - DEBUG - [Page 64] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:53,275 - DEBUG - [Page 65] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:53,956 - DEBUG - [Page 66] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:54,572 - DEBUG - [Page 32] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:54,634 - DEBUG - [Page 67] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:55,171 - DEBUG - Finished converting page batch time=4138.881
2025-06-10 20:22:55,195 - DEBUG - [Page 33] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:55,350 - DEBUG - [Page 68] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:55,548 - DEBUG - Finished converting page batch time=4139.257
2025-06-10 20:22:56,249 - DEBUG - [Page 34] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:56,557 - DEBUG - [Page 35] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:56,558 - DEBUG - Finished converting page batch time=4140.267
2025-06-10 20:22:56,834 - INFO - Finished converting document 10.1101_2022.02.21.22271281_947.pdf in 43.71 sec.
2025-06-10 20:22:57,149 - DEBUG - [Page 33] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:57,496 - DEBUG - Dynamic vertical threshold: 22.930199999999957, Overlap threshold: 0.7
2025-06-10 20:22:57,497 - DEBUG - [Page 36] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:58,056 - INFO - Extraction successful row 193, tokens=117036
2025-06-10 20:22:58,296 - DEBUG - Dynamic vertical threshold: 22.932000000000016, Overlap threshold: 0.7
2025-06-10 20:22:58,296 - DEBUG - [Page 37] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:58,426 - DEBUG - [Page 34] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:59,474 - DEBUG - [Page 38] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:59,502 - DEBUG - [Page 35] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:59,504 - DEBUG - Finished converting page batch time=4143.213
2025-06-10 20:23:00,279 - DEBUG - [Page 36] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:23:00,448 - DEBUG - [Page 39] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:23:00,449 - DEBUG - Finished converting page batch time=4144.158
2025-06-10 20:22:58,370 - DEBUG - [Page 40] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:58,780 - DEBUG - [Page 37] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:22:59,355 - DEBUG - Dynamic vertical threshold: 22.932000000000016, Overlap threshold: 0.7
2025-06-10 20:22:59,355 - DEBUG - [Page 41] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:23:00,055 - DEBUG - [Page 42] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:23:00,340 - DEBUG - [Page 38] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:23:01,123 - DEBUG - [Page 39] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:23:01,124 - DEBUG - Finished converting page batch time=4147.113
2025-06-10 20:23:01,352 - DEBUG - [Page 40] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:23:01,352 - DEBUG - Finished converting page batch time=4147.342
2025-06-10 20:23:01,947 - DEBUG - [Page 43] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:23:01,948 - DEBUG - Finished converting page batch time=4147.937
2025-06-10 20:23:02,573 - INFO - Finished converting document 10.1525_elementa.273_967.pdf in 42.13 sec.
2025-06-10 20:23:02,752 - DEBUG - [Page 44] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:23:03,180 - INFO - Extraction successful row 196, tokens=52804
2025-06-10 20:23:03,873 - DEBUG - Dynamic vertical threshold: 22.93020000000006, Overlap threshold: 0.7
2025-06-10 20:23:03,873 - DEBUG - [Page 45] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:23:04,863 - DEBUG - [Page 46] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:23:05,720 - DEBUG - [Page 47] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:23:05,721 - DEBUG - Finished converting page batch time=4151.710
2025-06-10 20:23:06,667 - DEBUG - [Page 48] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:23:07,227 - DEBUG - [Page 49] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:23:08,295 - DEBUG - [Page 50] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:23:09,360 - DEBUG - [Page 51] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:23:09,361 - DEBUG - Finished converting page batch time=4155.351
2025-06-10 20:23:10,287 - DEBUG - [Page 52] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:23:11,101 - DEBUG - [Page 53] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:23:13,573 - DEBUG - [Page 54] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:23:14,762 - DEBUG - [Page 55] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:23:14,763 - DEBUG - Finished converting page batch time=4160.752
2025-06-10 20:23:16,056 - DEBUG - [Page 56] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:23:17,431 - DEBUG - [Page 57] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:23:18,834 - DEBUG - [Page 58] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:23:20,161 - DEBUG - [Page 59] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:23:20,162 - DEBUG - Finished converting page batch time=4166.151
2025-06-10 20:23:21,603 - DEBUG - [Page 60] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:23:22,798 - DEBUG - [Page 61] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:23:24,143 - DEBUG - [Page 62] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:23:25,437 - DEBUG - [Page 63] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:23:25,438 - DEBUG - Finished converting page batch time=4171.427
2025-06-10 20:23:26,751 - DEBUG - [Page 64] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:23:29,589 - DEBUG - [Page 65] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:23:28,867 - DEBUG - [Page 66] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:23:30,432 - DEBUG - [Page 67] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:23:30,434 - DEBUG - Finished converting page batch time=4178.476
2025-06-10 20:23:31,861 - DEBUG - [Page 68] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:23:33,281 - DEBUG - [Page 69] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:23:34,628 - DEBUG - [Page 70] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:23:35,976 - DEBUG - [Page 71] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:23:35,977 - DEBUG - Finished converting page batch time=4184.020
2025-06-10 20:23:37,275 - DEBUG - [Page 72] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:23:38,517 - DEBUG - [Page 73] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:23:39,992 - DEBUG - [Page 74] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:23:41,288 - DEBUG - [Page 75] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:23:41,290 - DEBUG - Finished converting page batch time=4189.333
2025-06-10 20:23:42,641 - DEBUG - [Page 76] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:23:45,895 - DEBUG - [Page 77] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:23:47,221 - DEBUG - [Page 78] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:23:48,546 - DEBUG - [Page 79] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:23:48,547 - DEBUG - Finished converting page batch time=4196.590
2025-06-10 20:23:49,715 - DEBUG - [Page 80] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:23:50,993 - DEBUG - [Page 81] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:23:52,256 - DEBUG - [Page 82] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:23:53,514 - DEBUG - [Page 83] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:23:53,515 - DEBUG - Finished converting page batch time=4201.558
2025-06-10 20:23:54,016 - DEBUG - [Page 84] Total clusters reclassified from large size labels to TEXT: 0
2025-06-10 20:23:54,017 - DEBUG - Finished converting page batch time=4202.060
2025-06-10 20:23:54,464 - DEBUG - Creating masked image for page 3 with 21 clusters.
2025-06-10 20:23:54,465 - INFO - Masked image successfully created for page 3.
2025-06-10 20:23:54,472 - INFO - Starting prediction for 5 images with labels: ['formula', 'formula', 'formula', 'formula', 'formula']
2025-06-10 20:23:54,472 - DEBUG - Generating chat message for label: formula
2025-06-10 20:23:54,472 - DEBUG - Snippet 10.5194_acp-15-8889-2015_961_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:23:54,536 - DEBUG - Snippet 10.5194_acp-15-8889-2015_961_item_0 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:23:55,687 - DEBUG - Snippet 10.5194_acp-15-8889-2015_961_item_0: generation shape=torch.Size([1, 389])
2025-06-10 20:23:55,687 - DEBUG - Snippet 10.5194_acp-15-8889-2015_961_item_0 raw docling: (tokens=43)
<formula><loc_0><loc_0><loc_500><loc_500>\gamma _ { 2 } + h v \to N O + O ( ^ { 3 } P ) ,</formula><end_of_utterance>
2025-06-10 20:23:55,688 - DEBUG - Starting _parse_docling_output
2025-06-10 20:23:55,688 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>\gamma _ { 2 } + h v \to N O + O ( ^ { 3 } P ) ,</formula><end_of_utterance>
2025-06-10 20:23:55,688 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:23:55,688 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>\\gamma _ { 2 } + h v \\to N O + O ( ^ { 3 } P ) ,</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=650x52 at 0x7F967956F950>)]
2025-06-10 20:23:55,689 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:23:55,690 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=650.0, b=52.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 48))], orig='\\gamma _ { 2 } + h v \\to N O + O ( ^ { 3 } P ) ,', text='\\gamma _ { 2 } + h v \\to N O + O ( ^ { 3 } P ) ,', formatting=None, hyperlink=None)]
2025-06-10 20:23:55,691 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:23:55,691 - DEBUG - Processing text item: label=formula, text=\gamma _ { 2 } + h v \to N O + O ( ^ { 3 } P ) ,
2025-06-10 20:23:55,691 - DEBUG - Recognized string extracted: \gamma _ { 2 } + h v \to N O + O ( ^ { 3 } P ) ,
2025-06-10 20:23:55,691 - DEBUG - Generating chat message for label: formula
2025-06-10 20:23:55,692 - DEBUG - Snippet 10.5194_acp-15-8889-2015_961_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:23:55,753 - DEBUG - Snippet 10.5194_acp-15-8889-2015_961_item_1 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:23:57,023 - DEBUG - Snippet 10.5194_acp-15-8889-2015_961_item_1: generation shape=torch.Size([1, 394])
2025-06-10 20:23:57,024 - DEBUG - Snippet 10.5194_acp-15-8889-2015_961_item_1 raw docling: (tokens=48)
<formula><loc_0><loc_0><loc_500><loc_500>O ( ^ { 3 } P ) + O _ { 2 } + M \to O _ { 3 } + M .</formula><end_of_utterance>
2025-06-10 20:23:57,024 - DEBUG - Starting _parse_docling_output
2025-06-10 20:23:57,025 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>O ( ^ { 3 } P ) + O _ { 2 } + M \to O _ { 3 } + M .</formula><end_of_utterance>
2025-06-10 20:23:57,025 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:23:57,025 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>O ( ^ { 3 } P ) + O _ { 2 } + M \\to O _ { 3 } + M .</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=689x55 at 0x7F967956ED20>)]
2025-06-10 20:23:57,025 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:23:57,027 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=689.0, b=55.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 51))], orig='O ( ^ { 3 } P ) + O _ { 2 } + M \\to O _ { 3 } + M .', text='O ( ^ { 3 } P ) + O _ { 2 } + M \\to O _ { 3 } + M .', formatting=None, hyperlink=None)]
2025-06-10 20:23:57,028 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:23:57,028 - DEBUG - Processing text item: label=formula, text=O ( ^ { 3 } P ) + O _ { 2 } + M \to O _ { 3 } + M .
2025-06-10 20:23:57,028 - DEBUG - Recognized string extracted: O ( ^ { 3 } P ) + O _ { 2 } + M \to O _ { 3 } + M .
2025-06-10 20:23:57,028 - DEBUG - Generating chat message for label: formula
2025-06-10 20:23:57,028 - DEBUG - Snippet 10.5194_acp-15-8889-2015_961_item_2 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:23:57,090 - DEBUG - Snippet 10.5194_acp-15-8889-2015_961_item_2 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:23:58,166 - DEBUG - Snippet 10.5194_acp-15-8889-2015_961_item_2: generation shape=torch.Size([1, 386])
2025-06-10 20:23:58,167 - DEBUG - Snippet 10.5194_acp-15-8889-2015_961_item_2 raw docling: (tokens=40)
<formula><loc_0><loc_0><loc_500><loc_500>_ { 2 } + N O \to N O _ { 2 } + O H ,</formula><end_of_utterance>
2025-06-10 20:23:58,167 - DEBUG - Starting _parse_docling_output
2025-06-10 20:23:58,167 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>_ { 2 } + N O \to N O _ { 2 } + O H ,</formula><end_of_utterance>
2025-06-10 20:23:58,167 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:23:58,168 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>_ { 2 } + N O \\to N O _ { 2 } + O H ,</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=650x55 at 0x7F967956F0B0>)]
2025-06-10 20:23:58,168 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:23:58,169 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=650.0, b=55.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 37))], orig='_ { 2 } + N O \\to N O _ { 2 } + O H ,', text='_ { 2 } + N O \\to N O _ { 2 } + O H ,', formatting=None, hyperlink=None)]
2025-06-10 20:23:58,170 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:23:58,170 - DEBUG - Processing text item: label=formula, text=_ { 2 } + N O \to N O _ { 2 } + O H ,
2025-06-10 20:23:58,170 - DEBUG - Recognized string extracted: _ { 2 } + N O \to N O _ { 2 } + O H ,
2025-06-10 20:23:58,170 - DEBUG - Generating chat message for label: formula
2025-06-10 20:23:58,171 - DEBUG - Snippet 10.5194_acp-15-8889-2015_961_item_3 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:23:58,232 - DEBUG - Snippet 10.5194_acp-15-8889-2015_961_item_3 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:23:59,441 - DEBUG - Snippet 10.5194_acp-15-8889-2015_961_item_3: generation shape=torch.Size([1, 392])
2025-06-10 20:23:59,442 - DEBUG - Snippet 10.5194_acp-15-8889-2015_961_item_3 raw docling: (tokens=46)
<formula><loc_0><loc_0><loc_500><loc_500>\jmath _ { 3 } + N O \to N O _ { 2 } + O _ { 2 } ,</formula><end_of_utterance>
2025-06-10 20:23:59,442 - DEBUG - Starting _parse_docling_output
2025-06-10 20:23:59,442 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>\jmath _ { 3 } + N O \to N O _ { 2 } + O _ { 2 } ,</formula><end_of_utterance>
2025-06-10 20:23:59,442 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:23:59,442 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>\\jmath _ { 3 } + N O \\to N O _ { 2 } + O _ { 2 } ,</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=672x55 at 0x7F967956F650>)]
2025-06-10 20:23:59,443 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:23:59,444 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=672.0, b=55.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 50))], orig='\\jmath _ { 3 } + N O \\to N O _ { 2 } + O _ { 2 } ,', text='\\jmath _ { 3 } + N O \\to N O _ { 2 } + O _ { 2 } ,', formatting=None, hyperlink=None)]
2025-06-10 20:23:59,445 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:23:59,445 - DEBUG - Processing text item: label=formula, text=\jmath _ { 3 } + N O \to N O _ { 2 } + O _ { 2 } ,
2025-06-10 20:23:59,445 - DEBUG - Recognized string extracted: \jmath _ { 3 } + N O \to N O _ { 2 } + O _ { 2 } ,
2025-06-10 20:23:59,445 - DEBUG - Generating chat message for label: formula
2025-06-10 20:23:59,445 - DEBUG - Snippet 10.5194_acp-15-8889-2015_961_item_4 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:23:59,505 - DEBUG - Snippet 10.5194_acp-15-8889-2015_961_item_4 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:23:58,659 - DEBUG - Snippet 10.5194_acp-15-8889-2015_961_item_4: generation shape=torch.Size([1, 397])
2025-06-10 20:23:58,660 - DEBUG - Snippet 10.5194_acp-15-8889-2015_961_item_4 raw docling: (tokens=51)
<formula><loc_0><loc_0><loc_500><loc_500>C O + O H ( + O _ { 2 } ) \to C O _ { 2 } + H O _ { 2 } ,</formula><end_of_utterance>
2025-06-10 20:23:58,660 - DEBUG - Starting _parse_docling_output
2025-06-10 20:23:58,660 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>C O + O H ( + O _ { 2 } ) \to C O _ { 2 } + H O _ { 2 } ,</formula><end_of_utterance>
2025-06-10 20:23:58,660 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:23:58,660 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>C O + O H ( + O _ { 2 } ) \\to C O _ { 2 } + H O _ { 2 } ,</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=710x55 at 0x7F967956FDA0>)]
2025-06-10 20:23:58,661 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:23:58,663 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=710.0, b=55.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 57))], orig='C O + O H ( + O _ { 2 } ) \\to C O _ { 2 } + H O _ { 2 } ,', text='C O + O H ( + O _ { 2 } ) \\to C O _ { 2 } + H O _ { 2 } ,', formatting=None, hyperlink=None)]
2025-06-10 20:23:58,663 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:23:58,663 - DEBUG - Processing text item: label=formula, text=C O + O H ( + O _ { 2 } ) \to C O _ { 2 } + H O _ { 2 } ,
2025-06-10 20:23:58,663 - DEBUG - Recognized string extracted: C O + O H ( + O _ { 2 } ) \to C O _ { 2 } + H O _ { 2 } ,
2025-06-10 20:23:58,663 - INFO - All done. Returning 5 recognized text results.
2025-06-10 20:23:58,664 - DEBUG - Snippet 10.5194_acp-15-8889-2015_961_item_0 recognized text:
\gamma _ { 2 } + h v \to N O + O ( ^ { 3 } P ) ,
2025-06-10 20:23:58,664 - DEBUG - Snippet 10.5194_acp-15-8889-2015_961_item_1 recognized text:
O ( ^ { 3 } P ) + O _ { 2 } + M \to O _ { 3 } + M .
2025-06-10 20:23:58,664 - DEBUG - Snippet 10.5194_acp-15-8889-2015_961_item_2 recognized text:
_ { 2 } + N O \to N O _ { 2 } + O H ,
2025-06-10 20:23:58,664 - DEBUG - Snippet 10.5194_acp-15-8889-2015_961_item_3 recognized text:
\jmath _ { 3 } + N O \to N O _ { 2 } + O _ { 2 } ,
2025-06-10 20:23:58,665 - DEBUG - Snippet 10.5194_acp-15-8889-2015_961_item_4 recognized text:
C O + O H ( + O _ { 2 } ) \to C O _ { 2 } + H O _ { 2 } ,
2025-06-10 20:23:58,766 - DEBUG - Creating masked image for page 4 with 20 clusters.
2025-06-10 20:23:58,768 - INFO - Masked image successfully created for page 4.
2025-06-10 20:23:58,863 - DEBUG - Creating masked image for page 5 with 15 clusters.
2025-06-10 20:23:58,864 - INFO - Masked image successfully created for page 5.
2025-06-10 20:23:58,872 - INFO - Starting prediction for 5 images with labels: ['formula', 'formula', 'formula', 'formula', 'formula']
2025-06-10 20:23:58,872 - DEBUG - Generating chat message for label: formula
2025-06-10 20:23:58,872 - DEBUG - Snippet 10.5194_acp-15-8889-2015_961_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:23:58,932 - DEBUG - Snippet 10.5194_acp-15-8889-2015_961_item_0 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:24:00,179 - DEBUG - Snippet 10.5194_acp-15-8889-2015_961_item_0: generation shape=torch.Size([1, 393])
2025-06-10 20:24:00,179 - DEBUG - Snippet 10.5194_acp-15-8889-2015_961_item_0 raw docling: (tokens=47)
<formula><loc_0><loc_0><loc_500><loc_500>O _ { 3 } + h v \to O ( ^ { 1 } D ) + O _ { 2 } ,</formula><end_of_utterance>
2025-06-10 20:24:00,179 - DEBUG - Starting _parse_docling_output
2025-06-10 20:24:00,180 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>O _ { 3 } + h v \to O ( ^ { 1 } D ) + O _ { 2 } ,</formula><end_of_utterance>
2025-06-10 20:24:00,180 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:24:00,180 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>O _ { 3 } + h v \\to O ( ^ { 1 } D ) + O _ { 2 } ,</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=710x55 at 0x7F967956F290>)]
2025-06-10 20:24:00,180 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:24:00,182 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=710.0, b=55.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 49))], orig='O _ { 3 } + h v \\to O ( ^ { 1 } D ) + O _ { 2 } ,', text='O _ { 3 } + h v \\to O ( ^ { 1 } D ) + O _ { 2 } ,', formatting=None, hyperlink=None)]
2025-06-10 20:24:00,183 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:24:00,183 - DEBUG - Processing text item: label=formula, text=O _ { 3 } + h v \to O ( ^ { 1 } D ) + O _ { 2 } ,
2025-06-10 20:24:00,183 - DEBUG - Recognized string extracted: O _ { 3 } + h v \to O ( ^ { 1 } D ) + O _ { 2 } ,
2025-06-10 20:24:00,183 - DEBUG - Generating chat message for label: formula
2025-06-10 20:24:00,184 - DEBUG - Snippet 10.5194_acp-15-8889-2015_961_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:24:00,244 - DEBUG - Snippet 10.5194_acp-15-8889-2015_961_item_1 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:24:01,409 - DEBUG - Snippet 10.5194_acp-15-8889-2015_961_item_1: generation shape=torch.Size([1, 390])
2025-06-10 20:24:01,410 - DEBUG - Snippet 10.5194_acp-15-8889-2015_961_item_1 raw docling: (tokens=44)
<formula><loc_0><loc_0><loc_500><loc_500>O ( ^ { 1 } D ) + H _ { 2 } O \to O H + O H ,</formula><end_of_utterance>
2025-06-10 20:24:01,410 - DEBUG - Starting _parse_docling_output
2025-06-10 20:24:01,410 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>O ( ^ { 1 } D ) + H _ { 2 } O \to O H + O H ,</formula><end_of_utterance>
2025-06-10 20:24:01,410 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:24:01,411 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>O ( ^ { 1 } D ) + H _ { 2 } O \\to O H + O H ,</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=710x51 at 0x7F967956F170>)]
2025-06-10 20:24:01,411 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:24:01,413 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=710.0, b=51.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 45))], orig='O ( ^ { 1 } D ) + H _ { 2 } O \\to O H + O H ,', text='O ( ^ { 1 } D ) + H _ { 2 } O \\to O H + O H ,', formatting=None, hyperlink=None)]
2025-06-10 20:24:01,413 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:24:01,413 - DEBUG - Processing text item: label=formula, text=O ( ^ { 1 } D ) + H _ { 2 } O \to O H + O H ,
2025-06-10 20:24:01,413 - DEBUG - Recognized string extracted: O ( ^ { 1 } D ) + H _ { 2 } O \to O H + O H ,
2025-06-10 20:24:01,414 - DEBUG - Generating chat message for label: formula
2025-06-10 20:24:01,414 - DEBUG - Snippet 10.5194_acp-15-8889-2015_961_item_2 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:24:01,476 - DEBUG - Snippet 10.5194_acp-15-8889-2015_961_item_2 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:24:03,147 - DEBUG - Snippet 10.5194_acp-15-8889-2015_961_item_2: generation shape=torch.Size([1, 410])
2025-06-10 20:24:03,147 - DEBUG - Snippet 10.5194_acp-15-8889-2015_961_item_2 raw docling: (tokens=64)
<formula><loc_0><loc_0><loc_500><loc_500>I _ { 6 } + O H + O _ { 2 } \to C _ { 2 } H _ { 5 } O _ { 2 } + H _ { 2 } O ,</formula><end_of_utterance>
2025-06-10 20:24:03,148 - DEBUG - Starting _parse_docling_output
2025-06-10 20:24:03,148 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>I _ { 6 } + O H + O _ { 2 } \to C _ { 2 } H _ { 5 } O _ { 2 } + H _ { 2 } O ,</formula><end_of_utterance>
2025-06-10 20:24:03,148 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:24:03,148 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>I _ { 6 } + O H + O _ { 2 } \\to C _ { 2 } H _ { 5 } O _ { 2 } + H _ { 2 } O ,</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=639x55 at 0x7F967956F4D0>)]
2025-06-10 20:24:03,149 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:24:03,150 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=639.0, b=55.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 77))], orig='I _ { 6 } + O H + O _ { 2 } \\to C _ { 2 } H _ { 5 } O _ { 2 } + H _ { 2 } O ,', text='I _ { 6 } + O H + O _ { 2 } \\to C _ { 2 } H _ { 5 } O _ { 2 } + H _ { 2 } O ,', formatting=None, hyperlink=None)]
2025-06-10 20:24:03,151 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:24:03,151 - DEBUG - Processing text item: label=formula, text=I _ { 6 } + O H + O _ { 2 } \to C _ { 2 } H _ { 5 } O _ { 2 } + H _ { 2 } O ,
2025-06-10 20:24:03,151 - DEBUG - Recognized string extracted: I _ { 6 } + O H + O _ { 2 } \to C _ { 2 } H _ { 5 } O _ { 2 } + H _ { 2 } O ,
2025-06-10 20:24:03,151 - DEBUG - Generating chat message for label: formula
2025-06-10 20:24:03,152 - DEBUG - Snippet 10.5194_acp-15-8889-2015_961_item_3 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:24:03,213 - DEBUG - Snippet 10.5194_acp-15-8889-2015_961_item_3 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:24:04,552 - DEBUG - Snippet 10.5194_acp-15-8889-2015_961_item_3: generation shape=torch.Size([1, 397])
2025-06-10 20:24:04,553 - DEBUG - Snippet 10.5194_acp-15-8889-2015_961_item_3 raw docling: (tokens=51)
<formula><loc_0><loc_0><loc_500><loc_500>_ { 2 } + N O \to C _ { 2 } H _ { 5 } O + N O _ { 2 } ,</formula><end_of_utterance>
2025-06-10 20:24:04,553 - DEBUG - Starting _parse_docling_output
2025-06-10 20:24:04,554 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>_ { 2 } + N O \to C _ { 2 } H _ { 5 } O + N O _ { 2 } ,</formula><end_of_utterance>
2025-06-10 20:24:04,554 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:24:04,554 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>_ { 2 } + N O \\to C _ { 2 } H _ { 5 } O + N O _ { 2 } ,</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=605x55 at 0x7F967956EE40>)]
2025-06-10 20:24:04,554 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:24:04,556 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=605.0, b=55.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 55))], orig='_ { 2 } + N O \\to C _ { 2 } H _ { 5 } O + N O _ { 2 } ,', text='_ { 2 } + N O \\to C _ { 2 } H _ { 5 } O + N O _ { 2 } ,', formatting=None, hyperlink=None)]
2025-06-10 20:24:04,556 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:24:04,556 - DEBUG - Processing text item: label=formula, text=_ { 2 } + N O \to C _ { 2 } H _ { 5 } O + N O _ { 2 } ,
2025-06-10 20:24:04,557 - DEBUG - Recognized string extracted: _ { 2 } + N O \to C _ { 2 } H _ { 5 } O + N O _ { 2 } ,
2025-06-10 20:24:04,557 - DEBUG - Generating chat message for label: formula
2025-06-10 20:24:04,557 - DEBUG - Snippet 10.5194_acp-15-8889-2015_961_item_4 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:24:04,624 - DEBUG - Snippet 10.5194_acp-15-8889-2015_961_item_4 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:24:06,382 - DEBUG - Snippet 10.5194_acp-15-8889-2015_961_item_4: generation shape=torch.Size([1, 414])
2025-06-10 20:24:06,383 - DEBUG - Snippet 10.5194_acp-15-8889-2015_961_item_4 raw docling: (tokens=68)
<formula><loc_0><loc_0><loc_500><loc_500>R _ { n s } = \left ( \frac { 1 } { R _ { c } } - \frac { 1 } { R _ { c 1 } } \right ) ^ { - 1 } .</formula><end_of_utterance>
2025-06-10 20:24:06,383 - DEBUG - Starting _parse_docling_output
2025-06-10 20:24:06,383 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>R _ { n s } = \left ( \frac { 1 } { R _ { c } } - \frac { 1 } { R _ { c 1 } } \right ) ^ { - 1 } .</formula><end_of_utterance>
2025-06-10 20:24:06,383 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:24:06,383 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>R _ { n s } = \\left ( \\frac { 1 } { R _ { c } } - \\frac { 1 } { R _ { c 1 } } \\right ) ^ { - 1 } .</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=651x130 at 0x7F967956F1D0>)]
2025-06-10 20:24:06,384 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:24:06,387 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=651.0, b=130.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 98))], orig='R _ { n s } = \\left ( \\frac { 1 } { R _ { c } } - \\frac { 1 } { R _ { c 1 } } \\right ) ^ { - 1 } .', text='R _ { n s } = \\left ( \\frac { 1 } { R _ { c } } - \\frac { 1 } { R _ { c 1 } } \\right ) ^ { - 1 } .', formatting=None, hyperlink=None)]
2025-06-10 20:24:06,387 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:24:06,387 - DEBUG - Processing text item: label=formula, text=R _ { n s } = \left ( \frac { 1 } { R _ { c } } - \frac { 1 } { R _ { c 1 } } \right ) ^ { - 1 } .
2025-06-10 20:24:06,387 - DEBUG - Recognized string extracted: R _ { n s } = \left ( \frac { 1 } { R _ { c } } - \frac { 1 } { R _ { c 1 } } \right ) ^ { - 1 } .
2025-06-10 20:24:06,388 - INFO - All done. Returning 5 recognized text results.
2025-06-10 20:24:06,388 - DEBUG - Snippet 10.5194_acp-15-8889-2015_961_item_0 recognized text:
O _ { 3 } + h v \to O ( ^ { 1 } D ) + O _ { 2 } ,
2025-06-10 20:24:06,388 - DEBUG - Snippet 10.5194_acp-15-8889-2015_961_item_1 recognized text:
O ( ^ { 1 } D ) + H _ { 2 } O \to O H + O H ,
2025-06-10 20:24:06,388 - DEBUG - Snippet 10.5194_acp-15-8889-2015_961_item_2 recognized text:
I _ { 6 } + O H + O _ { 2 } \to C _ { 2 } H _ { 5 } O _ { 2 } + H _ { 2 } O ,
2025-06-10 20:24:06,388 - DEBUG - Snippet 10.5194_acp-15-8889-2015_961_item_3 recognized text:
_ { 2 } + N O \to C _ { 2 } H _ { 5 } O + N O _ { 2 } ,
2025-06-10 20:24:06,389 - DEBUG - Snippet 10.5194_acp-15-8889-2015_961_item_4 recognized text:
R _ { n s } = \left ( \frac { 1 } { R _ { c } } - \frac { 1 } { R _ { c 1 } } \right ) ^ { - 1 } .
2025-06-10 20:24:06,485 - DEBUG - Creating masked image for page 36 with 17 clusters.
2025-06-10 20:24:06,487 - INFO - Masked image successfully created for page 36.
2025-06-10 20:24:06,622 - DEBUG - Creating masked image for page 37 with 17 clusters.
2025-06-10 20:24:06,623 - INFO - Masked image successfully created for page 37.
2025-06-10 20:24:06,737 - DEBUG - Creating masked image for page 41 with 17 clusters.
2025-06-10 20:24:06,739 - INFO - Masked image successfully created for page 41.
2025-06-10 20:24:06,853 - DEBUG - Creating masked image for page 45 with 13 clusters.
2025-06-10 20:24:06,855 - INFO - Masked image successfully created for page 45.
2025-06-10 20:24:06,862 - INFO - Starting prediction for 5 images with labels: ['formula', 'formula', 'formula', 'formula', 'formula']
2025-06-10 20:24:06,862 - DEBUG - Generating chat message for label: formula
2025-06-10 20:24:06,863 - DEBUG - Snippet 10.5194_acp-15-8889-2015_961_item_0 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:24:06,924 - DEBUG - Snippet 10.5194_acp-15-8889-2015_961_item_0 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:24:08,022 - DEBUG - Snippet 10.5194_acp-15-8889-2015_961_item_0: generation shape=torch.Size([1, 388])
2025-06-10 20:24:08,023 - DEBUG - Snippet 10.5194_acp-15-8889-2015_961_item_0 raw docling: (tokens=42)
<formula><loc_0><loc_0><loc_500><loc_500>3 r + O _ { 3 } \to B r 0 + O _ { 2 } ,</formula><end_of_utterance>
2025-06-10 20:24:08,023 - DEBUG - Starting _parse_docling_output
2025-06-10 20:24:08,023 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>3 r + O _ { 3 } \to B r 0 + O _ { 2 } ,</formula><end_of_utterance>
2025-06-10 20:24:08,023 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:24:08,024 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>3 r + O _ { 3 } \\to B r 0 + O _ { 2 } ,</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=676x55 at 0x7F967956F830>)]
2025-06-10 20:24:08,024 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:24:08,026 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=676.0, b=55.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 39))], orig='3 r + O _ { 3 } \\to B r 0 + O _ { 2 } ,', text='3 r + O _ { 3 } \\to B r 0 + O _ { 2 } ,', formatting=None, hyperlink=None)]
2025-06-10 20:24:08,026 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:24:08,026 - DEBUG - Processing text item: label=formula, text=3 r + O _ { 3 } \to B r 0 + O _ { 2 } ,
2025-06-10 20:24:08,026 - DEBUG - Recognized string extracted: 3 r + O _ { 3 } \to B r 0 + O _ { 2 } ,
2025-06-10 20:24:08,027 - DEBUG - Generating chat message for label: formula
2025-06-10 20:24:08,027 - DEBUG - Snippet 10.5194_acp-15-8889-2015_961_item_1 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:24:08,087 - DEBUG - Snippet 10.5194_acp-15-8889-2015_961_item_1 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:24:09,201 - DEBUG - Snippet 10.5194_acp-15-8889-2015_961_item_1: generation shape=torch.Size([1, 388])
2025-06-10 20:24:09,202 - DEBUG - Snippet 10.5194_acp-15-8889-2015_961_item_1 raw docling: (tokens=42)
<formula><loc_0><loc_0><loc_500><loc_500>O + H O _ { 2 } \to H O B r + O _ { 2 } ,</formula><end_of_utterance>
2025-06-10 20:24:09,202 - DEBUG - Starting _parse_docling_output
2025-06-10 20:24:09,202 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>O + H O _ { 2 } \to H O B r + O _ { 2 } ,</formula><end_of_utterance>
2025-06-10 20:24:09,202 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:24:09,203 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>O + H O _ { 2 } \\to H O B r + O _ { 2 } ,</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=654x55 at 0x7F967956F6E0>)]
2025-06-10 20:24:09,203 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:24:09,205 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=654.0, b=55.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 41))], orig='O + H O _ { 2 } \\to H O B r + O _ { 2 } ,', text='O + H O _ { 2 } \\to H O B r + O _ { 2 } ,', formatting=None, hyperlink=None)]
2025-06-10 20:24:09,205 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:24:09,205 - DEBUG - Processing text item: label=formula, text=O + H O _ { 2 } \to H O B r + O _ { 2 } ,
2025-06-10 20:24:09,206 - DEBUG - Recognized string extracted: O + H O _ { 2 } \to H O B r + O _ { 2 } ,
2025-06-10 20:24:09,206 - DEBUG - Generating chat message for label: formula
2025-06-10 20:24:09,206 - DEBUG - Snippet 10.5194_acp-15-8889-2015_961_item_2 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:24:09,268 - DEBUG - Snippet 10.5194_acp-15-8889-2015_961_item_2 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:24:09,935 - DEBUG - Snippet 10.5194_acp-15-8889-2015_961_item_2: generation shape=torch.Size([1, 370])
2025-06-10 20:24:09,936 - DEBUG - Snippet 10.5194_acp-15-8889-2015_961_item_2 raw docling: (tokens=24)
<formula><loc_0><loc_0><loc_500><loc_500>\dots \dots</formula><end_of_utterance>
2025-06-10 20:24:09,936 - DEBUG - Starting _parse_docling_output
2025-06-10 20:24:09,936 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>\dots \dots</formula><end_of_utterance>
2025-06-10 20:24:09,937 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:24:09,937 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>\\dots \\dots</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=640x55 at 0x7F9670A4B6E0>)]
2025-06-10 20:24:09,937 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:24:09,938 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=640.0, b=55.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 11))], orig='\\dots \\dots', text='\\dots \\dots', formatting=None, hyperlink=None)]
2025-06-10 20:24:09,938 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:24:09,939 - DEBUG - Processing text item: label=formula, text=\dots \dots
2025-06-10 20:24:09,939 - DEBUG - Recognized string extracted: \dots \dots
2025-06-10 20:24:09,939 - DEBUG - Generating chat message for label: formula
2025-06-10 20:24:09,939 - DEBUG - Snippet 10.5194_acp-15-8889-2015_961_item_3 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:24:09,999 - DEBUG - Snippet 10.5194_acp-15-8889-2015_961_item_3 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:24:11,583 - DEBUG - Snippet 10.5194_acp-15-8889-2015_961_item_3: generation shape=torch.Size([1, 406])
2025-06-10 20:24:11,584 - DEBUG - Snippet 10.5194_acp-15-8889-2015_961_item_3 raw docling: (tokens=60)
<formula><loc_0><loc_0><loc_500><loc_500>C H _ { 4 } + O H + O _ { 2 } \to C H _ { 3 } O _ { 2 } + H _ { 2 } O ,</formula><end_of_utterance>
2025-06-10 20:24:11,584 - DEBUG - Starting _parse_docling_output
2025-06-10 20:24:11,584 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>C H _ { 4 } + O H + O _ { 2 } \to C H _ { 3 } O _ { 2 } + H _ { 2 } O ,</formula><end_of_utterance>
2025-06-10 20:24:11,585 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:24:11,585 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>C H _ { 4 } + O H + O _ { 2 } \\to C H _ { 3 } O _ { 2 } + H _ { 2 } O ,</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=710x55 at 0x7F9670A4BC50>)]
2025-06-10 20:24:11,585 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:24:11,587 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=710.0, b=55.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 71))], orig='C H _ { 4 } + O H + O _ { 2 } \\to C H _ { 3 } O _ { 2 } + H _ { 2 } O ,', text='C H _ { 4 } + O H + O _ { 2 } \\to C H _ { 3 } O _ { 2 } + H _ { 2 } O ,', formatting=None, hyperlink=None)]
2025-06-10 20:24:11,587 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:24:11,588 - DEBUG - Processing text item: label=formula, text=C H _ { 4 } + O H + O _ { 2 } \to C H _ { 3 } O _ { 2 } + H _ { 2 } O ,
2025-06-10 20:24:11,588 - DEBUG - Recognized string extracted: C H _ { 4 } + O H + O _ { 2 } \to C H _ { 3 } O _ { 2 } + H _ { 2 } O ,
2025-06-10 20:24:11,588 - DEBUG - Generating chat message for label: formula
2025-06-10 20:24:11,588 - DEBUG - Snippet 10.5194_acp-15-8889-2015_961_item_4 final prompt:
<|im_start|>User:<image>Convert formula to LaTeX.<end_of_utterance>
Assistant:
2025-06-10 20:24:11,651 - DEBUG - Snippet 10.5194_acp-15-8889-2015_961_item_4 => input_ids shape=torch.Size([1, 345]), prompt_len=345
2025-06-10 20:24:12,881 - DEBUG - Snippet 10.5194_acp-15-8889-2015_961_item_4: generation shape=torch.Size([1, 391])
2025-06-10 20:24:12,882 - DEBUG - Snippet 10.5194_acp-15-8889-2015_961_item_4 raw docling: (tokens=45)
<formula><loc_0><loc_0><loc_500><loc_500>R O + N O _ { 2 } + M \to R O N O _ { 2 } + M ,</formula><end_of_utterance>
2025-06-10 20:24:12,882 - DEBUG - Starting _parse_docling_output
2025-06-10 20:24:12,882 - DEBUG - Raw SmolDocling output at parse_docling_output:
<formula><loc_0><loc_0><loc_500><loc_500>R O + N O _ { 2 } + M \to R O N O _ { 2 } + M ,</formula><end_of_utterance>
2025-06-10 20:24:12,883 - DEBUG - Creating DocTagsDocument from raw_text and snippet_img
2025-06-10 20:24:12,883 - DEBUG - DocTagsDocument created successfully: pages=[DocTagsPage(tokens='<formula><loc_0><loc_0><loc_500><loc_500>R O + N O _ { 2 } + M \\to R O N O _ { 2 } + M ,</formula><end_of_utterance>', image=<PIL.Image.Image image mode=RGB size=710x55 at 0x7F96653A6FF0>)]
2025-06-10 20:24:12,883 - DEBUG - Loading DocTagsDocument into DoclingDocument
2025-06-10 20:24:12,885 - DEBUG - DoclingDocument loaded successfully. Extracted texts: [FormulaItem(self_ref='#/texts/0', parent=RefItem(cref='#/body'), children=[], content_layer=<ContentLayer.BODY: 'body'>, label=<DocItemLabel.FORMULA: 'formula'>, prov=[ProvenanceItem(page_no=1, bbox=BoundingBox(l=0.0, t=0.0, r=710.0, b=55.0, coord_origin=<CoordOrigin.TOPLEFT: 'TOPLEFT'>), charspan=(0, 47))], orig='R O + N O _ { 2 } + M \\to R O N O _ { 2 } + M ,', text='R O + N O _ { 2 } + M \\to R O N O _ { 2 } + M ,', formatting=None, hyperlink=None)]
2025-06-10 20:24:12,886 - DEBUG - Extracting text items from DoclingDocument
2025-06-10 20:24:12,886 - DEBUG - Processing text item: label=formula, text=R O + N O _ { 2 } + M \to R O N O _ { 2 } + M ,
2025-06-10 20:24:12,886 - DEBUG - Recognized string extracted: R O + N O _ { 2 } + M \to R O N O _ { 2 } + M ,
2025-06-10 20:24:12,886 - INFO - All done. Returning 5 recognized text results.
2025-06-10 20:24:12,886 - DEBUG - Snippet 10.5194_acp-15-8889-2015_961_item_0 recognized text:
3 r + O _ { 3 } \to B r 0 + O _ { 2 } ,
2025-06-10 20:24:12,887 - DEBUG - Snippet 10.5194_acp-15-8889-2015_961_item_1 recognized text:
O + H O _ { 2 } \to H O B r + O _ { 2 } ,
2025-06-10 20:24:12,887 - DEBUG - Snippet 10.5194_acp-15-8889-2015_961_item_2 recognized text:
\dots \dots
2025-06-10 20:24:12,887 - DEBUG - Snippet 10.5194_acp-15-8889-2015_961_item_3 recognized text:
C H _ { 4 } + O H + O _ { 2 } \to C H _ { 3 } O _ { 2 } + H _ { 2 } O ,
2025-06-10 20:24:12,887 - DEBUG - Snippet 10.5194_acp-15-8889-2015_961_item_4 recognized text:
R O + N O _ { 2 } + M \to R O N O _ { 2 } + M ,
2025-06-10 20:24:13,740 - INFO - Finished converting document 10.5194_acp-15-8889-2015_961.pdf in 119.73 sec.
2025-06-10 20:24:17,673 - INFO - Extraction successful row 194, tokens=136918
2025-06-10 20:24:19,095 - INFO - Multiprocessing Docling extraction complete.
2025-06-10 20:24:19,249 - INFO - Results saved to /mnt/c/Users/WSTATION/Desktop/docling_mods/data/ETL_output_docling_ts.feather
